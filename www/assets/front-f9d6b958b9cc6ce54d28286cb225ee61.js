if(!function(){"use strict";function t(t,e,n,i){function r(t,e){return t-=i,e-=i,0>t||t>=a||0>e||e>=a?!1:o.isDark(t,e)}var o=x(n,e);o.addData(t),o.make(),i=i||0;var a=o.getModuleCount(),s=o.getModuleCount()+2*i,l=function(t,e,n,i){var r=this.isDark,o=1/s;this.isDark=function(a,s){var l=s*o,u=a*o,c=l+o,h=u+o;return r(a,s)&&(t>c||l>n||e>h||u>i)}};this.text=t,this.level=e,this.version=n,this.moduleCount=s,this.isDark=r,this.addBlank=l}function e(e,n,i,r,o){i=Math.max(1,i||1),r=Math.min(40,r||40);for(var a=i;r>=a;a+=1)try{return new t(e,n,a,o)}catch(s){}}function n(t,e,n){var i=n.size,r="bold "+n.mSize*i+"px "+n.fontname,o=g("<canvas/>")[0].getContext("2d");o.font=r;var a=o.measureText(n.label).width,s=n.mSize,l=a/i,u=(1-l)*n.mPosX,c=(1-s)*n.mPosY,h=u+l,d=c+s,f=.01;1===n.mode?t.addBlank(0,c-f,i,d+f):t.addBlank(u-f,c-f,h+f,d+f),e.fillStyle=n.fontcolor,e.font=r,e.fillText(n.label,u*i,c*i+.75*n.mSize*i)}function i(t,e,n){var i=n.size,r=n.image.naturalWidth||1,o=n.image.naturalHeight||1,a=n.mSize,s=a*r/o,l=(1-s)*n.mPosX,u=(1-a)*n.mPosY,c=l+s,h=u+a,d=.01;3===n.mode?t.addBlank(0,u-d,i,h+d):t.addBlank(l-d,u-d,c+d,h+d),e.drawImage(n.image,l*i,u*i,s*i,a*i)}function r(t,e,r){g(r.background).is("img")?e.drawImage(r.background,0,0,r.size,r.size):r.background&&(e.fillStyle=r.background,e.fillRect(r.left,r.top,r.size,r.size));var o=r.mode;1===o||2===o?n(t,e,r):(3===o||4===o)&&i(t,e,r)}function o(t,e,n,i,r,o,a,s){t.isDark(a,s)&&e.rect(i,r,o,o)}function a(t,e,n,i,r,o,a,s,l,u){a?t.moveTo(e+o,n):t.moveTo(e,n),s?(t.lineTo(i-o,n),t.arcTo(i,n,i,r,o)):t.lineTo(i,n),l?(t.lineTo(i,r-o),t.arcTo(i,r,e,r,o)):t.lineTo(i,r),u?(t.lineTo(e+o,r),t.arcTo(e,r,e,n,o)):t.lineTo(e,r),a?(t.lineTo(e,n+o),t.arcTo(e,n,i,n,o)):t.lineTo(e,n)}function s(t,e,n,i,r,o,a,s,l,u){a&&(t.moveTo(e+o,n),t.lineTo(e,n),t.lineTo(e,n+o),t.arcTo(e,n,e+o,n,o)),s&&(t.moveTo(i-o,n),t.lineTo(i,n),t.lineTo(i,n+o),t.arcTo(i,n,i-o,n,o)),l&&(t.moveTo(i-o,r),t.lineTo(i,r),t.lineTo(i,r-o),t.arcTo(i,r,i-o,r,o)),u&&(t.moveTo(e+o,r),t.lineTo(e,r),t.lineTo(e,r-o),t.arcTo(e,r,e+o,r,o))}function l(t,e,n,i,r,o,l,u){var c=t.isDark,h=i+o,d=r+o,f=n.radius*o,p=l-1,g=l+1,m=u-1,v=u+1,y=c(l,u),x=c(p,m),b=c(p,u),_=c(p,v),w=c(l,v),k=c(g,v),C=c(g,u),j=c(g,m),E=c(l,m);y?a(e,i,r,h,d,f,!b&&!E,!b&&!w,!C&&!w,!C&&!E):s(e,i,r,h,d,f,b&&E&&x,b&&w&&_,C&&w&&k,C&&E&&j)}function u(t,e,n){var i,r,a=t.moduleCount,s=n.size/a,u=o;for(v&&n.radius>0&&n.radius<=.5&&(u=l),e.beginPath(),i=0;a>i;i+=1)for(r=0;a>r;r+=1){var c=n.left+r*s,h=n.top+i*s,d=s;u(t,e,n,c,h,d,i,r)}if(g(n.fill).is("img")){e.strokeStyle="rgba(0,0,0,0.5)",e.lineWidth=2,e.stroke();var f=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",e.fill(),e.globalCompositeOperation=f,e.clip(),e.drawImage(n.fill,0,0,n.size,n.size),e.restore()}else e.fillStyle=n.fill,e.fill()}function c(t,n){var i=e(n.text,n.ecLevel,n.minVersion,n.maxVersion,n.quiet);if(!i)return null;var o=g(t).data("qrcode",i),a=o[0].getContext("2d");return r(i,a,n),u(i,a,n),o}function h(t){var e=g("<canvas/>").attr("width",t.size).attr("height",t.size);return c(e,t)}function d(t){return g("<img/>").attr("src",h(t)[0].toDataURL("image/png"))}function f(t){var n=e(t.text,t.ecLevel,t.minVersion,t.maxVersion,t.quiet);if(!n)return null;var i,r,o=t.size,a=t.background,s=Math.floor,l=n.moduleCount,u=s(o/l),c=s(.5*(o-u*l)),h={position:"relative",left:0,top:0,padding:0,margin:0,width:o,height:o},d={position:"absolute",padding:0,margin:0,width:u,height:u,"background-color":t.fill},f=g("<div/>").data("qrcode",n).css(h);for(a&&f.css("background-color",a),i=0;l>i;i+=1)for(r=0;l>r;r+=1)n.isDark(i,r)&&g("<div/>").css(d).css({left:c+r*u,top:c+i*u}).appendTo(f);return f}function p(t){return m&&"canvas"===t.render?h(t):m&&"image"===t.render?d(t):f(t)}var g=jQuery,m=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}(),v="[object Opera]"!==Object.prototype.toString.call(window.opera),y={render:"canvas",minVersion:1,maxVersion:40,ecLevel:"L",left:0,top:0,size:200,fill:"#000",background:null,text:"no text",radius:0,quiet:0,mode:0,mSize:.1,mPosX:.5,mPosY:.5,label:"no label",fontname:"sans",fontcolor:"#000",image:null};g.fn.qrcode=function(t){var e=g.extend({},y,t);return this.each(function(){"canvas"===this.nodeName.toLowerCase()?c(this,e):g(this).append(p(e))})};var x=function(){function t(e,n){if("undefined"==typeof e.length)throw new Error(e.length+"/"+n);var i=function(){for(var t=0;t<e.length&&0==e[t];)t+=1;for(var i=new Array(e.length-t+n),r=0;r<e.length-t;r+=1)i[r]=e[r+t];return i}(),r={};return r.get=function(t){return i[t]},r.getLength=function(){return i.length},r.multiply=function(e){for(var n=new Array(r.getLength()+e.getLength()-1),i=0;i<r.getLength();i+=1)for(var o=0;o<e.getLength();o+=1)n[i+o]^=a.gexp(a.glog(r.get(i))+a.glog(e.get(o)));return t(n,0)},r.mod=function(e){if(r.getLength()-e.getLength()<0)return r;for(var n=a.glog(r.get(0))-a.glog(e.get(0)),i=new Array(r.getLength()),o=0;o<r.getLength();o+=1)i[o]=r.get(o);for(var o=0;o<e.getLength();o+=1)i[o]^=a.gexp(a.glog(e.get(o))+n);return t(i,0).mod(e)},r}var e=function(e,n){var r=236,a=17,c=e,h=i[n],d=null,f=0,g=null,m=new Array,v={},y=function(t,e){f=4*c+17,d=function(t){for(var e=new Array(t),n=0;t>n;n+=1){e[n]=new Array(t);for(var i=0;t>i;i+=1)e[n][i]=null}return e}(f),x(0,0),x(f-7,0),x(0,f-7),w(),_(),C(t,e),c>=7&&k(t),null==g&&(g=A(c,h,m)),j(g,e)},x=function(t,e){for(var n=-1;7>=n;n+=1)if(!(-1>=t+n||t+n>=f))for(var i=-1;7>=i;i+=1)-1>=e+i||e+i>=f||(d[t+n][e+i]=n>=0&&6>=n&&(0==i||6==i)||i>=0&&6>=i&&(0==n||6==n)||n>=2&&4>=n&&i>=2&&4>=i?!0:!1)},b=function(){for(var t=0,e=0,n=0;8>n;n+=1){y(!0,n);var i=o.getLostPoint(v);(0==n||t>i)&&(t=i,e=n)}return e},_=function(){for(var t=8;f-8>t;t+=1)null==d[t][6]&&(d[t][6]=t%2==0);for(var e=8;f-8>e;e+=1)null==d[6][e]&&(d[6][e]=e%2==0)},w=function(){for(var t=o.getPatternPosition(c),e=0;e<t.length;e+=1)for(var n=0;n<t.length;n+=1){var i=t[e],r=t[n];if(null==d[i][r])for(var a=-2;2>=a;a+=1)for(var s=-2;2>=s;s+=1)d[i+a][r+s]=-2==a||2==a||-2==s||2==s||0==a&&0==s?!0:!1}},k=function(t){for(var e=o.getBCHTypeNumber(c),n=0;18>n;n+=1){var i=!t&&1==(e>>n&1);d[Math.floor(n/3)][n%3+f-8-3]=i}for(var n=0;18>n;n+=1){var i=!t&&1==(e>>n&1);d[n%3+f-8-3][Math.floor(n/3)]=i}},C=function(t,e){for(var n=h<<3|e,i=o.getBCHTypeInfo(n),r=0;15>r;r+=1){var a=!t&&1==(i>>r&1);6>r?d[r][8]=a:8>r?d[r+1][8]=a:d[f-15+r][8]=a}for(var r=0;15>r;r+=1){var a=!t&&1==(i>>r&1);8>r?d[8][f-r-1]=a:9>r?d[8][15-r-1+1]=a:d[8][15-r-1]=a}d[f-8][8]=!t},j=function(t,e){for(var n=-1,i=f-1,r=7,a=0,s=o.getMaskFunction(e),l=f-1;l>0;l-=2)for(6==l&&(l-=1);;){for(var u=0;2>u;u+=1)if(null==d[i][l-u]){var c=!1;a<t.length&&(c=1==(t[a]>>>r&1));var h=s(i,l-u);h&&(c=!c),d[i][l-u]=c,r-=1,-1==r&&(a+=1,r=7)}if(i+=n,0>i||i>=f){i-=n,n=-n;break}}},E=function(e,n){for(var i=0,r=0,a=0,s=new Array(n.length),l=new Array(n.length),u=0;u<n.length;u+=1){var c=n[u].dataCount,h=n[u].totalCount-c;r=Math.max(r,c),a=Math.max(a,h),s[u]=new Array(c);for(var d=0;d<s[u].length;d+=1)s[u][d]=255&e.getBuffer()[d+i];i+=c;var f=o.getErrorCorrectPolynomial(h),p=t(s[u],f.getLength()-1),g=p.mod(f);l[u]=new Array(f.getLength()-1);for(var d=0;d<l[u].length;d+=1){var m=d+g.getLength()-l[u].length;l[u][d]=m>=0?g.get(m):0}}for(var v=0,d=0;d<n.length;d+=1)v+=n[d].totalCount;for(var y=new Array(v),x=0,d=0;r>d;d+=1)for(var u=0;u<n.length;u+=1)d<s[u].length&&(y[x]=s[u][d],x+=1);for(var d=0;a>d;d+=1)for(var u=0;u<n.length;u+=1)d<l[u].length&&(y[x]=l[u][d],x+=1);return y},A=function(t,e,n){for(var i=s.getRSBlocks(t,e),u=l(),c=0;c<n.length;c+=1){var h=n[c];u.put(h.getMode(),4),u.put(h.getLength(),o.getLengthInBits(h.getMode(),t)),h.write(u)}for(var d=0,c=0;c<i.length;c+=1)d+=i[c].dataCount;if(u.getLengthInBits()>8*d)throw new Error("code length overflow. ("+u.getLengthInBits()+">"+8*d+")");for(u.getLengthInBits()+4<=8*d&&u.put(0,4);u.getLengthInBits()%8!=0;)u.putBit(!1);for(;!(u.getLengthInBits()>=8*d)&&(u.put(r,8),!(u.getLengthInBits()>=8*d));)u.put(a,8);return E(u,i)};return v.addData=function(t){var e=u(t);m.push(e),g=null},v.isDark=function(t,e){if(0>t||t>=f||0>e||e>=f)throw new Error(t+","+e);return d[t][e]},v.getModuleCount=function(){return f},v.make=function(){y(!1,b())},v.createTableTag=function(t,e){t=t||2,e="undefined"==typeof e?4*t:e;var n="";n+='<table style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: "+e+"px;",n+='">',n+="<tbody>";for(var i=0;i<v.getModuleCount();i+=1){n+="<tr>";for(var r=0;r<v.getModuleCount();r+=1)n+='<td style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: 0px;",n+=" width: "+t+"px;",n+=" height: "+t+"px;",n+=" background-color: ",n+=v.isDark(i,r)?"#000000":"#ffffff",n+=";",n+='"/>';n+="</tr>"}return n+="</tbody>",n+="</table>"},v.createImgTag=function(t,e){t=t||2,e="undefined"==typeof e?4*t:e;var n=v.getModuleCount()*t+2*e,i=e,r=n-e;return p(n,n,function(e,n){if(e>=i&&r>e&&n>=i&&r>n){var o=Math.floor((e-i)/t),a=Math.floor((n-i)/t);return v.isDark(a,o)?0:1}return 1})},v};e.stringToBytes=function(t){for(var e=new Array,n=0;n<t.length;n+=1){var i=t.charCodeAt(n);e.push(255&i)}return e},e.createStringToBytes=function(t,e){var n=function(){for(var n=d(t),i=function(){var t=n.read();if(-1==t)throw new Error;return t},r=0,o={};;){var a=n.read();if(-1==a)break;var s=i(),l=i(),u=i(),c=String.fromCharCode(a<<8|s),h=l<<8|u;o[c]=h,r+=1}if(r!=e)throw new Error(r+" != "+e);return o}(),i="?".charCodeAt(0);return function(t){for(var e=new Array,r=0;r<t.length;r+=1){var o=t.charCodeAt(r);if(128>o)e.push(o);else{var a=n[t.charAt(r)];"number"==typeof a?(255&a)==a?e.push(a):(e.push(a>>>8),e.push(255&a)):e.push(i)}}return e}};var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},i={L:1,M:0,Q:3,H:2},r={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},o=function(){var e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],i=1335,o=7973,s=21522,l={},u=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e};return l.getBCHTypeInfo=function(t){for(var e=t<<10;u(e)-u(i)>=0;)e^=i<<u(e)-u(i);return(t<<10|e)^s},l.getBCHTypeNumber=function(t){for(var e=t<<12;u(e)-u(o)>=0;)e^=o<<u(e)-u(o);return t<<12|e},l.getPatternPosition=function(t){return e[t-1]},l.getMaskFunction=function(t){switch(t){case r.PATTERN000:return function(t,e){return(t+e)%2==0};case r.PATTERN001:return function(t){return t%2==0};case r.PATTERN010:return function(t,e){return e%3==0};case r.PATTERN011:return function(t,e){return(t+e)%3==0};case r.PATTERN100:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case r.PATTERN101:return function(t,e){return t*e%2+t*e%3==0};case r.PATTERN110:return function(t,e){return(t*e%2+t*e%3)%2==0};case r.PATTERN111:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw new Error("bad maskPattern:"+t)}},l.getErrorCorrectPolynomial=function(e){for(var n=t([1],0),i=0;e>i;i+=1)n=n.multiply(t([1,a.gexp(i)],0));return n},l.getLengthInBits=function(t,e){if(e>=1&&10>e)switch(t){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:return 8;case n.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(27>e)switch(t){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(41>e))throw new Error("type:"+e);switch(t){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},l.getLostPoint=function(t){for(var e=t.getModuleCount(),n=0,i=0;e>i;i+=1)for(var r=0;e>r;r+=1){for(var o=0,a=t.isDark(i,r),s=-1;1>=s;s+=1)if(!(0>i+s||i+s>=e))for(var l=-1;1>=l;l+=1)0>r+l||r+l>=e||(0!=s||0!=l)&&a==t.isDark(i+s,r+l)&&(o+=1);o>5&&(n+=3+o-5)}for(var i=0;e-1>i;i+=1)for(var r=0;e-1>r;r+=1){var u=0;t.isDark(i,r)&&(u+=1),t.isDark(i+1,r)&&(u+=1),t.isDark(i,r+1)&&(u+=1),t.isDark(i+1,r+1)&&(u+=1),(0==u||4==u)&&(n+=3)}for(var i=0;e>i;i+=1)for(var r=0;e-6>r;r+=1)t.isDark(i,r)&&!t.isDark(i,r+1)&&t.isDark(i,r+2)&&t.isDark(i,r+3)&&t.isDark(i,r+4)&&!t.isDark(i,r+5)&&t.isDark(i,r+6)&&(n+=40);for(var r=0;e>r;r+=1)for(var i=0;e-6>i;i+=1)t.isDark(i,r)&&!t.isDark(i+1,r)&&t.isDark(i+2,r)&&t.isDark(i+3,r)&&t.isDark(i+4,r)&&!t.isDark(i+5,r)&&t.isDark(i+6,r)&&(n+=40);for(var c=0,r=0;e>r;r+=1)for(var i=0;e>i;i+=1)t.isDark(i,r)&&(c+=1);var h=Math.abs(100*c/e/e-50)/5;return n+=10*h},l}(),a=function(){for(var t=new Array(256),e=new Array(256),n=0;8>n;n+=1)t[n]=1<<n;for(var n=8;256>n;n+=1)t[n]=t[n-4]^t[n-5]^t[n-6]^t[n-8];for(var n=0;255>n;n+=1)e[t[n]]=n;var i={};return i.glog=function(t){if(1>t)throw new Error("glog("+t+")");return e[t]},i.gexp=function(e){for(;0>e;)e+=255;for(;e>=256;)e-=255;return t[e]},i}(),s=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var n={};return n.totalCount=t,n.dataCount=e,n},n={},r=function(e,n){switch(n){case i.L:return t[4*(e-1)+0];case i.M:return t[4*(e-1)+1];case i.Q:return t[4*(e-1)+2];case i.H:return t[4*(e-1)+3];default:return void 0}};return n.getRSBlocks=function(t,n){var i=r(t,n);if("undefined"==typeof i)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+n);for(var o=i.length/3,a=new Array,s=0;o>s;s+=1)for(var l=i[3*s+0],u=i[3*s+1],c=i[3*s+2],h=0;l>h;h+=1)a.push(e(u,c));return a},n}(),l=function(){var t=new Array,e=0,n={};return n.getBuffer=function(){return t},n.get=function(e){var n=Math.floor(e/8);return 1==(t[n]>>>7-e%8&1)},n.put=function(t,e){for(var i=0;e>i;i+=1)n.putBit(1==(t>>>e-i-1&1))},n.getLengthInBits=function(){return e},n.putBit=function(n){var i=Math.floor(e/8);t.length<=i&&t.push(0),n&&(t[i]|=128>>>e%8),e+=1},n},u=function(t){var i=n.MODE_8BIT_BYTE,r=e.stringToBytes(t),o={};return o.getMode=function(){return i},o.getLength=function(){return r.length},o.write=function(t){for(var e=0;e<r.length;e+=1)t.put(r[e],8)},o},c=function(){var t=new Array,e={};return e.writeByte=function(e){t.push(255&e)},e.writeShort=function(t){e.writeByte(t),e.writeByte(t>>>8)},e.writeBytes=function(t,n,i){n=n||0,i=i||t.length;for(var r=0;i>r;r+=1)e.writeByte(t[r+n])},e.writeString=function(t){for(var n=0;n<t.length;n+=1)e.writeByte(t.charCodeAt(n))},e.toByteArray=function(){return t},e.toString=function(){var e="";e+="[";for(var n=0;n<t.length;n+=1)n>0&&(e+=","),e+=t[n];return e+="]"},e},h=function(){var t=0,e=0,n=0,i="",r={},o=function(t){i+=String.fromCharCode(a(63&t))},a=function(t){if(0>t);else{if(26>t)return 65+t;if(52>t)return 97+(t-26);if(62>t)return 48+(t-52);if(62==t)return 43;if(63==t)return 47}throw new Error("n:"+t)};return r.writeByte=function(i){for(t=t<<8|255&i,e+=8,n+=1;e>=6;)o(t>>>e-6),e-=6},r.flush=function(){if(e>0&&(o(t<<6-e),t=0,e=0),n%3!=0)for(var r=3-n%3,a=0;r>a;a+=1)i+="="},r.toString=function(){return i},r},d=function(t){var e=t,n=0,i=0,r=0,o={};o.read=function(){for(;8>r;){if(n>=e.length){if(0==r)return-1;throw new Error("unexpected end of file./"+r)}var t=e.charAt(n);if(n+=1,"="==t)return r=0,-1;t.match(/^\s$/)||(i=i<<6|a(t.charCodeAt(0)),r+=6)}var o=i>>>r-8&255;return r-=8,o};var a=function(t){if(t>=65&&90>=t)return t-65;if(t>=97&&122>=t)return t-97+26;if(t>=48&&57>=t)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw new Error("c:"+t)};return o},f=function(t,e){var n=t,i=e,r=new Array(t*e),o={};o.setPixel=function(t,e,i){r[e*n+t]=i},o.write=function(t){t.writeString("GIF87a"),t.writeShort(n),t.writeShort(i),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(","),t.writeShort(0),t.writeShort(0),t.writeShort(n),t.writeShort(i),t.writeByte(0);var e=2,r=s(e);t.writeByte(e);for(var o=0;r.length-o>255;)t.writeByte(255),t.writeBytes(r,o,255),o+=255;t.writeByte(r.length-o),t.writeBytes(r,o,r.length-o),t.writeByte(0),t.writeString(";")};var a=function(t){var e=t,n=0,i=0,r={};return r.write=function(t,r){if(t>>>r!=0)throw new Error("length over");for(;n+r>=8;)e.writeByte(255&(t<<n|i)),r-=8-n,t>>>=8-n,i=0,n=0;i=t<<n|i,n+=r},r.flush=function(){n>0&&e.writeByte(i)},r},s=function(t){for(var e=1<<t,n=(1<<t)+1,i=t+1,o=l(),s=0;e>s;s+=1)o.add(String.fromCharCode(s));o.add(String.fromCharCode(e)),o.add(String.fromCharCode(n));var u=c(),h=a(u);h.write(e,i);var d=0,f=String.fromCharCode(r[d]);for(d+=1;d<r.length;){var p=String.fromCharCode(r[d]);d+=1,o.contains(f+p)?f+=p:(h.write(o.indexOf(f),i),o.size()<4095&&(o.size()==1<<i&&(i+=1),o.add(f+p)),f=p)}return h.write(o.indexOf(f),i),h.write(n,i),h.flush(),u.toByteArray()},l=function(){var t={},e=0,n={};return n.add=function(i){if(n.contains(i))throw new Error("dup key:"+i);t[i]=e,e+=1},n.size=function(){return e},n.indexOf=function(e){return t[e]},n.contains=function(e){return"undefined"!=typeof t[e]},n};return o},p=function(t,e,n,i){for(var r=f(t,e),o=0;e>o;o+=1)for(var a=0;t>a;a+=1)r.setPixel(a,o,n(a,o));var s=c();r.write(s);for(var l=h(),u=s.toByteArray(),d=0;d<u.length;d+=1)l.writeByte(u[d]);l.flush();var p="";return p+="<img",p+=' src="',p+="data:image/gif;base64,",p+=l,p+='"',p+=' width="',p+=t,p+='"',p+=' height="',p+=e,p+='"',i&&(p+=' alt="',p+=i,p+='"'),p+="/>"};return e}()}(),function(t){if("function"==typeof define&&define.amd)define(t);else if("object"==typeof exports)module.exports=t();else{var e=window.Cookies,n=window.Cookies=t(window.jQuery);n.noConflict=function(){return window.Cookies=e,n}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}function e(n){function i(e,r,o){var a;if(arguments.length>1){if(o=t({path:"/"},i.defaults,o),"number"==typeof o.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*o.expires),o.expires=s}try{a=JSON.stringify(r),/^[\{\[]/.test(a)&&(r=a)}catch(l){}return r=encodeURIComponent(String(r)),r=r.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape),document.cookie=[e,"=",r,o.expires&&"; expires="+o.expires.toUTCString(),o.path&&"; path="+o.path,o.domain&&"; domain="+o.domain,o.secure?"; secure":""].join("")}e||(a={});for(var u=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,h=0;h<u.length;h++){var d=u[h].split("="),f=d[0].replace(c,decodeURIComponent),p=d.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{if(p=n&&n(p,f)||p.replace(c,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(l){}if(e===f){a=p;break}e||(a[f]=p)}catch(l){}}return a}return i.get=i.set=i,i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(e,n){i(e,"",t(n,{expires:-1}))},i.withConverter=e,i}return e()}),function(t){"use strict";var e,n=t.Base64,i="2.1.9";if("undefined"!=typeof module&&module.exports)try{e=require("buffer").Buffer}catch(r){}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(t){for(var e={},n=0,i=t.length;i>n;n++)e[t.charAt(n)]=n;return e}(o),s=String.fromCharCode,l=function(t){if(t.length<2){var e=t.charCodeAt(0);return 128>e?t:2048>e?s(192|e>>>6)+s(128|63&e):s(224|e>>>12&15)+s(128|e>>>6&63)+s(128|63&e)}var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return s(240|e>>>18&7)+s(128|e>>>12&63)+s(128|e>>>6&63)+s(128|63&e)},u=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(t){return t.replace(u,l)},h=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0),i=[o.charAt(n>>>18),o.charAt(n>>>12&63),e>=2?"=":o.charAt(n>>>6&63),e>=1?"=":o.charAt(63&n)];return i.join("")},d=t.btoa?function(e){return t.btoa(e)}:function(t){return t.replace(/[\s\S]{1,3}/g,h)},f=e?function(t){return(t.constructor===e.constructor?t:new e(t)).toString("base64")}:function(t){return d(c(t))},p=function(t,e){return e?f(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):f(String(t))},g=function(t){return p(t,!0)},m=new RegExp(["[\xc0-\xdf][\x80-\xbf]","[\xe0-\xef][\x80-\xbf]{2}","[\xf0-\xf7][\x80-\xbf]{3}"].join("|"),"g"),v=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return s((n>>>10)+55296)+s((1023&n)+56320);case 3:return s((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return s((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},y=function(t){return t.replace(m,v)},x=function(t){var e=t.length,n=e%4,i=(e>0?a[t.charAt(0)]<<18:0)|(e>1?a[t.charAt(1)]<<12:0)|(e>2?a[t.charAt(2)]<<6:0)|(e>3?a[t.charAt(3)]:0),r=[s(i>>>16),s(i>>>8&255),s(255&i)];return r.length-=[0,0,2,1][n],r.join("")},b=t.atob?function(e){return t.atob(e)}:function(t){return t.replace(/[\s\S]{1,4}/g,x)},_=e?function(t){return(t.constructor===e.constructor?t:new e(t,"base64")).toString()}:function(t){return y(b(t))},w=function(t){return _(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},k=function(){var e=t.Base64;return t.Base64=n,e};if(t.Base64={VERSION:i,atob:b,btoa:d,fromBase64:w,toBase64:p,utob:c,encode:p,encodeURI:g,btou:y,decode:w,noConflict:k},"function"==typeof Object.defineProperty){var C=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",C(function(){return w(this)})),Object.defineProperty(String.prototype,"toBase64",C(function(t){return p(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",C(function(){return p(this,!0)}))}}t.Meteor&&(Base64=t.Base64)}(this),function(){function t(t,e,n){for(var i=(n||0)-1,r=t?t.length:0;++i<r;)if(t[i]===e)return i;return-1}function e(e,n){var i=typeof n;if(e=e.cache,"boolean"==i||null==n)return e[n]?0:-1;"number"!=i&&"string"!=i&&(i="object");var r="number"==i?n:y+n;return e=(e=e[i])&&e[r],"object"==i?e&&t(e,n)>-1?0:-1:e?0:-1}function n(t){var e=this.cache,n=typeof t;if("boolean"==n||null==t)e[t]=!0;else{"number"!=n&&"string"!=n&&(n="object");var i="number"==n?t:y+t,r=e[n]||(e[n]={});"object"==n?(r[i]||(r[i]=[])).push(t):r[i]=!0}}function i(t){return t.charCodeAt(0)}function r(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||"undefined"==typeof n)return 1;if(i>n||"undefined"==typeof i)return-1}return t.index-e.index}function o(t){var e=-1,i=t.length,r=t[0],o=t[i/2|0],a=t[i-1];if(r&&"object"==typeof r&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;var s=l();s["false"]=s["null"]=s["true"]=s.undefined=!1;var u=l();for(u.array=t,u.cache=s,u.push=n;++e<i;)u.push(t[e]);return u}function a(t){return"\\"+Y[t]}function s(){return g.pop()||[]}function l(){return m.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function u(){}function c(t){t.length=0,g.length<b&&g.push(t)}function h(t){var e=t.cache;e&&h(e),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,m.length<b&&m.push(t)}function d(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var i=-1,r=n-e||0,o=Array(0>r?0:r);++i<r;)o[i]=t[e+i];return o}function f(n){function g(t){return t&&"object"==typeof t&&!Wn(t)&&jn.call(t,"__wrapped__")?t:new m(t)}function m(t,e){this.__chain__=!!e,this.__wrapped__=t}function b(t,e,n,i,r){if(n){var o=n(t);if("undefined"!=typeof o)return o}var a=Et(t);if(!a)return t;var l=Mn.call(t);if(!U[l])return t;var u=Xn[l];switch(l){case F:case O:return new u(+t);case D:case G:return new u(t);case R:return o=u(t.source,E.exec(t)),o.lastIndex=t.lastIndex,o}var h=Wn(t);if(e){var f=!i;i||(i=s()),r||(r=s());for(var p=i.length;p--;)if(i[p]==t)return r[p];o=h?u(t.length):{}}else o=h?d(t):ii({},t);return h&&(jn.call(t,"index")&&(o.index=t.index),jn.call(t,"input")&&(o.input=t.input)),e?(i.push(t),r.push(o),(h?qt:ai)(t,function(t,a){o[a]=b(t,e,n,i,r)}),f&&(c(i),c(r)),o):o}function Y(t,e,n){if("function"!=typeof t)return qe;if("undefined"==typeof e)return t;var i=t.__bindData__||Yn.funcNames&&!t.name;if("undefined"==typeof i){var r=M&&kn.call(t);Yn.funcNames||!r||A.test(r)||(i=!0),(Yn.funcNames||!i)&&(i=!Yn.funcDecomp||M.test(r),Jn(t,i))}if(i!==!0&&i&&1&i[1])return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return Se(t,e)}function W(t,e,n,i){for(var r=(i||0)-1,o=t?t.length:0,a=[];++r<o;){var s=t[r];if(s&&"object"==typeof s&&"number"==typeof s.length&&(Wn(s)||ut(s))){e||(s=W(s,e,n));var l=-1,u=s.length,c=a.length;for(a.length+=u;++l<u;)a[c++]=s[l]}else n||a.push(s)}return a}function K(t,e,n,i,r,o){if(n){var a=n(t,e);if("undefined"!=typeof a)return!!a}if(t===e)return 0!==t||1/t==1/e;var l=typeof t,u=typeof e;if(!(t!==t||t&&X[l]||e&&X[u]))return!1;if(null==t||null==e)return t===e;var h=Mn.call(t),d=Mn.call(e);if(h==$&&(h=N),d==$&&(d=N),h!=d)return!1;switch(h){case F:case O:return+t==+e;case D:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case R:case G:return t==pn(e)}var f=h==z;if(!f){if(jn.call(t,"__wrapped__ ")||jn.call(e,"__wrapped__"))return K(t.__wrapped__||t,e.__wrapped__||e,n,i,r,o);if(h!=N)return!1;var p=t.constructor,g=e.constructor;if(p!=g&&!(jt(p)&&p instanceof p&&jt(g)&&g instanceof g))return!1}var m=!r;r||(r=s()),o||(o=s());for(var v=r.length;v--;)if(r[v]==t)return o[v]==e;var y=0;if(a=!0,r.push(t),o.push(e),f){if(v=t.length,y=e.length,a=y==t.length,!a&&!i)return a;for(;y--;){var x=v,b=e[y];if(i)for(;x--&&!(a=K(t[x],b,n,i,r,o)););else if(!(a=K(t[y],b,n,i,r,o)))break}return a}return oi(e,function(e,s,l){return jn.call(l,s)?(y++,a=jn.call(t,s)&&K(t[s],e,n,i,r,o)):void 0}),a&&!i&&oi(t,function(t,e,n){return jn.call(n,e)?a=--y>-1:void 0}),m&&(c(r),c(o)),a}function Q(t,e,n,i,r){(Wn(e)?qt:ai)(e,function(e,o){var a,s,l=e,u=t[o];if(e&&((s=Wn(e))||si(e))){for(var c=i.length;c--;)if(a=i[c]==e){u=r[c];break}if(!a){var h;n&&(l=n(u,e),(h="undefined"!=typeof l)&&(u=l)),h||(u=s?Wn(u)?u:[]:si(u)?u:{}),i.push(e),r.push(u),h||Q(u,e,n,i,r)}}else n&&(l=n(u,e),"undefined"==typeof l&&(l=e)),"undefined"!=typeof l&&(u=l);t[o]=u})}function et(n,i,r){var a=-1,l=at(),u=n?n.length:0,d=[],f=!i&&u>=x&&l===t,p=r||f?s():d;if(f){var g=o(p);g?(l=e,p=g):(f=!1,p=r?p:(c(p),d))}for(;++a<u;){var m=n[a],v=r?r(m,a,n):m;(i?!a||p[p.length-1]!==v:l(p,v)<0)&&((r||f)&&p.push(v),d.push(m))}return f?(c(p.array),h(p)):r&&c(p),d}function nt(t){return function(e,n,i){var r={};n=g.createCallback(n,i,3);var o=-1,a=e?e.length:0;if("number"==typeof a)for(;++o<a;){var s=e[o];t(r,s,n(s,o,e),e)}else ai(e,function(e,i,o){t(r,e,n(e,i,o),o)});return r}}function it(t,e,n,i,r,o){var a=1&e,s=2&e,l=4&e,u=8&e,c=16&e,h=32&e,d=t;if(!s&&!jt(t))throw new gn;c&&!n.length&&(e&=-17,c=n=!1),h&&!i.length&&(e&=-33,h=i=!1);var f=t&&t.__bindData__;if(f)return!a||1&f[1]||(f[4]=r),!a&&1&f[1]&&(e|=8),!l||4&f[1]||(f[5]=o),c&&An.apply(f[2]||(f[2]=[]),n),h&&An.apply(f[3]||(f[3]=[]),i),f[1]|=e,it.apply(null,f);if(a&&!(s||l||h)&&(Yn.fastBind||Ln&&c)){if(c){var p=[r];An.apply(p,n)}var g=c?Ln.apply(t,p):Ln.call(t,r)}else g=function(){var f=arguments,p=a?r:this;if((l||c||h)&&(f=Un.call(f),c&&Pn.apply(f,n),h&&An.apply(f,i),l&&f.length<o))return e|=16,it(t,u?e:-4&e,f,null,r,o);if(s&&(t=p[d]),this instanceof g){p=rt(t.prototype);var m=t.apply(p,f);return Et(m)?m:p}return t.apply(p,f)};return Jn(g,Un.call(arguments)),g}function rt(t){return Et(t)?$n(t):{}}function ot(t){return Qn[t]}function at(){var e=(e=g.indexOf)===fe?t:e;return e}function st(t){var e,n;return t&&Mn.call(t)==N&&(e=t.constructor,!jt(e)||e instanceof e)?(oi(t,function(t,e){n=e}),"undefined"==typeof n||jn.call(t,n)):!1}function lt(t){return ti[t]}function ut(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Mn.call(t)==$||!1}function ct(t,e,n,i){return"boolean"!=typeof e&&null!=e&&(i=n,n=e,e=!1),b(t,e,"function"==typeof n&&Y(n,i,1))}function ht(t,e,n){return b(t,!0,"function"==typeof e&&Y(e,n,1))}function dt(t,e,n){var i;return e=g.createCallback(e,n,3),ai(t,function(t,n,r){return e(t,n,r)?(i=n,!1):void 0}),i}function ft(t,e,n){var i;return e=g.createCallback(e,n,3),gt(t,function(t,n,r){return e(t,n,r)?(i=n,!1):void 0}),i}function pt(t,e,n){var i=[];oi(t,function(t,e){i.push(e,t)});var r=i.length;for(e=Y(e,n,3);r--&&e(i[r--],i[r],t)!==!1;);return t}function gt(t,e,n){var i=Zn(t),r=i.length;for(e=Y(e,n,3);r--;){var o=i[r];if(e(t[o],o,t)===!1)break}return t}function mt(t){var e=[];return oi(t,function(t,n){jt(t)&&e.push(n)}),e.sort()}function vt(t,e){return t?jn.call(t,e):!1}function yt(t){for(var e=-1,n=Zn(t),i=n.length,r={};++e<i;){var o=n[e];r[t[o]]=o}return r}function xt(t){return t===!0||t===!1||Mn.call(t)==F}function bt(t){return t?"object"==typeof t&&Mn.call(t)==O:!1}function _t(t){return t?1===t.nodeType:!1}function wt(t){var e=!0;if(!t)return e;var n=Mn.call(t),i=t.length;return n==z||n==G||n==$||n==N&&"number"==typeof i&&jt(t.splice)?!i:(ai(t,function(){return e=!1}),e)}function kt(t,e,n,i){return K(t,e,"function"==typeof n&&Y(n,i,2))}function Ct(t){return Fn(t)&&!On(parseFloat(t))}function jt(t){return"function"==typeof t}function Et(t){return!(!t||!X[typeof t])}function At(t){return St(t)&&t!=+t}function Tt(t){return null===t}function St(t){return"number"==typeof t||Mn.call(t)==D}function Bt(t){return t?"object"==typeof t&&Mn.call(t)==R:!1;
}function Mt(t){return"string"==typeof t||Mn.call(t)==G}function Pt(t){return"undefined"==typeof t}function Vt(t){var e=arguments,n=2;if(!Et(t))return t;if("number"!=typeof e[2]&&(n=e.length),n>3&&"function"==typeof e[n-2])var i=Y(e[--n-1],e[n--],2);else n>2&&"function"==typeof e[n-1]&&(i=e[--n]);for(var r=Un.call(arguments,1,n),o=-1,a=s(),l=s();++o<n;)Q(t,r[o],i,a,l);return c(a),c(l),t}function Lt(t,e,n){var i=at(),r="function"==typeof e,o={};if(r)e=g.createCallback(e,n,3);else var a=W(arguments,!0,!1,1);return oi(t,function(t,n,s){(r?!e(t,n,s):i(a,n)<0)&&(o[n]=t)}),o}function $t(t){for(var e=-1,n=Zn(t),i=n.length,r=an(i);++e<i;){var o=n[e];r[e]=[o,t[o]]}return r}function zt(t,e,n){var i={};if("function"!=typeof e)for(var r=-1,o=W(arguments,!0,!1,1),a=Et(t)?o.length:0;++r<a;){var s=o[r];s in t&&(i[s]=t[s])}else e=g.createCallback(e,n,3),oi(t,function(t,n,r){e(t,n,r)&&(i[n]=t)});return i}function Ft(t,e,n,i){var r=Wn(t);if(e=Y(e,i,4),null==n)if(r)n=[];else{var o=t&&t.constructor,a=o&&o.prototype;n=rt(a)}return(r?qt:ai)(t,function(t,i,r){return e(n,t,i,r)}),n}function Ot(t){for(var e=-1,n=Zn(t),i=n.length,r=an(i);++e<i;)r[e]=t[n[e]];return r}function It(t){for(var e=arguments,n=-1,i=W(e,!0,!1,1),r=e[2]&&e[2][e[1]]===t?1:i.length,o=an(r);++n<r;)o[n]=t[i[n]];return o}function Dt(t,e,n){var i=-1,r=at(),o=t?t.length:0,a=!1;return n=(0>n?Dn(0,o+n):n)||0,Wn(t)?a=r(t,e,n)>-1:"number"==typeof o?a=(Mt(t)?t.indexOf(e,n):r(t,e,n))>-1:ai(t,function(t){return++i>=n?!(a=t===e):void 0}),a}function Nt(t,e,n){var i=!0;e=g.createCallback(e,n,3);var r=-1,o=t?t.length:0;if("number"==typeof o)for(;++r<o&&(i=!!e(t[r],r,t)););else ai(t,function(t,n,r){return i=!!e(t,n,r)});return i}function Rt(t,e,n){var i=[];e=g.createCallback(e,n,3);var r=-1,o=t?t.length:0;if("number"==typeof o)for(;++r<o;){var a=t[r];e(a,r,t)&&i.push(a)}else ai(t,function(t,n,r){e(t,n,r)&&i.push(t)});return i}function Gt(t,e,n){e=g.createCallback(e,n,3);var i=-1,r=t?t.length:0;if("number"!=typeof r){var o;return ai(t,function(t,n,i){return e(t,n,i)?(o=t,!1):void 0}),o}for(;++i<r;){var a=t[i];if(e(a,i,t))return a}}function Ut(t,e,n){var i;return e=g.createCallback(e,n,3),Ht(t,function(t,n,r){return e(t,n,r)?(i=t,!1):void 0}),i}function qt(t,e,n){var i=-1,r=t?t.length:0;if(e=e&&"undefined"==typeof n?e:Y(e,n,3),"number"==typeof r)for(;++i<r&&e(t[i],i,t)!==!1;);else ai(t,e);return t}function Ht(t,e,n){var i=t?t.length:0;if(e=e&&"undefined"==typeof n?e:Y(e,n,3),"number"==typeof i)for(;i--&&e(t[i],i,t)!==!1;);else{var r=Zn(t);i=r.length,ai(t,function(t,n,o){return n=r?r[--i]:--i,e(o[n],n,o)})}return t}function Xt(t,e){var n=Un.call(arguments,2),i=-1,r="function"==typeof e,o=t?t.length:0,a=an("number"==typeof o?o:0);return qt(t,function(t){a[++i]=(r?e:t[e]).apply(t,n)}),a}function Yt(t,e,n){var i=-1,r=t?t.length:0;if(e=g.createCallback(e,n,3),"number"==typeof r)for(var o=an(r);++i<r;)o[i]=e(t[i],i,t);else o=[],ai(t,function(t,n,r){o[++i]=e(t,n,r)});return o}function Jt(t,e,n){var r=-(1/0),o=r;if(!e&&Wn(t))for(var a=-1,s=t.length;++a<s;){var l=t[a];l>o&&(o=l)}else e=!e&&Mt(t)?i:g.createCallback(e,n,3),qt(t,function(t,n,i){var a=e(t,n,i);a>r&&(r=a,o=t)});return o}function Wt(t,e,n){var r=1/0,o=r;if(!e&&Wn(t))for(var a=-1,s=t.length;++a<s;){var l=t[a];o>l&&(o=l)}else e=!e&&Mt(t)?i:g.createCallback(e,n,3),qt(t,function(t,n,i){var a=e(t,n,i);r>a&&(r=a,o=t)});return o}function Kt(t,e){var n=-1,i=t?t.length:0;if("number"==typeof i)for(var r=an(i);++n<i;)r[n]=t[n][e];return r||Yt(t,e)}function Zt(t,e,n,i){if(!t)return n;var r=arguments.length<3;e=Y(e,i,4);var o=-1,a=t.length;if("number"==typeof a)for(r&&(n=t[++o]);++o<a;)n=e(n,t[o],o,t);else ai(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)});return n}function Qt(t,e,n,i){var r=arguments.length<3;return e=Y(e,i,4),Ht(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function te(t,e,n){return e=g.createCallback(e,n,3),Rt(t,function(t,n,i){return!e(t,n,i)})}function ee(t,e,n){var i=t?t.length:0;if("number"!=typeof i&&(t=Ot(t)),null==e||n)return t?t[Ye(i-1)]:p;var r=ne(t);return r.length=Nn(Dn(0,e),r.length),r}function ne(t){var e=-1,n=t?t.length:0,i=an("number"==typeof n?n:0);return qt(t,function(t){var n=Ye(++e);i[e]=i[n],i[n]=t}),i}function ie(t){var e=t?t.length:0;return"number"==typeof e?e:Zn(t).length}function re(t,e,n){var i;e=g.createCallback(e,n,3);var r=-1,o=t?t.length:0;if("number"==typeof o)for(;++r<o&&!(i=e(t[r],r,t)););else ai(t,function(t,n,r){return!(i=e(t,n,r))});return!!i}function oe(t,e,n){var i=-1,o=t?t.length:0,a=an("number"==typeof o?o:0);for(e=g.createCallback(e,n,3),qt(t,function(t,n,r){var o=a[++i]=l();o.criteria=e(t,n,r),o.index=i,o.value=t}),o=a.length,a.sort(r);o--;){var s=a[o];a[o]=s.value,h(s)}return a}function ae(t){return t&&"number"==typeof t.length?d(t):Ot(t)}function se(t){for(var e=-1,n=t?t.length:0,i=[];++e<n;){var r=t[e];r&&i.push(r)}return i}function le(n){var i=-1,r=at(),a=n?n.length:0,s=W(arguments,!0,!0,1),l=[],u=a>=x&&r===t;if(u){var c=o(s);c?(r=e,s=c):u=!1}for(;++i<a;){var d=n[i];r(s,d)<0&&l.push(d)}return u&&h(s),l}function ue(t,e,n){var i=-1,r=t?t.length:0;for(e=g.createCallback(e,n,3);++i<r;)if(e(t[i],i,t))return i;return-1}function ce(t,e,n){var i=t?t.length:0;for(e=g.createCallback(e,n,3);i--;)if(e(t[i],i,t))return i;return-1}function he(t,e,n){var i=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=-1;for(e=g.createCallback(e,n,3);++o<r&&e(t[o],o,t);)i++}else if(i=e,null==i||n)return t?t[0]:p;return d(t,0,Nn(Dn(0,i),r))}function de(t,e,n,i){return"boolean"!=typeof e&&null!=e&&(i=n,n=i&&i[e]===t?null:e,e=!1),null!=n&&(t=Yt(t,n,i)),W(t,e)}function fe(e,n,i){if("number"==typeof i){var r=e?e.length:0;i=0>i?Dn(0,r+i):i||0}else if(i){var o=we(e,n);return e[o]===n?o:-1}return t(e,n,i)}function pe(t,e,n){var i=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=r;for(e=g.createCallback(e,n,3);o--&&e(t[o],o,t);)i++}else i=null==e||n?1:e||i;return d(t,0,Nn(Dn(0,r-i),r))}function ge(n){for(var i=arguments,r=i.length,a=-1,l=s(),u=-1,d=at(),f=n?n.length:0,p=[],g=s();++a<r;){var m=i[a];l[a]=d===t&&(m?m.length:0)>=x&&o(a?i[a]:g)}t:for(;++u<f;){var v=l[0];if(m=n[u],(v?e(v,m):d(g,m))<0){for(a=r,(v||g).push(m);--a;)if(v=l[a],(v?e(v,m):d(i[a],m))<0)continue t;p.push(m)}}for(;r--;)v=l[r],v&&h(v);return c(l),c(g),p}function me(t,e,n){var i=0,r=t?t.length:0;if("number"!=typeof e&&null!=e){var o=r;for(e=g.createCallback(e,n,3);o--&&e(t[o],o,t);)i++}else if(i=e,null==i||n)return t?t[r-1]:p;return d(t,Dn(0,r-i))}function ve(t,e,n){var i=t?t.length:0;for("number"==typeof n&&(i=(0>n?Dn(0,i+n):Nn(n,i-1))+1);i--;)if(t[i]===e)return i;return-1}function ye(t){for(var e=arguments,n=0,i=e.length,r=t?t.length:0;++n<i;)for(var o=-1,a=e[n];++o<r;)t[o]===a&&(Bn.call(t,o--,1),r--);return t}function xe(t,e,n){t=+t||0,n="number"==typeof n?n:+n||1,null==e&&(e=t,t=0);for(var i=-1,r=Dn(0,bn((e-t)/(n||1))),o=an(r);++i<r;)o[i]=t,t+=n;return o}function be(t,e,n){var i=-1,r=t?t.length:0,o=[];for(e=g.createCallback(e,n,3);++i<r;){var a=t[i];e(a,i,t)&&(o.push(a),Bn.call(t,i--,1),r--)}return o}function _e(t,e,n){if("number"!=typeof e&&null!=e){var i=0,r=-1,o=t?t.length:0;for(e=g.createCallback(e,n,3);++r<o&&e(t[r],r,t);)i++}else i=null==e||n?1:Dn(0,e);return d(t,i)}function we(t,e,n,i){var r=0,o=t?t.length:r;for(n=n?g.createCallback(n,i,1):qe,e=n(e);o>r;){var a=r+o>>>1;n(t[a])<e?r=a+1:o=a}return r}function ke(t){return et(W(arguments,!0,!0))}function Ce(t,e,n,i){return"boolean"!=typeof e&&null!=e&&(i=n,n=i&&i[e]===t?null:e,e=!1),null!=n&&(n=g.createCallback(n,i,3)),et(t,e,n)}function je(t){return le(t,Un.call(arguments,1))}function Ee(){for(var t=arguments.length>1?arguments:arguments[0],e=-1,n=t?Jt(Kt(t,"length")):0,i=an(0>n?0:n);++e<n;)i[e]=Kt(t,e);return i}function Ae(t,e){for(var n=-1,i=t?t.length:0,r={};++n<i;){var o=t[n];e?r[o]=e[n]:o&&(r[o[0]]=o[1])}return r}function Te(t,e){if(!jt(e))throw new gn;return function(){return--t<1?e.apply(this,arguments):void 0}}function Se(t,e){return arguments.length>2?it(t,17,Un.call(arguments,2),null,e):it(t,1,null,null,e)}function Be(t){for(var e=arguments.length>1?W(arguments,!0,!1,1):mt(t),n=-1,i=e.length;++n<i;){var r=e[n];t[r]=it(t[r],1,null,null,t)}return t}function Me(t,e){return arguments.length>2?it(e,19,Un.call(arguments,2),null,t):it(e,3,null,null,t)}function Pe(){for(var t=arguments,e=t.length;e--;)if(!jt(t[e]))throw new gn;return function(){for(var e=arguments,n=t.length;n--;)e=[t[n].apply(this,e)];return e[0]}}function Ve(t,e,n){var i=typeof t;if(null==t||"function"==i)return Y(t,e,n);if("object"!=i)return function(e){return e[t]};var r=Zn(t),o=r[0],a=t[o];return 1!=r.length||a!==a||Et(a)?function(e){for(var n=r.length,i=!1;n--&&(i=K(e[r[n]],t[r[n]],null,!0)););return i}:function(t){var e=t[o];return a===e&&(0!==a||1/a==1/e)}}function Le(t,e){return e="number"==typeof e?e:+e||t.length,it(t,4,null,null,null,e)}function $e(t,e,n){var i,r,o,a,s,l,u,c=0,h=!1,d=!0;if(!jt(t))throw new gn;if(e=Dn(0,e)||0,n===!0){var f=!0;d=!1}else Et(n)&&(f=n.leading,h="maxWait"in n&&(Dn(e,n.maxWait)||0),d="trailing"in n?n.trailing:d);var g=function(){var n=e-(En()-a);if(0>=n){r&&_n(r);var h=u;r=l=u=p,h&&(c=En(),o=t.apply(s,i))}else l=Sn(g,n)},m=function(){l&&_n(l),r=l=u=p,(d||h!==e)&&(c=En(),o=t.apply(s,i))};return function(){if(i=arguments,a=En(),s=this,u=d&&(l||!f),h===!1)var n=f&&!l;else{r||f||(c=a);var p=h-(a-c);0>=p?(r&&(r=_n(r)),c=a,o=t.apply(s,i)):r||(r=Sn(m,p))}return l||e===h||(l=Sn(g,e)),n&&(o=t.apply(s,i)),o}}function ze(t){if(!jt(t))throw new gn;var e=Un.call(arguments,1);return Sn(function(){t.apply(p,e)},1)}function Fe(t,e){if(!jt(t))throw new gn;var n=Un.call(arguments,2);return Sn(function(){t.apply(p,n)},e)}function Oe(t,e){if(!jt(t))throw new gn;var n=function(){var i=n.cache,r=e?e.apply(this,arguments):y+arguments[0];return jn.call(i,r)?i[r]:i[r]=t.apply(this,arguments)};return n.cache={},n}function Ie(t){var e,n;if(!jt(t))throw new gn;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}}function De(t){return it(t,16,Un.call(arguments,1))}function Ne(t){return it(t,32,null,Un.call(arguments,1))}function Re(t,e,n){var i=!0,r=!0;if(!jt(t))throw new gn;n===!1?i=!1:Et(n)&&(i="leading"in n?n.leading:i,r="trailing"in n?n.trailing:r),q.leading=i,q.maxWait=e,q.trailing=r;var o=$e(t,e,q);return o}function Ge(t,e){if(!jt(e))throw new gn;return function(){var n=[t];return An.apply(n,arguments),e.apply(this,n)}}function Ue(t){return null==t?"":pn(t).replace(ni,ot)}function qe(t){return t}function He(t,e){var n=t,i=!e||jt(n);e||(n=m,e=t,t=g),qt(mt(e),function(r){var o=t[r]=e[r];i&&(n.prototype[r]=function(){var e=this.__wrapped__,i=[e];An.apply(i,arguments);var r=o.apply(t,i);return e&&"object"==typeof e&&e===r?this:(r=new n(r),r.__chain__=this.__chain__,r)})})}function Xe(){return n._=yn,this}function Ye(t,e,n){var i=null==t,r=null==e;null==n&&("boolean"==typeof t&&r?(n=t,t=1):r||"boolean"!=typeof e||(n=e,r=!0)),i&&r&&(e=1),t=+t||0,r?(e=t,t=0):e=+e||0;var o=Gn();return n||t%1||e%1?Nn(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e):t+wn(o*(e-t+1))}function Je(t,e){if(t){var n=t[e];return jt(n)?t[e]():n}}function We(t,e,n){var i=g.templateSettings;t||(t=""),n=ri({},n,i);var r,o=ri({},n.imports,i.imports),s=Zn(o),l=Ot(o),u=0,c=n.interpolate||B,h="__p += '",d=fn((n.escape||B).source+"|"+c.source+"|"+(c===T?j:B).source+"|"+(n.evaluate||B).source+"|$","g");t.replace(d,function(e,n,i,o,s,l){return i||(i=o),h+=t.slice(u,l).replace(P,a),n&&(h+="' +\n__e("+n+") +\n'"),s&&(r=!0,h+="';\n"+s+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+e.length,e}),h+="';\n";var f=n.variable,m=f;m||(f="obj",h="with ("+f+") {\n"+h+"\n}\n"),h=(r?h.replace(w,""):h).replace(k,"$1").replace(C,"$1;"),h="function("+f+") {\n"+(m?"":f+" || ("+f+" = {});\n")+"var __t, __p = '', __e = _.escape"+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var v="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+L++ +"]")+"\n*/";try{var y=un(s,"return "+h+v).apply(p,l)}catch(x){throw x.source=h,x}return e?y(e):(y.source=h,y)}function Ke(t,e,n){t=(t=+t)>-1?t:0;var i=-1,r=an(t);for(e=Y(e,n,1);++i<t;)r[i]=e(i);return r}function Ze(t){return null==t?"":pn(t).replace(ei,lt)}function Qe(t){var e=++v;return pn(null==t?"":t)+e}function tn(t){return t=new m(t),t.__chain__=!0,t}function en(t,e){return e(t),t}function nn(){return this.__chain__=!0,this}function rn(){return pn(this.__wrapped__)}function on(){return this.__wrapped__}n=n?tt.defaults(J.Object(),n,tt.pick(J,V)):J;var an=n.Array,sn=n.Boolean,ln=n.Date,un=n.Function,cn=n.Math,hn=n.Number,dn=n.Object,fn=n.RegExp,pn=n.String,gn=n.TypeError,mn=[],vn=dn.prototype,yn=n._,xn=fn("^"+pn(vn.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),bn=cn.ceil,_n=n.clearTimeout,wn=cn.floor,kn=un.prototype.toString,Cn=xn.test(Cn=dn.getPrototypeOf)&&Cn,jn=vn.hasOwnProperty,En=xn.test(En=ln.now)&&En||function(){return+new ln},An=mn.push,Tn=n.setImmediate,Sn=n.setTimeout,Bn=mn.splice,Mn=vn.toString,Pn=mn.unshift,Vn=function(){try{var t={},e=xn.test(e=dn.defineProperty)&&e,n=e(t,t,t)&&e}catch(i){}return n}(),Ln=xn.test(Ln=Mn.bind)&&Ln,$n=xn.test($n=dn.create)&&$n,zn=xn.test(zn=an.isArray)&&zn,Fn=n.isFinite,On=n.isNaN,In=xn.test(In=dn.keys)&&In,Dn=cn.max,Nn=cn.min,Rn=n.parseInt,Gn=cn.random,Un=mn.slice,qn=xn.test(n.attachEvent),Hn=Ln&&!/\n|true/.test(Ln+qn),Xn={};Xn[z]=an,Xn[F]=sn,Xn[O]=ln,Xn[I]=un,Xn[N]=dn,Xn[D]=hn,Xn[R]=fn,Xn[G]=pn,m.prototype=g.prototype;var Yn=g.support={};Yn.fastBind=Ln&&!Hn,Yn.funcDecomp=!xn.test(n.WinRTError)&&M.test(f),Yn.funcNames="string"==typeof un.name,g.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:T,variable:"",imports:{_:g}},$n||(rt=function(t){if(Et(t)){u.prototype=t;var e=new u;u.prototype=null}return e||{}});var Jn=Vn?function(t,e){H.value=e,Vn(t,"__bindData__",H)}:u,Wn=zn||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Mn.call(t)==z||!1},Kn=function(t){var e,n=t,i=[];if(!n)return i;if(!X[typeof t])return i;for(e in n)jn.call(n,e)&&i.push(e);return i},Zn=In?function(t){return Et(t)?In(t):[]}:Kn,Qn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ti=yt(Qn),ei=fn("("+Zn(ti).join("|")+")","g"),ni=fn("["+Zn(Qn).join("")+"]","g"),ii=function(t,e,n){var i,r=t,o=r;if(!r)return o;var a=arguments,s=0,l="number"==typeof n?2:a.length;if(l>3&&"function"==typeof a[l-2])var u=Y(a[--l-1],a[l--],2);else l>2&&"function"==typeof a[l-1]&&(u=a[--l]);for(;++s<l;)if(r=a[s],r&&X[typeof r])for(var c=-1,h=X[typeof r]&&Zn(r),d=h?h.length:0;++c<d;)i=h[c],o[i]=u?u(o[i],r[i]):r[i];return o},ri=function(t,e,n){var i,r=t,o=r;if(!r)return o;for(var a=arguments,s=0,l="number"==typeof n?2:a.length;++s<l;)if(r=a[s],r&&X[typeof r])for(var u=-1,c=X[typeof r]&&Zn(r),h=c?c.length:0;++u<h;)i=c[u],"undefined"==typeof o[i]&&(o[i]=r[i]);return o},oi=function(t,e,n){var i,r=t,o=r;if(!r)return o;if(!X[typeof r])return o;e=e&&"undefined"==typeof n?e:Y(e,n,3);for(i in r)if(e(r[i],i,t)===!1)return o;return o},ai=function(t,e,n){var i,r=t,o=r;if(!r)return o;if(!X[typeof r])return o;e=e&&"undefined"==typeof n?e:Y(e,n,3);for(var a=-1,s=X[typeof r]&&Zn(r),l=s?s.length:0;++a<l;)if(i=s[a],e(r[i],i,t)===!1)return o;return o},si=function(t){if(!t||Mn.call(t)!=N)return!1;var e=t.valueOf,n="function"==typeof e&&(n=Cn(e))&&Cn(n);return n?t==n||Cn(t)==n:st(t)},li=nt(function(t,e,n){jn.call(t,n)?t[n]++:t[n]=1}),ui=nt(function(t,e,n){(jn.call(t,n)?t[n]:t[n]=[]).push(e)}),ci=nt(function(t,e,n){t[n]=e}),hi=Rt;Hn&&Z&&"function"==typeof Tn&&(ze=function(t){if(!jt(t))throw new gn;return Tn.apply(n,arguments)});var di=8==Rn(_+"08")?Rn:function(t,e){return Rn(Mt(t)?t.replace(S,""):t,e||0)};return g.after=Te,g.assign=ii,g.at=It,g.bind=Se,g.bindAll=Be,g.bindKey=Me,g.chain=tn,g.compact=se,g.compose=Pe,g.countBy=li,g.createCallback=Ve,g.curry=Le,g.debounce=$e,g.defaults=ri,g.defer=ze,g.delay=Fe,g.difference=le,g.filter=Rt,g.flatten=de,g.forEach=qt,g.forEachRight=Ht,g.forIn=oi,g.forInRight=pt,g.forOwn=ai,g.forOwnRight=gt,g.functions=mt,g.groupBy=ui,g.indexBy=ci,g.initial=pe,g.intersection=ge,g.invert=yt,g.invoke=Xt,g.keys=Zn,g.map=Yt,g.max=Jt,g.memoize=Oe,g.merge=Vt,g.min=Wt,g.omit=Lt,g.once=Ie,g.pairs=$t,g.partial=De,g.partialRight=Ne,g.pick=zt,g.pluck=Kt,g.pull=ye,g.range=xe,g.reject=te,g.remove=be,g.rest=_e,g.shuffle=ne,g.sortBy=oe,g.tap=en,g.throttle=Re,g.times=Ke,g.toArray=ae,g.transform=Ft,g.union=ke,g.uniq=Ce,g.values=Ot,g.where=hi,g.without=je,g.wrap=Ge,g.zip=Ee,g.zipObject=Ae,g.collect=Yt,g.drop=_e,g.each=qt,g.eachRight=Ht,g.extend=ii,g.methods=mt,g.object=Ae,g.select=Rt,g.tail=_e,g.unique=Ce,g.unzip=Ee,He(g),g.clone=ct,g.cloneDeep=ht,g.contains=Dt,g.escape=Ue,g.every=Nt,g.find=Gt,g.findIndex=ue,g.findKey=dt,g.findLast=Ut,g.findLastIndex=ce,g.findLastKey=ft,g.has=vt,g.identity=qe,g.indexOf=fe,g.isArguments=ut,g.isArray=Wn,g.isBoolean=xt,g.isDate=bt,g.isElement=_t,g.isEmpty=wt,g.isEqual=kt,g.isFinite=Ct,g.isFunction=jt,g.isNaN=At,g.isNull=Tt,g.isNumber=St,g.isObject=Et,g.isPlainObject=si,g.isRegExp=Bt,g.isString=Mt,g.isUndefined=Pt,g.lastIndexOf=ve,g.mixin=He,g.noConflict=Xe,g.parseInt=di,g.random=Ye,g.reduce=Zt,g.reduceRight=Qt,g.result=Je,g.runInContext=f,g.size=ie,g.some=re,g.sortedIndex=we,g.template=We,g.unescape=Ze,g.uniqueId=Qe,g.all=Nt,g.any=re,g.detect=Gt,g.findWhere=Gt,g.foldl=Zt,g.foldr=Qt,g.include=Dt,g.inject=Zt,ai(g,function(t,e){g.prototype[e]||(g.prototype[e]=function(){var e=[this.__wrapped__],n=this.__chain__;An.apply(e,arguments);var i=t.apply(g,e);return n?new m(i,n):i})}),g.first=he,g.last=me,g.sample=ee,g.take=he,g.head=he,ai(g,function(t,e){var n="sample"!==e;g.prototype[e]||(g.prototype[e]=function(e,i){var r=this.__chain__,o=t(this.__wrapped__,e,i);return r||null!=e&&(!i||n&&"function"==typeof e)?new m(o,r):o})}),g.VERSION="2.2.1",g.prototype.chain=nn,g.prototype.toString=rn,g.prototype.value=on,g.prototype.valueOf=on,qt(["join","pop","shift"],function(t){var e=mn[t];g.prototype[t]=function(){var t=this.__chain__,n=e.apply(this.__wrapped__,arguments);return t?new m(n,t):n}}),qt(["push","reverse","sort","unshift"],function(t){var e=mn[t];g.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),qt(["concat","slice","splice"],function(t){var e=mn[t];g.prototype[t]=function(){return new m(e.apply(this.__wrapped__,arguments),this.__chain__)}}),g}var p,g=[],m=[],v=0,y=+new Date+"",x=75,b=40,_=" 	\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000",w=/\b__p \+= '';/g,k=/\b(__p \+=) '' \+/g,C=/(__e\(.*?\)|\b__t\)) \+\n'';/g,j=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,E=/\w*$/,A=/^function[ \n\r\t]+\w/,T=/<%=([\s\S]+?)%>/g,S=RegExp("^["+_+"]*0+(?=.$)"),B=/($^)/,M=/\bthis\b/,P=/['\n\r\t\u2028\u2029\\]/g,V=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],L=0,$="[object Arguments]",z="[object Array]",F="[object Boolean]",O="[object Date]",I="[object Function]",D="[object Number]",N="[object Object]",R="[object RegExp]",G="[object String]",U={};U[I]=!1,U[$]=U[z]=U[F]=U[O]=U[D]=U[N]=U[R]=U[G]=!0;var q={leading:!1,maxWait:0,trailing:!1},H={configurable:!1,enumerable:!1,value:null,writable:!1},X={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Y={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},J=X[typeof window]&&window||this,W=X[typeof exports]&&exports&&!exports.nodeType&&exports,K=X[typeof module]&&module&&!module.nodeType&&module,Z=K&&K.exports===W&&W,Q=X[typeof global]&&global;!Q||Q.global!==Q&&Q.window!==Q||(J=Q);var tt=f();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(J._=tt,define(function(){return tt})):W&&K?Z?(K.exports=tt)._=tt:W._=tt:J._=tt}.call(this),function(t,e){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(n,i,r){t.Backbone=e(t,r,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");e(t,exports,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,n,i){var r=t.Backbone,o=[],a=(o.push,o.slice);o.splice;e.VERSION="1.1.2",e.$=i,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=e.Events={on:function(t,e,n){if(!u(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,i){if(!u(this,"once",t,[e,i])||!e)return this;var r=this,o=n.once(function(){r.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,i)},off:function(t,e,i){var r,o,a,s,l,c,h,d;if(!this._events||!u(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events=void 0,this;for(s=t?[t]:n.keys(this._events),l=0,c=s.length;c>l;l++)if(t=s[l],a=this._events[t]){if(this._events[t]=r=[],e||i)for(h=0,d=a.length;d>h;h++)o=a[h],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&r.push(o);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!u(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&c(n,e),i&&c(i,arguments),this},stopListening:function(t,e,i){var r=this._listeningTo;if(!r)return this;var o=!e&&!i;i||"object"!=typeof e||(i=this),t&&((r={})[t._listenId]=t);for(var a in r)t=r[a],t.off(e,i,this),(o||n.isEmpty(t._events))&&delete this._listeningTo[a];return this}},l=/\s+/,u=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(l.test(n)){for(var o=n.split(l),a=0,s=o.length;s>a;a++)t[e].apply(t,[o[a]].concat(i));return!1}return!0},c=function(t,e){var n,i=-1,r=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}},h={listenTo:"on",listenToOnce:"once"};n.each(h,function(t,e){s[e]=function(e,i,r){var o=this._listeningTo||(this._listeningTo={}),a=e._listenId||(e._listenId=n.uniqueId("l"));return o[a]=e,r||"object"!=typeof i||(r=this),e[t](i,r,this),this}}),s.bind=s.on,s.unbind=s.off,n.extend(e,s);var d=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,s,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var r,o,a,s,l,u,c,h;if(null==t)return this;if("object"==typeof t?(o=t,i=e):(o={})[t]=e,i||(i={}),!this._validate(o,i))return!1;a=i.unset,l=i.silent,s=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={}),h=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(r in o)e=o[r],n.isEqual(h[r],e)||s.push(r),n.isEqual(c[r],e)?delete this.changed[r]:this.changed[r]=e,a?delete h[r]:h[r]=e;if(!l){s.length&&(this._pending=i);for(var d=0,f=s.length;f>d;d++)this.trigger("change:"+s[d],this,h[s[d]],i)}if(u)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?n.clone(this.changed):!1;var e,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in t)n.isEqual(r[o],e=t[o])||((i||(i={}))[o]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(i&&i(e,n,t),void e.trigger("sync",e,n,t)):!1},F(this,t),this.sync("read",this,t)},save:function(t,e,i){var r,o,a,s=this.attributes;if(null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e,i=n.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},s,r)),void 0===i.parse&&(i.parse=!0);var l=this,u=i.success;return i.success=function(t){l.attributes=s;var e=l.parse(t,i);return i.wait&&(e=n.extend(r||{},e)),n.isObject(e)&&!l.set(e,i)?!1:(u&&u(l,t,i),void l.trigger("sync",l,t,i))},F(this,i),o=this.isNew()?"create":i.patch?"patch":"update","patch"===o&&(i.attrs=r),a=this.sync(o,this,i),r&&i.wait&&(this.attributes=s),a},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&r(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;F(this,t);var o=this.sync("delete",this,t);return t.wait||r(),o},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||z();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1):!0}});var f=["keys","values","pairs","invert","pick","omit"];n.each(f,function(t){d.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),n[t].apply(n,e)}});var p=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},g={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(p.prototype,s,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,m))},remove:function(t,e){var i=!n.isArray(t);t=i?[t]:n.clone(t),e||(e={});var r,o,a,s;for(r=0,o=t.length;o>r;r++)s=t[r]=this.get(t[r]),s&&(delete this._byId[s.id],delete this._byId[s.cid],a=this.indexOf(s),this.models.splice(a,1),this.length--,e.silent||(e.index=a,s.trigger("remove",s,this,e)),this._removeReference(s,e));return i?t[0]:t},set:function(t,e){e=n.defaults({},e,g),e.parse&&(t=this.parse(t,e));var i=!n.isArray(t);t=i?t?[t]:[]:n.clone(t);var r,o,a,s,l,u,c,h=e.at,f=this.model,p=this.comparator&&null==h&&e.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,v=[],y=[],x={},b=e.add,_=e.merge,w=e.remove,k=!p&&b&&w?[]:!1;for(r=0,o=t.length;o>r;r++){if(l=t[r]||{},a=l instanceof d?s=l:l[f.prototype.idAttribute||"id"],u=this.get(a))w&&(x[u.cid]=!0),_&&(l=l===s?s.attributes:l,e.parse&&(l=u.parse(l,e)),u.set(l,e),p&&!c&&u.hasChanged(m)&&(c=!0)),t[r]=u;else if(b){if(s=t[r]=this._prepareModel(l,e),!s)continue;v.push(s),this._addReference(s,e)}s=u||s,!k||!s.isNew()&&x[s.id]||k.push(s),x[s.id]=!0}if(w){for(r=0,o=this.length;o>r;++r)x[(s=this.models[r]).cid]||y.push(s);y.length&&this.remove(y,e)}if(v.length||k&&k.length)if(p&&(c=!0),this.length+=v.length,null!=h)for(r=0,o=v.length;o>r;r++)this.models.splice(h+r,0,v[r]);else{k&&(this.models.length=0);var C=k||v;for(r=0,o=C.length;o>r;r++)this.models.push(C[r])}if(c&&this.sort({silent:!0}),!e.silent){for(r=0,o=v.length;o>r;r++)(s=v[r]).trigger("add",s,this,e);(c||k&&k.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;r>i;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return n.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var r=t.reset?"reset":"set";i[r](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},F(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?n.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,r=e.success;return e.success=function(t,n){e.wait&&i.add(t,e),r&&r(t,n,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t;e=e?n.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_addReference:function(t,e){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(v,function(t){p.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),n[t].apply(n,e)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(t){p.prototype[t]=function(e,i){var r=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,r,i)}});var x=e.View=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,_)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];n.extend(x.prototype,s,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[t[e]]),i){var r=e.match(b),o=r[1],a=r[2];i=n.bind(i,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,i):this.$el.on(o,a,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var t=n.extend({},n.result(this,"attributes"));
this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className"));var i=e.$("<"+n.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,r){var o=k[t];n.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:o,dataType:"json"};if(r.url||(a.url=n.result(i,"url")||z()),null!=r.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",r.emulateJSON&&(a.data._method=o);var s=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",o),s?s.apply(this,arguments):void 0}}"GET"===a.type||r.emulateJSON||(a.processData=!1),"PATCH"===a.type&&w&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=e.ajax(n.extend(a,r));return i.trigger("request",i,l,r),l};var w=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var C=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},j=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,A=/\*\w+/g,T=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,s,{initialize:function(){},route:function(t,i,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return e.history.route(t,function(n){var a=o._extractParameters(t,n);o.execute(r,a),o.trigger.apply(o,["route:"+i].concat(a)),o.trigger("route",i,a),e.history.trigger("route",o,i,a)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(T,"\\$&").replace(j,"(?:$1)?").replace(E,function(t,e){return e?t:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var S=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},B=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,P=/msie [\w.]+/,V=/\/$/,L=/#.*$/;S.started=!1,n.extend(S.prototype,s,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(V,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace(B,"")},start:function(t){if(S.started)throw new Error("Backbone.history has already been started");S.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,o=P.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);if(this.root=("/"+this.root+"/").replace(M,"/"),o&&this._wantsHashChange){var a=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=a.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var s=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&s.hash&&(this.fragment=this.getHash().replace(B,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),S.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),n.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!S.started)return!1;e&&e!==!0||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(L,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new S;var $=function(t,e){var i,r=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,e);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,t&&n.extend(i.prototype,t),i.__super__=r.prototype,i};d.extend=p.extend=C.extend=x.extend=S.extend=$;var z=function(){throw new Error('A "url" property or function must be specified')},F=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}};return e}),function(t,e){"function"==typeof define&&define.amd?define([],e):t.Vectorizer=t.V=e()}(this,function(){function t(){var t=++h+"";return"v-"+t}function e(t){var e='<svg xmlns="'+u.xmlns+'" xmlns:xlink="'+u.xlink+'" version="'+c+'">'+(t||"")+"</svg>",n=new DOMParser;return n.async=!1,n.parseFromString(e,"text/xml").documentElement}function n(t,n,r){if(!t)return void 0;if("object"==typeof t)return new s(t);if(n=n||{},"svg"===t.toLowerCase())return new s(e());if("<"===t[0]){var o=e(t);if(o.childNodes.length>1){for(var a=[],l=0,c=o.childNodes.length;c>l;l++){var h=o.childNodes[l];a.push(new s(document.importNode(h,!0)))}return a}return new s(document.importNode(o.firstChild,!0))}t=document.createElementNS(u.xmlns,t);for(var d in n)i(t,d,n[d]);"[object Array]"!=Object.prototype.toString.call(r)&&(r=[r]);for(var f,l=0,c=r[0]&&r.length||0;c>l;l++)f=r[l],t.appendChild(f instanceof s?f.node:f);return new s(t)}function i(t,e,n){if(e.indexOf(":")>-1){var i=e.split(":");t.setAttributeNS(u[i[0]],i[1],n)}else"id"===e?t.id=n:t.setAttribute(e,n)}function r(t){var e,n,i;if(t){var r=/[ ,]+/,o=t.match(/translate\((.*)\)/);o&&(e=o[1].split(r));var a=t.match(/rotate\((.*)\)/);a&&(n=a[1].split(r));var s=t.match(/scale\((.*)\)/);s&&(i=s[1].split(r))}var l=i&&i[0]?parseFloat(i[0]):1;return{translate:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotate:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:l,sy:i&&i[1]?parseFloat(i[1]):l}}}function o(t,e){var n=e.x*t.a+e.y*t.c+0,i=e.x*t.b+e.y*t.d+0;return{x:n,y:i}}function a(t){var e=o(t,{x:0,y:1}),n=o(t,{x:1,y:0}),i=180/Math.PI*Math.atan2(e.y,e.x)-90,r=180/Math.PI*Math.atan2(n.y,n.x);return{translateX:t.e,translateY:t.f,scaleX:Math.sqrt(t.a*t.a+t.b*t.b),scaleY:Math.sqrt(t.c*t.c+t.d*t.d),skewX:i,skewY:r,rotation:i}}function s(e){this.node=e,this.node.id||(this.node.id=t())}function l(t){var e=t.rx||t["top-rx"]||0,n=t.rx||t["bottom-rx"]||0,i=t.ry||t["top-ry"]||0,r=t.ry||t["bottom-ry"]||0;return["M",t.x,t.y+i,"v",t.height-i-r,"a",n,r,0,0,0,n,r,"h",t.width-2*n,"a",n,r,0,0,0,n,-r,"v",-(t.height-r-i),"a",e,i,0,0,0,-e,-i,"h",-(t.width-2*e),"a",e,i,0,0,0,-e,i].join(" ")}var u=(!(!window.SVGAngle&&!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")),{xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"}),c="1.1",h=0;s.prototype={translate:function(t,e,n){n=n||{},e=e||0;var i=this.attr("transform")||"",o=r(i);if("undefined"==typeof t)return o.translate;i=i.replace(/translate\([^\)]*\)/g,"").trim();var a=n.absolute?t:o.translate.tx+t,s=n.absolute?e:o.translate.ty+e,l="translate("+a+","+s+")";return this.attr("transform",(l+" "+i).trim()),this},rotate:function(t,e,n,i){i=i||{};var o=this.attr("transform")||"",a=r(o);if("undefined"==typeof t)return a.rotate;o=o.replace(/rotate\([^\)]*\)/g,"").trim(),t%=360;var s=i.absolute?t:a.rotate.angle+t,l=void 0!==e&&void 0!==n?","+e+","+n:"",u="rotate("+s+l+")";return this.attr("transform",(o+" "+u).trim()),this},scale:function(t,e){e="undefined"==typeof e?t:e;var n=this.attr("transform")||"",i=r(n);if("undefined"==typeof t)return i.scale;n=n.replace(/scale\([^\)]*\)/g,"").trim();var o="scale("+t+","+e+")";return this.attr("transform",(n+" "+o).trim()),this},bbox:function(t,e){if(!this.node.ownerSVGElement)return{x:0,y:0,width:0,height:0};var n;try{n=this.node.getBBox(),n={x:0|n.x,y:0|n.y,width:0|n.width,height:0|n.height}}catch(i){n={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}if(t)return n;var r=this.node.getTransformToElement(e||this.node.ownerSVGElement);return d.transformRect(n,r)},text:function(t,e){e=e||{};var i,r=t.split("\n"),o=0;this.attr("y","0.8em"),this.attr("display",t?null:"none"),this.node.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.node.textContent="";var a=this.node;if(e.textPath){var s=this.find("defs");0===s.length&&(s=n("defs"),this.append(s));var l=Object(e.textPath)===e.textPath?e.textPath.d:e.textPath;if(l){var u=n("path",{d:l});s.append(u)}var c=n("textPath");!e.textPath["xlink:href"]&&u&&c.attr("xlink:href","#"+u.node.id),Object(e.textPath)===e.textPath&&c.attr(e.textPath),this.append(c),a=c.node}if(1===r.length)return a.textContent=t,this;for(;o<r.length;o++)i=d("tspan",{dy:0==o?"0em":e.lineHeight||"1em",x:this.attr("x")||0}),i.addClass("line"),r[o]||i.addClass("empty-line"),i.node.textContent=r[o]||" ",d(a).append(i);return this},attr:function(t,e){if("string"==typeof t&&"undefined"==typeof e)return this.node.getAttribute(t);if("object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&i(this.node,n,t[n]);else i(this.node,t,e);return this},remove:function(){this.node.parentNode&&this.node.parentNode.removeChild(this.node)},append:function(t){var e=t;"[object Array]"!==Object.prototype.toString.call(t)&&(e=[t]);for(var n=0,i=e.length;i>n;n++)t=e[n],this.node.appendChild(t instanceof s?t.node:t);return this},prepend:function(t){this.node.insertBefore(t instanceof s?t.node:t,this.node.firstChild)},svg:function(){return this.node instanceof window.SVGSVGElement?this:d(this.node.ownerSVGElement)},defs:function(){var t=this.svg().node.getElementsByTagName("defs");return t&&t.length?d(t[0]):void 0},clone:function(){var e=d(this.node.cloneNode(!0));return e.node.id=t(),e},findOne:function(t){var e=this.node.querySelector(t);return e?d(e):void 0},find:function(t){for(var e=this.node.querySelectorAll(t),n=0,i=e.length;i>n;n++)e[n]=d(e[n]);return e},toLocalPoint:function(t,e){var n=this.svg().node,i=n.createSVGPoint();i.x=t,i.y=e;try{var r=i.matrixTransform(n.getScreenCTM().inverse()),o=this.node.getTransformToElement(n).inverse()}catch(a){return i}return r.matrixTransform(o)},translateCenterToPoint:function(t){var e=this.bbox(),n=g.rect(e).center();this.translate(t.x-n.x,t.y-n.y)},translateAndAutoOrient:function(t,e,n){var i=this.scale();this.attr("transform",""),this.scale(i.sx,i.sy);var r=this.svg().node,o=this.bbox(!1,n),s=r.createSVGTransform();s.setTranslate(-o.x-o.width/2,-o.y-o.height/2);var l=r.createSVGTransform(),u=g.point(t).changeInAngle(t.x-e.x,t.y-e.y,e);l.setRotate(u,0,0);var c=r.createSVGTransform(),h=g.point(t).move(e,o.width/2);c.setTranslate(t.x+(t.x-h.x),t.y+(t.y-h.y));var d=this.node.getTransformToElement(n),f=r.createSVGTransform();f.setMatrix(c.matrix.multiply(l.matrix.multiply(s.matrix.multiply(d))));var p=a(f.matrix);return this.translate(p.translateX,p.translateY),this.rotate(p.rotation),this},animateAlongPath:function(t,e){var n=d("animateMotion",t),i=d("mpath",{"xlink:href":"#"+d(e).node.id});n.append(i),this.append(n);try{n.node.beginElement()}catch(r){if("fake"===document.documentElement.getAttribute("smiling")){var o=n.node;o.animators=[];var a=o.getAttribute("id");a&&(id2anim[a]=o);for(var s=getTargets(o),l=0,u=s.length;u>l;l++){var c=s[l],h=new Animator(o,c,l);animators.push(h),o.animators[l]=h,h.register()}}}},hasClass:function(t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(this.node.getAttribute("class"))},addClass:function(t){if(!this.hasClass(t)){var e=this.node.getAttribute("class")||"";this.node.setAttribute("class",(e+" "+t).trim())}return this},removeClass:function(t){if(this.hasClass(t)){var e=this.node.getAttribute("class").replace(new RegExp("(\\s|^)"+t+"(\\s|$)","g"),"$2");this.node.setAttribute("class",e)}return this},toggleClass:function(t,e){var n="undefined"==typeof e?this.hasClass(t):!e;return n?this.removeClass(t):this.addClass(t),this}};var d=n;d.decomposeMatrix=a,d.rectToPath=l;var f=d("svg").node;return d.createSVGMatrix=function(t){var e=f.createSVGMatrix();for(var n in t)e[n]=t[n];return e},d.createSVGTransform=function(){return f.createSVGTransform()},d.createSVGPoint=function(t,e){var n=f.createSVGPoint();return n.x=t,n.y=e,n},d.transformRect=function(t,e){var n=f.createSVGPoint();n.x=t.x,n.y=t.y;var i=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y;var r=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y+t.height;var o=n.matrixTransform(e);n.x=t.x,n.y=t.y+t.height;var a=n.matrixTransform(e),s=Math.min(i.x,r.x,o.x,a.x),l=Math.max(i.x,r.x,o.x,a.x),u=Math.min(i.y,r.y,o.y,a.y),c=Math.max(i.y,r.y,o.y,a.y);return{x:s,y:u,width:l-s,height:c-u}},d}),function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.g=e()}(this,function(){function t(e,n){if(!(this instanceof t))return new t(e,n);var i;void 0===n&&Object(e)!==e?(i=e.split(-1===e.indexOf("@")?" ":"@"),this.x=parseInt(i[0],10),this.y=parseInt(i[1],10)):Object(e)===e?(this.x=e.x,this.y=e.y):(this.x=e,this.y=n)}function e(n,i){return this instanceof e?(this.start=t(n),void(this.end=t(i))):new e(n,i)}function n(t,e,i,r){return this instanceof n?(void 0===e&&(e=t.y,i=t.width,r=t.height,t=t.x),this.x=t,this.y=e,this.width=i,void(this.height=r)):new n(t,e,i,r)}function i(e,n,r){return this instanceof i?(e=t(e),this.x=e.x,this.y=e.y,this.a=n,void(this.b=r)):new i(e,n,r)}var r=Math,o=r.abs,a=r.cos,s=r.sin,l=r.sqrt,u=r.min,c=r.max,h=(r.atan,r.atan2),d=(r.acos,r.round),f=r.floor,p=r.PI,g=r.random,m=function(t){return 180*t/p%360},v=function(t,e){return e=e||!1,t=e?t:t%360,t*p/180},y=function(t,e){return e*Math.round(t/e)},x=function(t){return t%360+(0>t?360:0)};t.prototype={toString:function(){return this.x+"@"+this.y},adhereToRect:function(t){return t.containsPoint(this)?this:(this.x=u(c(this.x,t.x),t.x+t.width),this.y=u(c(this.y,t.y),t.y+t.height),this)},theta:function(e){e=t(e);var n=-(e.y-this.y),i=e.x-this.x,r=10,o=0==n.toFixed(r)&&0==i.toFixed(r)?0:h(n,i);return 0>o&&(o=2*p+o),180*o/p},distance:function(t){return e(this,t).length()},manhattanDistance:function(t){return o(t.x-this.x)+o(t.y-this.y)},offset:function(t,e){return this.x+=t||0,this.y+=e||0,this},magnitude:function(){return l(this.x*this.x+this.y*this.y)||.01},update:function(t,e){return this.x=t||0,this.y=e||0,this},round:function(t){return this.x=t?this.x.toFixed(t):d(this.x),this.y=t?this.y.toFixed(t):d(this.y),this},normalize:function(t){var e=(t||1)/this.magnitude();return this.x=e*this.x,this.y=e*this.y,this},difference:function(e){return t(this.x-e.x,this.y-e.y)},bearing:function(t){return e(this,t).bearing()},toPolar:function(e){e=e&&t(e)||t(0,0);var n=this.x,i=this.y;return this.x=l((n-e.x)*(n-e.x)+(i-e.y)*(i-e.y)),this.y=v(e.theta(t(n,i))),this},rotate:function(e,n){n=(n+360)%360,this.toPolar(e),this.y+=v(n);var i=t.fromPolar(this.x,this.y,e);return this.x=i.x,this.y=i.y,this},move:function(e,n){var i=v(t(e).theta(this));return this.offset(a(i)*n,-s(i)*n)},changeInAngle:function(e,n,i){return t(this).offset(-e,-n).theta(i)-this.theta(i)},equals:function(t){return this.x===t.x&&this.y===t.y},snapToGrid:function(t,e){return this.x=y(this.x,t),this.y=y(this.y,e||t),this},reflection:function(e){return t(e).move(this,this.distance(e))}},t.fromPolar=function(e,n,i){i=i&&t(i)||t(0,0);var r=o(e*a(n)),l=o(e*s(n)),u=x(m(n));return 90>u?l=-l:180>u?(r=-r,l=-l):270>u&&(r=-r),t(i.x+r,i.y+l)},t.random=function(e,n,i,r){return t(f(g()*(n-e+1)+e),f(g()*(r-i+1)+i))},e.prototype={toString:function(){return this.start.toString()+" "+this.end.toString()},length:function(){return l(this.squaredLength())},squaredLength:function(){var t=this.start.x,e=this.start.y,n=this.end.x,i=this.end.y;return(t-=n)*t+(e-=i)*e},midpoint:function(){return t((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},intersection:function(e){var n=t(this.end.x-this.start.x,this.end.y-this.start.y),i=t(e.end.x-e.start.x,e.end.y-e.start.y),r=n.x*i.y-n.y*i.x,o=t(e.start.x-this.start.x,e.start.y-this.start.y),a=o.x*i.y-o.y*i.x,s=o.x*n.y-o.y*n.x;if(0===r||0>a*r||0>s*r)return null;if(r>0){if(a>r||s>r)return null}else if(r>a||r>s)return null;return t(this.start.x+a*n.x/r,this.start.y+a*n.y/r)},bearing:function(){var t=v(this.start.y),e=v(this.end.y),n=this.start.x,i=this.end.x,r=v(i-n),o=s(r)*a(e),l=a(t)*s(e)-s(t)*a(e)*a(r),u=m(h(o,l)),c=["NE","E","SE","S","SW","W","NW","N"],d=u-22.5;return 0>d&&(d+=360),d=parseInt(d/45),c[d]},pointAt:function(e){var n=(1-e)*this.start.x+e*this.end.x,i=(1-e)*this.start.y+e*this.end.y;return t(n,i)}},n.prototype={toString:function(){return this.origin().toString()+" "+this.corner().toString()},origin:function(){return t(this.x,this.y)},corner:function(){return t(this.x+this.width,this.y+this.height)},topRight:function(){return t(this.x+this.width,this.y)},bottomLeft:function(){return t(this.x,this.y+this.height)},center:function(){return t(this.x+this.width/2,this.y+this.height/2)},intersect:function(t){var e=this.origin(),n=this.corner(),i=t.origin(),r=t.corner();return r.x<=e.x||r.y<=e.y||i.x>=n.x||i.y>=n.y?!1:!0},sideNearestToPoint:function(e){e=t(e);var n=e.x-this.x,i=this.x+this.width-e.x,r=e.y-this.y,o=this.y+this.height-e.y,a=n,s="left";return a>i&&(a=i,s="right"),a>r&&(a=r,s="top"),a>o&&(a=o,s="bottom"),s},containsPoint:function(e){return e=t(e),e.x>=this.x&&e.x<=this.x+this.width&&e.y>=this.y&&e.y<=this.y+this.height?!0:!1},containsRect:function(t){var e=n(t).normalize(),i=e.width,r=e.height,o=e.x,a=e.y,s=this.width,l=this.height;if(0>(s|l|i|r))return!1;var u=this.x,c=this.y;if(u>o||c>a)return!1;if(s+=u,i+=o,o>=i){if(s>=u||i>s)return!1}else if(s>=u&&i>s)return!1;if(l+=c,r+=a,a>=r){if(l>=c||r>l)return!1}else if(l>=c&&r>l)return!1;return!0},pointNearestToPoint:function(e){if(e=t(e),this.containsPoint(e)){var n=this.sideNearestToPoint(e);switch(n){case"right":return t(this.x+this.width,e.y);case"left":return t(this.x,e.y);case"bottom":return t(e.x,this.y+this.height);case"top":return t(e.x,this.y)}}return e.adhereToRect(this)},intersectionWithLineFromCenterToPoint:function(n,i){n=t(n);var r,o=t(this.x+this.width/2,this.y+this.height/2);i&&n.rotate(o,i);for(var a=[e(this.origin(),this.topRight()),e(this.topRight(),this.corner()),e(this.corner(),this.bottomLeft()),e(this.bottomLeft(),this.origin())],s=e(o,n),l=a.length-1;l>=0;--l){var u=a[l].intersection(s);if(null!==u){r=u;break}}return r&&i&&r.rotate(o,-i),r},moveAndExpand:function(t){return this.x+=t.x,this.y+=t.y,this.width+=t.width,this.height+=t.height,this},round:function(t){return this.x=t?this.x.toFixed(t):d(this.x),this.y=t?this.y.toFixed(t):d(this.y),this.width=t?this.width.toFixed(t):d(this.width),this.height=t?this.height.toFixed(t):d(this.height),this},normalize:function(){var t=this.x,e=this.y,n=this.width,i=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,i=-this.height),this.x=t,this.y=e,this.width=n,this.height=i,this},bbox:function(t){var e=v(t||0),i=o(s(e)),r=o(a(e)),l=this.width*r+this.height*i,u=this.width*i+this.height*r;return n(this.x+(this.width-l)/2,this.y+(this.height-u)/2,l,u)}},i.prototype={toString:function(){return t(this.x,this.y).toString()+" "+this.a+" "+this.b},bbox:function(){return n(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},intersectionWithLineFromCenterToPoint:function(e,n){e=t(e),n&&e.rotate(t(this.x,this.y),n);var i,r=e.x-this.x,o=e.y-this.y;if(0===r)return i=this.bbox().pointNearestToPoint(e),n?i.rotate(t(this.x,this.y),-n):i;var a=o/r,s=a*a,u=this.a*this.a,c=this.b*this.b,h=l(1/(1/u+s/c));h=0>r?-h:h;var d=a*h;return i=t(this.x+h,this.y+d),n?i.rotate(t(this.x,this.y),-n):i}};var b={curveThroughPoints:function(t){for(var e=this.getCurveControlPoints(t),n=["M",t[0].x,t[0].y],i=0;i<e[0].length;i++)n.push("C",e[0][i].x,e[0][i].y,e[1][i].x,e[1][i].y,t[i+1].x,t[i+1].y);return n},getCurveControlPoints:function(e){var n,i=[],r=[],o=e.length-1;if(1==o)return i[0]=t((2*e[0].x+e[1].x)/3,(2*e[0].y+e[1].y)/3),r[0]=t(2*i[0].x-e[0].x,2*i[0].y-e[0].y),[i,r];var a=[];for(n=1;o-1>n;n++)a[n]=4*e[n].x+2*e[n+1].x;a[0]=e[0].x+2*e[1].x,a[o-1]=(8*e[o-1].x+e[o].x)/2;var s=this.getFirstControlPoints(a);for(n=1;o-1>n;++n)a[n]=4*e[n].y+2*e[n+1].y;a[0]=e[0].y+2*e[1].y,a[o-1]=(8*e[o-1].y+e[o].y)/2;var l=this.getFirstControlPoints(a);for(n=0;o>n;n++)i.push(t(s[n],l[n])),o-1>n?r.push(t(2*e[n+1].x-s[n+1],2*e[n+1].y-l[n+1])):r.push(t((e[o].x+s[o-1])/2,(e[o].y+l[o-1])/2));return[i,r]},getFirstControlPoints:function(t){var e=t.length,n=[],i=[],r=2;n[0]=t[0]/r;for(var o=1;e>o;o++)i[o]=1/r,r=(e-1>o?4:3.5)-i[o],n[o]=(t[o]-n[o-1])/r;for(o=1;e>o;o++)n[e-o-1]-=i[e-o]*n[e-o];return n},getInversionSolver:function(t,e,n,i){function r(t,e){var n=o[t],i=o[e];return function(r){var o=(t%3?3:1)*(e%3?3:1),a=r.x*(n.y-i.y)+r.y*(i.x-n.x)+n.x*i.y-n.y*i.x;return o*a}}var o=arguments;return function(n){var i=3*r(2,3)(e),o=r(1,3)(t)/i,a=-r(2,3)(t)/i,s=o*r(3,1)(n)+a*(r(3,0)(n)+r(2,1)(n))+r(2,0)(n),l=o*r(3,0)(n)+a*r(2,0)(n)+r(1,0)(n);return l/(l-s)}},getCurveDivider:function(t,n,i,r){return function(o){var a=e(t,n).pointAt(o),s=e(n,i).pointAt(o),l=e(i,r).pointAt(o),u=e(a,s).pointAt(o),c=e(s,l).pointAt(o),h=e(u,c).pointAt(o);return[{p0:t,p1:a,p2:u,p3:h},{p0:h,p1:c,p2:l,p3:r}]}}},_={linear:function(t,e,n){var i=t[1]-t[0],r=e[1]-e[0];return(n-t[0])/i*r+e[0]||0}};return{toDeg:m,toRad:v,snapToGrid:y,normalizeAngle:x,point:t,line:e,rect:n,ellipse:i,bezier:b,scale:_}}),"object"==typeof exports)var _=require("lodash");var joint={version:"0.9.3",dia:{},ui:{},layout:{},shapes:{},format:{},connectors:{},routers:{},util:{hashCode:function(t){var e=0;if(0==t.length)return e;for(var n=0;n<t.length;n++){var i=t.charCodeAt(n);e=(e<<5)-e+i,e&=e}return e},getByPath:function(t,e,n){n=n||".";for(var i,r=e.split(n);r.length;){if(i=r.shift(),!(Object(t)===t&&i in t))return void 0;t=t[i]}return t},setByPath:function(t,e,n,i){i=i||".";var r=e.split(i),o=t,a=0;if(e.indexOf(i)>-1){for(var s=r.length;s-1>a;a++)o=o[r[a]]||(o[r[a]]={});o[r[s-1]]=n}else t[e]=n;return t},unsetByPath:function(t,e,n){n=n||".";var i=e.lastIndexOf(n);if(i>-1){var r=joint.util.getByPath(t,e.substr(0,i),n);r&&delete r[e.slice(i+1)]}else delete t[e];return t},flattenObject:function(t,e,n){e=e||".";var i={};for(var r in t)if(t.hasOwnProperty(r)){var o="object"==typeof t[r];if(o&&n&&n(t[r])&&(o=!1),o){var a=this.flattenObject(t[r],e,n);for(var s in a)a.hasOwnProperty(s)&&(i[r+e+s]=a[s])}else i[r]=t[r]}return i},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},guid:function(t){return this.guid.id=this.guid.id||1,t.id=void 0===t.id?"j_"+this.guid.id++:t.id,t.id},mixin:function(){for(var t=arguments[0],e=1,n=arguments.length;n>e;e++){var i=arguments[e];(Object(i)===i||_.isFunction(i)||null!==i&&void 0!==i)&&_.each(i,function(e,n){return this.mixin.deep&&Object(e)===e?(t[n]||(t[n]=_.isArray(e)?[]:{}),void this.mixin(t[n],e)):void(t[n]!==e&&(this.mixin.supplement&&t.hasOwnProperty(n)||(t[n]=e)))},this)}return t},supplement:function(){this.mixin.supplement=!0;var t=this.mixin.apply(this,arguments);return this.mixin.supplement=!1,t},deepMixin:function(){this.mixin.deep=!0;var t=this.mixin.apply(this,arguments);return this.mixin.deep=!1,t},deepSupplement:function(){this.mixin.deep=this.mixin.supplement=!0;var t=this.mixin.apply(this,arguments);return this.mixin.deep=this.mixin.supplement=!1,t},normalizeEvent:function(t){return t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches.length?t.originalEvent.changedTouches[0]:t},nextFrame:function(){var t,e="undefined"!=typeof window;if(e&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame),!t){var n=0;t=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-n)),r=setTimeout(function(){t(e+i)},i);return n=e+i,r}}return e?_.bind(t,window):t}(),cancelFrame:function(){var t,e="undefined"!=typeof window;return e&&(t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame),t=t||clearTimeout,e?_.bind(t,window):t}(),findIntersection:function(t,e){var n=g.rect(V(t).bbox()).moveAndExpand(g.rect(-5,-5,10,10)),i=n.center(),r=g.rect(n).intersectionWithLineFromCenterToPoint(e);if(!r)return void 0;if(!_.contains(["PATH","CIRCLE","ELLIPSE","RECT","POLYGON","LINE","POLYLINE"],t.localName.toUpperCase()))return r;if(!t.isPointInStroke||!t.isPointInFill)return r;for(var o=r,a=t.getCTM(),s=V.createSVGPoint(0,0),l=r.distance(i);l>1;){if(r=r.move(i,-1),l=r.distance(i),s.x=r.x,s.y=r.y,s=s.matrixTransform(a.inverse()),t.isPointInStroke(s)||t.isPointInFill(s))return o;o=g.point(r)}return void 0},shapePerimeterConnectionPoint:function(t,e,n,i){var r,o=g.rect(e.getBBox());if(!n){var a=e.$(".scalable")[0],s=e.$(".rotatable")[0];a&&a.firstChild?n=a.firstChild:s&&s.firstChild&&(n=s.firstChild)}return r=n?joint.util.findIntersection(n,i):o.intersectionWithLineFromCenterToPoint(i),r||o.center()},breakText:function(t,e,n,i){i=i||{};var r=e.width,o=e.height,a=i.svgDocument||V("svg").node,s=V("<text><tspan></tspan></text>").attr(n||{}).node,l=s.firstChild,u=document.createTextNode("");l.appendChild(u),a.appendChild(s),i.svgDocument||document.body.appendChild(a);for(var c,h=t.split(" "),d=[],f=[],p=0,g=0,m=h.length;m>p;p++){var v=h[p];if(u.data=f[g]?f[g]+" "+v:v,l.getComputedTextLength()<=r)f[g]=u.data,c&&(d[g++]=!0,c=0);else{if(!f[g]||c){var y=!!c;if(c=v.length-1,y||!c){if(!c){if(!f[g]){f=[];break}h.splice(p,2,v+h[p+1]),m--,d[g++]=!0,p--;continue}h[p]=v.substring(0,c),h[p+1]=v.substring(c)+h[p+1]}else h.splice(p,1,v.substring(0,c),v.substring(c)),m++,g&&!d[g-1]&&g--;p--;continue}g++,p--}if("undefined"!=typeof o){var x=x||1.25*s.getBBox().height;if(x*f.length>o){f.splice(Math.floor(o/x));break}}}return i.svgDocument?a.removeChild(s):document.body.removeChild(a),f.join("\n")},imageToDataUri:function(t,e){if(!t||"data:"===t.substr(0,"data:".length))return setTimeout(function(){e(null,t)},0);var n=document.createElement("canvas"),i=document.createElement("img");i.onload=function(){var r=n.getContext("2d");n.width=i.width,n.height=i.height,r.drawImage(i,0,0);try{var o=(t.split(".").pop()||"png","jpeg"),a=n.toDataURL(o)}catch(s){if(/\.svg$/.test(t)){var l=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");l.open("GET",t,!1),l.send(null);var u=l.responseText;return e(null,"data:image/svg+xml,"+encodeURIComponent(u))}console.error(i.src,"fails to convert",s)}e(null,a)},i.ononerror=function(){e(new Error("Failed to load image."))},i.src=t},timing:{linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e=0,n=1;1;e+=n,n/=2)if(t>=(7-4*e)/11){var i=(11-6*e-11*t)/4;return-i*i+n*n}},reverse:function(t){return function(e){return 1-t(1-e)}},reflect:function(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}},clamp:function(t,e,n){return e=e||0,n=n||1,function(i){var r=t(i);return e>r?e:r>n?n:r}},back:function(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}},elastic:function(t){return t||(t=1.5),function(e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}},interpolate:{number:function(t,e){var n=e-t;return function(e){return t+n*e}},object:function(t,e){var n=_.keys(t);return function(i){var r,o,a={};for(r=n.length-1;-1!=r;r--)o=n[r],a[o]=t[o]+(e[o]-t[o])*i;return a}},hexColor:function(t,e){var n=parseInt(t.slice(1),16),i=parseInt(e.slice(1),16),r=255&n,o=(255&i)-r,a=65280&n,s=(65280&i)-a,l=16711680&n,u=(16711680&i)-l;return function(t){var e=r+o*t&255,n=a+s*t&65280,i=l+u*t&16711680;return"#"+(1<<24|e|n|i).toString(16).slice(1)}},unit:function(t,e){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,i=n.exec(t),r=n.exec(e),o=r[1].indexOf("."),a=o>0?r[1].length-o-1:0,t=+i[1],s=+r[1]-t,l=i[2];return function(e){return(t+s*e).toFixed(a)+l}}},filter:{blur:function(t){var e=_.isFinite(t.x)?t.x:2;return _.template('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>',{stdDeviation:_.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return _.template(e,{dx:t.dx||0,dy:t.dy||0,opacity:_.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:_.isFinite(t.blur)?t.blur:4})},grayscale:function(t){var e=_.isFinite(t.amount)?t.amount:1;return _.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>',{a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},sepia:function(t){var e=_.isFinite(t.amount)?t.amount:1;return _.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>',{a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},saturate:function(t){var e=_.isFinite(t.amount)?t.amount:1;return _.template('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>',{amount:1-e})},hueRotate:function(t){return _.template('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>',{angle:t.angle||0})},invert:function(t){var e=_.isFinite(t.amount)?t.amount:1;return _.template('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>',{amount:e,amount2:1-e})},brightness:function(t){return _.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>',{amount:_.isFinite(t.amount)?t.amount:1})},contrast:function(t){var e=_.isFinite(t.amount)?t.amount:1;
return _.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>',{amount:e,amount2:.5-e/2})}},format:{number:function(t,e,n){function i(t){for(var e=t.length,i=[],r=0,o=n.grouping[0];e>0&&o>0;)i.push(t.substring(e-=o,e+o)),o=n.grouping[r=(r+1)%n.grouping.length];return i.reverse().join(n.thousands)}n=n||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var r=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,o=r.exec(t),a=o[1]||" ",s=o[2]||">",l=o[3]||"",u=o[4]||"",c=o[5],h=+o[6],d=o[7],f=o[8],p=o[9],g=1,m="",v="",y=!1;switch(f&&(f=+f.substring(1)),(c||"0"===a&&"="===s)&&(c=a="0",s="=",d&&(h-=Math.floor((h-1)/4))),p){case"n":d=!0,p="g";break;case"%":g=100,v="%",p="f";break;case"p":g=100,v="%",p="r";break;case"b":case"o":case"x":case"X":"#"===u&&(m="0"+p.toLowerCase());case"c":case"d":y=!0,f=0;break;case"s":g=-1,p="r"}"$"===u&&(m=n.currency[0],v=n.currency[1]),"r"!=p||f||(p="g"),null!=f&&("g"==p?f=Math.max(1,Math.min(21,f)):("e"==p||"f"==p)&&(f=Math.max(0,Math.min(20,f))));var x=c&&d;if(y&&e%1)return"";var b=0>e||0===e&&0>1/e?(e=-e,"-"):l,_=v;if(0>g){var w=this.prefix(e,f);e=w.scale(e),_=w.symbol+v}else e*=g;e=this.convert(p,e,f);var k=e.lastIndexOf("."),C=0>k?e:e.substring(0,k),j=0>k?"":n.decimal+e.substring(k+1);!c&&d&&n.grouping&&(C=i(C));var E=m.length+C.length+j.length+(x?0:b.length),A=h>E?new Array(E=h-E+1).join(a):"";return x&&(C=i(A+C)),b+=m,e=C+j,("<"===s?b+e+A:">"===s?A+b+e:"^"===s?A.substring(0,E>>=1)+b+e+A.substring(E):b+(x?e:A+e))+_},string:function(t,e){for(var n,i="{",r=!1,o=[];-1!==(n=t.indexOf(i));){var a,s,l;if(a=t.slice(0,n),r){s=a.split(":"),l=s.shift().split("."),a=e;for(var u=0;u<l.length;u++)a=a[l[u]];s.length&&(a=this.number(s,a))}o.push(a),t=t.slice(n+1),i=(r=!r)?"}":"{"}return o.push(t),o.join("")},convert:function(t,e,n){switch(t){case"b":return e.toString(2);case"c":return String.fromCharCode(e);case"o":return e.toString(8);case"x":return e.toString(16);case"X":return e.toString(16).toUpperCase();case"g":return e.toPrecision(n);case"e":return e.toExponential(n);case"f":return e.toFixed(n);case"r":return(e=this.round(e,this.precision(e,n))).toFixed(Math.max(0,Math.min(20,this.precision(e*(1+1e-15),n))));default:return e+""}},round:function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},precision:function(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)},prefix:function(t,e){var n=_.map(["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],function(t,e){var n=Math.pow(10,3*abs(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}),i=0;return t&&(0>t&&(t*=-1),e&&(t=this.round(t,this.precision(t,e))),i=1+Math.floor(1e-12+Math.log(t)/Math.LN10),i=Math.max(-24,Math.min(24,3*Math.floor((0>=i?i+1:i-1)/3)))),n[8+i/3]}}}};if("object"==typeof exports&&(module.exports=joint),"object"==typeof exports)var joint={dia:{Link:require("./joint.dia.link").Link,Element:require("./joint.dia.element").Element},shapes:require("../plugins/shapes")},Backbone=require("backbone"),_=require("lodash"),g=require("./geometry");if(joint.dia.GraphCells=Backbone.Collection.extend({initialize:function(){this.on("change:z",this.sort,this)},model:function(t,e){if("link"===t.type)return new joint.dia.Link(t,e);var n=t.type.split(".")[0],i=t.type.split(".")[1];return joint.shapes[n]&&joint.shapes[n][i]?new joint.shapes[n][i](t,e):new joint.dia.Element(t,e)},comparator:function(t){return t.get("z")||0},getConnectedLinks:function(t,e){e=e||{},_.isUndefined(e.inbound)&&_.isUndefined(e.outbound)&&(e.inbound=e.outbound=!0);var n=this.filter(function(n){var i=n.get("source"),r=n.get("target");return i&&i.id===t.id&&e.outbound||r&&r.id===t.id&&e.inbound});if(e.deep){var i=t.getEmbeddedCells({deep:!0});_.each(this.difference(n,i),function(t){if(e.outbound){var r=t.get("source");if(r&&r.id&&_.find(i,{id:r.id}))return void n.push(t)}if(e.inbound){var o=t.get("target");o&&o.id&&_.find(i,{id:o.id})&&n.push(t)}})}return n},getCommonAncestor:function(){var t=_.map(arguments,function(t){for(var e=[t.id],n=t.get("parent");n;)e.push(n),n=this.get(n).get("parent");return e},this);t=_.sortBy(t,"length");var e=_.find(t.shift(),function(e){return _.every(t,function(t){return _.contains(t,e)})});return this.get(e)}}),joint.dia.Graph=Backbone.Model.extend({initialize:function(t,e){this.set("cells",new joint.dia.GraphCells([],{model:e&&e.cellModel})),this.get("cells").on("all",this.trigger,this),this.get("cells").on("remove",this.removeCell,this)},toJSON:function(){var t=Backbone.Model.prototype.toJSON.apply(this,arguments);return t.cells=this.get("cells").toJSON(),t},fromJSON:function(t,e){if(!t.cells)throw new Error("Graph JSON must contain cells array.");this.set(_.omit(t,"cells"),e),this.resetCells(t.cells,e)},clear:function(t){this.trigger("batch:start"),this.get("cells").remove(this.get("cells").models,t),this.trigger("batch:stop")},_prepareCell:function(t){return t instanceof Backbone.Model&&_.isUndefined(t.get("z"))?t.set("z",this.maxZIndex()+1,{silent:!0}):_.isUndefined(t.z)&&(t.z=this.maxZIndex()+1),t},maxZIndex:function(){var t=this.get("cells").last();return t?t.get("z")||0:0},addCell:function(t,e){return _.isArray(t)?this.addCells(t,e):(this.get("cells").add(this._prepareCell(t),e||{}),this)},addCells:function(t,e){return e=e||{},e.position=t.length,_.each(t,function(t){e.position--,this.addCell(t,e)},this),this},resetCells:function(t,e){return this.get("cells").reset(_.map(t,this._prepareCell,this),e),this},removeCell:function(t,e,n){n&&n.disconnectLinks?this.disconnectLinks(t,n):this.removeLinks(t,n),this.get("cells").remove(t,{silent:!0})},getCell:function(t){return this.get("cells").get(t)},getElements:function(){return this.get("cells").filter(function(t){return t instanceof joint.dia.Element})},getLinks:function(){return this.get("cells").filter(function(t){return t instanceof joint.dia.Link})},getConnectedLinks:function(t,e){return this.get("cells").getConnectedLinks(t,e)},getNeighbors:function(t){var e=this.getConnectedLinks(t),n=[],i=this.get("cells");return _.each(e,function(e){var r=e.get("source"),o=e.get("target");if(!r.x){var a=i.get(r.id);a!==t&&n.push(a)}if(!o.x){var s=i.get(o.id);s!==t&&n.push(s)}}),n},disconnectLinks:function(t,e){_.each(this.getConnectedLinks(t),function(n){n.set(n.get("source").id===t.id?"source":"target",g.point(0,0),e)})},removeLinks:function(t,e){_.invoke(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(t){return _.filter(this.getElements(),function(e){return e.getBBox().containsPoint(t)})},findModelsInArea:function(t){return _.filter(this.getElements(),function(e){return e.getBBox().intersect(t)})},getBBox:function(t){var e={x:1/0,y:1/0},n={x:0,y:0};return _.each(t,function(t){var i=t.getBBox();e.x=Math.min(e.x,i.x),e.y=Math.min(e.y,i.y),n.x=Math.max(n.x,i.x+i.width),n.y=Math.max(n.y,i.y+i.height)}),g.rect(e.x,e.y,n.x-e.x,n.y-e.y)},getCommonAncestor:function(){var t=this.get("cells");return t.getCommonAncestor.apply(t,arguments)}}),"object"==typeof exports&&(module.exports.Graph=joint.dia.Graph),"object"==typeof exports)var joint={util:require("./core").util,dia:{Link:require("./joint.dia.link").Link}},Backbone=require("backbone"),_=require("lodash");if(joint.dia.Cell=Backbone.Model.extend({constructor:function(t,e){var n,i=t||{};this.cid=_.uniqueId("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(i=this.parse(i,e)||{}),(n=_.result(this,"defaults"))&&(i=_.merge({},n,i)),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(){var t=this.constructor.prototype.defaults.attrs||{},e=this.attributes.attrs,n={};_.each(e,function(e,i){var r=t[i];_.each(e,function(t,e){_.isObject(t)&&!_.isArray(t)?_.each(t,function(t,o){r&&r[e]&&_.isEqual(r[e][o],t)||(n[i]=n[i]||{},(n[i][e]||(n[i][e]={}))[o]=t)}):r&&_.isEqual(r[e],t)||(n[i]=n[i]||{},n[i][e]=t)})});var i=_.cloneDeep(_.omit(this.attributes,"attrs"));return i.attrs=n,i},initialize:function(t){t&&t.id||this.set("id",joint.util.uuid(),{silent:!0}),this._transitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},processPorts:function(){var t=this.ports,e={};_.each(this.get("attrs"),function(t,n){t&&t.port&&(_.isUndefined(t.port.id)?e[t.port]={id:t.port}:e[t.port.id]=t.port)});var n={};if(_.each(t,function(t,i){e[i]||(n[i]=!0)}),this.collection&&!_.isEmpty(n)){var i=this.collection.getConnectedLinks(this,{inbound:!0});_.each(i,function(t){n[t.get("target").port]&&t.remove()});var r=this.collection.getConnectedLinks(this,{outbound:!0});_.each(r,function(t){n[t.get("source").port]&&t.remove()})}this.ports=e},remove:function(t){var e=this.collection;e&&e.trigger("batch:start");var n=this.get("parent");if(n){var i=this.collection&&this.collection.get(n);i.unembed(this)}return _.invoke(this.getEmbeddedCells(),"remove",t),this.trigger("remove",this,this.collection,t),e&&e.trigger("batch:stop"),this},toFront:function(t){if(this.collection){t=t||{};var e=(this.collection.last().get("z")||0)+1;if(this.trigger("batch:start").set("z",e,t),t.deep){var n=this.getEmbeddedCells({deep:!0,breadthFirst:!0});_.each(n,function(n){n.set("z",++e,t)})}this.trigger("batch:stop")}return this},toBack:function(t){if(this.collection){t=t||{};var e=(this.collection.first().get("z")||0)-1;if(this.trigger("batch:start"),t.deep){var n=this.getEmbeddedCells({deep:!0,breadthFirst:!0});_.eachRight(n,function(n){n.set("z",e--,t)})}this.set("z",e,t).trigger("batch:stop")}return this},embed:function(t,e){if(this==t||this.isEmbeddedIn(t))throw new Error("Recursive embedding not allowed.");this.trigger("batch:start");var n=_.clone(this.get("embeds")||[]);return n[t.isLink()?"unshift":"push"](t.id),t.set("parent",this.id,e),this.set("embeds",_.uniq(n),e),this.trigger("batch:stop"),this},unembed:function(t,e){return this.trigger("batch:start"),t.unset("parent",e),this.set("embeds",_.without(this.get("embeds"),t.id),e),this.trigger("batch:stop"),this},getEmbeddedCells:function(t){if(t=t||{},this.collection){var e;if(t.deep)if(t.breadthFirst){e=[];for(var n=this.getEmbeddedCells();n.length>0;){var i=n.shift();e.push(i),n.push.apply(n,i.getEmbeddedCells())}}else e=this.getEmbeddedCells(),_.each(e,function(n){e.push.apply(e,n.getEmbeddedCells(t))});else e=_.map(this.get("embeds"),this.collection.get,this.collection);return e}return[]},isEmbeddedIn:function(t,e){var n=_.isString(t)?t:t.id;e=_.defaults({deep:!0},e);var i=this.get("parent");if(this.collection&&e.deep){for(;i;){if(i==n)return!0;i=this.collection.get(i).get("parent")}return!1}return i==n},clone:function(t){t=t||{};var e=Backbone.Model.prototype.clone.apply(this,arguments);if(e.set("id",joint.util.uuid(),{silent:!0}),e.set("embeds",""),!t.deep)return e;var n=_.sortBy(this.getEmbeddedCells(),function(t){return t instanceof joint.dia.Element}),i=[e],r={};return _.each(n,function(t){var n=t.clone({deep:!0});e.embed(n[0]),_.each(n,function(n){if(n instanceof joint.dia.Link)return n.get("source").id==this.id&&n.prop("source",{id:e.id}),n.get("target").id==this.id&&n.prop("target",{id:e.id}),void(r[t.id]=n);i.push(n);var o=this.collection.getConnectedLinks(t,{inbound:!0});_.each(o,function(t){var e=r[t.id]||t.clone();r[t.id]=e,e.prop("target",{id:n.id})});var a=this.collection.getConnectedLinks(t,{outbound:!0});_.each(a,function(t){var e=r[t.id]||t.clone();r[t.id]=e,e.prop("source",{id:n.id})})},this)},this),i=i.concat(_.values(r))},prop:function(t,e,n){var i="/";if(_.isString(t)){if("undefined"!=typeof e){var r=t,o=r.split("/"),a=o[0];if(n=n||{},n.propertyPath=r,n.propertyValue=e,1==o.length)return this.set(a,e,n);var s={},l=s,u=a;_.each(_.rest(o),function(t){l=l[u]=_.isFinite(Number(t))?[]:{},u=t}),s=joint.util.setByPath(s,r,e,"/");var c=_.merge({},this.attributes);n.rewrite&&joint.util.unsetByPath(c,r,"/");var h=_.merge(c,s);return this.set(a,h[a],n)}return joint.util.getByPath(this.attributes,t,i)}return this.set(_.merge({},this.attributes,t),e)},attr:function(t,e,n){return _.isString(t)?this.prop("attrs/"+t,e,n):this.prop({attrs:t},e)},removeAttr:function(t,e){if(_.isArray(t))return _.each(t,function(t){this.removeAttr(t,e)},this),this;var n=joint.util.unsetByPath(_.merge({},this.get("attrs")),t,"/");return this.set("attrs",n,_.extend({dirty:!0},e))},transition:function(t,e,n,i){i=i||"/";var r={duration:100,delay:10,timingFunction:joint.util.timing.linear,valueFunction:joint.util.interpolate.number};n=_.extend(r,n);var o,a=0,s=_.bind(function(e){var i,r,l;a=a||e,e-=a,r=e/n.duration,1>r?this._transitionIds[t]=i=joint.util.nextFrame(s):(r=1,delete this._transitionIds[t]),l=o(n.timingFunction(r)),n.transitionId=i,this.prop(t,l,n),i||this.trigger("transition:end",this,t)},this),l=_.bind(function(r){this.stopTransitions(t),o=n.valueFunction(joint.util.getByPath(this.attributes,t,i),e),this._transitionIds[t]=joint.util.nextFrame(r),this.trigger("transition:start",this,t)},this);return _.delay(l,n.delay,s)},getTransitions:function(){return _.keys(this._transitionIds)},stopTransitions:function(t,e){e=e||"/";var n=t&&t.split(e);return _(this._transitionIds).keys().filter(n&&function(t){return _.isEqual(n,t.split(e).slice(0,n.length))}).each(function(t){joint.util.cancelFrame(this._transitionIds[t]),delete this._transitionIds[t],this.trigger("transition:end",this,t)},this),this},addTo:function(t){return t.addCell(this),this},findView:function(t){return t.findViewByModel(this)},isLink:function(){return!1}}),joint.dia.CellView=Backbone.View.extend({tagName:"g",attributes:function(){return{"model-id":this.model.id}},constructor:function(t){this._configure(t),Backbone.View.apply(this,arguments)},_configure:function(t){this.options&&(t=_.extend({},_.result(this,"options"),t)),this.options=t,this.options.id=this.options.id||joint.util.guid(this)},initialize:function(){_.bindAll(this,"remove","update"),this.$el.data("view",this),this.listenTo(this.model,"remove",this.remove),this.listenTo(this.model,"change:attrs",this.onChangeAttrs)},onChangeAttrs:function(t,e,n){return n.dirty?this.render():this.update()},_ensureElement:function(){var t;if(this.el)t=_.result(this,"el");else{var e=_.extend({id:this.id},_.result(this,"attributes"));this.className&&(e["class"]=_.result(this,"className")),t=V(_.result(this,"tagName"),e).node}this.setElement(t,!1)},findBySelector:function(t){var e="."===t?this.$el:this.$el.find(t);return e},notify:function(t){if(this.paper){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t].concat(e)),this.paper.trigger.apply(this.paper,[t,this].concat(e))}},getStrokeBBox:function(t){var e=!!t;t=t||this.el;var n,i=V(t).bbox(!1,this.paper.viewport);return n=e?V(t).attr("stroke-width"):this.model.attr("rect/stroke-width")||this.model.attr("circle/stroke-width")||this.model.attr("ellipse/stroke-width")||this.model.attr("path/stroke-width"),n=parseFloat(n)||0,g.rect(i).moveAndExpand({x:-n/2,y:-n/2,width:n,height:n})},getBBox:function(){return V(this.el).bbox()},highlight:function(t,e){return t=t?this.$(t)[0]||this.el:this.el,e=e||{},e.partial=t!=this.el,this.notify("cell:highlight",t,e),this},unhighlight:function(t,e){return t=t?this.$(t)[0]||this.el:this.el,e=e||{},e.partial=t!=this.el,this.notify("cell:unhighlight",t,e),this},findMagnet:function(t){var e=this.$(t);if(0===e.length||e[0]===this.el){var n=this.model.get("attrs")||{};return n["."]&&n["."].magnet===!1?void 0:this.el}return e.attr("magnet")?e[0]:this.findMagnet(e.parent())},applyFilter:function(t,e){var n=this.findBySelector(t),i=e.name+this.paper.svg.id+joint.util.hashCode(JSON.stringify(e));if(!this.paper.svg.getElementById(i)){var r=joint.util.filter[e.name]&&joint.util.filter[e.name](e.args||{});if(!r)throw new Error("Non-existing filter "+e.name);var o=V(r);o.attr({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3}),e.attrs&&o.attr(e.attrs),o.node.id=i,V(this.paper.svg).defs().append(o)}n.each(function(){V(this).attr("filter","url(#"+i+")")})},applyGradient:function(t,e,n){var i=this.findBySelector(t),r=n.type+this.paper.svg.id+joint.util.hashCode(JSON.stringify(n));if(!this.paper.svg.getElementById(r)){var o=["<"+n.type+">",_.map(n.stops,function(t){return'<stop offset="'+t.offset+'" stop-color="'+t.color+'" stop-opacity="'+(_.isFinite(t.opacity)?t.opacity:1)+'" />'}).join(""),"</"+n.type+">"].join(""),a=V(o);n.attrs&&a.attr(n.attrs),a.node.id=r,V(this.paper.svg).defs().append(a)}i.each(function(){V(this).attr(e,"url(#"+r+")")})},getSelector:function(t,e){if(t===this.el)return e;var n=$(t).index();return e=t.tagName+":nth-child("+(n+1)+") "+(e||""),this.getSelector($(t).parent()[0],e+" ")},pointerdblclick:function(t,e,n){this.notify("cell:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){this.notify("cell:pointerclick",t,e,n)},pointerdown:function(t,e,n){this.model.collection&&(this.model.trigger("batch:start"),this._collection=this.model.collection),this.notify("cell:pointerdown",t,e,n)},pointermove:function(t,e,n){this.notify("cell:pointermove",t,e,n)},pointerup:function(t,e,n){this.notify("cell:pointerup",t,e,n),this._collection&&(this._collection.trigger("batch:stop"),delete this._collection)},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)}}),"object"==typeof exports&&(module.exports.Cell=joint.dia.Cell,module.exports.CellView=joint.dia.CellView),"object"==typeof exports)var joint={util:require("./core").util,dia:{Cell:require("./joint.dia.cell").Cell,CellView:require("./joint.dia.cell").CellView}},Backbone=require("backbone"),_=require("lodash");if(joint.dia.Element=joint.dia.Cell.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},position:function(t,e,n){var i=_.isNumber(e);if(n=(i?n:t)||{},n.parentRelative){if(!this.collection)throw new Error("Element must be part of a collection.");var r=this.collection.get(this.get("parent")),o=r&&!r.isLink()?r.get("position"):{x:0,y:0}}if(i)return n.parentRelative&&(t+=o.x,e+=o.y),this.set("position",{x:t,y:e},n);var a=g.point(this.get("position"));return n.parentRelative?a.difference(o):a},translate:function(t,e,n){if(e=e||0,0===t&&0===e)return this;n=n||{},n.translateBy=n.translateBy||this.id,n.tx=t,n.ty=e;var i=this.get("position")||{x:0,y:0},r={x:i.x+t||0,y:i.y+e||0};return n.transition?(_.isObject(n.transition)||(n.transition={}),this.transition("position",r,_.extend({},n.transition,{valueFunction:joint.util.interpolate.object}))):(this.set("position",r,n),_.invoke(this.getEmbeddedCells(),"translate",t,e,n)),this},resize:function(t,e){return this.trigger("batch:start"),this.set("size",{width:t,height:e}),this.trigger("batch:stop"),this},rotate:function(t,e,n){if(n){var i=this.getBBox().center(),r=this.get("size"),o=this.get("position");i.rotate(n,(this.get("angle")||0)-t);var a=i.x-r.width/2-o.x,s=i.y-r.height/2-o.y;this.trigger("batch:start"),this.translate(a,s),this.rotate(t,e),this.trigger("batch:stop")}else this.set("angle",e?t:((this.get("angle")||0)+t)%360);return this},getBBox:function(){var t=this.get("position"),e=this.get("size");return g.rect(t.x,t.y,e.width,e.height)}}),joint.dia.ElementView=joint.dia.CellView.extend({className:function(){return"element "+this.model.get("type").split(".").join(" ")},initialize:function(){_.bindAll(this,"translate","resize","rotate"),joint.dia.CellView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:position",this.translate),this.listenTo(this.model,"change:size",this.resize),this.listenTo(this.model,"change:angle",this.rotate)},update:function(t,e){var n=this.model.get("attrs"),i=V(this.$(".rotatable")[0]);if(i){var r=i.attr("transform");i.attr("transform","")}var o=[];_.each(e||n,function(t,e){var n=this.findBySelector(e);if(0!==n.length){var i=["style","text","html","ref-x","ref-y","ref-dx","ref-dy","ref-width","ref-height","ref","x-alignment","y-alignment","port"];_.isObject(t.filter)&&(i.push("filter"),this.applyFilter(e,t.filter)),_.isObject(t.fill)&&(i.push("fill"),this.applyGradient(e,"fill",t.fill)),_.isObject(t.stroke)&&(i.push("stroke"),this.applyGradient(e,"stroke",t.stroke)),_.isUndefined(t.text)||(n.each(function(){V(this).text(t.text+"",{lineHeight:t.lineHeight,textPath:t.textPath})}),i.push("lineHeight","textPath"));var r=_.omit(t,i);n.each(function(){V(this).attr(r)}),t.port&&n.attr("port",_.isUndefined(t.port.id)?t.port:t.port.id),t.style&&n.css(t.style),_.isUndefined(t.html)||n.each(function(){$(this).html(t.html+"")}),_.isUndefined(t["ref-x"])&&_.isUndefined(t["ref-y"])&&_.isUndefined(t["ref-dx"])&&_.isUndefined(t["ref-dy"])&&_.isUndefined(t["x-alignment"])&&_.isUndefined(t["y-alignment"])&&_.isUndefined(t["ref-width"])&&_.isUndefined(t["ref-height"])||_.each(n,function(t,e,n){var i=$(t);i.selector=n.selector,o.push(i)})}},this);var a=this.el.getBBox();e=e||{},_.each(o,function(t){var i=e[t.selector],r=i?_.merge({},n[t.selector],i):n[t.selector];this.positionRelative(t,a,r)},this),i&&i.attr("transform",r||"")},positionRelative:function(t,e,n){function i(t){return _.isNumber(t)&&!_.isNaN(t)}var r=n.ref,o=parseFloat(n["ref-x"]),a=parseFloat(n["ref-y"]),s=parseFloat(n["ref-dx"]),l=parseFloat(n["ref-dy"]),u=n["y-alignment"],c=n["x-alignment"],h=parseFloat(n["ref-width"]),d=parseFloat(n["ref-height"]),f=_.contains(_.pluck(_.pluck(t.parents("g"),"className"),"baseVal"),"scalable");r&&(e=V(this.findBySelector(r)[0]).bbox(!1,this.el));var p=V(t[0]);p.attr("transform")&&p.attr("transform",p.attr("transform").replace(/translate\([^)]*\)/g,"").trim()||"");var g=0,m=0;if(i(h)&&(h>=0&&1>=h?p.attr("width",h*e.width):p.attr("width",Math.max(h+e.width,0))),i(d)&&(d>=0&&1>=d?p.attr("height",d*e.height):p.attr("height",Math.max(d+e.height,0))),i(s))if(f){var v=V(this.$(".scalable")[0]).scale();g=e.x+e.width+s/v.sx}else g=e.x+e.width+s;if(i(l))if(f){var v=V(this.$(".scalable")[0]).scale();m=e.y+e.height+l/v.sy}else m=e.y+e.height+l;if(i(o))if(o>0&&1>o)g=e.x+e.width*o;else if(f){var v=V(this.$(".scalable")[0]).scale();g=e.x+o/v.sx}else g=e.x+o;if(i(a))if(a>0&&1>a)m=e.y+e.height*a;else if(f){var v=V(this.$(".scalable")[0]).scale();m=e.y+a/v.sy}else m=e.y+a;var y=p.bbox(!1,this.paper.viewport);"middle"===u?m-=y.height/2:i(u)&&(m+=u>-1&&1>u?y.height*u:u),"middle"===c?g-=y.width/2:i(c)&&(g+=c>-1&&1>c?y.width*c:c),p.translate(g,m)},renderMarkup:function(){var t=this.model.markup||this.model.get("markup");if(!t)throw new Error("properties.markup is missing while the default render() implementation is used.");var e=V(t);V(this.el).append(e)},render:function(){return this.$el.empty(),this.renderMarkup(),this.update(),this.resize(),this.rotate(),this.translate(),this},scale:function(t,e){V(this.el).scale(t,e)},resize:function(){var t=this.model.get("size")||{width:1,height:1},e=this.model.get("angle")||0,n=V(this.$(".scalable")[0]);if(n){var i=n.bbox(!0);n.attr("transform","scale("+t.width/(i.width||1)+","+t.height/(i.height||1)+")");var r=V(this.$(".rotatable")[0]),o=r&&r.attr("transform");if(o&&"null"!==o){r.attr("transform",o+" rotate("+-e+","+t.width/2+","+t.height/2+")");var a=n.bbox(!1,this.paper.viewport);this.model.set("position",{x:a.x,y:a.y}),this.rotate()}this.update()}},translate:function(t,e,n){var i=this.model.get("position")||{x:0,y:0};V(this.el).attr("transform","translate("+i.x+","+i.y+")")},rotate:function(){var t=V(this.$(".rotatable")[0]);if(t){var e=this.model.get("angle")||0,n=this.model.get("size")||{width:1,height:1},i=n.width/2,r=n.height/2;t.attr("transform","rotate("+e+","+i+","+r+")")}},getBBox:function(t){if(t&&t.useModelGeometry){var e=this.model.getBBox().bbox(this.model.get("angle")),n=this.paper.viewport.getCTM();return V.transformRect(e,n)}return joint.dia.CellView.prototype.getBBox.apply(this,arguments)},findParentsByKey:function(t){var e=this.model.getBBox();return"bbox"==t?this.paper.model.findModelsInArea(e):this.paper.model.findModelsFromPoint(e[t]())},prepareEmbedding:function(){this.model.toFront({deep:!0,ui:!0}),_.invoke(this.paper.model.getConnectedLinks(this.model,{deep:!0}),"toFront",{ui:!0});var t=this.model.get("parent");t&&this.paper.model.getCell(t).unembed(this.model,{ui:!0})},processEmbedding:function(t){t=t||this.paper.options;var e=this.findParentsByKey(t.findParentBy);e=_.reject(e,function(t){return this.model.id==t.id||t.isEmbeddedIn(this.model)},this),t.frontParentOnly&&(e=e.slice(-1));for(var n=null,i=this._candidateEmbedView,r=e.length-1;r>=0;r--){var o=e[r];if(i&&i.model.id==o.id){n=i;break}var a=o.findView(this.paper);if(t.validateEmbedding.call(this.paper,this,a)){n=a;break}}n&&n!=i&&(i&&i.unhighlight(null,{embedding:!0}),this._candidateEmbedView=n.highlight(null,{embedding:!0})),!n&&i&&(i.unhighlight(null,{embedding:!0}),delete this._candidateEmbedView)},finalizeEmbedding:function(){var t=this._candidateEmbedView;t&&(t.model.embed(this.model,{ui:!0}),t.unhighlight(null,{embedding:!0}),delete this._candidateEmbedView),_.invoke(this.paper.model.getConnectedLinks(this.model,{deep:!0}),"reparent",{ui:!0})},pointerdown:function(t,e,n){if(this.model.trigger("batch:start"),t.target.getAttribute("magnet")&&this.paper.options.validateMagnet.call(this.paper,this,t.target)){var i=this.paper.getDefaultLink(this,t.target);i.set({source:{id:this.model.id,selector:this.getSelector(t.target),port:$(t.target).attr("port")},target:{x:e,y:n}}),this.paper.model.addCell(i),this._linkView=this.paper.findViewByModel(i),this._linkView.startArrowheadMove("target")}else this._dx=e,this._dy=n,joint.dia.CellView.prototype.pointerdown.apply(this,arguments)},pointermove:function(t,e,n){if(this._linkView)this._linkView.pointermove(t,e,n);else{var i=this.paper.options.gridSize,r=_.isFunction(this.options.interactive)?this.options.interactive(this,"pointermove"):this.options.interactive;if(r!==!1){var o=this.model.get("position");this.model.translate(g.snapToGrid(o.x,i)-o.x+g.snapToGrid(e-this._dx,i),g.snapToGrid(o.y,i)-o.y+g.snapToGrid(n-this._dy,i)),this.paper.options.embeddingMode&&(this._inProcessOfEmbedding||(this.prepareEmbedding(),this._inProcessOfEmbedding=!0),this.processEmbedding())}this._dx=g.snapToGrid(e,i),this._dy=g.snapToGrid(n,i),joint.dia.CellView.prototype.pointermove.apply(this,arguments)}},pointerup:function(t,e,n){this._linkView?(this._linkView.pointerup(t,e,n),delete this._linkView):(this._inProcessOfEmbedding&&(this.finalizeEmbedding(),this._inProcessOfEmbedding=!1),joint.dia.CellView.prototype.pointerup.apply(this,arguments)),this.model.trigger("batch:stop")}}),"object"==typeof exports&&(module.exports.Element=joint.dia.Element,module.exports.ElementView=joint.dia.ElementView),"object"==typeof exports)var joint={dia:{Cell:require("./joint.dia.cell").Cell,CellView:require("./joint.dia.cell").CellView}},Backbone=require("backbone"),_=require("lodash"),g=require("./geometry");if(joint.dia.Link=joint.dia.Cell.extend({markup:['<path class="connection" stroke="black"/>','<path class="marker-source" fill="black" stroke="black" />','<path class="marker-target" fill="black" stroke="black" />','<path class="connection-wrap"/>','<g class="labels"/>','<g class="marker-vertices"/>','<g class="marker-arrowheads"/>','<g class="link-tools"/>'].join(""),labelMarkup:['<g class="label">',"<rect />","<text />","</g>"].join(""),toolMarkup:['<g class="link-tool">','<g class="tool-remove" event="remove">','<circle r="11" />','<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z"/>',"<title>Remove link.</title>","</g>",'<g class="tool-options" event="link:options">','<circle r="11" transform="translate(25)"/>','<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',"<title>Link options.</title>","</g>","</g>"].join(""),vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>"].join(""),arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',"</g>"].join(""),defaults:{type:"link",source:{},target:{}},disconnect:function(){return this.set({source:g.point(0,0),target:g.point(0,0)})},label:function(t,e){t=t||0;var n=this.get("labels")||[];if(0===arguments.length||1===arguments.length)return n[t];var i=_.merge({},n[t],e),r=n.slice();return r[t]=i,this.set({labels:r})},translate:function(t,e,n){var i={},r=this.get("source"),o=this.get("target"),a=this.get("vertices");return r.id||(i.source={x:r.x+t,y:r.y+e}),o.id||(i.target={x:o.x+t,y:o.y+e}),a&&a.length&&(i.vertices=_.map(a,function(n){return{x:n.x+t,y:n.y+e}})),this.set(i,n)},reparent:function(t){var e;if(this.collection){var n=this.collection.get(this.get("source").id),i=this.collection.get(this.get("target").id),r=this.collection.get(this.get("parent"));n&&i&&(e=this.collection.getCommonAncestor(n,i)),!r||e&&e.id==r.id||r.unembed(this,t),e&&e.embed(this,t)}return e},isLink:function(){return!0},hasLoop:function(){var t=this.get("source").id,e=this.get("target").id;return t&&e&&t==e}}),joint.dia.LinkView=joint.dia.CellView.extend({className:function(){return _.unique(this.model.get("type").split(".").concat("link")).join(" ")},options:{shortLinkLength:100,doubleLinkTools:!1,longLinkLength:160,linkToolsOffset:40,doubleLinkToolsOffset:60},initialize:function(t){joint.dia.CellView.prototype.initialize.apply(this,arguments),"function"!=typeof this.constructor.prototype.watchSource&&(this.constructor.prototype.watchSource=this.createWatcher("source"),this.constructor.prototype.watchTarget=this.createWatcher("target")),this._labelCache={},this._markerCache={},this.startListening()},startListening:function(){this.listenTo(this.model,"change:markup",this.render),this.listenTo(this.model,"change:smooth change:manhattan change:router change:connector",this.update),this.listenTo(this.model,"change:toolMarkup",function(){this.renderTools().updateToolsPosition()}),this.listenTo(this.model,"change:labels change:labelMarkup",function(){this.renderLabels().updateLabelPositions()}),this.listenTo(this.model,"change:vertices change:vertexMarkup",function(t,e,n){this.renderVertexMarkers(),(!n.translateBy||n.translateBy==this.model.id||this.model.hasLoop())&&this.update()}),this.listenTo(this.model,"change:source",function(t,e){this.watchSource(t,e).update()}),this.listenTo(this.model,"change:target",function(t,e){this.watchTarget(t,e).update()})},render:function(){this.$el.empty();var t=V(this.model.get("markup")||this.model.markup);if(_.isArray(t)||(t=[t]),this._V={},_.each(t,function(t){var e=t.attr("class");e&&(this._V[$.camelCase(e)]=t)},this),!this._V.connection)throw new Error("link: no connection path in the markup");return this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),V(this.el).append(t),this.renderLabels(),this.watchSource(this.model,this.model.get("source")).watchTarget(this.model,this.model.get("target")).update(),
this},renderLabels:function(){if(!this._V.labels)return this;this._labelCache={};var t=$(this._V.labels.node).empty(),e=this.model.get("labels")||[];if(!e.length)return this;var n=_.template(this.model.get("labelMarkup")||this.model.labelMarkup),i=V(n());return _.each(e,function(e,n){var r=i.clone().node;this._labelCache[n]=V(r);var o=$(r).find("text"),a=$(r).find("rect"),s=_.extend({"text-anchor":"middle","font-size":14},joint.util.getByPath(e,"attrs/text","/"));o.attr(_.omit(s,"text")),_.isUndefined(s.text)||V(o[0]).text(s.text+""),t.append(r);var l=V(o[0]).bbox(!0,t[0]);V(o[0]).translate(0,-l.height/2);var u=_.extend({fill:"white",rx:3,ry:3},joint.util.getByPath(e,"attrs/rect","/"));a.attr(_.extend(u,{x:l.x,y:l.y-l.height/2,width:l.width,height:l.height}))},this),this},renderTools:function(){if(!this._V.linkTools)return this;var t=$(this._V.linkTools.node).empty(),e=_.template(this.model.get("toolMarkup")||this.model.toolMarkup),n=V(e());if(t.append(n.node),this._toolCache=n,this.options.doubleLinkTools){var i=n.clone();t.append(i.node),this._tool2Cache=i}return this},renderVertexMarkers:function(){if(!this._V.markerVertices)return this;var t=$(this._V.markerVertices.node).empty(),e=_.template(this.model.get("vertexMarkup")||this.model.vertexMarkup);return _.each(this.model.get("vertices"),function(n,i){t.append(V(e(_.extend({idx:i},n))).node)}),this},renderArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;var t=$(this._V.markerArrowheads.node);t.empty();var e=_.template(this.model.get("arrowheadMarkup")||this.model.arrowheadMarkup);return this._V.sourceArrowhead=V(e({end:"source"})),this._V.targetArrowhead=V(e({end:"target"})),t.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node),this},update:function(){_.each(this.model.get("attrs"),function(t,e){var n=[];_.isObject(t.fill)&&(this.applyGradient(e,"fill",t.fill),n.push("fill")),_.isObject(t.stroke)&&(this.applyGradient(e,"stroke",t.stroke),n.push("stroke")),_.isObject(t.filter)&&(this.applyFilter(e,t.filter),n.push("filter")),n.length>0&&(n.unshift(t),t=_.omit.apply(_,n)),this.findBySelector(e).attr(t)},this);var t=this.route=this.findRoute(this.model.get("vertices")||[]);this._findConnectionPoints(t);var e=this.getPathData(t);return this._V.connection.attr("d",e),this._V.connectionWrap&&this._V.connectionWrap.attr("d",e),this._translateAndAutoOrientArrows(this._V.markerSource,this._V.markerTarget),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),delete this.options.perpendicular,this.updatePostponed=!1,this},_findConnectionPoints:function(t){var e,n,i,r,o=_.first(t);e=this.getConnectionPoint("source",this.model.get("source"),o||this.model.get("target")).round();var a=_.last(t);n=this.getConnectionPoint("target",this.model.get("target"),a||e).round();var s=this._markerCache;this._V.markerSource&&(s.sourceBBox=s.sourceBBox||this._V.markerSource.bbox(!0),i=g.point(e).move(o||n,s.sourceBBox.width*this._V.markerSource.scale().sx*-1).round()),this._V.markerTarget&&(s.targetBBox=s.targetBBox||this._V.markerTarget.bbox(!0),r=g.point(n).move(a||e,s.targetBBox.width*this._V.markerTarget.scale().sx*-1).round()),s.sourcePoint=i||e,s.targetPoint=r||n,this.sourcePoint=e,this.targetPoint=n},updateLabelPositions:function(){if(!this._V.labels)return this;var t=this.model.get("labels")||[];if(!t.length)return this;var e=this._V.connection.node,n=e.getTotalLength();return _.isNaN(n)||_.each(t,function(t,i){var r=t.position;r=r>n?n:r,r=0>r?n+r:r,r=r>1?r:n*r;var o=e.getPointAtLength(r);this._labelCache[i].attr("transform","translate("+o.x+", "+o.y+")")},this),this},updateToolsPosition:function(){if(!this._V.linkTools)return this;var t="",e=this.options.linkToolsOffset,n=this.getConnectionLength();n<this.options.shortLinkLength&&(t="scale(.5)",e/=2);var i=this.getPointAtLength(e);if(this._toolCache.attr("transform","translate("+i.x+", "+i.y+") "+t),this.options.doubleLinkTools&&n>=this.options.longLinkLength){var r=this.options.doubleLinkToolsOffset||e;i=this.getPointAtLength(n-r),this._tool2Cache.attr("transform","translate("+i.x+", "+i.y+") "+t),this._tool2Cache.attr("visibility","visible")}else this.options.doubleLinkTools&&this._tool2Cache.attr("visibility","hidden");return this},updateArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;if("none"===$.css(this._V.markerArrowheads.node,"display"))return this;var t=this.getConnectionLength()<this.options.shortLinkLength?.5:1;return this._V.sourceArrowhead.scale(t),this._V.targetArrowhead.scale(t),this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead),this},createWatcher:function(t){function e(e,i){i=i||{};var r=null,o=e.previous(t)||{};return o.id&&this.stopListening(this.paper.getModelById(o.id),"change",n),i.id&&(r=this.paper.getModelById(i.id),this.listenTo(r,"change",n)),n.call(this,r,{cacheOnly:!0}),this}var n=_.partial(this.onEndModelChange,t);return e},onEndModelChange:function(t,e,n){var i=!n.cacheOnly,r=this.model.get(t)||{};if(e){var o=this.constructor.makeSelector(r),a="source"==t?"target":"source",s=this.model.get(a)||{},l=s.id&&this.constructor.makeSelector(s);if(n.isLoop&&o==l)this[t+"BBox"]=this[a+"BBox"],this[t+"View"]=this[a+"View"],this[t+"Magnet"]=this[a+"Magnet"];else if(n.translateBy){var u=this[t+"BBox"];u.x+=n.tx,u.y+=n.ty}else{var c=this.paper.findViewByModel(r.id),h=c.el.querySelector(o);this[t+"BBox"]=c.getStrokeBBox(h),this[t+"View"]=c,this[t+"Magnet"]=h}if(n.isLoop&&n.translateBy&&this.model.isEmbeddedIn(e)&&!_.isEmpty(this.model.get("vertices"))&&(i=!1),!this.updatePostponed&&s.id){var d=this.paper.getModelById(s.id);n.isLoop=r.id==s.id,(n.isLoop||n.translateBy&&d.isEmbeddedIn(n.translateBy))&&(this.updatePostponed=!0,i=!1)}}else this[t+"BBox"]=g.rect(r.x||0,r.y||0,1,1),this[t+"View"]=this[t+"Magnet"]=null;this.lastEndChange=t,i&&this.update()},_translateAndAutoOrientArrows:function(t,e){t&&t.translateAndAutoOrient(this.sourcePoint,_.first(this.route)||this.targetPoint,this.paper.viewport),e&&e.translateAndAutoOrient(this.targetPoint,_.last(this.route)||this.sourcePoint,this.paper.viewport)},removeVertex:function(t){var e=_.clone(this.model.get("vertices"));return e&&e.length&&(e.splice(t,1),this.model.set("vertices",e,{ui:!0})),this},addVertex:function(t){for(var e,n=(this.model.get("vertices")||[]).slice(),i=n.slice(),r=this._V.connection.node.cloneNode(!1),o=r.getTotalLength(),a=20,s=n.length+1;s--&&(n.splice(s,0,t),V(r).attr("d",this.getPathData(this.findRoute(n))),e=r.getTotalLength(),e-o>a);)n=i.slice();return-1===s&&(s=0,n.splice(s,0,t)),this.model.set("vertices",n,{ui:!0}),s},sendToken:function(t,e,n){e=e||1e3,V(this.paper.viewport).append(t),V(t).animateAlongPath({dur:e+"ms",repeatCount:1},this._V.connection.node),_.delay(function(){V(t).remove(),n&&n()},e)},findRoute:function(t){var e=this.model.get("router");if(!e){if(!this.model.get("manhattan"))return t;e={name:"orthogonal"}}var n=joint.routers[e.name];if(!_.isFunction(n))throw"unknown router: "+e.name;var i=n.call(this,t||[],e.args||{},this);return i},getPathData:function(t){var e=this.model.get("connector");if(e||(e=this.model.get("smooth")?{name:"smooth"}:{name:"normal"}),!_.isFunction(joint.connectors[e.name]))throw"unknown connector: "+e.name;var n=joint.connectors[e.name].call(this,this._markerCache.sourcePoint,this._markerCache.targetPoint,t||this.model.get("vertices")||{},e.args||{},this);return n},getConnectionPoint:function(t,e,n){var i;if(_.isEmpty(e)&&(e={x:0,y:0}),_.isEmpty(n)&&(n={x:0,y:0}),e.id){var r,o="source"===t?this.sourceBBox:this.targetBBox;if(n.id){var a="source"===t?this.targetBBox:this.sourceBBox;r=g.rect(a).intersectionWithLineFromCenterToPoint(g.rect(o).center()),r=r||g.rect(a).center()}else r=g.point(n);if(this.paper.options.perpendicularLinks||this.options.perpendicular){var s,l=g.rect(0,r.y,this.paper.options.width,1),u=g.rect(r.x,0,1,this.paper.options.height);if(l.intersect(g.rect(o)))switch(s=g.rect(o).sideNearestToPoint(r)){case"left":i=g.point(o.x,r.y);break;case"right":i=g.point(o.x+o.width,r.y);break;default:i=g.rect(o).center()}else if(u.intersect(g.rect(o)))switch(s=g.rect(o).sideNearestToPoint(r)){case"top":i=g.point(r.x,o.y);break;case"bottom":i=g.point(r.x,o.y+o.height);break;default:i=g.rect(o).center()}else i=g.rect(o).intersectionWithLineFromCenterToPoint(r),i=i||g.rect(o).center()}else if(this.paper.options.linkConnectionPoint){var c="target"===t?this.targetView:this.sourceView,h="target"===t?this.targetMagnet:this.sourceMagnet;i=this.paper.options.linkConnectionPoint(this,c,h,r)}else i=g.rect(o).intersectionWithLineFromCenterToPoint(r),i=i||g.rect(o).center()}else i=g.point(e);return i},getConnectionLength:function(){return this._V.connection.node.getTotalLength()},getPointAtLength:function(t){return this._V.connection.node.getPointAtLength(t)},_beforeArrowheadMove:function(){this.model.trigger("batch:start"),this._z=this.model.get("z"),this.model.toFront(),this.el.style.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets()},_afterArrowheadMove:function(){this._z&&(this.model.set("z",this._z,{ui:!0}),delete this._z),this.el.style.pointerEvents="visiblePainted",this.paper.options.markAvailable&&this._unmarkAvailableMagnets(),this.model.trigger("batch:stop")},_createValidateConnectionArgs:function(t){function e(t,e){return n[o]=t,n[o+1]=t.el===e?void 0:e,n}var n=[];n[4]=t,n[5]=this;var i,r=0,o=0;"source"===t?(r=2,i="target"):(o=2,i="source");var a=this.model.get(i);return a.id&&(n[r]=this.paper.findViewByModel(a.id),n[r+1]=a.selector&&n[r].el.querySelector(a.selector)),e},_markAvailableMagnets:function(){var t=this.paper.model.getElements(),e=this.paper.options.validateConnection;_.chain(t).map(this.paper.findViewByModel,this.paper).each(function(t){var n="false"!==t.el.getAttribute("magnet")&&e.apply(this.paper,this._validateConnectionArgs(t,null)),i=_.filter(t.el.querySelectorAll("[magnet]"),function(n){return e.apply(this.paper,this._validateConnectionArgs(t,n))},this);n&&V(t.el).addClass("available-magnet"),_.each(i,function(t){V(t).addClass("available-magnet")}),(n||i.length)&&V(t.el).addClass("available-cell")},this)},_unmarkAvailableMagnets:function(){_.each(this.paper.el.querySelectorAll(".available-cell, .available-magnet"),function(t){V(t).removeClass("available-magnet").removeClass("available-cell")})},startArrowheadMove:function(t){this._action="arrowhead-move",this._arrowhead=t,this._validateConnectionArgs=this._createValidateConnectionArgs(this._arrowhead),this._beforeArrowheadMove()},pointerdown:function(t,e,n){function i(t){return _.isObject(r)&&r[t]===!1?!1:!0}joint.dia.CellView.prototype.pointerdown.apply(this,arguments),this._dx=e,this._dy=n;var r=_.isFunction(this.options.interactive)?this.options.interactive(this,"pointerdown"):this.options.interactive;if(r!==!1){var o=t.target.getAttribute("class");switch(o){case"marker-vertex":i("vertexMove")&&(this._action="vertex-move",this._vertexIdx=t.target.getAttribute("idx"));break;case"marker-vertex-remove":case"marker-vertex-remove-area":i("vertexRemove")&&this.removeVertex(t.target.getAttribute("idx"));break;case"marker-arrowhead":i("arrowheadMove")&&this.startArrowheadMove(t.target.getAttribute("end"));break;default:var a=t.target.parentNode.getAttribute("event");a?"remove"===a?this.model.remove():this.paper.trigger(a,t,this,e,n):i("vertexAdd")&&(this._vertexIdx=this.addVertex({x:e,y:n}),this._action="vertex-move")}this.paper.trigger("link:pointerdown",t,this,e,n)}},pointermove:function(t,e,n){switch(joint.dia.CellView.prototype.pointermove.apply(this,arguments),this._action){case"vertex-move":var i=_.clone(this.model.get("vertices"));i[this._vertexIdx]={x:e,y:n},this.model.set("vertices",i,{ui:!0});break;case"arrowhead-move":if(this.paper.options.snapLinks){var r=this.paper.options.snapLinks.radius||50,o=this.paper.findViewsInArea({x:e-r,y:n-r,width:2*r,height:2*r});this._closestView&&this._closestView.unhighlight(this._closestEnd.selector,{connecting:!0,snapping:!0}),this._closestView=this._closestEnd=null;var a,s=g.point(e,n),l=Number.MAX_VALUE;_.each(o,function(t){"false"!==t.el.getAttribute("magnet")&&(a=t.model.getBBox().center().distance(s),r>a&&l>a&&this.paper.options.validateConnection.apply(this.paper,this._validateConnectionArgs(t,null))&&(l=a,this._closestView=t,this._closestEnd={id:t.model.id})),t.$("[magnet]").each(_.bind(function(e,n){var i=V(n).bbox(!1,this.paper.viewport);a=s.distance({x:i.x+i.width/2,y:i.y+i.height/2}),r>a&&l>a&&this.paper.options.validateConnection.apply(this.paper,this._validateConnectionArgs(t,n))&&(l=a,this._closestView=t,this._closestEnd={id:t.model.id,selector:t.getSelector(n),port:n.getAttribute("port")})},this))},this),this._closestView&&this._closestView.highlight(this._closestEnd.selector,{connecting:!0,snapping:!0}),this.model.set(this._arrowhead,this._closestEnd||{x:e,y:n},{ui:!0})}else{var u="mousemove"===t.type?t.target:document.elementFromPoint(t.clientX,t.clientY);this._targetEvent!==u&&(this._magnetUnderPointer&&this._viewUnderPointer.unhighlight(this._magnetUnderPointer,{connecting:!0}),this._viewUnderPointer=this.paper.findView(u),this._viewUnderPointer?(this._magnetUnderPointer=this._viewUnderPointer.findMagnet(u),this._magnetUnderPointer&&this.paper.options.validateConnection.apply(this.paper,this._validateConnectionArgs(this._viewUnderPointer,this._magnetUnderPointer))?this._magnetUnderPointer&&this._viewUnderPointer.highlight(this._magnetUnderPointer,{connecting:!0}):this._magnetUnderPointer=null):this._magnetUnderPointer=null),this._targetEvent=u,this.model.set(this._arrowhead,{x:e,y:n},{ui:!0})}}this._dx=e,this._dy=n},pointerup:function(t){joint.dia.CellView.prototype.pointerup.apply(this,arguments),"arrowhead-move"===this._action&&(this.paper.options.snapLinks?(this._closestView&&this._closestView.unhighlight(this._closestEnd.selector,{connecting:!0,snapping:!0}),this._closestView=this._closestEnd=null):(this._magnetUnderPointer&&(this._viewUnderPointer.unhighlight(this._magnetUnderPointer,{connecting:!0}),this.model.set(this._arrowhead,{id:this._viewUnderPointer.model.id,selector:this._viewUnderPointer.getSelector(this._magnetUnderPointer),port:$(this._magnetUnderPointer).attr("port")},{ui:!0})),delete this._viewUnderPointer,delete this._magnetUnderPointer),this.paper.options.embeddingMode&&this.model.reparent()&&delete this._z,this._afterArrowheadMove()),delete this._action}},{makeSelector:function(t){var e='[model-id="'+t.id+'"]';return t.port?e+=' [port="'+t.port+'"]':t.selector&&(e+=" "+t.selector),e}}),"object"==typeof exports&&(module.exports.Link=joint.dia.Link,module.exports.LinkView=joint.dia.LinkView),joint.dia.Paper=Backbone.View.extend({className:"paper",options:{width:800,height:600,origin:{x:0,y:0},gridSize:50,perpendicularLinks:!1,elementView:joint.dia.ElementView,linkView:joint.dia.LinkView,snapLinks:!1,markAvailable:!1,defaultLink:new joint.dia.Link,validateMagnet:function(t,e){return"passive"!==e.getAttribute("magnet")},validateConnection:function(t,e,n,i,r,o){return("target"===r?n:t)instanceof joint.dia.ElementView},embeddingMode:!1,validateEmbedding:function(t,e){return!0},findParentBy:"bbox",frontParentOnly:!0},events:{mousedown:"pointerdown",dblclick:"mousedblclick",click:"mouseclick",touchstart:"pointerdown",mousemove:"pointermove",touchmove:"pointermove","mouseover .element":"cellMouseover","mouseover .link":"cellMouseover","mouseout .element":"cellMouseout","mouseout .link":"cellMouseout"},constructor:function(t){this._configure(t),Backbone.View.apply(this,arguments)},_configure:function(t){this.options&&(t=_.extend({},_.result(this,"options"),t)),this.options=t},initialize:function(){_.bindAll(this,"addCell","sortCells","resetCells","pointerup","asyncRenderCells"),this.svg=V("svg").node,this.viewport=V("g").addClass("viewport").node,this.defs=V("defs").node,V(this.svg).append([this.viewport,this.defs]),this.$el.append(this.svg),this.setOrigin(),this.setDimensions(),this.listenTo(this.model,"add",this.onAddCell),this.listenTo(this.model,"reset",this.resetCells),this.listenTo(this.model,"sort",this.sortCells),$(document).on("mouseup touchend",this.pointerup),this._mousemoved=!1,this.on({"cell:highlight":this.onCellHighlight,"cell:unhighlight":this.onCellUnhighlight})},remove:function(){this.removeCells(),$(document).off("mouseup touchend",this.pointerup),Backbone.View.prototype.remove.call(this)},setDimensions:function(t,e){t=this.options.width=t||this.options.width,e=this.options.height=e||this.options.height,V(this.svg).attr({width:t,height:e}),this.trigger("resize",t,e)},setOrigin:function(t,e){this.options.origin.x=t||0,this.options.origin.y=e||0,V(this.viewport).translate(t,e,{absolute:!0}),this.trigger("translate",t,e)},fitToContent:function(t,e,n,i){_.isObject(t)?(i=t,t=i.gridWidth||1,e=i.gridHeight||1,n=i.padding||0):(i=i||{},t=t||1,e=e||1,n=n||0);var r=V(this.viewport).bbox(!0,this.svg),o=V(this.viewport).scale();r.x*=o.sx,r.y*=o.sy,r.width*=o.sx,r.height*=o.sy;var a=Math.max(Math.ceil((r.width+r.x)/t),1)*t,s=Math.max(Math.ceil((r.height+r.y)/e),1)*e,l=0,u=0;("negative"==i.allowNewOrigin&&r.x<0||"positive"==i.allowNewOrigin&&r.x>=0||"any"==i.allowNewOrigin)&&(l=Math.ceil(-r.x/t)*t,l+=n,a+=l),("negative"==i.allowNewOrigin&&r.y<0||"positive"==i.allowNewOrigin&&r.y>=0||"any"==i.allowNewOrigin)&&(u=Math.ceil(-r.y/e)*e,u+=n,s+=u),a+=n,s+=n,a=Math.max(a,i.minWidth||0),s=Math.max(s,i.minHeight||0);var c=a!=this.options.width||s!=this.options.height,h=l!=this.options.origin.x||u!=this.options.origin.y;h&&this.setOrigin(l,u),c&&this.setDimensions(a,s)},scaleContentToFit:function(t){var e=this.getContentBBox();if(e.width&&e.height){t=t||{},_.defaults(t,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE});var n=t.padding,i=t.minScaleX||t.minScale,r=t.maxScaleX||t.maxScale,o=t.minScaleY||t.minScale,a=t.maxScaleY||t.maxScale,s=t.fittingBBox||{x:this.options.origin.x,y:this.options.origin.y,width:this.options.width,height:this.options.height};s=g.rect(s).moveAndExpand({x:n,y:n,width:-2*n,height:-2*n});var l=V(this.viewport).scale(),u=s.width/e.width*l.sx,c=s.height/e.height*l.sy;if(t.preserveAspectRatio&&(u=c=Math.min(u,c)),t.scaleGrid){var h=t.scaleGrid;u=h*Math.floor(u/h),c=h*Math.floor(c/h)}u=Math.min(r,Math.max(i,u)),c=Math.min(a,Math.max(o,c)),this.scale(u,c);var d=this.getContentBBox(),f=s.x-d.x,p=s.y-d.y;this.setOrigin(f,p)}},getContentBBox:function(){var t=this.viewport.getBoundingClientRect(),e=this.viewport.getScreenCTM(),n=this.viewport.getCTM(),i=g.rect({x:t.left-e.e+n.e,y:t.top-e.f+n.f,width:t.width,height:t.height});return i},createViewForModel:function(t){var e,n=t.get("type"),i=n.split(".")[0],r=n.split(".")[1];return e=joint.shapes[i]&&joint.shapes[i][r+"View"]?new joint.shapes[i][r+"View"]({model:t,interactive:this.options.interactive}):t instanceof joint.dia.Element?new this.options.elementView({model:t,interactive:this.options.interactive}):new this.options.linkView({model:t,interactive:this.options.interactive})},onAddCell:function(t,e,n){if(this.options.async&&n.async!==!1&&_.isNumber(n.position)){if(this._asyncCells=this._asyncCells||[],this._asyncCells.push(t),0==n.position){if(this._frameId)throw"another asynchronous rendering in progress";this.asyncRenderCells(this._asyncCells),delete this._asyncCells}}else this.addCell(t)},addCell:function(t){var e=this.createViewForModel(t);V(this.viewport).append(e.el),e.paper=this,e.render(),$(e.el).find("image").on("dragstart",function(){return!1})},beforeRenderCells:function(t){return t.sort(function(t,e){return t instanceof joint.dia.Link?1:-1}),t},afterRenderCells:function(){this.sortCells()},resetCells:function(t){$(this.viewport).empty();var e=t.models.slice();e=this.beforeRenderCells(e),this._frameId&&(joint.util.cancelFrame(this._frameId),delete this._frameId),this.options.async?this.asyncRenderCells(e):(_.each(e,this.addCell,this),this.sortCells())},removeCells:function(){this.model.get("cells").each(function(t){var e=this.findViewByModel(t);e&&e.remove()},this)},asyncBatchAdded:_.identity,asyncRenderCells:function(t,e){var n=!1;this._frameId&&(_.each(_.range(this.options.async&&this.options.async.batchSize||50),function(){var e=t.shift();n=!e,n||this.addCell(e)},this),this.asyncBatchAdded()),n?(delete this._frameId,this.afterRenderCells(),this.trigger("render:done",e)):this._frameId=joint.util.nextFrame(_.bind(function(){this.asyncRenderCells(t,e)},this))},sortCells:function(){var t=$(this.viewport).children("[model-id]"),e=this.model.get("cells");this.sortElements(t,function(t,n){var i=e.get($(t).attr("model-id")),r=e.get($(n).attr("model-id"));return(i.get("z")||0)>(r.get("z")||0)?1:-1})},sortElements:function(t,e){var n=$(t),i=n.map(function(){var t=this,e=t.parentNode,n=e.insertBefore(document.createTextNode(""),t.nextSibling);return function(){if(e===this)throw new Error("You can't sort elements if any one is a descendant of another.");e.insertBefore(this,n),e.removeChild(n)}});return Array.prototype.sort.call(n,e).each(function(t){i[t].call(this)})},scale:function(t,e,n,i){e=e||t,_.isUndefined(n)&&(n=0,i=0),V(this.viewport).attr("transform","");var r=this.options.origin.x,o=this.options.origin.y;if(n||i||r||o){var a=r-n*(t-1),s=o-i*(e-1);this.setOrigin(a,s)}return V(this.viewport).scale(t,e),this.trigger("scale",t,e,n,i),this},rotate:function(t,e,n){if(_.isUndefined(e)){var i=this.viewport.getBBox();e=i.width/2,n=i.height/2}V(this.viewport).rotate(t,e,n)},findView:function(t){var e=this.$(t);return 0===e.length||e[0]===this.el?void 0:e.data("view")?e.data("view"):this.findView(e.parent())},findViewByModel:function(t){var e=_.isString(t)?t:t.id,n=this.$('[model-id="'+e+'"]');return n.length?n.data("view"):void 0},findViewsFromPoint:function(t){t=g.point(t);var e=_.map(this.model.getElements(),this.findViewByModel);return _.filter(e,function(e){return e&&g.rect(V(e.el).bbox(!1,this.viewport)).containsPoint(t)},this)},findViewsInArea:function(t){t=g.rect(t);var e=_.map(this.model.getElements(),this.findViewByModel);return _.filter(e,function(e){return e&&t.intersect(g.rect(V(e.el).bbox(!1,this.viewport)))},this)},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t){var e=V(this.viewport).toLocalPoint(t.x,t.y);return{x:g.snapToGrid(e.x,this.options.gridSize),y:g.snapToGrid(e.y,this.options.gridSize)}},getDefaultLink:function(t,e){return _.isFunction(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},onCellHighlight:function(t,e){V(e).addClass("highlighted")},onCellUnhighlight:function(t,e){V(e).removeClass("highlighted")},mousedblclick:function(t){t.preventDefault(),t=joint.util.normalizeEvent(t);var e=this.findView(t.target),n=this.snapToGrid({x:t.clientX,y:t.clientY});e?e.pointerdblclick(t,n.x,n.y):this.trigger("blank:pointerdblclick",t,n.x,n.y)},mouseclick:function(t){if(!this._mousemoved){t=joint.util.normalizeEvent(t);var e=this.findView(t.target),n=this.snapToGrid({x:t.clientX,y:t.clientY});e?e.pointerclick(t,n.x,n.y):this.trigger("blank:pointerclick",t,n.x,n.y)}this._mousemoved=!1},pointerdown:function(t){t=joint.util.normalizeEvent(t);var e=this.findView(t.target),n=this.snapToGrid({x:t.clientX,y:t.clientY});e?(this.sourceView=e,e.pointerdown(t,n.x,n.y)):this.trigger("blank:pointerdown",t,n.x,n.y)},pointermove:function(t){if(t.preventDefault(),t=joint.util.normalizeEvent(t),this.sourceView){this._mousemoved=!0;var e=this.snapToGrid({x:t.clientX,y:t.clientY});this.sourceView.pointermove(t,e.x,e.y)}},pointerup:function(t){t=joint.util.normalizeEvent(t);var e=this.snapToGrid({x:t.clientX,y:t.clientY});this.sourceView?(this.sourceView.pointerup(t,e.x,e.y),this.sourceView=null):this.trigger("blank:pointerup",t,e.x,e.y)},cellMouseover:function(t){t=joint.util.normalizeEvent(t);var e=this.findView(t.target);e&&e.mouseover(t)},cellMouseout:function(t){t=joint.util.normalizeEvent(t);var e=this.findView(t.target);e&&e.mouseout(t)}}),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{},dia:{Element:require("../src/joint.dia.element").Element,ElementView:require("../src/joint.dia.element").ElementView}},_=require("lodash");if(joint.shapes.basic={},joint.shapes.basic.Generic=joint.dia.Element.extend({defaults:joint.util.deepSupplement({type:"basic.Generic",attrs:{".":{fill:"#FFFFFF",stroke:"none"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.basic.Rect=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Rect",attrs:{rect:{fill:"#FFFFFF",stroke:"black",width:100,height:60},text:{"font-size":14,text:"","ref-x":.5,"ref-y":.5,ref:"rect","y-alignment":"middle","x-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.TextView=joint.dia.ElementView.extend({initialize:function(){joint.dia.ElementView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:attrs",this.resize)}}),joint.shapes.basic.Text=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><text/></g></g>',defaults:joint.util.deepSupplement({type:"basic.Text",attrs:{text:{"font-size":18,fill:"black"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Circle=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Circle",size:{width:60,height:60},attrs:{circle:{fill:"#FFFFFF",stroke:"black",r:30,transform:"translate(30, 30)"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,ref:"circle","y-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Image=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Image",attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,ref:"image","y-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Path=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Path",size:{width:60,height:60},attrs:{path:{fill:"#FFFFFF",stroke:"black"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,ref:"path","y-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Rhombus=joint.shapes.basic.Path.extend({defaults:joint.util.deepSupplement({type:"basic.Rhombus",attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5}}},joint.shapes.basic.Path.prototype.defaults)}),joint.shapes.basic.PortsModelInterface={initialize:function(){this.updatePortsAttrs(),this.on("change:inPorts change:outPorts",this.updatePortsAttrs,this),this.constructor.__super__.constructor.__super__.initialize.apply(this,arguments)},updatePortsAttrs:function(t){var e=this.get("attrs");_.each(this._portSelectors,function(t){e[t]&&delete e[t]}),this._portSelectors=[];var n={};_.each(this.get("inPorts"),function(t,e,i){var r=this.getPortAttrs(t,e,i.length,".inPorts","in");this._portSelectors=this._portSelectors.concat(_.keys(r)),_.extend(n,r)},this),_.each(this.get("outPorts"),function(t,e,i){var r=this.getPortAttrs(t,e,i.length,".outPorts","out");this._portSelectors=this._portSelectors.concat(_.keys(r)),_.extend(n,r)},this),this.attr(n,{silent:!0}),this.processPorts(),this.trigger("process:ports")},getPortSelector:function(t){var e=".inPorts",n=this.get("inPorts").indexOf(t);if(0>n&&(e=".outPorts",n=this.get("outPorts").indexOf(t),0>n))throw new Error("getPortSelector(): Port doesn't exist.");return e+">g:nth-child("+(n+1)+")>circle"}},joint.shapes.basic.PortsViewInterface={initialize:function(){this.listenTo(this.model,"process:ports",this.update),joint.dia.ElementView.prototype.initialize.apply(this,arguments)},update:function(){this.renderPorts(),joint.dia.ElementView.prototype.update.apply(this,arguments)},renderPorts:function(){var t=this.$(".inPorts").empty(),e=this.$(".outPorts").empty(),n=_.template(this.model.portMarkup);_.each(_.filter(this.model.ports,function(t){return"in"===t.type}),function(e,i){t.append(V(n({id:i,port:e})).node)}),_.each(_.filter(this.model.ports,function(t){return"out"===t.type}),function(t,i){e.append(V(n({id:i,port:t})).node)})}},joint.shapes.basic.TextBlock=joint.shapes.basic.Generic.extend({markup:['<g class="rotatable"><g class="scalable"><rect/></g><switch>','<foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" class="fobj">','<body xmlns="http://www.w3.org/1999/xhtml"><div/></body>',"</foreignObject>",'<text class="content"/>',"</switch></g>"].join(""),defaults:joint.util.deepSupplement({type:"basic.TextBlock",attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"",ref:"rect","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},joint.shapes.basic.Generic.prototype.defaults),initialize:function(){"undefined"!=typeof SVGForeignObjectElement&&(this.setForeignObjectSize(this,this.get("size")),this.setDivContent(this,this.get("content")),this.listenTo(this,"change:size",this.setForeignObjectSize),this.listenTo(this,"change:content",this.setDivContent)),joint.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},setForeignObjectSize:function(t,e){t.attr({".fobj":_.clone(e),div:{style:_.clone(e)}})},setDivContent:function(t,e){t.attr({div:{html:e}})}}),joint.shapes.basic.TextBlockView=joint.dia.ElementView.extend({initialize:function(){joint.dia.ElementView.prototype.initialize.apply(this,arguments),"undefined"==typeof SVGForeignObjectElement&&(this.noSVGForeignObjectElement=!0,this.listenTo(this.model,"change:content",function(t){this.updateContent(t)}))},update:function(t,e){if(this.noSVGForeignObjectElement){var n=this.model,i=_.omit(e||n.get("attrs"),".content");joint.dia.ElementView.prototype.update.call(this,n,i),(!e||_.has(e,".content"))&&this.updateContent(n,e)}else joint.dia.ElementView.prototype.update.call(this,n,e)},updateContent:function(t,e){var n=_.merge({},(e||t.get("attrs"))[".content"]);delete n.text;var i=joint.util.breakText(t.get("content"),t.get("size"),n,{svgDocument:this.paper.svg}),r=joint.util.setByPath({},".content",n,"/");r[".content"].text=i,joint.dia.ElementView.prototype.update.call(this,t,r)}}),"object"==typeof exports&&(module.exports=joint.shapes.basic),joint.routers.orthogonal=function(){function t(t,e){return t.y<e.y&&t.x===e.x?"down":t.y>e.y&&t.x===e.x?"up":t.x<e.x&&t.y===e.y?"right":"left"}function e(t,e,n){var i;if(i=t.x<e.x?t.y>e.y?["up","right"]:t.y<e.y?["down","right"]:["right"]:t.x>e.x?t.y>e.y?["up","left"]:t.y<e.y?["down","left"]:["left"]:t.y>e.y?["up"]:["down"],_.contains(i,n))return n;var r=_.first(i);switch(n){case"down":if("up"===r)return _.last(i);break;case"up":if("down"===r)return _.last(i);break;case"left":if("right"===r)return _.last(i);break;case"right":if("left"===r)return _.last(i)}return r}function n(t,n,i){var r=e(t,n,i);return"down"===r||"up"===r?{x:t.x,y:n.y,d:r}:{x:n.x,y:t.y,d:r}}function i(e){e=(e||[]).slice();var i=[],a=r.center(),s=o.center();e.length||(Math.abs(a.x-s.x)<r.width/2||Math.abs(a.y-s.y)<r.height/2)&&(e=[{x:Math.min(a.x,s.x)+Math.abs(a.x-s.x)/2,y:Math.min(a.y,s.y)+Math.abs(a.y-s.y)/2}]),e.unshift(a),e.push(s);for(var l,u,c,h,d=0;d<e.length-1;d++){c=e[d],h=e[d+1],u=_.last(i),d>0&&(l=c,l.d=u?t(u,c):"top",i.push(l),u=l);var f=u&&u.d;l=n(c,h,f),g.point(l).equals(g.point(c))||g.point(l).equals(g.point(h))||i.push(l)}return i}var r,o;return function(t){return r=this.sourceBBox,o=this.targetBBox,i(t)}}(),joint.routers.manhattan=function(){"use strict";function t(t,e){for(var n,i=[],r={x:0,y:0},o=e;n=t[o];){var a=n.difference(o);a.equals(r)||(i.unshift(o),r=a),o=n}return i.unshift(o),i}function e(t,e,n){var i=n.step,r=t.center(),o=_.chain(n.directionMap).pick(e).map(function(e){var n=e.x*t.width/2,o=e.y*t.height/2,a=g.point(r).offset(n,o).snapToGrid(i);return t.containsPoint(a)&&a.offset(e.x*i,e.y*i),a}).value();return o}function n(t,e,n){var i=360/n,r=Math.floor(t.theta(e)/i);return n-r}function i(i,r,o,a){var s=a.reversed?a.endDirections:a.startDirections,l=a.reversed?a.startDirections:a.endDirections,u=i instanceof g.rect?e(i,s,a):[i],c=r instanceof g.rect?e(r,l,a):[r],h=u.length>1?i.center():u[0],d=c.length>1?r.center():c[0],f=_.filter(c,function(t){
var e=g.point(t).snapToGrid(a.mapGridSize).toString(),n=_.every(o[e],function(e){return!e.containsPoint(t)});return n});if(f.length)for(var p=a.step,m=a.penalties,v=_.chain(f).invoke("snapToGrid",p).min(function(t){return a.estimateCost(h,t)}).value(),y={},x={},b={},w=a.directions,k=w.length,C=k/2,j=a.previousDirIndexes||{},E={},A={},T=_.chain(u).invoke("snapToGrid",p).each(function(t){var e=t.toString();x[e]=0,b[e]=a.estimateCost(t,v),j[e]=j[e]||n(h,t,k),A[e]=!0}).map(function(t){return t.toString()}).sortBy(function(t){return b[t]}).value(),S=a.maximumLoops,B=a.maxAllowedDirectionChange;T.length&&S--;){var M=T[0],P=g.point(M);if(v.equals(P))return a.previousDirIndexes=_.pick(j,M),t(y,P);T.splice(0,1),A[I]=null,E[I]=!0;for(var V=j[M],L=x[M],$=0;k>$;$++){var z=Math.abs($-V);if(z>C&&(z=k-z),!(z>B)){var F=w[$],O=g.point(P).offset(F.offsetX,F.offsetY),I=O.toString();if(!E[I]){var D=g.point(O).snapToGrid(a.mapGridSize).toString(),N=_.every(o[D],function(t){return!t.containsPoint(O)});if(N){var R=_.has(A,I),G=L+F.cost;if((!R||G<x[I])&&(y[I]=P,j[I]=$,x[I]=G,b[I]=G+a.estimateCost(O,v)+m[z],!R)){var U=_.sortedIndex(T,I,function(t){return b[t]});T.splice(U,0,I),A[I]=!0}}}}}}return a.fallbackRoute(h,d,a)}function r(t,e){e.directions=_.result(e,"directions"),e.penalties=_.result(e,"penalties"),e.paddingBox=_.result(e,"paddingBox"),this.options.perpendicular=!!e.perpendicular;var n=e.reversed="source"===this.lastEndChange,r=n?g.rect(this.targetBBox):g.rect(this.sourceBBox),o=n?g.rect(this.sourceBBox):g.rect(this.targetBBox);r.moveAndExpand(e.paddingBox),o.moveAndExpand(e.paddingBox);for(var a=this.model,s=this.paper.model,l=_.chain(e.excludeEnds).map(a.get,a).pluck("id").map(s.getCell,s).value(),u=e.mapGridSize,c=_.chain(s.getElements()).difference(l).reject(function(t){return _.contains(e.excludeTypes,t.get("type"))}).invoke("getBBox").invoke("moveAndExpand",e.paddingBox).foldl(function(t,e){for(var n=e.origin().snapToGrid(u),i=e.corner().snapToGrid(u),r=n.x;r<=i.x;r+=u)for(var o=n.y;o<=i.y;o+=u){var a=r+"@"+o;t[a]=t[a]||[],t[a].push(e)}return t},{}).value(),h=[],d=_.map(t,g.point),f=r.center(),p=0,m=d.length;m>=p;p++){var v=null,y=x||r,x=d[p];if(!x){x=o;var b=!this.model.get("source").id||!this.model.get("target").id;if(b&&_.isFunction(e.draggingRoute)){var w=y instanceof g.rect?y.center():y;v=e.draggingRoute(w,x.origin(),e)}}v=v||i(y,x,c,e);var k=_.first(v);k&&k.equals(f)&&v.shift(),f=_.last(v)||f,h=h.concat(v)}return n?h.reverse():h}var o={step:10,perpendicular:!0,mapGridSize:100,excludeEnds:[],excludeTypes:["basic.Text"],maximumLoops:500,startDirections:["left","right","top","bottom"],endDirections:["left","right","top","bottom"],directionMap:{right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0},top:{x:0,y:-1}},maxAllowedDirectionChange:1,paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},directions:function(){var t=this.step;return[{offsetX:t,offsetY:0,cost:t},{offsetX:0,offsetY:t,cost:t},{offsetX:-t,offsetY:0,cost:t},{offsetX:0,offsetY:-t,cost:t}]},penalties:function(){return[0,this.step/2,this.step]},estimateCost:function(t,e){return t.manhattanDistance(e)},fallbackRoute:function(t,e,n){var i=n.prevDirIndexes||{},r=(i[t]||0)%2?g.point(t.x,e.y):g.point(e.x,t.y);return[r,e]},draggingRoute:null};return function(t,e,n){return r.call(n,t,_.extend({},o,e))}}(),joint.routers.metro=function(){if(!_.isFunction(joint.routers.manhattan))throw"Metro requires the manhattan router.";var t={diagonalCost:null,directions:function(){var t=this.step,e=this.diagonalCost||Math.ceil(Math.sqrt(t*t<<1));return[{offsetX:t,offsetY:0,cost:t},{offsetX:t,offsetY:t,cost:e},{offsetX:0,offsetY:t,cost:t},{offsetX:-t,offsetY:t,cost:e},{offsetX:-t,offsetY:0,cost:t},{offsetX:-t,offsetY:-t,cost:e},{offsetX:0,offsetY:-t,cost:t},{offsetX:t,offsetY:-t,cost:e}]},fallbackRoute:function(t,e,n){var i=t.theta(e),r={x:e.x,y:t.y},o={x:t.x,y:e.y};if(i%180>90){var a=r;r=o,o=a}var s=45>i%90?r:o,l=g.line(t,s),u=90*Math.ceil(i/90),c=g.point.fromPolar(l.squaredLength(),g.toRad(u+135),s),h=g.line(e,c),d=l.intersection(h);return d?[d.round(),e]:[e]}};return function(e,n,i){return joint.routers.manhattan(e,_.extend({},t,n),i)}}(),joint.connectors.normal=function(t,e,n){var i=["M",t.x,t.y];return _.each(n,function(t){i.push(t.x,t.y)}),i.push(e.x,e.y),i.join(" ")},joint.connectors.rounded=function(t,e,n,i){var r,o,a,s,l,u,c=i.radius||10,h=["M",t.x,t.y];return _.each(n,function(i,d){l=n[d-1]||t,u=n[d+1]||e,a=s||g.point(i).distance(l)/2,s=g.point(i).distance(u)/2,r=g.point(i).move(l,-Math.min(c,a)).round(),o=g.point(i).move(u,-Math.min(c,s)).round(),h.push(r.x,r.y,"S",i.x,i.y,o.x,o.y,"L")}),h.push(e.x,e.y),h.join(" ")},joint.connectors.smooth=function(t,e,n){var i;if(n.length)i=g.bezier.curveThroughPoints([t].concat(n).concat([e]));else{var r=t.x<e.x?e.x-(e.x-t.x)/2:t.x-(t.x-e.x)/2;i=["M",t.x,t.y,"C",r,t.y,r,e.y,e.x,e.y]}return i.join(" ")},"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{},dia:{Element:require("../src/joint.dia.element").Element,Link:require("../src/joint.dia.link").Link}};joint.shapes.erd={},joint.shapes.erd.Entity=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.Entity",size:{width:150,height:60},attrs:{".outer":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"100,0 100,60 0,60 0,0"},".inner":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"95,5 95,55 5,55 5,5",display:"none"},text:{text:"Entity","font-family":"Arial","font-size":14,ref:".outer","ref-x":.5,"ref-y":.5,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.WeakEntity=joint.shapes.erd.Entity.extend({defaults:joint.util.deepSupplement({type:"erd.WeakEntity",attrs:{".inner":{display:"auto"},text:{text:"Weak Entity"}}},joint.shapes.erd.Entity.prototype.defaults)}),joint.shapes.erd.Relationship=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.Relationship",size:{width:80,height:80},attrs:{".outer":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,0 80,40 40,80 0,40"},".inner":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,5 75,40 40,75 5,40",display:"none"},text:{text:"Relationship","font-family":"Arial","font-size":12,ref:".","ref-x":.5,"ref-y":.5,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.IdentifyingRelationship=joint.shapes.erd.Relationship.extend({defaults:joint.util.deepSupplement({type:"erd.IdentifyingRelationship",attrs:{".inner":{display:"auto"},text:{text:"Identifying"}}},joint.shapes.erd.Relationship.prototype.defaults)}),joint.shapes.erd.Attribute=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><ellipse class="outer"/><ellipse class="inner"/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.Attribute",size:{width:100,height:50},attrs:{ellipse:{transform:"translate(50, 25)"},".outer":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:50,ry:25,fill:"#E67E22"},".inner":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:45,ry:20,fill:"#E67E22",display:"none"},text:{"font-family":"Arial","font-size":14,ref:".","ref-x":.5,"ref-y":.5,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.Multivalued=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Multivalued",attrs:{".inner":{display:"block"},text:{text:"multivalued"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.Derived=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Derived",attrs:{".outer":{"stroke-dasharray":"3,5"},text:{text:"derived"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.Key=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Key",attrs:{ellipse:{"stroke-width":4},text:{text:"key","font-weight":"800","text-decoration":"underline"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.Normal=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Normal",attrs:{text:{text:"Normal"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.ISA=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.ISA",size:{width:100,height:50},attrs:{polygon:{points:"0,0 50,50 100,0",fill:"#F1C40F",stroke:"#F39C12","stroke-width":2},text:{text:"ISA","font-size":18,ref:"polygon","ref-x":.5,"ref-y":.3,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.Line=joint.dia.Link.extend({defaults:{type:"erd.Line"},cardinality:function(t){this.set("labels",[{position:-20,attrs:{text:{dy:-8,text:t}}}])}}),"object"==typeof exports&&(module.exports=joint.shapes.erd),function(t){if("undefined"!=typeof module&&module.exports)module.exports=t(this);else if("function"==typeof define&&define.amd){var e=this;define("i18n",function(){return t(e)})}else this.I18n=t(this)}(function(t){"use strict";var e=t&&t.I18n||{},n=Array.prototype.slice,i=function(t){return("0"+t.toString()).substr(-2)},r={day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridian:["AM","PM"]},o={precision:3,separator:".",delimiter:",",strip_insignificant_zeros:!1},a={unit:"$",precision:2,format:"%u%n",sign_first:!0,delimiter:",",separator:"."},s={unit:"%",precision:3,format:"%n%u",separator:".",delimiter:""},l=[null,"kb","mb","gb","tb"],u={defaultLocale:"en",locale:"en",defaultSeparator:".",placeholder:/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm,fallbacks:!1,translations:{},missingBehaviour:"message",missingTranslationPrefix:""};return e.reset=function(){this.defaultLocale=u.defaultLocale,this.locale=u.locale,this.defaultSeparator=u.defaultSeparator,this.placeholder=u.placeholder,this.fallbacks=u.fallbacks,this.translations=u.translations,this.missingBehaviour=u.missingBehaviour,this.missingTranslationPrefix=u.missingTranslationPrefix},e.initializeOptions=function(){"undefined"==typeof this.defaultLocale&&null!==this.defaultLocale&&(this.defaultLocale=u.defaultLocale),"undefined"==typeof this.locale&&null!==this.locale&&(this.locale=u.locale),"undefined"==typeof this.defaultSeparator&&null!==this.defaultSeparator&&(this.defaultSeparator=u.defaultSeparator),"undefined"==typeof this.placeholder&&null!==this.placeholder&&(this.placeholder=u.placeholder),"undefined"==typeof this.fallbacks&&null!==this.fallbacks&&(this.fallbacks=u.fallbacks),"undefined"==typeof this.translations&&null!==this.translations&&(this.translations=u.translations)},e.initializeOptions(),e.locales={},e.locales.get=function(t){var n=this[t]||this[e.locale]||this["default"];return"function"==typeof n&&(n=n(t)),n instanceof Array==!1&&(n=[n]),n},e.locales["default"]=function(t){var n,i=[],r=[];return t&&i.push(t),!t&&e.locale&&i.push(e.locale),e.fallbacks&&e.defaultLocale&&i.push(e.defaultLocale),i.forEach(function(t){n=t.split("-")[0],~r.indexOf(t)||r.push(t),e.fallbacks&&n&&n!==t&&!~r.indexOf(n)&&r.push(n)}),i.length||i.push("en"),r},e.pluralization={},e.pluralization.get=function(t){return this[t]||this[e.locale]||this["default"]},e.pluralization["default"]=function(t){switch(t){case 0:return["zero","other"];case 1:return["one"];default:return["other"]}},e.currentLocale=function(){return this.locale||this.defaultLocale},e.isSet=function(t){return void 0!==t&&null!==t},e.lookup=function(t,e){e=this.prepareOptions(e);var n,i,r,o=this.locales.get(e.locale).slice();o[0];for(t=this.getFullScope(t,e);o.length;)if(n=o.shift(),i=t.split(this.defaultSeparator),r=this.translations[n]){for(;i.length&&(r=r[i.shift()],void 0!==r&&null!==r););if(void 0!==r&&null!==r)return r}return this.isSet(e.defaultValue)?e.defaultValue:void 0},e.meridian=function(){var t=this.lookup("time"),e=this.lookup("date");return t&&t.am&&t.pm?[t.am,t.pm]:e&&e.meridian?e.meridian:r.meridian},e.prepareOptions=function(){for(var t,e=n.call(arguments),i={};e.length;)if(t=e.shift(),"object"==typeof t)for(var r in t)t.hasOwnProperty(r)&&(this.isSet(i[r])||(i[r]=t[r]));return i},e.createTranslationOptions=function(t,e){var n=[{scope:t}];return this.isSet(e.defaults)&&(n=n.concat(e.defaults)),this.isSet(e.defaultValue)&&(n.push({message:e.defaultValue}),delete e.defaultValue),n},e.translate=function(t,e){e=this.prepareOptions(e);var n,i=this.createTranslationOptions(t,e),r=i.some(function(t){return this.isSet(t.scope)?n=this.lookup(t.scope,e):this.isSet(t.message)&&(n=t.message),void 0!==n&&null!==n?!0:void 0},this);return r?("string"==typeof n?n=this.interpolate(n,e):n instanceof Object&&this.isSet(e.count)&&(n=this.pluralize(e.count,n,e)),n):this.missingTranslation(t,e)},e.interpolate=function(t,e){e=this.prepareOptions(e);var n,i,r,o,a=t.match(this.placeholder);if(!a)return t;for(var i;a.length;)n=a.shift(),r=n.replace(this.placeholder,"$1"),i=this.isSet(e[r])?e[r].toString().replace(/\$/gm,"_#$#_"):r in e?this.nullPlaceholder(n,t):this.missingPlaceholder(n,t),o=new RegExp(n.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),t=t.replace(o,i);return t.replace(/_#\$#_/g,"$")},e.pluralize=function(t,e,n){n=this.prepareOptions(n);var i,r,o,a,s;if(i=e instanceof Object?e:this.lookup(e,n),!i)return this.missingTranslation(e,n);for(r=this.pluralization.get(n.locale),o=r(t);o.length;)if(a=o.shift(),this.isSet(i[a])){s=i[a];break}return n.count=String(t),this.interpolate(s,n)},e.missingTranslation=function(t,e){if("guess"==this.missingBehaviour){var n=t.split(".").slice(-1)[0];return(this.missingTranslationPrefix.length>0?this.missingTranslationPrefix:"")+n.replace("_"," ").replace(/([a-z])([A-Z])/g,function(t,e,n){return e+" "+n.toLowerCase()})}var i=this.getFullScope(t,e),r=[this.currentLocale(),i].join(this.defaultSeparator);return'[missing "'+r+'" translation]'},e.missingPlaceholder=function(t,e){return"[missing "+t+" value]"},e.nullPlaceholder=function(){return e.missingPlaceholder.apply(e,arguments)},e.toNumber=function(t,e){e=this.prepareOptions(e,this.lookup("number.format"),o);var n,i,r=0>t,a=Math.abs(t).toFixed(e.precision).toString(),s=a.split("."),l=[],u=e.format||"%n",c=r?"-":"";for(t=s[0],n=s[1];t.length>0;)l.unshift(t.substr(Math.max(0,t.length-3),3)),t=t.substr(0,t.length-3);return i=l.join(e.delimiter),e.strip_insignificant_zeros&&n&&(n=n.replace(/0+$/,"")),e.precision>0&&n&&(i+=e.separator+n),u=e.sign_first?"%s"+u:u.replace("%n","%s%n"),i=u.replace("%u",e.unit).replace("%n",i).replace("%s",c)},e.toCurrency=function(t,e){return e=this.prepareOptions(e,this.lookup("number.currency.format"),this.lookup("number.format"),a),this.toNumber(t,e)},e.localize=function(t,e,n){switch(n||(n={}),t){case"currency":return this.toCurrency(e);case"number":return t=this.lookup("number.format"),this.toNumber(e,t);case"percentage":return this.toPercentage(e);default:var i;return i=t.match(/^(date|time)/)?this.toTime(t,e):e.toString(),this.interpolate(i,n)}},e.parseDate=function(t){var e,n,i;if("object"==typeof t)return t;if(e=t.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2})([\.,]\d{1,3})?)?(Z|\+00:?00)?/)){for(var r=1;6>=r;r++)e[r]=parseInt(e[r],10)||0;e[2]-=1,i=e[7]?1e3*("0"+e[7]):null,n=e[8]?new Date(Date.UTC(e[1],e[2],e[3],e[4],e[5],e[6],i)):new Date(e[1],e[2],e[3],e[4],e[5],e[6],i)}else"number"==typeof t?(n=new Date,n.setTime(t)):t.match(/([A-Z][a-z]{2}) ([A-Z][a-z]{2}) (\d+) (\d+:\d+:\d+) ([+-]\d+) (\d+)/)?(n=new Date,n.setTime(Date.parse([RegExp.$1,RegExp.$2,RegExp.$3,RegExp.$6,RegExp.$4,RegExp.$5].join(" ")))):t.match(/\d+ \d+:\d+:\d+ [+-]\d+ \d+/)?(n=new Date,n.setTime(Date.parse(t))):(n=new Date,n.setTime(Date.parse(t)));return n},e.strftime=function(t,n){var o=this.lookup("date"),a=e.meridian();o||(o={}),o=this.prepareOptions(o,r);var s=t.getDay(),l=t.getDate(),u=t.getFullYear(),c=t.getMonth()+1,h=t.getHours(),d=h,f=h>11?1:0,p=t.getSeconds(),g=t.getMinutes(),m=t.getTimezoneOffset(),v=Math.floor(Math.abs(m/60)),y=Math.abs(m)-60*v,x=(m>0?"-":"+")+(v.toString().length<2?"0"+v:v)+(y.toString().length<2?"0"+y:y);return d>12?d-=12:0===d&&(d=12),n=n.replace("%a",o.abbr_day_names[s]),n=n.replace("%A",o.day_names[s]),n=n.replace("%b",o.abbr_month_names[c]),n=n.replace("%B",o.month_names[c]),n=n.replace("%d",i(l)),n=n.replace("%e",l),n=n.replace("%-d",l),n=n.replace("%H",i(h)),n=n.replace("%-H",h),n=n.replace("%I",i(d)),n=n.replace("%-I",d),n=n.replace("%m",i(c)),n=n.replace("%-m",c),n=n.replace("%M",i(g)),n=n.replace("%-M",g),n=n.replace("%p",a[f]),n=n.replace("%S",i(p)),n=n.replace("%-S",p),n=n.replace("%w",s),n=n.replace("%y",i(u)),n=n.replace("%-y",i(u).replace(/^0+/,"")),n=n.replace("%Y",u),n=n.replace("%z",x)},e.toTime=function(t,e){var n=this.parseDate(e),i=this.lookup(t);return n.toString().match(/invalid/i)?n.toString():i?this.strftime(n,i):n.toString()},e.toPercentage=function(t,e){return e=this.prepareOptions(e,this.lookup("number.percentage.format"),this.lookup("number.format"),s),this.toNumber(t,e)},e.toHumanSize=function(t,e){for(var n,i,r=1024,o=t,a=0;o>=r&&4>a;)o/=r,a+=1;return 0===a?(n=this.t("number.human.storage_units.units.byte",{count:o}),i=0):(n=this.t("number.human.storage_units.units."+l[a]),i=o-Math.floor(o)===0?0:1),e=this.prepareOptions(e,{unit:n,precision:i,format:"%n%u",delimiter:""}),this.toNumber(o,e)},e.getFullScope=function(t,e){return e=this.prepareOptions(e),t.constructor===Array&&(t=t.join(this.defaultSeparator)),e.scope&&(t=[e.scope,t].join(this.defaultSeparator)),t},e.t=e.translate,e.l=e.localize,e.p=e.pluralize,e}),I18n.translations||(I18n.translations={}),I18n.translations.en={js:{as:{bt:"Belongs to",has:"Has"},at:{sys:{created_at:"Created at",email:"Email",passwd:"Password",status:"Status",status_values:["inactive","active","blocked"],updated_at:"Updated at"}},cms:{confirm:{"delete":"Delete this %{slab}?"}},confirm:{upgrade_ver:"You are running an outdated version. Do you want to reload the page to update?"},demo:{hint_no_upload:"Demo App is read-only. Uploading is deactivated."},editor:{ack:{dev_sync_off:"Phone/Tablet synchronization: OFF",dev_sync_on:"Phone/Tablet synchronization: ON",field_name:{block:"block",inline:"inline",none:"none"},update_field_name:"Show field name: %{state}"},attr_type:{attach:"Attachment",bool:"Boolean",date:"Date",datetime:"Datetime",geoloc:"Location",hyperlink:"URL",image:"Image",number:"Number",select:"Choice",string:"Text",text:"Text",time:"Time"},confirm:{delete_attr:"Delete this data field?",delete_data:"Delete this data model?",delete_dview:"Delete this detail view?",delete_elem:"Delete this element?",delete_rel:"Delete this relationship?",delete_root:"Delete this navigation page?",delete_seco:"Delete this pop-up page?",delete_tab:"Delete this tab?",delete_view:"Delete this view?"},data:{unnamed:"Unnamed"},elem:{default_label_count:"Count All %{slab}",default_label_count_linked:"Count %{slab}",hd_admin:"Timestamp",hd_content:"Content",hd_count:"Data Count",hd_linked:"Associated Content",hd_linked_count:"Associated Data Count"},error:{"invalid-assoc":"Invalid relationship","invalid-struct-attr":"Invalid data field name","invalid-struct-label":"Invalid model name"},hint:{elem_unavailable:{acb:"Action Buttons are not available for this view",lv_acb:"Action Buttons are not available for list item",lv_cv:"Child Views are not available for list item"}},"import":{error:{ext_not_csv:"Not a .CSV file",file_too_large:"File too large (max. 3 MB)",invalid_csv:"Invalid CSV file"}},view:{unnamed:"Unnamed"}},error:{no_network:"No network. Please check your network connection.",upload_no_image:"Only images are allowed: JPEG, PNG, GIF."},form:{cancel:"Cancel",ok:"OK"},hint:{link_desktop_only:"Please open the link with a desktop browser."},shared:{sort_asc:"ascending",sort_desc:"descending"},static_content:{image:"Image",map:"Map"},web:{confirm:{"delete":"Delete this %{slab}?"},msg_signup_success:"Thank you for signing up. You will receive an email with instructions for how to confirm your email address in a few minutes."}}},I18n.translations.de={js:{as:{bt:"Geh\xf6rt zu",has:"Hat"},at:{sys:{created_at:"Erstellt am",email:"Email",passwd:"Passwort",status:"Status",status_values:["inactiv","activ","blockiert"],updated_at:"Aktualisiert am"}},cms:{confirm:{"delete":"%{slab} l\xf6schen?"}},confirm:{upgrade_ver:"Neue Version wurde gefunden. M\xf6chten Sie die App aktualisieren?"},demo:{hint_no_upload:"Beispiel-App ist schreibgesch\xfctzt. Hochladen ist nicht m\xf6glich."},editor:{ack:{dev_sync_off:"Phone/Tablet Synchronization: AUS",dev_sync_on:"Phone/Tablet Synchronization: EIN",field_name:{block:"block",inline:"inline",none:"aus"},update_field_name:"Feldname wird angezeigt: %{state}"},attr_type:{attach:"Anlage",bool:"Boolean",date:"Datum",datetime:"Zeit",geoloc:"Location",hyperlink:"URL",image:"Bild",number:"Zahl",select:"Auswahlliste",string:"Text",text:"Text",time:"Uhrzeit"},confirm:{delete_attr:"Datenfeld l\xf6schen?",delete_data:"Datenmodell l\xf6schen?",delete_dview:"Detailansicht l\xf6schen?",delete_elem:"Element l\xf6schen?",delete_rel:"Beziehung l\xf6schen?",delete_root:"Navigation-Seite l\xf6schen?",delete_seco:"Popup-Seite l\xf6schen?",delete_tab:"Tab-Ansicht l\xf6schen?",delete_view:"Ansicht l\xf6schen?"},data:{unnamed:"Unbenannt"},elem:{default_label_count:"Anzahl (gesamt) %{slab}",default_label_count_linked:"Anzahl %{slab}",hd_admin:"Zeitstempel",hd_content:"Inhalte",hd_count:"Anzahl der Datens\xe4tze",hd_linked:"Verkn\xfcpfte Inhalte",hd_linked_count:"Anzahl verkn\xfcpfter Datens\xe4tze"},error:{"invalid-assoc":"Beziehung ist ung\xfcltig","invalid-struct-attr":"Name des Datenfeldes ist ung\xfcltig","invalid-struct-label":"Name des Datenmodelles ist ung\xfcltig"},hint:{elem_unavailable:{acb:"Aktionsbuttons sind nicht erh\xe4ltlich f\xfcr diese Ansicht",lv_acb:"Aktionsbuttons sind nicht erh\xe4ltlich f\xfcr Listenansicht",lv_cv:"Unteransichten sind nicht erh\xe4ltlich f\xfcr Listenansicht"}},"import":{error:{ext_not_csv:"Keine .CSV Datei",file_too_large:"Datei ist zu gro\xdf (max. 3 MB)",invalid_csv:"Die CSV-Datei ist ung\xfcltig"}},view:{unnamed:"Unbenannt"}},error:{no_network:"Sie sind zurzeit offline. Bitte \xfcberpr\xfcfen Sie Ihre Netzverbindung.",upload_no_image:"Nur folgende Bild-Formate sind erlaubt: JPEG, PNG, GIF."},form:{cancel:"Abbrechen",ok:"OK"},hint:{link_desktop_only:"Bitte \xf6ffnen Sie den Link an PC mit einem Web-Browser."},shared:{sort_asc:"aufsteigend",sort_desc:"absteigend"},static_content:{image:"Bild",map:"Landkarte"},web:{confirm:{"delete":"%{slab} l\xf6schen?"},msg_signup_success:"Vielen Dank f\xfcr Ihre Registriertung. In weniger Minuten erhalten Sie eine E-Mail mit den Aktivierungslink."}}},I18n.translations.zh={js:{as:{bt:"\u96b6\u5c5e",has:"\u62e5\u6709"},at:{sys:{created_at:"\u521b\u5efa\u65f6\u95f4",email:"\u90ae\u4ef6\u5730\u5740",passwd:"\u5bc6\u7801",status:"\u72b6\u6001",status_values:["\u672a\u6fc0\u6d3b","\u6b63\u5e38","\u5df2\u5c4f\u853d"],updated_at:"\u66f4\u65b0\u65f6\u95f4"}},cms:{confirm:{"delete":"\u5220\u9664\u8fd9\u4e2a%{slab}?"}},confirm:{upgrade_ver:"\u9879\u76ee\u7248\u672c\u6709\u66f4\u65b0\uff0c\u662f\u5426\u91cd\u8f7d\u9875\u9762\uff1f"},demo:{hint_no_upload:"\u793a\u4f8b\u5e94\u7528\u53ea\u53ef\u8bfb\uff0c\u65e0\u6cd5\u4e0a\u4f20\u6587\u4ef6\u3002"},editor:{ack:{dev_sync_off:"\u4e0d\u540c\u5c3a\u5bf8\u5e03\u5c40\u540c\u6b65\uff1a\u505c\u6b62",dev_sync_on:"\u4e0d\u540c\u5c3a\u5bf8\u5e03\u5c40\u540c\u6b65\uff1a\u5f00\u542f",field_name:{block:"\u5355\u884c\u663e\u793a",inline:"\u540c\u884c\u663e\u793a",none:"\u4e0d\u663e\u793a"},update_field_name:"\u5b50\u9879\u540d\u79f0\u663e\u793a\u65b9\u5f0f: %{state}"},attr_type:{attach:"\u9644\u4ef6",bool:"\u5f00\u5173\u9879",date:"\u65e5\u671f",datetime:"\u65f6\u95f4",geoloc:"\u5730\u7406\u4f4d\u7f6e",hyperlink:"\u7f51\u9875\u94fe\u63a5",image:"\u56fe\u7247",number:"\u6570\u5b57",select:"\u9009\u62e9\u9879",string:"\u6587\u5b57",text:"\u6587\u5b57",time:"\u949f\u70b9"},confirm:{delete_attr:"\u5220\u9664\u8fd9\u4e2a\u6570\u636e\u7c7b\u5b50\u9879?",delete_data:"\u5220\u9664\u8fd9\u4e2a\u6570\u636e\u7c7b\uff1f",delete_dview:"\u5220\u9664\u8fd9\u4e2a\u89c6\u56fe?",delete_elem:"\u5220\u9664\u8fd9\u4e2a\u9875\u9762\u5b50\u9879?",delete_rel:"\u5220\u9664\u8fd9\u4e2a\u6570\u636e\u5173\u7cfb?",delete_root:"\u5220\u9664\u8fd9\u4e2a\u5bfc\u822a\u9875?",delete_seco:"\u5220\u9664\u8fd9\u4e2a\u5f39\u51fa\u9875?",delete_tab:"\u5220\u9664\u8fd9\u4e2a\u5206\u680f\u9875?",delete_view:"\u5220\u9664\u8fd9\u4e2a\u89c6\u56fe?"},data:{unnamed:"\u672a\u547d\u540d"},elem:{default_label_count:"\u603b\u6570: %{slab}",default_label_count_linked:"\u6570\u91cf: %{slab}",hd_admin:"\u7cfb\u7edf\u4fe1\u606f",hd_content:"\u5185\u5bb9",hd_count:"\u7edf\u8ba1\u503c",hd_linked:"\u5173\u8054\u5185\u5bb9",hd_linked_count:"\u5173\u8054\u7edf\u8ba1\u503c"},error:{"invalid-assoc":"\u6570\u636e\u5173\u7cfb\u65e0\u6548","invalid-struct-attr":"\u8be5\u540d\u79f0\u5df2\u5b58\u5728\uff0c\u8bf7\u9009\u62e9\u5176\u5b83\u547d\u540d","invalid-struct-label":"\u8be5\u540d\u79f0\u5df2\u5b58\u5728\uff0c\u8bf7\u9009\u62e9\u5176\u5b83\u547d\u540d"},hint:{elem_unavailable:{acb:"\u6ca1\u6709\u53ef\u7528\u7684\u72ec\u7acb\u64cd\u4f5c\u6309\u952e",lv_acb:"\u5217\u8868\u5185\u4e0d\u80fd\u6dfb\u52a0\u72ec\u7acb\u64cd\u4f5c\u6309\u952e",lv_cv:"\u5217\u8868\u5185\u4e0d\u80fd\u5185\u5d4c\u5b50\u89c6\u56fe"}},"import":{error:{ext_not_csv:"\u4e0d\u662fCSV\u6587\u4ef6",file_too_large:"\u6587\u4ef6\u592a\u5927 (\u6700\u59273MB)",invalid_csv:"\u65e0\u6548\u7684CSV\u683c\u5f0f"}},view:{unnamed:"\u672a\u547d\u540d"}},error:{no_network:"\u60a8\u5f53\u524d\u5904\u4e8e\u79bb\u7ebf\u72b6\u6001\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8bbe\u7f6e\u3002",upload_no_image:"\u56fe\u7247\u4e0a\u4f20\u76ee\u524d\u53ea\u652f\u6301\u4ee5\u4e0b\u683c\u5f0f: JPEG, PNG, GIF\u3002"},form:{cancel:"\u53d6\u6d88",ok:"\u786e\u5b9a"},hint:{link_desktop_only:"\u8bf7\u5728\u53f0\u5f0f\u6216\u7b14\u8bb0\u672c\u7535\u8111\u4e0a\u6253\u5f00\u94fe\u63a5\u3002"},shared:{sort_asc:"\u5347\u5e8f",sort_desc:"\u964d\u5e8f"},static_content:{image:"\u56fe\u7247",map:"\u5730\u56fe"},web:{confirm:{"delete":"\u5220\u9664\u8fd9\u4e2a%{slab}?"},msg_signup_success:"\u611f\u8c22\u6ce8\u518c\u5e10\u53f7\uff0c\u60a8\u5c06\u9a6c\u4e0a\u6536\u5230\u4e00\u5c01\u90ae\u4ef6\u901a\u77e5\u60a8\u786e\u8ba4\u90ae\u4ef6\u5730\u5740\u3002"}}},function(){this.guideInit=function(){var t,e;return e=$(".guide-toc .nav"),t=null,$(".guide-body h3").each(function(){var n,i,r,o,a,s,l;if(r=$(this),s=r.text(),n=r.attr("id"),o=(a=r.attr("ico"))?$("<i>").addClass("fa fa-fw fa-"+a):null,n){if(!n.match(/-/))return r.addClass("larger"),t=$("<li><a href='#"+n+"'>"+s+"</li>").appendTo(e);if(l=t.find("ul"),0===l.length&&(l=$("<ul></ul>").addClass("nav nav-2").appendTo(t)),i=$("<li><a href='#"+n+"'>"+s+"</li>").appendTo(l),o)return i.find("a").prepend(o),r.prepend(o.clone().css({"margin-right":"10px"}))}else;}),$(".guide-toc li:first").addClass("active"),$("body").scrollspy({target:".guide-toc"})}}.call(this),function(){var t,e,n,i,r,o,a,s,l,u,c,h,d,f,p,g,m,v,y,x,b,w,k,C,j,E,A,T;C=null,b=null,x=null,p=null,y=null,g=null,k=null,w=null,m=null,v=null,function(){var t,e,n,i,r,s,l,u;return n=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725],e=function(t){var e;return e=t.toString(16),1===e.length?"0"+e:e},t=function(){var t,e;for(e=[],l=t=1;20>=t;l=++t)u=n[l-1],e.push({r:u>>16,g:u>>8&255,b:255&u});return e}(),r=function(e){var n,i;return 0>e?[]:(n=t[2*e%20],i=t[(2*e+1)%20],[n,i])},i=function(t){var n,i,o,a,s;for(a=r(t),s=[],i=0,o=a.length;o>i;i++)n=a[i],s.push("#"+e(n.r)+e(n.g)+e(n.b));return s},s=function(t){return t?i(~~jsc[t]):["#fff","#fff"]},C=function(t){var e;return i((e=o(t))?~~e.color:-1)},b=function(t){return"string"==typeof t&&(t=$(t)),t.find("[color]").each(function(t){var e,n;return n=$(this),e=r(n.attr("color"))[1],n.css("background-color","rgba("+e.r+","+e.g+","+e.b+",0.75)")})},x=function(t){return"string"==typeof t&&(t=$(t)),t.find("[color]").each(function(t){var e,n;return n=$(this),e=i(n.attr("color")),n.css("border-color",e[0]),n.css("background-color",e[1])})},p=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=s(n.attr("js-c")),n.css("border-color",e[1])})},y=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=s(n.attr("js-c")),n.css("border-color",e[0]),n.css("background-color",e[1])})},g=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=s(n.attr("js-c")),n.css("border-color",e[0])})},k=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=s(n.attr("js-c")),n.css("border-left-color",e[0])})},w=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=s(n.attr("js-c")),n.css("border-color",e[1]),n.css("border-left-color",e[0])}),t.find(".seco-hd[js-c], .form-hd[js-c]").each(function(t){var e,n;return n=$(this),e=s(n.attr("js-c")),n.css("background-color",e[1])}),t.find(".rest-toolbar[js-c]").each(function(t){var e,n;return n=$(this),e=s(n.attr("js-c")),n.css("background-color",e[1])}),t.find(".e-ac-btn[js-c]").each(function(t){var e,n;return n=$(this),e=s(n.attr("js-c")),n.css("border-color",e[0]),n.css("background-color",e[0])})},m=function(t){var e,n,i;return e=function(){var t,e;t=a(),e=[];for(i in t)n=t[i],e.push({color:i});return e}(),"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(){var t,e;return e=$(this),(i=e.attr("js-c"))&&(t=C(i),e.css("border-color",t[0]),e.hasClass("data-title"))?e.css("background-color",t[1]):void 0})},v=function(t){var e,n,i;return e=function(){var t,e;t=a(),e=[];for(i in t)n=t[i],e.push({color:i});return e}(),"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(){var t,e;return e=$(this),(i=e.attr("js-c"))&&!e.hasClass("template")?(t=C(i),e.css("border-color",t[0]),e.css("background-color",t[1])):void 0})}}(),SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(t){return t.getScreenCTM().inverse().multiply(this.getScreenCTM())},u=null,c=null,f=null,h=null,d=null,l=528,s=450,function(t){return function(){var t,e,n,i,o,p,g,m,v,y;return e=null,o=null,i=null,n=null,t=function(t){return t&&t.required,1},y=function(){var t;return t=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},{x:t(30,l-130),y:t(30,s-130)}},v=function(t,n,i,r){var o,a,s,l,u,c;return l=n,r&&(l="\uf007 "+n),i||(i=y()),c=C(t),o=c[0],a=c[1],u={size:{width:88,height:36},position:i,attrs:{text:{text:l,label:n},".outer":{stroke:o,fill:a,rel:t}}},s=new joint.shapes.erd.Entity(u),e.addCell(s),s},m=function(n,i,r,o,a,s){var l,u,c,h;return c={source:{id:n.id},target:{id:i.id},attrs:{".connection":{"stroke-width":t(o),rel:"as-"+s},".labels":{rel:"as-"+s}}},l=[],o.multiple&&(h="n",l.push({position:-18,attrs:{text:{dy:0,text:h}}})),o.required?(h="*",l.push({position:12,attrs:{text:{dy:0,text:h}}})):o.required||(h="0..1"),l.length&&(c.labels=l),u=new joint.shapes.erd.Line(c),a&&(u.set("vertices",a),u.set({smooth:!1})),e.addCell(u),u},g=function(){return o=f()},c=function(t,e,n,r){var o;return null==r&&(r=!0),o=e.label,i[t]=v(t,o,n,e.acts_as_user),d(t),r&&g()},p=function(t,e,r,o){var a,s,l,u;return null==o&&(o=!0),l=[t.psn,t.csn],u=l[0],a=l[1],s=[u,a].join("-"),i[u]&&i[a]?(n[s]={cell:m(i[u],i[a],{label:null},t,r,e),as:t},o&&g()):void 0},f=function(){var t,n,r,o,a,s,l,u,c,h,d,f;if(e){for(l={},f={},u=e.attributes.cells.models,n=0,o=u.length;o>n;n++)switch(a=u[n],a.attributes.type){case"erd.Entity":r=a.attributes.attrs.text.label,h=ddd_find_sn_by_label(r),l[h]=a.attributes.position;break;case"erd.Line":d=_.find(i,function(t){return t.attributes.id===a.attributes.source.id}).attributes.attrs.text.text,t=_.find(i,function(t){return t.attributes.id===a.attributes.target.id}).attributes.attrs.text.text,r=null!=(c=a.attributes.labels)?c[0].attrs.text.text:void 0,s=[d,t,r].join("-"),f[s]=a.get("vertices")}return{nodes:l,vertices:f}}},u=function(t){var u,h,d,f,m,v,y,x,b,_,w,k,C,j,E;i={},n={},$("#paper").empty(),e=new joint.dia.Graph,m=new joint.dia.Paper({
el:$("#paper"),width:l,height:s,gridSize:1,model:e}),C=new Date,y=a();for(k in y)d=y[k],v=null!=(x=o||t)?x.nodes[k]:void 0,c(k,d,v,!1);b=r();for(h in b)u=b[h],f=[u.psn,u.csn].join("-"),E=null!=(_=o||t)&&null!=(w=_.vertices)?w[f]:void 0,p(u,h,E,!1);return e.on("change",function(t){return g()}),j=new Date},h=function(){var t,n,i,r,o;return r=joint.layout.DirectedGraph.layout(e,{setLinkVertices:!1}),o=r.width,i=r.height,t=(l-o)/2,n=(s-i)/2,_.each(e.getElements(),function(e){return e.translate(t,n)}),{width:o,height:i}},d=function(t){var e,n,i,r,o,a,s,l;for(a=$("#paper g.link"),a.find(".connection").css({"stroke-width":1,stroke:"#eee"}),a.find(".labels text").css({fill:"#ccc"}),s=ddd_find_related(t),r=0,o=s.length;o>r;r++)e=s[r],i=e._cn,l=e.required?3:1,n=e.required?"#333":"#111",a.find(".connection[rel='as-"+i+"']").css({"stroke-width":l,stroke:n}),a.find(".labels[rel='as-"+i+"'] text").css({fill:n});return $("#paper g.Entity .outer").each(function(e){var n,i;return n=$(this),i=n.attr("rel")===t?3:2,n.css({"stroke-width":i})})},$(document).on("click","#paper g.Entity .outer",function(){var t;return t=$(this).attr("rel"),j(t),d(t),!1}),$(document).on("click","#paper",function(){var t;return t=$("#paper g.link"),t.find(".connection").css({"stroke-width":1,stroke:"#111"}),t.find(".labels text").css({fill:"#111"})})}}(this)(),this.setlang=function(t){var e,n,i,r,o;return o=window.location,r=[o.protocol,o.host,o.pathname],i=r[0],e=r[1],n=r[2],n=n.match(/^\/(de|zh)($|\/)/)?n.replace(/^\/(de|zh)/,"/"+t):"/"+t+n,n=n.replace(/^\/en($|\/)/,"/").replace(/\/$/,""),window.location=i+"//"+e+n},this.setlangs=function(){var t,e;return t=$("html").attr("lang"),e=(navigator.language||navigator.userLanguage||"").slice(0,2),"zh"!==e&&"de"!==e&&(e="en"),"en"===e&&(e=location.pathname.slice(0,4).replace(/\//g,""),"zh"!==e&&"de"!==e&&(e="en")),Cookies.get("locale")||e===t||(t=e,setlang(t)),Cookies.set("locale",t,{expires:90}),T(t,e)},T=function(t,e){var n,i,r,o,a,s;for(o=["en","de"],"zh"===e&&o.push(e),r={en:"English",de:"Deutsch",zh:"\u4e2d\u6587(\u7b80\u4f53)"},s="",n=0,a=o.length;a>n;n++)i=o[n],s+="<li><a href='#' onclick=\"setlang('"+i+"');return false;\" style='padding:5px 10px'>"+r[i]+"</a></li>";return $("#footer .lang-sel").html("<div class='dropup' style='display:inline'><button type='button' data-toggle='dropdown' style='cursor:pointer'>"+r[t]+"</button><ul class='dropdown-menu' style='min-width:110px'>"+s+"</ul></div>")},$(function(){var t;return $("a.desktop-only").click(function(){var t;return t=$(this),device.desktop()?!0:t.hasClass("tablet-ok")&&device.tablet()?!0:(alert(I18n.t("js.hint.link_desktop_only")),!1)}),$(".qrcode").each(function(){var t,e,n;return t=$(this).empty(),e=~~t.attr("qrc-size"),n=t.attr("qrc-url"),t.qrcode({size:e,text:n})}),b($("body")),t=device.windows()?2:device.android()?1:0,$("#info-web-install .nav-tabs li").removeClass("active").eq(t).addClass("active"),$("#info-web-install .tab-content .tab-pane").removeClass("active").eq(t).addClass("active"),$("form#signup-form").submit(function(){var t;try{(t=localStorage.getItem("growSumoPartnerKey"))&&$(this).find("input[name=dpid]").val(t)}catch(e){}return!0}),guideInit()}),E=function(t){var e,n;try{return n=t.split(".")[1],e=JSON.parse(Base64.decode(n)),e._data}catch(i){return{}}},(t=$("#is_demo").text())&&(A=E(t),e=A[0],n=A[1],i=A[2],a=function(){return n},o=function(t){return a()[t]},r=function(){return i},f=function(){return null},d=function(){return null},j=function(){return null},l=~~$("#paper").css("width").replace("px","")||400),$(function(){var n,i,r,o,a,s,c,h,d,f,p,g,m;if(t){c=[999,0],a=c[0],o=c[1],h=e.nodes;for(p in h)s=h[p],a=Math.min(a,s.x),o=Math.max(o,s.x);a=a,o+=72,n=(l-(o-a))/2,d=e.nodes;for(p in d)s=d[p],s.x=s.x-a+n;u(e)}return t&&(i=$(".dt-phone .iframe"),i.length&&i.is(":visible"))?(g=i.attr("data-url"),f={w:"288px",h:"512px"},m=f.w,r=f.h,$("<iframe src='"+g+"' width='"+m+"' height='"+r+"' scrolling='yes' frameborder='0'/>").append("<p>Your browser does not support iframes</p>").appendTo(i)):void 0})}.call(this);