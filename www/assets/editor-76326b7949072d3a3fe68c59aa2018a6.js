if(function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.Handlebars=e():t.Handlebars=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){(function(r){"use strict";function i(){var t=m();return t.compile=function(e,n){return h.compile(e,n,t)},t.precompile=function(e,n){return h.precompile(e,n,t)},t.AST=l["default"],t.Compiler=h.Compiler,t.JavaScriptCompiler=d["default"],t.Parser=c.parser,t.parse=c.parse,t}var o=n(7)["default"];e.__esModule=!0;var a=n(1),s=o(a),u=n(2),l=o(u),c=n(3),h=n(4),f=n(5),d=o(f),p=n(6),g=o(p),m=s["default"].create,v=i();v.create=i,v.Visitor=g["default"];var y=r.Handlebars;v.noConflict=function(){r.Handlebars===v&&(r.Handlebars=y)},v["default"]=v,e["default"]=v,t.exports=e["default"]}).call(e,function(){return this}())},function(t,e,n){(function(r){"use strict";function i(){var t=new s.HandlebarsEnvironment;return d.extend(t,s),t.SafeString=l["default"],t.Exception=h["default"],t.Utils=d,t.escapeExpression=d.escapeExpression,t.VM=g,t.template=function(e){return g.template(e,t)},t}var o=n(7)["default"];e.__esModule=!0;var a=n(8),s=o(a),u=n(9),l=o(u),c=n(10),h=o(c),f=n(11),d=o(f),p=n(12),g=o(p),m=i();m.create=i;var v="undefined"!=typeof r?r:window,y=v.Handlebars;m.noConflict=function(){v.Handlebars===m&&(v.Handlebars=y)},m["default"]=m,e["default"]=m,t.exports=e["default"]}).call(e,function(){return this}())},function(t,e,n){"use strict";e.__esModule=!0;var r={Program:function(t,e,n,r){this.loc=r,this.type="Program",this.body=t,this.blockParams=e,this.strip=n},MustacheStatement:function(t,e,n,r,i,o){this.loc=o,this.type="MustacheStatement",this.path=t,this.params=e||[],this.hash=n,this.escaped=r,this.strip=i},BlockStatement:function(t,e,n,r,i,o,a,s,u){this.loc=u,this.type="BlockStatement",this.path=t,this.params=e||[],this.hash=n,this.program=r,this.inverse=i,this.openStrip=o,this.inverseStrip=a,this.closeStrip=s},PartialStatement:function(t,e,n,r,i){this.loc=i,this.type="PartialStatement",this.name=t,this.params=e||[],this.hash=n,this.indent="",this.strip=r},ContentStatement:function(t,e){this.loc=e,this.type="ContentStatement",this.original=this.value=t},CommentStatement:function(t,e,n){this.loc=n,this.type="CommentStatement",this.value=t,this.strip=e},SubExpression:function(t,e,n,r){this.loc=r,this.type="SubExpression",this.path=t,this.params=e||[],this.hash=n},PathExpression:function(t,e,n,r,i){this.loc=i,this.type="PathExpression",this.data=t,this.original=r,this.parts=n,this.depth=e},StringLiteral:function(t,e){this.loc=e,this.type="StringLiteral",this.original=this.value=t},NumberLiteral:function(t,e){this.loc=e,this.type="NumberLiteral",this.original=this.value=Number(t)},BooleanLiteral:function(t,e){this.loc=e,this.type="BooleanLiteral",this.original=this.value="true"===t},UndefinedLiteral:function(t){this.loc=t,this.type="UndefinedLiteral",this.original=this.value=void 0},NullLiteral:function(t){this.loc=t,this.type="NullLiteral",this.original=this.value=null},Hash:function(t,e){this.loc=e,this.type="Hash",this.pairs=t},HashPair:function(t,e,n){this.loc=n,this.type="HashPair",this.key=t,this.value=e},helpers:{helperExpression:function(t){return!("SubExpression"!==t.type&&!t.params.length&&!t.hash)},scopedId:function(t){return/^\.|this\b/.test(t.original)},simpleId:function(t){return 1===t.parts.length&&!r.helpers.scopedId(t)&&!t.depth}}};e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";function r(t,e){if("Program"===t.type)return t;a["default"].yy=p,p.locInfo=function(t){return new p.SourceLocation(e&&e.srcName,t)};var n=new c["default"];return n.accept(a["default"].parse(t))}var i=n(7)["default"];e.__esModule=!0,e.parse=r;var o=n(13),a=i(o),s=n(2),u=i(s),l=n(14),c=i(l),h=n(15),f=i(h),d=n(11);e.parser=a["default"];var p={};d.extend(p,f,u["default"])},function(t,e,n){"use strict";function r(){}function i(t,e,n){if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new c["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var r=n.parse(t,e),i=(new n.Compiler).compile(r,e);return(new n.JavaScriptCompiler).compile(i,e)}function o(t,e,n){function r(){var e=n.parse(t,o),r=(new n.Compiler).compile(e,o),i=(new n.JavaScriptCompiler).compile(r,o,void 0,!0);return n.template(i)}function i(t,e){return a||(a=r()),a.call(this,t,e)}var o=void 0===arguments[1]?{}:arguments[1];if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new c["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);"data"in o||(o.data=!0),o.compat&&(o.useDepths=!0);var a=void 0;return i._setup=function(t){return a||(a=r()),a._setup(t)},i._child=function(t,e,n,i){return a||(a=r()),a._child(t,e,n,i)},i}function a(t,e){if(t===e)return!0;if(h.isArray(t)&&h.isArray(e)&&t.length===e.length){for(var n=0;n<t.length;n++)if(!a(t[n],e[n]))return!1;return!0}}function s(t){if(!t.path.parts){var e=t.path;t.path=new d["default"].PathExpression(!1,0,[e.original+""],e.original+"",e.loc)}}var u=n(7)["default"];e.__esModule=!0,e.Compiler=r,e.precompile=i,e.compile=o;var l=n(10),c=u(l),h=n(11),f=n(2),d=u(f),p=[].slice;r.prototype={compiler:r,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var n=0;e>n;n++){var r=this.opcodes[n],i=t.opcodes[n];if(r.opcode!==i.opcode||!a(r.args,i.args))return!1}e=this.children.length;for(var n=0;e>n;n++)if(!this.children[n].equals(t.children[n]))return!1;return!0},guid:0,compile:function(t,e){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds,e.blockParams=e.blockParams||[];var n=e.knownHelpers;if(e.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},n)for(var r in n)r in n&&(e.knownHelpers[r]=n[r]);return this.accept(t)},compileProgram:function(t){var e=new this.compiler,n=e.compile(t,this.options),r=this.guid++;return this.usePartial=this.usePartial||n.usePartial,this.children[r]=n,this.useDepths=this.useDepths||n.useDepths,r},accept:function(t){this.sourceNode.unshift(t);var e=this[t.type](t);return this.sourceNode.shift(),e},Program:function(t){this.options.blockParams.unshift(t.blockParams);for(var e=t.body,n=e.length,r=0;n>r;r++)this.accept(e[r]);return this.options.blockParams.shift(),this.isSimple=1===n,this.blockParams=t.blockParams?t.blockParams.length:0,this},BlockStatement:function(t){s(t);var e=t.program,n=t.inverse;e=e&&this.compileProgram(e),n=n&&this.compileProgram(n);var r=this.classifySexpr(t);"helper"===r?this.helperSexpr(t,e,n):"simple"===r?(this.simpleSexpr(t),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue",t.path.original)):(this.ambiguousSexpr(t,e,n),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},PartialStatement:function(t){this.usePartial=!0;var e=t.params;if(e.length>1)throw new c["default"]("Unsupported number of partial arguments: "+e.length,t);e.length||e.push({type:"PathExpression",parts:[],depth:0});var n=t.name.original,r="SubExpression"===t.name.type;r&&this.accept(t.name),this.setupFullMustacheParams(t,void 0,void 0,!0);var i=t.indent||"";this.options.preventIndent&&i&&(this.opcode("appendContent",i),i=""),this.opcode("invokePartial",r,n,i),this.opcode("append")},MustacheStatement:function(t){this.SubExpression(t),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ContentStatement:function(t){t.value&&this.opcode("appendContent",t.value)},CommentStatement:function(){},SubExpression:function(t){s(t);var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ambiguousSexpr:function(t,e,n){var r=t.path,i=r.parts[0],o=null!=e||null!=n;this.opcode("getContext",r.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.accept(r),this.opcode("invokeAmbiguous",i,o)},simpleSexpr:function(t){this.accept(t.path),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,n){var r=this.setupFullMustacheParams(t,e,n),i=t.path,o=i.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",r.length,o);else{if(this.options.knownHelpersOnly)throw new c["default"]("You specified knownHelpersOnly, but used the unknown helper "+o,t);i.falsy=!0,this.accept(i),this.opcode("invokeHelper",r.length,i.original,d["default"].helpers.simpleId(i))}},PathExpression:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0],n=d["default"].helpers.scopedId(t),r=!t.depth&&!n&&this.blockParamIndex(e);r?this.opcode("lookupBlockParam",r,t.parts):e?t.data?(this.options.data=!0,this.opcode("lookupData",t.depth,t.parts)):this.opcode("lookupOnContext",t.parts,t.falsy,n):this.opcode("pushContext")},StringLiteral:function(t){this.opcode("pushString",t.value)},NumberLiteral:function(t){this.opcode("pushLiteral",t.value)},BooleanLiteral:function(t){this.opcode("pushLiteral",t.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(t){var e=t.pairs,n=0,r=e.length;for(this.opcode("pushHash");r>n;n++)this.pushParam(e[n].value);for(;n--;)this.opcode("assignToHash",e[n].key);this.opcode("popHash")},opcode:function(t){this.opcodes.push({opcode:t,args:p.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(t){t&&(this.useDepths=!0)},classifySexpr:function(t){var e=d["default"].helpers.simpleId(t.path),n=e&&!!this.blockParamIndex(t.path.parts[0]),r=!n&&d["default"].helpers.helperExpression(t),i=!n&&(r||e);if(i&&!r){var o=t.path.parts[0],a=this.options;a.knownHelpers[o]?r=!0:a.knownHelpersOnly&&(i=!1)}return r?"helper":i?"ambiguous":"simple"},pushParams:function(t){for(var e=0,n=t.length;n>e;e++)this.pushParam(t[e])},pushParam:function(t){var e=null!=t.value?t.value:t.original||"";if(this.stringParams)e.replace&&(e=e.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",e,t.type),"SubExpression"===t.type&&this.accept(t);else{if(this.trackIds){var n=void 0;if(!t.parts||d["default"].helpers.scopedId(t)||t.depth||(n=this.blockParamIndex(t.parts[0])),n){var r=t.parts.slice(1).join(".");this.opcode("pushId","BlockParam",n,r)}else e=t.original||e,e.replace&&(e=e.replace(/^\.\//g,"").replace(/^\.$/g,"")),this.opcode("pushId",t.type,e)}this.accept(t)}},setupFullMustacheParams:function(t,e,n,r){var i=t.params;return this.pushParams(i),this.opcode("pushProgram",e),this.opcode("pushProgram",n),t.hash?this.accept(t.hash):this.opcode("emptyHash",r),i},blockParamIndex:function(t){for(var e=0,n=this.options.blockParams.length;n>e;e++){var r=this.options.blockParams[e],i=r&&h.indexOf(r,t);if(r&&i>=0)return[e,i]}}}},function(t,e,n){"use strict";function r(t){this.value=t}function i(){}function o(t,e,n,r){var i=e.popStack(),o=0,a=n.length;for(t&&a--;a>o;o++)i=e.nameLookup(i,n[o],r);return t?[e.aliasable("this.strict"),"(",i,", ",e.quotedString(n[o]),")"]:i}var a=n(7)["default"];e.__esModule=!0;var s=n(8),u=n(10),l=a(u),c=n(11),h=n(16),f=a(h);i.prototype={nameLookup:function(t,e){return i.isValidJavaScriptVariableName(e)?[t,".",e]:[t,"['",e,"']"]},depthedLookup:function(t){return[this.aliasable("this.lookup"),'(depths, "',t,'")']},compilerInfo:function(){var t=s.COMPILER_REVISION,e=s.REVISION_CHANGES[t];return[t,e]},appendToBuffer:function(t,e,n){return c.isArray(t)||(t=[t]),t=this.source.wrap(t,e),this.environment.isSimple?["return ",t,";"]:n?["buffer += ",t,";"]:(t.appendToBuffer=!0,t)},initializeBuffer:function(){return this.quotedString("")},compile:function(t,e,n,r){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!r,this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.useDepths||this.options.compat,this.useBlockParams=this.useBlockParams||t.useBlockParams;var i=t.opcodes,o=void 0,a=void 0,s=void 0,u=void 0;for(s=0,u=i.length;u>s;s++)o=i[s],this.source.currentLocation=o.loc,a=a||o.loc,this[o.opcode].apply(this,o.args);if(this.source.currentLocation=a,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new l["default"]("Compile completed with content left on stack");var c=this.createFunctionContext(r);if(this.isChild)return c;var h={compiler:this.compilerInfo(),main:c},f=this.context.programs;for(s=0,u=f.length;u>s;s++)f[s]&&(h[s]=f[s]);return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),r?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),e.srcName?(h=h.toStringWithSourceMap({file:e.destName}),h.map=h.map&&h.map.toString()):h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new f["default"](this.options.srcName)},createFunctionContext:function(t){var e="",n=this.stackVars.concat(this.registers.list);n.length>0&&(e+=", "+n.join(", "));var r=0;for(var i in this.aliases){var o=this.aliases[i];this.aliases.hasOwnProperty(i)&&o.children&&o.referenceCount>1&&(e+=", alias"+ ++r+"="+i,o.children[0]="alias"+r)}var a=["depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&a.push("blockParams"),this.useDepths&&a.push("depths");var s=this.mergeSource(e);return t?(a.push(s),Function.apply(this,a)):this.source.wrap(["function(",a.join(","),") {\n  ",s,"}"])},mergeSource:function(t){var e=this.environment.isSimple,n=!this.forceBuffer,r=void 0,i=void 0,o=void 0,a=void 0;return this.source.each(function(t){t.appendToBuffer?(o?t.prepend("  + "):o=t,a=t):(o&&(i?o.prepend("buffer += "):r=!0,a.add(";"),o=a=void 0),i=!0,e||(n=!1))}),n?o?(o.prepend("return "),a.add(";")):i||this.source.push('return "";'):(t+=", buffer = "+(r?"":this.initializeBuffer()),o?(o.prepend("return buffer + "),a.add(";")):this.source.push("return buffer;")),t&&this.source.prepend("var "+t.substring(2)+(r?"":";\n")),this.source.merge()},blockValue:function(t){var e=this.aliasable("helpers.blockHelperMissing"),n=[this.contextName(0)];this.setupHelperArgs(t,0,n);var r=this.popStack();n.splice(1,0,r),this.push(this.source.functionCall(e,"call",n))},ambiguousBlockValue:function(){var t=this.aliasable("helpers.blockHelperMissing"),e=[this.contextName(0)];this.setupHelperArgs("",0,e,!0),this.flushInline();var n=this.topStack();e.splice(1,0,n),this.pushSource(["if (!",this.lastHelper,") { ",n," = ",this.source.functionCall(t,"call",e),"}"])},appendContent:function(t){this.pendingContent?t=this.pendingContent+t:this.pendingLocation=this.source.currentLocation,this.pendingContent=t},append:function(){if(this.isInline())this.replaceStack(function(t){return[" != null ? ",t,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var t=this.popStack();this.pushSource(["if (",t," != null) { ",this.appendToBuffer(t,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("this.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,n){var r=0;n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[r++])),this.resolvePath("context",t,r,e)},lookupBlockParam:function(t,e){this.useBlockParams=!0,this.push(["blockParams[",t[0],"][",t[1],"]"]),this.resolvePath("context",e,1)},lookupData:function(t,e){t?this.pushStackLiteral("this.data(data, "+t+")"):this.pushStackLiteral("data"),this.resolvePath("data",e,0,!0)},resolvePath:function(t,e,n,r){var i=this;if(this.options.strict||this.options.assumeObjects)return void this.push(o(this.options.strict,this,e,t));for(var a=e.length;a>n;n++)this.replaceStack(function(o){var a=i.nameLookup(o,e[n],t);return r?[" && ",a]:[" != null ? ",a," : ",o]})},resolvePossibleLambda:function(){this.push([this.aliasable("this.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"SubExpression"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(t){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(t?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(t.ids)),this.stringParams&&(this.push(this.objectLiteral(t.contexts)),this.push(this.objectLiteral(t.types))),this.push(this.objectLiteral(t.values))},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},invokeHelper:function(t,e,n){var r=this.popStack(),i=this.setupHelper(t,e),o=n?[i.name," || "]:"",a=["("].concat(o,r);this.options.strict||a.push(" || ",this.aliasable("helpers.helperMissing")),a.push(")"),this.push(this.source.functionCall(a,"call",i.callParams))},invokeKnownHelper:function(t,e){var n=this.setupHelper(t,e);this.push(this.source.functionCall(n.name,"call",n.callParams))},invokeAmbiguous:function(t,e){this.useRegister("helper");var n=this.popStack();this.emptyHash();var r=this.setupHelper(0,t,e),i=this.lastHelper=this.nameLookup("helpers",t,"helper"),o=["(","(helper = ",i," || ",n,")"];this.options.strict||(o[0]="(helper = ",o.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",o,r.paramsInit?["),(",r.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",r.callParams)," : helper))"])},invokePartial:function(t,e,n){var r=[],i=this.setupParams(e,1,r,!1);t&&(e=this.popStack(),delete i.name),n&&(i.indent=JSON.stringify(n)),i.helpers="helpers",i.partials="partials",t?r.unshift(e):r.unshift(this.nameLookup("partials",e,"partial")),this.options.compat&&(i.depths="depths"),i=this.objectLiteral(i),r.push(i),this.push(this.source.functionCall("this.invokePartial","",r))},assignToHash:function(t){var e=this.popStack(),n=void 0,r=void 0,i=void 0;this.trackIds&&(i=this.popStack()),this.stringParams&&(r=this.popStack(),n=this.popStack());var o=this.hash;n&&(o.contexts[t]=n),r&&(o.types[t]=r),i&&(o.ids[t]=i),o.values[t]=e},pushId:function(t,e,n){"BlockParam"===t?this.pushStackLiteral("blockParams["+e[0]+"].path["+e[1]+"]"+(n?" + "+JSON.stringify("."+n):"")):"PathExpression"===t?this.pushString(e):"SubExpression"===t?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:i,compileChildren:function(t,e){for(var n=t.children,r=void 0,i=void 0,o=0,a=n.length;a>o;o++){r=n[o],i=new this.compiler;var s=this.matchExistingProgram(r);null==s?(this.context.programs.push(""),s=this.context.programs.length,r.index=s,r.name="program"+s,this.context.programs[s]=i.compile(r,e,this.context,!this.precompile),this.context.environments[s]=r,this.useDepths=this.useDepths||i.useDepths,this.useBlockParams=this.useBlockParams||i.useBlockParams):(r.index=s,r.name="program"+s,this.useDepths=this.useDepths||r.useDepths,this.useBlockParams=this.useBlockParams||r.useBlockParams)}},matchExistingProgram:function(t){for(var e=0,n=this.context.environments.length;n>e;e++){var r=this.context.environments[e];if(r&&r.equals(t))return e}},programExpression:function(t){var e=this.environment.children[t],n=[e.index,"data",e.blockParams];return(this.useBlockParams||this.useDepths)&&n.push("blockParams"),this.useDepths&&n.push("depths"),"this.program("+n.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},push:function(t){return t instanceof r||(t=this.source.wrap(t)),this.inlineStack.push(t),t},pushStackLiteral:function(t){this.push(new r(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),t&&this.source.push(t)},replaceStack:function(t){var e=["("],n=void 0,i=void 0,o=void 0;if(!this.isInline())throw new l["default"]("replaceStack on non-inline");var a=this.popStack(!0);if(a instanceof r)n=[a.value],e=["(",n],o=!0;else{i=!0;var s=this.incrStack();e=["((",this.push(s)," = ",a,")"],n=this.topStack()}var u=t.call(this,n);o||this.popStack(),i&&this.stackSlot--,this.push(e.concat(u,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;this.inlineStack=[];for(var e=0,n=t.length;n>e;e++){var i=t[e];if(i instanceof r)this.compileStack.push(i);else{var o=this.incrStack();this.pushSource([o," = ",i,";"]),this.compileStack.push(o)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),n=(e?this.inlineStack:this.compileStack).pop();if(!t&&n instanceof r)return n.value;if(!e){if(!this.stackSlot)throw new l["default"]("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,e=t[t.length-1];return e instanceof r?e.value:e},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return this.source.quotedString(t)},objectLiteral:function(t){return this.source.objectLiteral(t)},aliasable:function(t){var e=this.aliases[t];return e?(e.referenceCount++,e):(e=this.aliases[t]=this.source.wrap(t),e.aliasable=!0,e.referenceCount=1,e)},setupHelper:function(t,e,n){var r=[],i=this.setupHelperArgs(e,t,r,n),o=this.nameLookup("helpers",e,"helper");return{params:r,paramsInit:i,name:o,callParams:[this.contextName(0)].concat(r)}},setupParams:function(t,e,n){var r={},i=[],o=[],a=[],s=void 0;r.name=this.quotedString(t),r.hash=this.popStack(),this.trackIds&&(r.hashIds=this.popStack()),this.stringParams&&(r.hashTypes=this.popStack(),r.hashContexts=this.popStack());var u=this.popStack(),l=this.popStack();(l||u)&&(r.fn=l||"this.noop",r.inverse=u||"this.noop");for(var c=e;c--;)s=this.popStack(),n[c]=s,this.trackIds&&(a[c]=this.popStack()),this.stringParams&&(o[c]=this.popStack(),i[c]=this.popStack());return this.trackIds&&(r.ids=this.source.generateArray(a)),this.stringParams&&(r.types=this.source.generateArray(o),r.contexts=this.source.generateArray(i)),this.options.data&&(r.data="data"),this.useBlockParams&&(r.blockParams="blockParams"),r},setupHelperArgs:function(t,e,n,r){var i=this.setupParams(t,e,n,!0);return i=this.objectLiteral(i),r?(this.useRegister("options"),n.push("options"),["options=",i]):(n.push(i),"")}},function(){for(var t="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=i.RESERVED_WORDS={},n=0,r=t.length;r>n;n++)e[t[n]]=!0}(),i.isValidJavaScriptVariableName=function(t){return!i.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},e["default"]=i,t.exports=e["default"]},function(t,e,n){"use strict";function r(){this.parents=[]}var i=n(7)["default"];e.__esModule=!0;var o=n(10),a=i(o),s=n(2),u=i(s);r.prototype={constructor:r,mutating:!1,acceptKey:function(t,e){var n=this.accept(t[e]);if(this.mutating){if(n&&(!n.type||!u["default"][n.type]))throw new a["default"]('Unexpected node type "'+n.type+'" found when accepting '+e+" on "+t.type);t[e]=n}},acceptRequired:function(t,e){if(this.acceptKey(t,e),!t[e])throw new a["default"](t.type+" requires "+e)},acceptArray:function(t){for(var e=0,n=t.length;n>e;e++)this.acceptKey(t,e),t[e]||(t.splice(e,1),e--,n--)},accept:function(t){if(t){this.current&&this.parents.unshift(this.current),this.current=t;var e=this[t.type](t);return this.current=this.parents.shift(),!this.mutating||e?e:e!==!1?t:void 0}},Program:function(t){this.acceptArray(t.body)},MustacheStatement:function(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")},BlockStatement:function(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash"),this.acceptKey(t,"program"),this.acceptKey(t,"inverse")},PartialStatement:function(t){this.acceptRequired(t,"name"),this.acceptArray(t.params),this.acceptKey(t,"hash")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:function(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")},PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(t){this.acceptArray(t.pairs)},HashPair:function(t){this.acceptRequired(t,"value")}},e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";e["default"]=function(t){return t&&t.__esModule?t:{"default":t}},e.__esModule=!0},function(t,e,n){"use strict";function r(t,e){this.helpers=t||{},this.partials=e||{},i(this)}function i(t){t.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new c["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),t.registerHelper("blockHelperMissing",function(e,n){var r=n.inverse,i=n.fn;if(e===!0)return i(this);if(e===!1||null==e)return r(this);if(p(e))return e.length>0?(n.ids&&(n.ids=[n.name]),t.helpers.each(e,n)):r(this);if(n.data&&n.ids){var a=o(n.data);a.contextPath=u.appendContextPath(n.data.contextPath,n.name),n={data:a}}return i(e,n)}),t.registerHelper("each",function(t,e){function n(e,n,i){l&&(l.key=e,l.index=n,l.first=0===n,l.last=!!i,h&&(l.contextPath=h+e)),s+=r(t[e],{data:l,blockParams:u.blockParams([t[e],e],[h+e,null])})}if(!e)throw new c["default"]("Must pass iterator to #each");var r=e.fn,i=e.inverse,a=0,s="",l=void 0,h=void 0;if(e.data&&e.ids&&(h=u.appendContextPath(e.data.contextPath,e.ids[0])+"."),g(t)&&(t=t.call(this)),e.data&&(l=o(e.data)),t&&"object"==typeof t)if(p(t))for(var f=t.length;f>a;a++)n(a,a,a===t.length-1);else{var d=void 0;for(var m in t)t.hasOwnProperty(m)&&(d&&n(d,a-1),d=m,a++);d&&n(d,a-1,!0)}return 0===a&&(s=i(this)),s}),t.registerHelper("if",function(t,e){return g(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||u.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers["if"].call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),t.registerHelper("with",function(t,e){g(t)&&(t=t.call(this));var n=e.fn;if(u.isEmpty(t))return e.inverse(this);if(e.data&&e.ids){var r=o(e.data);r.contextPath=u.appendContextPath(e.data.contextPath,e.ids[0]),e={data:r}}return n(t,e)}),t.registerHelper("log",function(e,n){var r=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;t.log(r,e)}),t.registerHelper("lookup",function(t,e){return t&&t[e]})}function o(t){var e=u.extend({},t);return e._parent=t,e}var a=n(7)["default"];e.__esModule=!0,e.HandlebarsEnvironment=r,e.createFrame=o;var s=n(11),u=a(s),l=n(10),c=a(l),h="3.0.1";e.VERSION=h;var f=6;e.COMPILER_REVISION=f;var d={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};e.REVISION_CHANGES=d;var p=u.isArray,g=u.isFunction,m=u.toString,v="[object Object]";r.prototype={constructor:r,logger:y,log:b,registerHelper:function(t,e){if(m.call(t)===v){if(e)throw new c["default"]("Arg not supported with multiple helpers");u.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(m.call(t)===v)u.extend(this.partials,t);else{if("undefined"==typeof e)throw new c["default"]("Attempting to register a partial as undefined");this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]}};var y={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(t,e){if("undefined"!=typeof console&&y.level<=t){var n=y.methodMap[t];(console[n]||console.log).call(console,e)}}};e.logger=y;var b=y.log;e.log=b},function(t,e,n){"use strict";function r(t){this.string=t}e.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";function r(t,e){var n=e&&e.loc,o=void 0,a=void 0;n&&(o=n.start.line,a=n.start.column,t+=" - "+o+":"+a);for(var s=Error.prototype.constructor.call(this,t),u=0;u<i.length;u++)this[i[u]]=s[i[u]];Error.captureStackTrace&&Error.captureStackTrace(this,r),n&&(this.lineNumber=o,this.column=a)}e.__esModule=!0;var i=["description","fileName","lineNumber","message","name","number","stack"];r.prototype=new Error,e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return c[t]}function i(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&(t[n]=arguments[e][n]);return t}function o(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}function a(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return f.test(t)?t.replace(h,r):t}function s(t){return t||0===t?g(t)&&0===t.length?!0:!1:!0}function u(t,e){return t.path=e,t}function l(t,e){return(t?t+".":"")+e}e.__esModule=!0,e.extend=i,e.indexOf=o,e.escapeExpression=a,e.isEmpty=s,e.blockParams=u,e.appendContextPath=l;var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},h=/[&<>"'`]/g,f=/[&<>"'`]/,d=Object.prototype.toString;e.toString=d;var p=function(t){return"function"==typeof t};p(/x/)&&(e.isFunction=p=function(t){return"function"==typeof t&&"[object Function]"===d.call(t)});var p;e.isFunction=p;var g=Array.isArray||function(t){return t&&"object"==typeof t?"[object Array]"===d.call(t):!1};e.isArray=g},function(t,e,n){"use strict";function r(t){var e=t&&t[0]||1,n=g.COMPILER_REVISION;if(e!==n){if(n>e){var r=g.REVISION_CHANGES[n],i=g.REVISION_CHANGES[e];throw new p["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new p["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function i(t,e){function n(n,r,i){i.hash&&(r=f.extend({},r,i.hash)),n=e.VM.resolvePartial.call(this,n,r,i);var o=e.VM.invokePartial.call(this,n,r,i);if(null==o&&e.compile&&(i.partials[i.name]=e.compile(n,t.compilerOptions,e),o=i.partials[i.name](r,i)),null!=o){if(i.indent){for(var a=o.split("\n"),s=0,u=a.length;u>s&&(a[s]||s+1!==u);s++)a[s]=i.indent+a[s];o=a.join("\n")}return o}throw new p["default"]("The partial "+i.name+" could not be compiled when running in runtime-only mode")}function r(e){var n=void 0===arguments[1]?{}:arguments[1],o=n.data;r._setup(n),!n.partial&&t.useData&&(o=l(e,o));var a=void 0,s=t.useBlockParams?[]:void 0;return t.useDepths&&(a=n.depths?[e].concat(n.depths):[e]),t.main.call(i,e,i.helpers,i.partials,o,s,a)}if(!e)throw new p["default"]("No environment passed to template");if(!t||!t.main)throw new p["default"]("Unknown template object: "+typeof t);e.VM.checkRevision(t.compiler);var i={strict:function(t,e){if(!(e in t))throw new p["default"]('"'+e+'" not defined in '+t);return t[e]},lookup:function(t,e){for(var n=t.length,r=0;n>r;r++)if(t[r]&&null!=t[r][e])return t[r][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:f.escapeExpression,
invokePartial:n,fn:function(e){return t[e]},programs:[],program:function(t,e,n,r,i){var a=this.programs[t],s=this.fn(t);return e||i||r||n?a=o(this,t,s,e,n,r,i):a||(a=this.programs[t]=o(this,t,s)),a},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n=f.extend({},e,t)),n},noop:e.VM.noop,compilerInfo:t.compiler};return r.isTop=!0,r._setup=function(n){n.partial?(i.helpers=n.helpers,i.partials=n.partials):(i.helpers=i.merge(n.helpers,e.helpers),t.usePartial&&(i.partials=i.merge(n.partials,e.partials)))},r._child=function(e,n,r,a){if(t.useBlockParams&&!r)throw new p["default"]("must pass block params");if(t.useDepths&&!a)throw new p["default"]("must pass parent depths");return o(i,e,t[e],n,0,r,a)},r}function o(t,e,n,r,i,o,a){function s(e){var i=void 0===arguments[1]?{}:arguments[1];return n.call(t,e,t.helpers,t.partials,i.data||r,o&&[i.blockParams].concat(o),a&&[e].concat(a))}return s.program=e,s.depth=a?a.length:0,s.blockParams=i||0,s}function a(t,e,n){return t?t.call||n.name||(n.name=t,t=n.partials[t]):t=n.partials[n.name],t}function s(t,e,n){if(n.partial=!0,void 0===t)throw new p["default"]("The partial "+n.name+" could not be found");return t instanceof Function?t(e,n):void 0}function u(){return""}function l(t,e){return e&&"root"in e||(e=e?g.createFrame(e):{},e.root=t),e}var c=n(7)["default"];e.__esModule=!0,e.checkRevision=r,e.template=i,e.wrapProgram=o,e.resolvePartial=a,e.invokePartial=s,e.noop=u;var h=n(11),f=c(h),d=n(10),p=c(d),g=n(8)},function(t,e,n){"use strict";e.__esModule=!0;var r=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,content:12,COMMENT:13,CONTENT:14,openRawBlock:15,END_RAW_BLOCK:16,OPEN_RAW_BLOCK:17,helperName:18,openRawBlock_repetition0:19,openRawBlock_option0:20,CLOSE_RAW_BLOCK:21,openBlock:22,block_option0:23,closeBlock:24,openInverse:25,block_option1:26,OPEN_BLOCK:27,openBlock_repetition0:28,openBlock_option0:29,openBlock_option1:30,CLOSE:31,OPEN_INVERSE:32,openInverse_repetition0:33,openInverse_option0:34,openInverse_option1:35,openInverseChain:36,OPEN_INVERSE_CHAIN:37,openInverseChain_repetition0:38,openInverseChain_option0:39,openInverseChain_option1:40,inverseAndProgram:41,INVERSE:42,inverseChain:43,inverseChain_option0:44,OPEN_ENDBLOCK:45,OPEN:46,mustache_repetition0:47,mustache_option0:48,OPEN_UNESCAPED:49,mustache_repetition1:50,mustache_option1:51,CLOSE_UNESCAPED:52,OPEN_PARTIAL:53,partialName:54,partial_repetition0:55,partial_option0:56,param:57,sexpr:58,OPEN_SEXPR:59,sexpr_repetition0:60,sexpr_option0:61,CLOSE_SEXPR:62,hash:63,hash_repetition_plus0:64,hashSegment:65,ID:66,EQUALS:67,blockParams:68,OPEN_BLOCK_PARAMS:69,blockParams_repetition_plus0:70,CLOSE_BLOCK_PARAMS:71,path:72,dataName:73,STRING:74,NUMBER:75,BOOLEAN:76,UNDEFINED:77,NULL:78,DATA:79,pathSegments:80,SEP:81,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"COMMENT",14:"CONTENT",16:"END_RAW_BLOCK",17:"OPEN_RAW_BLOCK",21:"CLOSE_RAW_BLOCK",27:"OPEN_BLOCK",31:"CLOSE",32:"OPEN_INVERSE",37:"OPEN_INVERSE_CHAIN",42:"INVERSE",45:"OPEN_ENDBLOCK",46:"OPEN",49:"OPEN_UNESCAPED",52:"CLOSE_UNESCAPED",53:"OPEN_PARTIAL",59:"OPEN_SEXPR",62:"CLOSE_SEXPR",66:"ID",67:"EQUALS",69:"OPEN_BLOCK_PARAMS",71:"CLOSE_BLOCK_PARAMS",74:"STRING",75:"NUMBER",76:"BOOLEAN",77:"UNDEFINED",78:"NULL",79:"DATA",81:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[10,3],[15,5],[9,4],[9,4],[22,6],[25,6],[36,6],[41,2],[43,3],[43,1],[24,3],[8,5],[8,5],[11,5],[57,1],[57,1],[58,5],[63,1],[65,3],[68,3],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[54,1],[54,1],[73,2],[72,1],[80,3],[80,1],[6,0],[6,2],[19,0],[19,2],[20,0],[20,1],[23,0],[23,1],[26,0],[26,1],[28,0],[28,2],[29,0],[29,1],[30,0],[30,1],[33,0],[33,2],[34,0],[34,1],[35,0],[35,1],[38,0],[38,2],[39,0],[39,1],[40,0],[40,1],[44,0],[44,1],[47,0],[47,2],[48,0],[48,1],[50,0],[50,2],[51,0],[51,1],[55,0],[55,2],[56,0],[56,1],[60,0],[60,2],[61,0],[61,1],[64,1],[64,2],[70,1],[70,2]],performAction:function(t,e,n,r,i,o,a){var s=o.length-1;switch(i){case 1:return o[s-1];case 2:this.$=new r.Program(o[s],null,{},r.locInfo(this._$));break;case 3:this.$=o[s];break;case 4:this.$=o[s];break;case 5:this.$=o[s];break;case 6:this.$=o[s];break;case 7:this.$=o[s];break;case 8:this.$=new r.CommentStatement(r.stripComment(o[s]),r.stripFlags(o[s],o[s]),r.locInfo(this._$));break;case 9:this.$=new r.ContentStatement(o[s],r.locInfo(this._$));break;case 10:this.$=r.prepareRawBlock(o[s-2],o[s-1],o[s],this._$);break;case 11:this.$={path:o[s-3],params:o[s-2],hash:o[s-1]};break;case 12:this.$=r.prepareBlock(o[s-3],o[s-2],o[s-1],o[s],!1,this._$);break;case 13:this.$=r.prepareBlock(o[s-3],o[s-2],o[s-1],o[s],!0,this._$);break;case 14:this.$={path:o[s-4],params:o[s-3],hash:o[s-2],blockParams:o[s-1],strip:r.stripFlags(o[s-5],o[s])};break;case 15:this.$={path:o[s-4],params:o[s-3],hash:o[s-2],blockParams:o[s-1],strip:r.stripFlags(o[s-5],o[s])};break;case 16:this.$={path:o[s-4],params:o[s-3],hash:o[s-2],blockParams:o[s-1],strip:r.stripFlags(o[s-5],o[s])};break;case 17:this.$={strip:r.stripFlags(o[s-1],o[s-1]),program:o[s]};break;case 18:var u=r.prepareBlock(o[s-2],o[s-1],o[s],o[s],!1,this._$),l=new r.Program([u],null,{},r.locInfo(this._$));l.chained=!0,this.$={strip:o[s-2].strip,program:l,chain:!0};break;case 19:this.$=o[s];break;case 20:this.$={path:o[s-1],strip:r.stripFlags(o[s-2],o[s])};break;case 21:this.$=r.prepareMustache(o[s-3],o[s-2],o[s-1],o[s-4],r.stripFlags(o[s-4],o[s]),this._$);break;case 22:this.$=r.prepareMustache(o[s-3],o[s-2],o[s-1],o[s-4],r.stripFlags(o[s-4],o[s]),this._$);break;case 23:this.$=new r.PartialStatement(o[s-3],o[s-2],o[s-1],r.stripFlags(o[s-4],o[s]),r.locInfo(this._$));break;case 24:this.$=o[s];break;case 25:this.$=o[s];break;case 26:this.$=new r.SubExpression(o[s-3],o[s-2],o[s-1],r.locInfo(this._$));break;case 27:this.$=new r.Hash(o[s],r.locInfo(this._$));break;case 28:this.$=new r.HashPair(r.id(o[s-2]),o[s],r.locInfo(this._$));break;case 29:this.$=r.id(o[s-1]);break;case 30:this.$=o[s];break;case 31:this.$=o[s];break;case 32:this.$=new r.StringLiteral(o[s],r.locInfo(this._$));break;case 33:this.$=new r.NumberLiteral(o[s],r.locInfo(this._$));break;case 34:this.$=new r.BooleanLiteral(o[s],r.locInfo(this._$));break;case 35:this.$=new r.UndefinedLiteral(r.locInfo(this._$));break;case 36:this.$=new r.NullLiteral(r.locInfo(this._$));break;case 37:this.$=o[s];break;case 38:this.$=o[s];break;case 39:this.$=r.preparePath(!0,o[s],this._$);break;case 40:this.$=r.preparePath(!1,o[s],this._$);break;case 41:o[s-2].push({part:r.id(o[s]),original:o[s],separator:o[s-1]}),this.$=o[s-2];break;case 42:this.$=[{part:r.id(o[s]),original:o[s]}];break;case 43:this.$=[];break;case 44:o[s-1].push(o[s]);break;case 45:this.$=[];break;case 46:o[s-1].push(o[s]);break;case 53:this.$=[];break;case 54:o[s-1].push(o[s]);break;case 59:this.$=[];break;case 60:o[s-1].push(o[s]);break;case 65:this.$=[];break;case 66:o[s-1].push(o[s]);break;case 73:this.$=[];break;case 74:o[s-1].push(o[s]);break;case 77:this.$=[];break;case 78:o[s-1].push(o[s]);break;case 81:this.$=[];break;case 82:o[s-1].push(o[s]);break;case 85:this.$=[];break;case 86:o[s-1].push(o[s]);break;case 89:this.$=[o[s]];break;case 90:o[s-1].push(o[s]);break;case 91:this.$=[o[s]];break;case 92:o[s-1].push(o[s])}},table:[{3:1,4:2,5:[2,43],6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],46:[2,43],49:[2,43],53:[2,43]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:[1,11],14:[1,18],15:16,17:[1,21],22:14,25:15,27:[1,19],32:[1,20],37:[2,2],42:[2,2],45:[2,2],46:[1,12],49:[1,13],53:[1,17]},{1:[2,1]},{5:[2,44],13:[2,44],14:[2,44],17:[2,44],27:[2,44],32:[2,44],37:[2,44],42:[2,44],45:[2,44],46:[2,44],49:[2,44],53:[2,44]},{5:[2,3],13:[2,3],14:[2,3],17:[2,3],27:[2,3],32:[2,3],37:[2,3],42:[2,3],45:[2,3],46:[2,3],49:[2,3],53:[2,3]},{5:[2,4],13:[2,4],14:[2,4],17:[2,4],27:[2,4],32:[2,4],37:[2,4],42:[2,4],45:[2,4],46:[2,4],49:[2,4],53:[2,4]},{5:[2,5],13:[2,5],14:[2,5],17:[2,5],27:[2,5],32:[2,5],37:[2,5],42:[2,5],45:[2,5],46:[2,5],49:[2,5],53:[2,5]},{5:[2,6],13:[2,6],14:[2,6],17:[2,6],27:[2,6],32:[2,6],37:[2,6],42:[2,6],45:[2,6],46:[2,6],49:[2,6],53:[2,6]},{5:[2,7],13:[2,7],14:[2,7],17:[2,7],27:[2,7],32:[2,7],37:[2,7],42:[2,7],45:[2,7],46:[2,7],49:[2,7],53:[2,7]},{5:[2,8],13:[2,8],14:[2,8],17:[2,8],27:[2,8],32:[2,8],37:[2,8],42:[2,8],45:[2,8],46:[2,8],49:[2,8],53:[2,8]},{18:22,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:33,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:34,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{4:35,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{12:36,14:[1,18]},{18:38,54:37,58:39,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,9],13:[2,9],14:[2,9],16:[2,9],17:[2,9],27:[2,9],32:[2,9],37:[2,9],42:[2,9],45:[2,9],46:[2,9],49:[2,9],53:[2,9]},{18:41,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:42,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:43,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[2,73],47:44,59:[2,73],66:[2,73],74:[2,73],75:[2,73],76:[2,73],77:[2,73],78:[2,73],79:[2,73]},{21:[2,30],31:[2,30],52:[2,30],59:[2,30],62:[2,30],66:[2,30],69:[2,30],74:[2,30],75:[2,30],76:[2,30],77:[2,30],78:[2,30],79:[2,30]},{21:[2,31],31:[2,31],52:[2,31],59:[2,31],62:[2,31],66:[2,31],69:[2,31],74:[2,31],75:[2,31],76:[2,31],77:[2,31],78:[2,31],79:[2,31]},{21:[2,32],31:[2,32],52:[2,32],59:[2,32],62:[2,32],66:[2,32],69:[2,32],74:[2,32],75:[2,32],76:[2,32],77:[2,32],78:[2,32],79:[2,32]},{21:[2,33],31:[2,33],52:[2,33],59:[2,33],62:[2,33],66:[2,33],69:[2,33],74:[2,33],75:[2,33],76:[2,33],77:[2,33],78:[2,33],79:[2,33]},{21:[2,34],31:[2,34],52:[2,34],59:[2,34],62:[2,34],66:[2,34],69:[2,34],74:[2,34],75:[2,34],76:[2,34],77:[2,34],78:[2,34],79:[2,34]},{21:[2,35],31:[2,35],52:[2,35],59:[2,35],62:[2,35],66:[2,35],69:[2,35],74:[2,35],75:[2,35],76:[2,35],77:[2,35],78:[2,35],79:[2,35]},{21:[2,36],31:[2,36],52:[2,36],59:[2,36],62:[2,36],66:[2,36],69:[2,36],74:[2,36],75:[2,36],76:[2,36],77:[2,36],78:[2,36],79:[2,36]},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],78:[2,40],79:[2,40],81:[1,45]},{66:[1,32],80:46},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{50:47,52:[2,77],59:[2,77],66:[2,77],74:[2,77],75:[2,77],76:[2,77],77:[2,77],78:[2,77],79:[2,77]},{23:48,36:50,37:[1,52],41:51,42:[1,53],43:49,45:[2,49]},{26:54,41:55,42:[1,53],45:[2,51]},{16:[1,56]},{31:[2,81],55:57,59:[2,81],66:[2,81],74:[2,81],75:[2,81],76:[2,81],77:[2,81],78:[2,81],79:[2,81]},{31:[2,37],59:[2,37],66:[2,37],74:[2,37],75:[2,37],76:[2,37],77:[2,37],78:[2,37],79:[2,37]},{31:[2,38],59:[2,38],66:[2,38],74:[2,38],75:[2,38],76:[2,38],77:[2,38],78:[2,38],79:[2,38]},{18:58,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{28:59,31:[2,53],59:[2,53],66:[2,53],69:[2,53],74:[2,53],75:[2,53],76:[2,53],77:[2,53],78:[2,53],79:[2,53]},{31:[2,59],33:60,59:[2,59],66:[2,59],69:[2,59],74:[2,59],75:[2,59],76:[2,59],77:[2,59],78:[2,59],79:[2,59]},{19:61,21:[2,45],59:[2,45],66:[2,45],74:[2,45],75:[2,45],76:[2,45],77:[2,45],78:[2,45],79:[2,45]},{18:65,31:[2,75],48:62,57:63,58:66,59:[1,40],63:64,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{66:[1,70]},{21:[2,39],31:[2,39],52:[2,39],59:[2,39],62:[2,39],66:[2,39],69:[2,39],74:[2,39],75:[2,39],76:[2,39],77:[2,39],78:[2,39],79:[2,39],81:[1,45]},{18:65,51:71,52:[2,79],57:72,58:66,59:[1,40],63:73,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{24:74,45:[1,75]},{45:[2,50]},{4:76,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{45:[2,19]},{18:77,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:78,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{24:79,45:[1,75]},{45:[2,52]},{5:[2,10],13:[2,10],14:[2,10],17:[2,10],27:[2,10],32:[2,10],37:[2,10],42:[2,10],45:[2,10],46:[2,10],49:[2,10],53:[2,10]},{18:65,31:[2,83],56:80,57:81,58:66,59:[1,40],63:82,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{59:[2,85],60:83,62:[2,85],66:[2,85],74:[2,85],75:[2,85],76:[2,85],77:[2,85],78:[2,85],79:[2,85]},{18:65,29:84,31:[2,55],57:85,58:66,59:[1,40],63:86,64:67,65:68,66:[1,69],69:[2,55],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,31:[2,61],34:87,57:88,58:66,59:[1,40],63:89,64:67,65:68,66:[1,69],69:[2,61],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,20:90,21:[2,47],57:91,58:66,59:[1,40],63:92,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[1,93]},{31:[2,74],59:[2,74],66:[2,74],74:[2,74],75:[2,74],76:[2,74],77:[2,74],78:[2,74],79:[2,74]},{31:[2,76]},{21:[2,24],31:[2,24],52:[2,24],59:[2,24],62:[2,24],66:[2,24],69:[2,24],74:[2,24],75:[2,24],76:[2,24],77:[2,24],78:[2,24],79:[2,24]},{21:[2,25],31:[2,25],52:[2,25],59:[2,25],62:[2,25],66:[2,25],69:[2,25],74:[2,25],75:[2,25],76:[2,25],77:[2,25],78:[2,25],79:[2,25]},{21:[2,27],31:[2,27],52:[2,27],62:[2,27],65:94,66:[1,95],69:[2,27]},{21:[2,89],31:[2,89],52:[2,89],62:[2,89],66:[2,89],69:[2,89]},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],67:[1,96],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{21:[2,41],31:[2,41],52:[2,41],59:[2,41],62:[2,41],66:[2,41],69:[2,41],74:[2,41],75:[2,41],76:[2,41],77:[2,41],78:[2,41],79:[2,41],81:[2,41]},{52:[1,97]},{52:[2,78],59:[2,78],66:[2,78],74:[2,78],75:[2,78],76:[2,78],77:[2,78],78:[2,78],79:[2,78]},{52:[2,80]},{5:[2,12],13:[2,12],14:[2,12],17:[2,12],27:[2,12],32:[2,12],37:[2,12],42:[2,12],45:[2,12],46:[2,12],49:[2,12],53:[2,12]},{18:98,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{36:50,37:[1,52],41:51,42:[1,53],43:100,44:99,45:[2,71]},{31:[2,65],38:101,59:[2,65],66:[2,65],69:[2,65],74:[2,65],75:[2,65],76:[2,65],77:[2,65],78:[2,65],79:[2,65]},{45:[2,17]},{5:[2,13],13:[2,13],14:[2,13],17:[2,13],27:[2,13],32:[2,13],37:[2,13],42:[2,13],45:[2,13],46:[2,13],49:[2,13],53:[2,13]},{31:[1,102]},{31:[2,82],59:[2,82],66:[2,82],74:[2,82],75:[2,82],76:[2,82],77:[2,82],78:[2,82],79:[2,82]},{31:[2,84]},{18:65,57:104,58:66,59:[1,40],61:103,62:[2,87],63:105,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{30:106,31:[2,57],68:107,69:[1,108]},{31:[2,54],59:[2,54],66:[2,54],69:[2,54],74:[2,54],75:[2,54],76:[2,54],77:[2,54],78:[2,54],79:[2,54]},{31:[2,56],69:[2,56]},{31:[2,63],35:109,68:110,69:[1,108]},{31:[2,60],59:[2,60],66:[2,60],69:[2,60],74:[2,60],75:[2,60],76:[2,60],77:[2,60],78:[2,60],79:[2,60]},{31:[2,62],69:[2,62]},{21:[1,111]},{21:[2,46],59:[2,46],66:[2,46],74:[2,46],75:[2,46],76:[2,46],77:[2,46],78:[2,46],79:[2,46]},{21:[2,48]},{5:[2,21],13:[2,21],14:[2,21],17:[2,21],27:[2,21],32:[2,21],37:[2,21],42:[2,21],45:[2,21],46:[2,21],49:[2,21],53:[2,21]},{21:[2,90],31:[2,90],52:[2,90],62:[2,90],66:[2,90],69:[2,90]},{67:[1,96]},{18:65,57:112,58:66,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,22],13:[2,22],14:[2,22],17:[2,22],27:[2,22],32:[2,22],37:[2,22],42:[2,22],45:[2,22],46:[2,22],49:[2,22],53:[2,22]},{31:[1,113]},{45:[2,18]},{45:[2,72]},{18:65,31:[2,67],39:114,57:115,58:66,59:[1,40],63:116,64:67,65:68,66:[1,69],69:[2,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,23],13:[2,23],14:[2,23],17:[2,23],27:[2,23],32:[2,23],37:[2,23],42:[2,23],45:[2,23],46:[2,23],49:[2,23],53:[2,23]},{62:[1,117]},{59:[2,86],62:[2,86],66:[2,86],74:[2,86],75:[2,86],76:[2,86],77:[2,86],78:[2,86],79:[2,86]},{62:[2,88]},{31:[1,118]},{31:[2,58]},{66:[1,120],70:119},{31:[1,121]},{31:[2,64]},{14:[2,11]},{21:[2,28],31:[2,28],52:[2,28],62:[2,28],66:[2,28],69:[2,28]},{5:[2,20],13:[2,20],14:[2,20],17:[2,20],27:[2,20],32:[2,20],37:[2,20],42:[2,20],45:[2,20],46:[2,20],49:[2,20],53:[2,20]},{31:[2,69],40:122,68:123,69:[1,108]},{31:[2,66],59:[2,66],66:[2,66],69:[2,66],74:[2,66],75:[2,66],76:[2,66],77:[2,66],78:[2,66],79:[2,66]},{31:[2,68],69:[2,68]},{21:[2,26],31:[2,26],52:[2,26],59:[2,26],62:[2,26],66:[2,26],69:[2,26],74:[2,26],75:[2,26],76:[2,26],77:[2,26],78:[2,26],79:[2,26]},{13:[2,14],14:[2,14],17:[2,14],27:[2,14],32:[2,14],37:[2,14],42:[2,14],45:[2,14],46:[2,14],49:[2,14],53:[2,14]},{66:[1,125],71:[1,124]},{66:[2,91],71:[2,91]},{13:[2,15],14:[2,15],17:[2,15],27:[2,15],32:[2,15],42:[2,15],45:[2,15],46:[2,15],49:[2,15],53:[2,15]},{31:[1,126]},{31:[2,70]},{31:[2,29]},{66:[2,92],71:[2,92]},{13:[2,16],14:[2,16],17:[2,16],27:[2,16],32:[2,16],37:[2,16],42:[2,16],45:[2,16],46:[2,16],49:[2,16],53:[2,16]}],defaultActions:{4:[2,1],49:[2,50],51:[2,19],55:[2,52],64:[2,76],73:[2,80],78:[2,17],82:[2,84],92:[2,48],99:[2,18],100:[2,72],105:[2,88],107:[2,58],110:[2,64],111:[2,11],123:[2,70],124:[2,29]},parseError:function(t,e){throw new Error(t)},parse:function(t){function e(){var t;return t=n.lexer.lex()||1,"number"!=typeof t&&(t=n.symbols_[t]||t),t}var n=this,r=[0],i=[null],o=[],a=this.table,s="",u=0,l=0,c=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;o.push(h);var f=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var d,p,g,m,v,y,b,_,x,w={};;){if(g=r[r.length-1],this.defaultActions[g]?m=this.defaultActions[g]:((null===d||"undefined"==typeof d)&&(d=e()),m=a[g]&&a[g][d]),"undefined"==typeof m||!m.length||!m[0]){var k="";if(!c){x=[];for(y in a[g])this.terminals_[y]&&y>2&&x.push("'"+this.terminals_[y]+"'");k=this.lexer.showPosition?"Parse error on line "+(u+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[d]||d)+"'":"Parse error on line "+(u+1)+": Unexpected "+(1==d?"end of input":"'"+(this.terminals_[d]||d)+"'"),this.parseError(k,{text:this.lexer.match,token:this.terminals_[d]||d,line:this.lexer.yylineno,loc:h,expected:x})}}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+d);switch(m[0]){case 1:r.push(d),i.push(this.lexer.yytext),o.push(this.lexer.yylloc),r.push(m[1]),d=null,p?(d=p,p=null):(l=this.lexer.yyleng,s=this.lexer.yytext,u=this.lexer.yylineno,h=this.lexer.yylloc,c>0&&c--);break;case 2:if(b=this.productions_[m[1]][1],w.$=i[i.length-b],w._$={first_line:o[o.length-(b||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(b||1)].first_column,last_column:o[o.length-1].last_column},f&&(w._$.range=[o[o.length-(b||1)].range[0],o[o.length-1].range[1]]),v=this.performAction.call(w,s,l,u,this.yy,m[1],i,o),"undefined"!=typeof v)return v;b&&(r=r.slice(0,-1*b*2),i=i.slice(0,-1*b),o=o.slice(0,-1*b)),r.push(this.productions_[m[1]][0]),i.push(w.$),o.push(w._$),_=a[r[r.length-2]][r[r.length-1]],r.push(_);break;case 3:return!0}}return!0}},n=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,r,i;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),a=0;a<o.length&&(n=this._input.match(this.rules[o[a]]),!n||e&&!(n[0].length>e[0].length)||(e=n,r=a,this.options.flex));a++);return e?(i=e[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t?t:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return"undefined"!=typeof t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,n,r){function i(t,n){return e.yytext=e.yytext.substr(t,e.yyleng-n)}switch(n){case 0:if("\\\\"===e.yytext.slice(-2)?(i(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(i(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return e.yytext=e.yytext.substr(5,e.yyleng-9),this.popState(),16;case 4:return 14;case 5:return this.popState(),13;case 6:return 59;case 7:return 62;case 8:return 17;case 9:return this.popState(),this.begin("raw"),21;case 10:return 53;case 11:return 27;case 12:return 45;case 13:return this.popState(),42;case 14:return this.popState(),42;case 15:return 32;case 16:return 37;case 17:return 49;case 18:return 46;case 19:this.unput(e.yytext),this.popState(),this.begin("com");break;case 20:return this.popState(),13;case 21:return 46;case 22:return 67;case 23:return 66;case 24:return 66;case 25:return 81;case 26:break;case 27:return this.popState(),52;case 28:return this.popState(),31;case 29:return e.yytext=i(1,2).replace(/\\"/g,'"'),74;case 30:return e.yytext=i(1,2).replace(/\\'/g,"'"),74;case 31:return 79;case 32:return 76;case 33:return 76;case 34:return 77;case 35:return 78;case 36:return 75;case 37:return 69;case 38:return 71;case 39:return 66;case 40:return 66;case 41:return"INVALID";case 42:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,42],inclusive:!0}},t}();return e.lexer=n,t.prototype=e,e.Parser=t,new t}();e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";function r(){}function i(t,e,n){void 0===e&&(e=t.length);var r=t[e-1],i=t[e-2];return r?"ContentStatement"===r.type?(i||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(r.original):void 0:n}function o(t,e,n){void 0===e&&(e=-1);var r=t[e+1],i=t[e+2];return r?"ContentStatement"===r.type?(i||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(r.original):void 0:n}function a(t,e,n){var r=t[null==e?0:e+1];if(r&&"ContentStatement"===r.type&&(n||!r.rightStripped)){var i=r.value;r.value=r.value.replace(n?/^\s+/:/^[ \t]*\r?\n?/,""),r.rightStripped=r.value!==i}}function s(t,e,n){var r=t[null==e?t.length-1:e-1];if(r&&"ContentStatement"===r.type&&(n||!r.leftStripped)){var i=r.value;return r.value=r.value.replace(n?/\s+$/:/[ \t]+$/,""),r.leftStripped=r.value!==i,r.leftStripped}}var u=n(7)["default"];e.__esModule=!0;var l=n(6),c=u(l);r.prototype=new c["default"],r.prototype.Program=function(t){var e=!this.isRootSeen;this.isRootSeen=!0;for(var n=t.body,r=0,u=n.length;u>r;r++){var l=n[r],c=this.accept(l);if(c){var h=i(n,r,e),f=o(n,r,e),d=c.openStandalone&&h,p=c.closeStandalone&&f,g=c.inlineStandalone&&h&&f;c.close&&a(n,r,!0),c.open&&s(n,r,!0),g&&(a(n,r),s(n,r)&&"PartialStatement"===l.type&&(l.indent=/([ \t]+$)/.exec(n[r-1].original)[1])),d&&(a((l.program||l.inverse).body),s(n,r)),p&&(a(n,r),s((l.inverse||l.program).body))}}return t},r.prototype.BlockStatement=function(t){this.accept(t.program),this.accept(t.inverse);var e=t.program||t.inverse,n=t.program&&t.inverse,r=n,u=n;if(n&&n.chained)for(r=n.body[0].program;u.chained;)u=u.body[u.body.length-1].program;var l={open:t.openStrip.open,close:t.closeStrip.close,openStandalone:o(e.body),closeStandalone:i((r||e).body)};if(t.openStrip.close&&a(e.body,null,!0),n){var c=t.inverseStrip;c.open&&s(e.body,null,!0),c.close&&a(r.body,null,!0),t.closeStrip.open&&s(u.body,null,!0),i(e.body)&&o(r.body)&&(s(e.body),a(r.body))}else t.closeStrip.open&&s(e.body,null,!0);return l},r.prototype.MustacheStatement=function(t){return t.strip},r.prototype.PartialStatement=r.prototype.CommentStatement=function(t){var e=t.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}},e["default"]=r,t.exports=e["default"]},function(t,e,n){"use strict";function r(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function i(t){return/^\[.*\]$/.test(t)?t.substr(1,t.length-2):t}function o(t,e){return{open:"~"===t.charAt(2),close:"~"===e.charAt(e.length-3)}}function a(t){return t.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function s(t,e,n){n=this.locInfo(n);for(var r=t?"@":"",i=[],o=0,a="",s=0,u=e.length;u>s;s++){var l=e[s].part,c=e[s].original!==l;if(r+=(e[s].separator||"")+l,c||".."!==l&&"."!==l&&"this"!==l)i.push(l);else{if(i.length>0)throw new d["default"]("Invalid path: "+r,{loc:n});".."===l&&(o++,a+="../")}}return new this.PathExpression(t,o,i,r,n)}function u(t,e,n,r,i,o){var a=r.charAt(3)||r.charAt(2),s="{"!==a&&"&"!==a;return new this.MustacheStatement(t,e,n,s,i,this.locInfo(o))}function l(t,e,n,r){if(t.path.original!==n){var i={loc:t.path.loc};throw new d["default"](t.path.original+" doesn't match "+n,i)}r=this.locInfo(r);var o=new this.Program([e],null,{},r);return new this.BlockStatement(t.path,t.params,t.hash,o,void 0,{},{},{},r)}function c(t,e,n,r,i,o){if(r&&r.path&&t.path.original!==r.path.original){var a={loc:t.path.loc};throw new d["default"](t.path.original+" doesn't match "+r.path.original,a)}e.blockParams=t.blockParams;var s=void 0,u=void 0;return n&&(n.chain&&(n.program.body[0].closeStrip=r.strip),u=n.strip,s=n.program),i&&(i=s,s=e,e=i),new this.BlockStatement(t.path,t.params,t.hash,e,s,t.strip,u,r&&r.strip,this.locInfo(o))}var h=n(7)["default"];e.__esModule=!0,e.SourceLocation=r,e.id=i,e.stripFlags=o,e.stripComment=a,e.preparePath=s,e.prepareMustache=u,e.prepareRawBlock=l,e.prepareBlock=c;var f=n(10),d=h(f)},function(t,e,n){"use strict";function r(t,e,n){if(o.isArray(t)){for(var r=[],i=0,a=t.length;a>i;i++)r.push(e.wrap(t[i],n));return r}return"boolean"==typeof t||"number"==typeof t?t+"":t}function i(t){this.srcFile=t,this.source=[]}e.__esModule=!0;var o=n(11),a=void 0;try{}catch(s){}a||(a=function(t,e,n,r){this.src="",r&&this.add(r)},a.prototype={add:function(t){o.isArray(t)&&(t=t.join("")),this.src+=t},prepend:function(t){o.isArray(t)&&(t=t.join("")),this.src=t+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),i.prototype={prepend:function(t,e){this.source.unshift(this.wrap(t,e))},push:function(t,e){this.source.push(this.wrap(t,e))},merge:function(){var t=this.empty();return this.each(function(e){t.add(["  ",e,"\n"])}),t},each:function(t){for(var e=0,n=this.source.length;n>e;e++)t(this.source[e])},empty:function(){var t=void 0===arguments[0]?this.currentLocation||{start:{}}:arguments[0];return new a(t.start.line,t.start.column,this.srcFile)},wrap:function(t){var e=void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return t instanceof a?t:(t=r(t,this,e),new a(e.start.line,e.start.column,this.srcFile,t))},functionCall:function(t,e,n){return n=this.generateList(n),this.wrap([t,e?"."+e+"(":"(",n,")"])},quotedString:function(t){return'"'+(t+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(t){var e=[];for(var n in t)if(t.hasOwnProperty(n)){var i=r(t[n],this);"undefined"!==i&&e.push([this.quotedString(n),":",i])}var o=this.generateList(e);return o.prepend("{"),o.add("}"),o},generateList:function(t,e){for(var n=this.empty(e),i=0,o=t.length;o>i;i++)i&&n.add(","),n.add(r(t[i],this,e));return n},generateArray:function(t,e){var n=this.generateList(t,e);return n.prepend("["),n.add("]"),n}},e["default"]=i,t.exports=e["default"]}])}),function(t,e){function n(t){return"number"==typeof t?!0:"string"!=typeof t?!1:t.match(c)}function r(t){return n(t)?parseFloat(t):"true"===t||"false"===t?Boolean(t):t}function i(t){return JSON.parse(t)}function o(t){return JSON.stringify(t)}function a(t){return e.param(t)}function s(t,n){var i=/^\d+$/,o=/([^\[\]]+)|(\[\])/g,a=/([^?#]*)(#.*)?$/,s={},u=null,l=null;n=void 0===n?!0:n;var c=function(t){return decodeURIComponent(t.replace(/\+/g," "))};return t&&a.test(t)&&(u=t.split("&"),e.each(u,function(t,e){var a=e.split("="),u=c(a.shift()),h=c(a.join("=")),f=s;a=u.match(o);for(var d=0,p=a.length-1;p>d;d++)f[a[d]]||(f[a[d]]=i.test(a[d+1])||"[]"==a[d+1]?[]:{}),f=f[a[d]];l=a.pop(),"[]"==l?f.push(h):(h=n?r(h):h,f[l]=h)})),s}function u(t,n){var r=t[0],i=null;return r?(n=void 0===n?!0:n,i="form"==r.nodeName.toLowerCase()&&r.elements?e.makeArray(r.elements):e("input[name], textarea[name], select[name]",r),l(i,n)):{}}function l(t,n){var i={},o=null,a=/radio|checkbox/i,s=/[^\[\]]+/g;return e.each(t,function(t,e){var u=e.type&&e.type.toLowerCase();if("submit"!=u&&e.name){var l,c=e.name,h=$.data(e,"value")||$.fn.val.call([e]),f=a.test(e.type),d=c.match(s),p=!f||!!e.checked,g=!!c.match(/\[\]$/);
n&&(h=r(h)),o=i;for(var m=0;m<d.length-1;m++)o[d[m]]||(o[d[m]]={}),o=o[d[m]];l=d[d.length-1],(g||l in o)&&"checkbox"===u?($.isArray(o[l])||(o[l]=void 0===o[l]?[]:[o[l]]),p&&o[l].push(h)):(p||!o[l])&&(o[l]=p?h:void 0)}}),i}if(void 0===e)throw new Error("jQuery is required");var c=/^[\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?jQuery/,h=function(){function t(t){return function(e){return n=e,l[t]}}function e(){return n}var n,r={},l={json:{object:function(){return i(n)},query:function(){var t=i(n);return a(t)},json:e},object:{object:e,query:function(){return a(n)},json:function(){return o(n)}},query:{object:function(){return s(n)},query:e,json:function(){return o(s(n))}},form:{object:function(){return u(n)},query:function(){return n.serialize()},json:function(){return o(u(n))}}};return r.form=t("form"),r.query=t("query"),r.json=t("json"),r.object=t("object"),r},f=function(){function t(t){return function(e){if(e)return h()[t](e);throw new Error("You must pass a source")}}var e={};return e.json=t("json"),e.query=t("query"),e.form=t("form"),e.object=t("object"),e}();e.io=f}(this,jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){var e=0,n=Array.prototype.slice;t.cleanData=function(e){return function(n){var r,i,o;for(o=0;null!=(i=n[o]);o++)try{r=t._data(i,"events"),r&&r.remove&&t(i).triggerHandler("remove")}catch(a){}e(n)}}(t.cleanData),t.widget=function(e,n,r){var i,o,a,s,u={},l=e.split(".")[0];return e=e.split(".")[1],i=l+"-"+e,r||(r=n,n=t.Widget),t.expr[":"][i.toLowerCase()]=function(e){return!!t.data(e,i)},t[l]=t[l]||{},o=t[l][e],a=t[l][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new a(t,e)},t.extend(a,o,{version:r.version,_proto:t.extend({},r),_childConstructors:[]}),s=new n,s.options=t.widget.extend({},s.options),t.each(r,function(e,r){return t.isFunction(r)?void(u[e]=function(){var t=function(){return n.prototype[e].apply(this,arguments)},i=function(t){return n.prototype[e].apply(this,t)};return function(){var e,n=this._super,o=this._superApply;return this._super=t,this._superApply=i,e=r.apply(this,arguments),this._super=n,this._superApply=o,e}}()):void(u[e]=r)}),a.prototype=t.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix||e:e},u,{constructor:a,namespace:l,widgetName:e,widgetFullName:i}),o?(t.each(o._childConstructors,function(e,n){var r=n.prototype;t.widget(r.namespace+"."+r.widgetName,a,n._proto)}),delete o._childConstructors):n._childConstructors.push(a),t.widget.bridge(e,a),a},t.widget.extend=function(e){for(var r,i,o=n.call(arguments,1),a=0,s=o.length;s>a;a++)for(r in o[a])i=o[a][r],o[a].hasOwnProperty(r)&&void 0!==i&&(t.isPlainObject(i)?e[r]=t.isPlainObject(e[r])?t.widget.extend({},e[r],i):t.widget.extend({},i):e[r]=i);return e},t.widget.bridge=function(e,r){var i=r.prototype.widgetFullName||e;t.fn[e]=function(o){var a="string"==typeof o,s=n.call(arguments,1),u=this;return o=!a&&s.length?t.widget.extend.apply(null,[o].concat(s)):o,a?this.each(function(){var n,r=t.data(this,i);return"instance"===o?(u=r,!1):r?t.isFunction(r[o])&&"_"!==o.charAt(0)?(n=r[o].apply(r,s),n!==r&&void 0!==n?(u=n&&n.jquery?u.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")}):this.each(function(){var e=t.data(this,i);e?(e.option(o||{}),e._init&&e._init()):t.data(this,i,new r(o,this))}),u}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(n,r){r=t(r||this.defaultElement||this)[0],this.element=t(r),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),n),this.bindings=t(),this.hoverable=t(),this.focusable=t(),r!==this&&(t.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===r&&this.destroy()}}),this.document=t(r.style?r.ownerDocument:r.document||r),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,n){var r,i,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},r=e.split("."),e=r.shift(),r.length){for(i=a[e]=t.widget.extend({},this.options[e]),o=0;o<r.length-1;o++)i[r[o]]=i[r[o]]||{},i=i[r[o]];if(e=r.pop(),1===arguments.length)return void 0===i[e]?null:i[e];i[e]=n}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=n}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,n,r){var i,o=this;"boolean"!=typeof e&&(r=n,n=e,e=!1),r?(n=i=t(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),t.each(r,function(r,a){function s(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||t.guid++);var u=r.match(/^([\w:-]*)\s*(.*)$/),l=u[1]+o.eventNamespace,c=u[2];c?i.delegate(c,l,s):n.bind(l,s)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function n(){return("string"==typeof t?r[t]:t).apply(r,arguments)}var r=this;return setTimeout(n,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,n,r){var i,o,a=this.options[e];if(r=r||{},n=t.Event(n),n.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(i in o)i in n||(n[i]=o[i]);return this.element.trigger(n,r),!(t.isFunction(a)&&a.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,n){t.Widget.prototype["_"+e]=function(r,i,o){"string"==typeof i&&(i={effect:i});var a,s=i?i===!0||"number"==typeof i?n:i.effect||n:e;i=i||{},"number"==typeof i&&(i={duration:i}),a=!t.isEmptyObject(i),i.complete=o,i.delay&&r.delay(i.delay),a&&t.effects&&t.effects.effect[s]?r[e](i):s!==e&&r[s]?r[s](i.duration,i.easing,o):r.queue(function(n){t(this)[e](),o&&o.call(r[0]),n()})}});t.widget}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):window.jQuery)}(function(t){"use strict";var e=0;t.ajaxTransport("iframe",function(n){if(n.async){var r,i,o,a=n.initialIframeSrc||"javascript:false;";return{send:function(s,u){r=t('<form style="display:none;"></form>'),r.attr("accept-charset",n.formAcceptCharset),o=/\?/.test(n.url)?"&":"?","DELETE"===n.type?(n.url=n.url+o+"_method=DELETE",n.type="POST"):"PUT"===n.type?(n.url=n.url+o+"_method=PUT",n.type="POST"):"PATCH"===n.type&&(n.url=n.url+o+"_method=PATCH",n.type="POST"),e+=1,i=t('<iframe src="'+a+'" name="iframe-transport-'+e+'"></iframe>').bind("load",function(){var e,o=t.isArray(n.paramName)?n.paramName:[n.paramName];i.unbind("load").bind("load",function(){var e;try{if(e=i.contents(),!e.length||!e[0].firstChild)throw new Error}catch(n){e=void 0}u(200,"success",{iframe:e}),t('<iframe src="'+a+'"></iframe>').appendTo(r),window.setTimeout(function(){r.remove()},0)}),r.prop("target",i.prop("name")).prop("action",n.url).prop("method",n.type),n.formData&&t.each(n.formData,function(e,n){t('<input type="hidden"/>').prop("name",n.name).val(n.value).appendTo(r)}),n.fileInput&&n.fileInput.length&&"POST"===n.type&&(e=n.fileInput.clone(),n.fileInput.after(function(t){return e[t]}),n.paramName&&n.fileInput.each(function(e){t(this).prop("name",o[e]||n.paramName)}),r.append(n.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),n.fileInput.removeAttr("form")),r.submit(),e&&e.length&&n.fileInput.each(function(n,r){var i=t(e[n]);t(r).prop("name",i.prop("name")).attr("form",i.attr("form")),i.replaceWith(r)})}),r.append(i).appendTo(document.body)},abort:function(){i&&i.unbind("load").prop("src",a),r&&r.remove()}}}}),t.ajaxSetup({converters:{"iframe text":function(e){return e&&t(e[0].body).text()},"iframe json":function(e){return e&&t.parseJSON(t(e[0].body).text())},"iframe html":function(e){return e&&t(e[0].body).html()},"iframe xml":function(e){var n=e&&e[0];return n&&t.isXMLDoc(n)?n:t.parseXML(n.XMLDocument&&n.XMLDocument.xml||t(n.body).html())},"iframe script":function(e){return e&&t.globalEval(t(e[0].body).text())}}})}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],t):"object"==typeof exports?t(require("jquery"),require("./vendor/jquery.ui.widget")):t(window.jQuery)}(function(t){"use strict";function e(e){var n="dragover"===e;return function(r){r.dataTransfer=r.originalEvent&&r.originalEvent.dataTransfer;var i=r.dataTransfer;i&&-1!==t.inArray("Files",i.types)&&this._trigger(e,t.Event(e,{delegatedEvent:r}))!==!1&&(r.preventDefault(),n&&(i.dropEffect="copy"))}}t.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||t('<input type="file">').prop("disabled")),t.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),t.support.xhrFormDataFileUpload=!!window.FormData,t.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),t.widget("blueimp.fileupload",{options:{dropZone:t(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(e,n){return e=this.messages[e]||e.toString(),n&&t.each(n,function(t,n){e=e.replace("{"+t+"}",n)}),e},formData:function(t){return t.serializeArray()},add:function(e,n){return e.isDefaultPrevented()?!1:void((n.autoUpload||n.autoUpload!==!1&&t(this).fileupload("option","autoUpload"))&&n.process().done(function(){n.submit()}))},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:t.support.blobSlice&&function(){var t=this.slice||this.webkitSlice||this.mozSlice;return t.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(t,e,n){var r=t-this.timestamp;return(!this.bitrate||!n||r>n)&&(this.bitrate=(e-this.loaded)*(1e3/r)*8,this.loaded=e,this.timestamp=t),this.bitrate}},_isXHRUpload:function(e){return!e.forceIframeTransport&&(!e.multipart&&t.support.xhrFileUpload||t.support.xhrFormDataFileUpload)},_getFormData:function(e){var n;return"function"===t.type(e.formData)?e.formData(e.form):t.isArray(e.formData)?e.formData:"object"===t.type(e.formData)?(n=[],t.each(e.formData,function(t,e){n.push({name:t,value:e})}),n):[]},_getTotal:function(e){var n=0;return t.each(e,function(t,e){n+=e.size||1}),n},_initProgressObject:function(e){var n={loaded:0,total:0,bitrate:0};e._progress?t.extend(e._progress,n):e._progress=n},_initResponseObject:function(t){var e;if(t._response)for(e in t._response)t._response.hasOwnProperty(e)&&delete t._response[e];else t._response={}},_onProgress:function(e,n){if(e.lengthComputable){var r,i=Date.now?Date.now():(new Date).getTime();if(n._time&&n.progressInterval&&i-n._time<n.progressInterval&&e.loaded!==e.total)return;n._time=i,r=Math.floor(e.loaded/e.total*(n.chunkSize||n._progress.total))+(n.uploadedBytes||0),this._progress.loaded+=r-n._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(i,this._progress.loaded,n.bitrateInterval),n._progress.loaded=n.loaded=r,n._progress.bitrate=n.bitrate=n._bitrateTimer.getBitrate(i,r,n.bitrateInterval),this._trigger("progress",t.Event("progress",{delegatedEvent:e}),n),this._trigger("progressall",t.Event("progressall",{delegatedEvent:e}),this._progress)}},_initProgressListener:function(e){var n=this,r=e.xhr?e.xhr():t.ajaxSettings.xhr();r.upload&&(t(r.upload).bind("progress",function(t){var r=t.originalEvent;t.lengthComputable=r.lengthComputable,t.loaded=r.loaded,t.total=r.total,n._onProgress(t,e)}),e.xhr=function(){return r})},_isInstanceOf:function(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"},_initXHRData:function(e){var n,r=this,i=e.files[0],o=e.multipart||!t.support.xhrFileUpload,a="array"===t.type(e.paramName)?e.paramName[0]:e.paramName;e.headers=t.extend({},e.headers),e.contentRange&&(e.headers["Content-Range"]=e.contentRange),o&&!e.blob&&this._isInstanceOf("File",i)||(e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.name)+'"'),o?t.support.xhrFormDataFileUpload&&(e.postMessage?(n=this._getFormData(e),e.blob?n.push({name:a,value:e.blob}):t.each(e.files,function(r,i){n.push({name:"array"===t.type(e.paramName)&&e.paramName[r]||a,value:i})})):(r._isInstanceOf("FormData",e.formData)?n=e.formData:(n=new FormData,t.each(this._getFormData(e),function(t,e){n.append(e.name,e.value)})),e.blob?n.append(a,e.blob,i.name):t.each(e.files,function(i,o){(r._isInstanceOf("File",o)||r._isInstanceOf("Blob",o))&&n.append("array"===t.type(e.paramName)&&e.paramName[i]||a,o,o.uploadName||o.name)})),e.data=n):(e.contentType=i.type||"application/octet-stream",e.data=e.blob||i),e.blob=null},_initIframeSettings:function(e){var n=t("<a></a>").prop("href",e.url).prop("host");e.dataType="iframe "+(e.dataType||""),e.formData=this._getFormData(e),e.redirect&&n&&n!==location.host&&e.formData.push({name:e.redirectParamName||"redirect",value:e.redirect})},_initDataSettings:function(t){this._isXHRUpload(t)?(this._chunkedUpload(t,!0)||(t.data||this._initXHRData(t),this._initProgressListener(t)),t.postMessage&&(t.dataType="postmessage "+(t.dataType||""))):this._initIframeSettings(t)},_getParamName:function(e){var n=t(e.fileInput),r=e.paramName;return r?t.isArray(r)||(r=[r]):(r=[],n.each(function(){for(var e=t(this),n=e.prop("name")||"files[]",i=(e.prop("files")||[1]).length;i;)r.push(n),i-=1}),r.length||(r=[n.prop("name")||"files[]"])),r},_initFormSettings:function(e){e.form&&e.form.length||(e.form=t(e.fileInput.prop("form")),e.form.length||(e.form=t(this.options.fileInput.prop("form")))),e.paramName=this._getParamName(e),e.url||(e.url=e.form.prop("action")||location.href),e.type=(e.type||"string"===t.type(e.form.prop("method"))&&e.form.prop("method")||"").toUpperCase(),"POST"!==e.type&&"PUT"!==e.type&&"PATCH"!==e.type&&(e.type="POST"),e.formAcceptCharset||(e.formAcceptCharset=e.form.attr("accept-charset"))},_getAJAXSettings:function(e){var n=t.extend({},this.options,e);return this._initFormSettings(n),this._initDataSettings(n),n},_getDeferredState:function(t){return t.state?t.state():t.isResolved()?"resolved":t.isRejected()?"rejected":"pending"},_enhancePromise:function(t){return t.success=t.done,t.error=t.fail,t.complete=t.always,t},_getXHRPromise:function(e,n,r){var i=t.Deferred(),o=i.promise();return n=n||this.options.context||o,e===!0?i.resolveWith(n,r):e===!1&&i.rejectWith(n,r),o.abort=i.promise,this._enhancePromise(o)},_addConvenienceMethods:function(e,n){var r=this,i=function(e){return t.Deferred().resolveWith(r,e).promise()};n.process=function(e,o){return(e||o)&&(n._processQueue=this._processQueue=(this._processQueue||i([this])).pipe(function(){return n.errorThrown?t.Deferred().rejectWith(r,[n]).promise():i(arguments)}).pipe(e,o)),this._processQueue||i([this])},n.submit=function(){return"pending"!==this.state()&&(n.jqXHR=this.jqXHR=r._trigger("submit",t.Event("submit",{delegatedEvent:e}),this)!==!1&&r._onSend(e,this)),this.jqXHR||r._getXHRPromise()},n.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",r._trigger("fail",null,this),r._getXHRPromise(!1))},n.state=function(){return this.jqXHR?r._getDeferredState(this.jqXHR):this._processQueue?r._getDeferredState(this._processQueue):void 0},n.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===r._getDeferredState(this._processQueue)},n.progress=function(){return this._progress},n.response=function(){return this._response}},_getUploadedBytes:function(t){var e=t.getResponseHeader("Range"),n=e&&e.split("-"),r=n&&n.length>1&&parseInt(n[1],10);return r&&r+1},_chunkedUpload:function(e,n){e.uploadedBytes=e.uploadedBytes||0;var r,i,o=this,a=e.files[0],s=a.size,u=e.uploadedBytes,l=e.maxChunkSize||s,c=this._blobSlice,h=t.Deferred(),f=h.promise();return this._isXHRUpload(e)&&c&&(u||s>l)&&!e.data?n?!0:u>=s?(a.error=e.i18n("uploadedBytes"),this._getXHRPromise(!1,e.context,[null,"error",a.error])):(i=function(){var n=t.extend({},e),f=n._progress.loaded;n.blob=c.call(a,u,u+l,a.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+u+"-"+(u+n.chunkSize-1)+"/"+s,o._initXHRData(n),o._initProgressListener(n),r=(o._trigger("chunksend",null,n)!==!1&&t.ajax(n)||o._getXHRPromise(!1,n.context)).done(function(r,a,l){u=o._getUploadedBytes(l)||u+n.chunkSize,f+n.chunkSize-n._progress.loaded&&o._onProgress(t.Event("progress",{lengthComputable:!0,loaded:u-n.uploadedBytes,total:u-n.uploadedBytes}),n),e.uploadedBytes=n.uploadedBytes=u,n.result=r,n.textStatus=a,n.jqXHR=l,o._trigger("chunkdone",null,n),o._trigger("chunkalways",null,n),s>u?i():h.resolveWith(n.context,[r,a,l])}).fail(function(t,e,r){n.jqXHR=t,n.textStatus=e,n.errorThrown=r,o._trigger("chunkfail",null,n),o._trigger("chunkalways",null,n),h.rejectWith(n.context,[t,e,r])})},this._enhancePromise(f),f.abort=function(){return r.abort()},i(),f):!1},_beforeSend:function(t,e){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(e),this._initProgressObject(e),e._progress.loaded=e.loaded=e.uploadedBytes||0,e._progress.total=e.total=this._getTotal(e.files)||1,e._progress.bitrate=e.bitrate=0,this._active+=1,this._progress.loaded+=e.loaded,this._progress.total+=e.total},_onDone:function(e,n,r,i){var o=i._progress.total,a=i._response;i._progress.loaded<o&&this._onProgress(t.Event("progress",{lengthComputable:!0,loaded:o,total:o}),i),a.result=i.result=e,a.textStatus=i.textStatus=n,a.jqXHR=i.jqXHR=r,this._trigger("done",null,i)},_onFail:function(t,e,n,r){var i=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total),i.jqXHR=r.jqXHR=t,i.textStatus=r.textStatus=e,i.errorThrown=r.errorThrown=n,this._trigger("fail",null,r)},_onAlways:function(t,e,n,r){this._trigger("always",null,r)},_onSend:function(e,n){n.submit||this._addConvenienceMethods(e,n);var r,i,o,a,s=this,u=s._getAJAXSettings(n),l=function(){return s._sending+=1,u._bitrateTimer=new s._BitrateTimer,r=r||((i||s._trigger("send",t.Event("send",{delegatedEvent:e}),u)===!1)&&s._getXHRPromise(!1,u.context,i)||s._chunkedUpload(u)||t.ajax(u)).done(function(t,e,n){s._onDone(t,e,n,u)}).fail(function(t,e,n){s._onFail(t,e,n,u)}).always(function(t,e,n){if(s._onAlways(t,e,n,u),s._sending-=1,s._active-=1,u.limitConcurrentUploads&&u.limitConcurrentUploads>s._sending)for(var r=s._slots.shift();r;){if("pending"===s._getDeferredState(r)){r.resolve();break}r=s._slots.shift()}0===s._active&&s._trigger("stop")})};return this._beforeSend(e,u),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=t.Deferred(),this._slots.push(o),a=o.pipe(l)):(this._sequence=this._sequence.pipe(l,l),a=this._sequence),a.abort=function(){return i=[void 0,"abort","abort"],r?r.abort():(o&&o.rejectWith(u.context,i),l())},this._enhancePromise(a)):l()},_onAdd:function(e,n){var r,i,o,a,s=this,u=!0,l=t.extend({},this.options,n),c=n.files,h=c.length,f=l.limitMultiFileUploads,d=l.limitMultiFileUploadSize,p=l.limitMultiFileUploadSizeOverhead,g=0,m=this._getParamName(l),v=0;if(!d||h&&void 0!==c[0].size||(d=void 0),(l.singleFileUploads||f||d)&&this._isXHRUpload(l))if(l.singleFileUploads||d||!f)if(!l.singleFileUploads&&d)for(o=[],r=[],a=0;h>a;a+=1)g+=c[a].size+p,(a+1===h||g+c[a+1].size+p>d||f&&a+1-v>=f)&&(o.push(c.slice(v,a+1)),i=m.slice(v,a+1),i.length||(i=m),r.push(i),v=a+1,g=0);else r=m;else for(o=[],r=[],a=0;h>a;a+=f)o.push(c.slice(a,a+f)),i=m.slice(a,a+f),i.length||(i=m),r.push(i);else o=[c],r=[m];return n.originalFiles=c,t.each(o||c,function(i,a){var l=t.extend({},n);return l.files=o?a:[a],l.paramName=r[i],s._initResponseObject(l),s._initProgressObject(l),s._addConvenienceMethods(e,l),u=s._trigger("add",t.Event("add",{delegatedEvent:e}),l)}),u},_replaceFileInput:function(e){var n=e.fileInput,r=n.clone(!0);e.fileInputClone=r,t("<form></form>").append(r)[0].reset(),n.after(r).detach(),t.cleanData(n.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(t,e){return e===n[0]?r[0]:e}),n[0]===this.element[0]&&(this.element=r)},_handleFileTreeEntry:function(e,n){var r,i=this,o=t.Deferred(),a=function(t){t&&!t.entry&&(t.entry=e),o.resolve([t])},s=function(t){i._handleFileTreeEntries(t,n+e.name+"/").done(function(t){o.resolve(t)}).fail(a)},u=function(){r.readEntries(function(t){t.length?(l=l.concat(t),u()):s(l)},a)},l=[];return n=n||"",e.isFile?e._file?(e._file.relativePath=n,o.resolve(e._file)):e.file(function(t){t.relativePath=n,o.resolve(t)},a):e.isDirectory?(r=e.createReader(),u()):o.resolve([]),o.promise()},_handleFileTreeEntries:function(e,n){var r=this;return t.when.apply(t,t.map(e,function(t){return r._handleFileTreeEntry(t,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(e){e=e||{};var n=e.items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(t.map(n,function(t){var e;return t.webkitGetAsEntry?(e=t.webkitGetAsEntry(),e&&(e._file=t.getAsFile()),e):t.getAsEntry()})):t.Deferred().resolve(t.makeArray(e.files)).promise()},_getSingleFileInputFiles:function(e){e=t(e);var n,r,i=e.prop("webkitEntries")||e.prop("entries");if(i&&i.length)return this._handleFileTreeEntries(i);if(n=t.makeArray(e.prop("files")),n.length)void 0===n[0].name&&n[0].fileName&&t.each(n,function(t,e){e.name=e.fileName,e.size=e.fileSize});else{if(r=e.prop("value"),!r)return t.Deferred().resolve([]).promise();n=[{name:r.replace(/^.*\\/,"")}]}return t.Deferred().resolve(n).promise()},_getFileInputFiles:function(e){return e instanceof t&&1!==e.length?t.when.apply(t,t.map(e,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(e)},_onChange:function(e){var n=this,r={fileInput:t(e.target),form:t(e.target.form)};this._getFileInputFiles(r.fileInput).always(function(i){r.files=i,n.options.replaceFileInput&&n._replaceFileInput(r),n._trigger("change",t.Event("change",{delegatedEvent:e}),r)!==!1&&n._onAdd(e,r)})},_onPaste:function(e){var n=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,r={files:[]};n&&n.length&&(t.each(n,function(t,e){var n=e.getAsFile&&e.getAsFile();n&&r.files.push(n)}),this._trigger("paste",t.Event("paste",{delegatedEvent:e}),r)!==!1&&this._onAdd(e,r))},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var n=this,r=e.dataTransfer,i={};r&&r.files&&r.files.length&&(e.preventDefault(),this._getDroppedFiles(r).always(function(r){i.files=r,n._trigger("drop",t.Event("drop",{delegatedEvent:e}),i)!==!1&&n._onAdd(e,i)}))},_onDragOver:e("dragover"),_onDragEnter:e("dragenter"),_onDragLeave:e("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),t.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(e,n){var r=-1!==t.inArray(e,this._specialOptions);r&&this._destroyEventHandlers(),this._super(e,n),r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var e=this.options;void 0===e.fileInput?e.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):e.fileInput instanceof t||(e.fileInput=t(e.fileInput)),e.dropZone instanceof t||(e.dropZone=t(e.dropZone)),e.pasteZone instanceof t||(e.pasteZone=t(e.pasteZone))},_getRegExp:function(t){var e=t.split("/"),n=e.pop();return e.shift(),new RegExp(e.join("/"),n)},_isRegExpOption:function(e,n){return"url"!==e&&"string"===t.type(n)&&/^\/.*\/[igm]{0,3}$/.test(n)},_initDataAttributes:function(){var e=this,n=this.options,r=this.element.data();t.each(this.element[0].attributes,function(t,i){var o,a=i.name.toLowerCase();/^data-/.test(a)&&(a=a.slice(5).replace(/-[a-z]/g,function(t){return t.charAt(1).toUpperCase()}),o=r[a],e._isRegExpOption(a,o)&&(o=e._getRegExp(o)),n[a]=o)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(e){var n=this;e&&!this.options.disabled&&(e.fileInput&&!e.files?this._getFileInputFiles(e.fileInput).always(function(t){e.files=t,n._onAdd(null,e)}):(e.files=t.makeArray(e.files),this._onAdd(null,e)))},send:function(e){if(e&&!this.options.disabled){if(e.fileInput&&!e.files){var n,r,i=this,o=t.Deferred(),a=o.promise();return a.abort=function(){return r=!0,n?n.abort():(o.reject(null,"abort","abort"),a)},this._getFileInputFiles(e.fileInput).always(function(t){if(!r){if(!t.length)return void o.reject();e.files=t,n=i._onSend(null,e),n.then(function(t,e,n){o.resolve(t,e,n)},function(t,e,n){o.reject(t,e,n)})}}),this._enhancePromise(a)}if(e.files=t.makeArray(e.files),e.files.length)return this._onSend(null,e)}return this._getXHRPromise(!1,e&&e.context)}})}),!function(t){"use strict";var e=function(t,n,r){var i,o,a=document.createElement("img");if(a.onerror=n,a.onload=function(){!o||r&&r.noRevoke||e.revokeObjectURL(o),n&&n(e.scale(a,r))},e.isInstanceOf("Blob",t)||e.isInstanceOf("File",t))i=o=e.createObjectURL(t),a._type=t.type;else{if("string"!=typeof t)return!1;i=t,r&&r.crossOrigin&&(a.crossOrigin=r.crossOrigin)}return i?(a.src=i,a):e.readFile(t,function(t){var e=t.target;e&&e.result?a.src=e.result:n&&n(t)})},n=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;e.isInstanceOf=function(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"},e.transformCoordinates=function(){},e.getTransformedOptions=function(t,e){var n,r,i,o,a=e.aspectRatio;if(!a)return e;n={};for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n.crop=!0,i=t.naturalWidth||t.width,o=t.naturalHeight||t.height,i/o>a?(n.maxWidth=o*a,n.maxHeight=o):(n.maxWidth=i,n.maxHeight=i/a),n},e.renderImageToCanvas=function(t,e,n,r,i,o,a,s,u,l){return t.getContext("2d").drawImage(e,n,r,i,o,a,s,u,l),t},e.hasCanvasOption=function(t){return t.canvas||t.crop||t.aspectRatio},e.scale=function(t,n){n=n||{};var r,i,o,a,s,u,l,c,h,f=document.createElement("canvas"),d=t.getContext||e.hasCanvasOption(n)&&f.getContext,p=t.naturalWidth||t.width,g=t.naturalHeight||t.height,m=p,v=g,y=function(){var t=Math.max((o||m)/m,(a||v)/v);t>1&&(m*=t,v*=t)},b=function(){var t=Math.min((r||m)/m,(i||v)/v);1>t&&(m*=t,v*=t)};return d&&(n=e.getTransformedOptions(t,n),l=n.left||0,c=n.top||0,n.sourceWidth?(s=n.sourceWidth,void 0!==n.right&&void 0===n.left&&(l=p-s-n.right)):s=p-l-(n.right||0),n.sourceHeight?(u=n.sourceHeight,void 0!==n.bottom&&void 0===n.top&&(c=g-u-n.bottom)):u=g-c-(n.bottom||0),m=s,v=u),r=n.maxWidth,i=n.maxHeight,o=n.minWidth,a=n.minHeight,d&&r&&i&&n.crop?(m=r,v=i,h=s/u-r/i,0>h?(u=i*s/r,void 0===n.top&&void 0===n.bottom&&(c=(g-u)/2)):h>0&&(s=r*u/i,void 0===n.left&&void 0===n.right&&(l=(p-s)/2))):((n.contain||n.cover)&&(o=r=r||o,a=i=i||a),n.cover?(b(),y()):(y(),b())),d?(f.width=m,f.height=v,e.transformCoordinates(f,n),e.renderImageToCanvas(f,t,l,c,s,u,0,0,m,v)):(t.width=m,t.height=v,t)},e.createObjectURL=function(t){return n?n.createObjectURL(t):!1},e.revokeObjectURL=function(t){return n?n.revokeObjectURL(t):!1},e.readFile=function(t,e,n){if(window.FileReader){var r=new FileReader;if(r.onload=r.onerror=e,n=n||"readAsDataURL",r[n])return r[n](t),r}return!1},"function"==typeof define&&define.amd?define(function(){return e}):t.loadImage=e}(this),function(t){"use strict";"function"==typeof define&&define.amd?define(["load-image"],t):t(window.loadImage)}(function(t){"use strict";if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var e=t.renderImageToCanvas;t.detectSubsampling=function(t){var e,n;return t.width*t.height>1048576?(e=document.createElement("canvas"),e.width=e.height=1,n=e.getContext("2d"),n.drawImage(t,-t.width+1,0),0===n.getImageData(0,0,1,1).data[3]):!1},t.detectVerticalSquash=function(t,e){var n,r,i,o,a,s=t.naturalHeight||t.height,u=document.createElement("canvas"),l=u.getContext("2d");for(e&&(s/=2),u.width=1,u.height=s,l.drawImage(t,0,0),n=l.getImageData(0,0,1,s).data,r=0,i=s,o=s;o>r;)a=n[4*(o-1)+3],0===a?i=o:r=o,o=i+r>>1;return o/s||1},t.renderImageToCanvas=function(n,r,i,o,a,s,u,l,c,h){if("image/jpeg"===r._type){var f,d,p,g,m=n.getContext("2d"),v=document.createElement("canvas"),y=1024,b=v.getContext("2d");if(v.width=y,v.height=y,m.save(),f=t.detectSubsampling(r),f&&(i/=2,o/=2,a/=2,s/=2),d=t.detectVerticalSquash(r,f),f||1!==d){for(o*=d,c=Math.ceil(y*c/a),h=Math.ceil(y*h/s/d),l=0,g=0;s>g;){for(u=0,p=0;a>p;)b.clearRect(0,0,y,y),b.drawImage(r,i,o,a,s,-p,-g,a,s),m.drawImage(v,0,0,y,y,u,l,c,h),p+=y,u+=c;g+=y,l+=h}return m.restore(),n}}return e(n,r,i,o,a,s,u,l,c,h)}}}),function(t){"use strict";"function"==typeof define&&define.amd?define(["load-image"],t):t(window.loadImage)}(function(t){"use strict";var e=t.hasCanvasOption,n=t.transformCoordinates,r=t.getTransformedOptions;t.hasCanvasOption=function(n){return e.call(t,n)||n.orientation},t.transformCoordinates=function(e,r){n.call(t,e,r);var i=e.getContext("2d"),o=e.width,a=e.height,s=r.orientation;if(s&&!(s>8))switch(s>4&&(e.width=a,e.height=o),s){case 2:i.translate(o,0),i.scale(-1,1);break;case 3:i.translate(o,a),i.rotate(Math.PI);break;case 4:i.translate(0,a),i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI),i.translate(0,-a);break;case 7:i.rotate(.5*Math.PI),i.translate(o,-a),i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI),i.translate(-o,0)}},t.getTransformedOptions=function(e,n){var i,o,a=r.call(t,e,n),s=a.orientation;if(!s||s>8||1===s)return a;i={};for(o in a)a.hasOwnProperty(o)&&(i[o]=a[o]);switch(a.orientation){case 2:i.left=a.right,i.right=a.left;break;case 3:i.left=a.right,i.top=a.bottom,i.right=a.left,i.bottom=a.top;break;case 4:i.top=a.bottom,
i.bottom=a.top;break;case 5:i.left=a.top,i.top=a.left,i.right=a.bottom,i.bottom=a.right;break;case 6:i.left=a.top,i.top=a.right,i.right=a.bottom,i.bottom=a.left;break;case 7:i.left=a.bottom,i.top=a.right,i.right=a.top,i.bottom=a.left;break;case 8:i.left=a.bottom,i.top=a.left,i.right=a.top,i.bottom=a.right}return a.orientation>4&&(i.maxWidth=a.maxHeight,i.maxHeight=a.maxWidth,i.minWidth=a.minHeight,i.minHeight=a.minWidth,i.sourceWidth=a.sourceHeight,i.sourceHeight=a.sourceWidth),i}}),function(t){"use strict";"function"==typeof define&&define.amd?define(["load-image"],t):t(window.loadImage)}(function(t){"use strict";var e=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);t.blobSlice=e&&function(){var t=this.slice||this.webkitSlice||this.mozSlice;return t.apply(this,arguments)},t.metaDataParsers={jpeg:{65505:[]}},t.parseMetaData=function(e,n,r){r=r||{};var i=this,o=r.maxMetaDataSize||262144,a={},s=!(window.DataView&&e&&e.size>=12&&"image/jpeg"===e.type&&t.blobSlice);(s||!t.readFile(t.blobSlice.call(e,0,o),function(e){if(e.target.error)return console.log(e.target.error),void n(a);var o,s,u,l,c=e.target.result,h=new DataView(c),f=2,d=h.byteLength-4,p=f;if(65496===h.getUint16(0)){for(;d>f&&(o=h.getUint16(f),o>=65504&&65519>=o||65534===o);){if(s=h.getUint16(f+2)+2,f+s>h.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(u=t.metaDataParsers.jpeg[o])for(l=0;l<u.length;l+=1)u[l].call(i,h,f,s,a,r);f+=s,p=f}!r.disableImageHead&&p>6&&(a.imageHead=c.slice?c.slice(0,p):new Uint8Array(c).subarray(0,p))}else console.log("Invalid JPEG file: Missing JPEG marker.");n(a)},"readAsArrayBuffer"))&&n(a)}}),function(t){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-meta"],t):t(window.loadImage)}(function(t){"use strict";t.ExifMap=function(){return this},t.ExifMap.prototype.map={Orientation:274},t.ExifMap.prototype.get=function(t){return this[t]||this[this.map[t]]},t.getExifThumbnail=function(t,e,n){var r,i,o;if(!n||e+n>t.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");for(r=[],i=0;n>i;i+=1)o=t.getUint8(e+i),r.push((16>o?"0":"")+o.toString(16));return"data:image/jpeg,%"+r.join("%")},t.exifTagTypes={1:{getValue:function(t,e){return t.getUint8(e)},size:1},2:{getValue:function(t,e){return String.fromCharCode(t.getUint8(e))},size:1,ascii:!0},3:{getValue:function(t,e,n){return t.getUint16(e,n)},size:2},4:{getValue:function(t,e,n){return t.getUint32(e,n)},size:4},5:{getValue:function(t,e,n){return t.getUint32(e,n)/t.getUint32(e+4,n)},size:8},9:{getValue:function(t,e,n){return t.getInt32(e,n)},size:4},10:{getValue:function(t,e,n){return t.getInt32(e,n)/t.getInt32(e+4,n)},size:8}},t.exifTagTypes[7]=t.exifTagTypes[1],t.getExifValue=function(e,n,r,i,o,a){var s,u,l,c,h,f,d=t.exifTagTypes[i];if(!d)return void console.log("Invalid Exif data: Invalid tag type.");if(s=d.size*o,u=s>4?n+e.getUint32(r+8,a):r+8,u+s>e.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===o)return d.getValue(e,u,a);for(l=[],c=0;o>c;c+=1)l[c]=d.getValue(e,u+c*d.size,a);if(d.ascii){for(h="",c=0;c<l.length&&(f=l[c],"\x00"!==f);c+=1)h+=f;return h}return l},t.parseExifTag=function(e,n,r,i,o){var a=e.getUint16(r,i);o.exif[a]=t.getExifValue(e,n,r,e.getUint16(r+2,i),e.getUint32(r+4,i),i)},t.parseExifTags=function(t,e,n,r,i){var o,a,s;if(n+6>t.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(o=t.getUint16(n,r),a=n+2+12*o,a+4>t.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(s=0;o>s;s+=1)this.parseExifTag(t,e,n+2+12*s,r,i);return t.getUint32(a,r)},t.parseExifData=function(e,n,r,i,o){if(!o.disableExif){var a,s,u,l=n+10;if(1165519206===e.getUint32(n+4)){if(l+8>e.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==e.getUint16(n+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(e.getUint16(l)){case 18761:a=!0;break;case 19789:a=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==e.getUint16(l+2,a))return void console.log("Invalid Exif data: Missing TIFF marker.");s=e.getUint32(l+4,a),i.exif=new t.ExifMap,s=t.parseExifTags(e,l,l+s,a,i),s&&!o.disableExifThumbnail&&(u={exif:{}},s=t.parseExifTags(e,l,l+s,a,u),u.exif[513]&&(i.exif.Thumbnail=t.getExifThumbnail(e,l+u.exif[513],u.exif[514]))),i.exif[34665]&&!o.disableExifSub&&t.parseExifTags(e,l,l+i.exif[34665],a,i),i.exif[34853]&&!o.disableExifGps&&t.parseExifTags(e,l,l+i.exif[34853],a,i)}}},t.metaDataParsers.jpeg[65505].push(t.parseExifData)}),function(t){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-exif"],t):t(window.loadImage)}(function(t){"use strict";t.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},t.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},t.ExifMap.prototype.getText=function(t){var e=this.get(t);switch(t){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[t][e];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(e[0],e[1],e[2],e[3]);case"ComponentsConfiguration":return this.stringValues[t][e[0]]+this.stringValues[t][e[1]]+this.stringValues[t][e[2]]+this.stringValues[t][e[3]];case"GPSVersionID":return e[0]+"."+e[1]+"."+e[2]+"."+e[3]}return String(e)},function(t){var e,n=t.tags,r=t.map;for(e in n)n.hasOwnProperty(e)&&(r[n[e]]=e)}(t.ExifMap.prototype),t.ExifMap.prototype.getAll=function(){var t,e,n={};for(t in this)this.hasOwnProperty(t)&&(e=this.tags[t],e&&(n[e]=this.getText(e)));return n}}),function(t){"use strict";var e=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,n=t.Blob&&function(){try{return Boolean(new Blob)}catch(t){return!1}}(),r=n&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return!1}}(),i=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,o=(n||i)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(t){var e,o,a,s,u,l;for(e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):decodeURIComponent(t.split(",")[1]),o=new ArrayBuffer(e.length),a=new Uint8Array(o),s=0;s<e.length;s+=1)a[s]=e.charCodeAt(s);return u=t.split(",")[0].split(":")[1].split(";")[0],n?new Blob([r?a:o],{type:u}):(l=new i,l.append(o),l.getBlob(u))};t.HTMLCanvasElement&&!e.toBlob&&(e.mozGetAsFile?e.toBlob=function(t,n,r){t(r&&e.toDataURL&&o?o(this.toDataURL(n,r)):this.mozGetAsFile("blob",n))}:e.toDataURL&&o&&(e.toBlob=function(t,e,n){t(o(this.toDataURL(e,n)))})),"function"==typeof define&&define.amd?define(function(){return o}):t.dataURLtoBlob=o}(this),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","./jquery.fileupload"],t):t("object"==typeof exports?require("jquery"):window.jQuery)}(function(t){"use strict";var e=t.blueimp.fileupload.prototype.options.add;t.widget("blueimp.fileupload",t.blueimp.fileupload,{options:{processQueue:[],add:function(n,r){var i=t(this);r.process(function(){return i.fileupload("process",r)}),e.call(this,n,r)}},processActions:{},_processFile:function(e,n){var r=this,i=t.Deferred().resolveWith(r,[e]),o=i.promise();return this._trigger("process",null,e),t.each(e.processQueue,function(e,i){var a=function(e){return n.errorThrown?t.Deferred().rejectWith(r,[n]).promise():r.processActions[i.action].call(r,e,i)};o=o.pipe(a,i.always&&a)}),o.done(function(){r._trigger("processdone",null,e),r._trigger("processalways",null,e)}).fail(function(){r._trigger("processfail",null,e),r._trigger("processalways",null,e)}),o},_transformProcessQueue:function(e){var n=[];t.each(e.processQueue,function(){var r={},i=this.action,o=this.prefix===!0?i:this.prefix;t.each(this,function(n,i){"string"===t.type(i)&&"@"===i.charAt(0)?r[n]=e[i.slice(1)||(o?o+n.charAt(0).toUpperCase()+n.slice(1):n)]:r[n]=i}),n.push(r)}),e.processQueue=n},processing:function(){return this._processing},process:function(e){var n=this,r=t.extend({},this.options,e);return r.processQueue&&r.processQueue.length&&(this._transformProcessQueue(r),0===this._processing&&this._trigger("processstart"),t.each(e.files,function(i){var o=i?t.extend({},r):r,a=function(){return e.errorThrown?t.Deferred().rejectWith(n,[e]).promise():n._processFile(o,e)};o.index=i,n._processing+=1,n._processingQueue=n._processingQueue.pipe(a,a).always(function(){n._processing-=1,0===n._processing&&n._trigger("processstop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=t.Deferred().resolveWith(this).promise()}})}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","load-image","load-image-meta","load-image-exif","load-image-ios","canvas-to-blob","./jquery.fileupload-process"],t):"object"==typeof exports?t(require("jquery"),require("load-image")):t(window.jQuery,window.loadImage)}(function(t,e){"use strict";t.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImageMetaData",disableImageHead:"@",disableExif:"@",disableExifThumbnail:"@",disableExifSub:"@",disableExifGps:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:!0,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"},{action:"deleteImageReferences",disabled:"@disableImageReferencesDeletion"}),t.widget("blueimp.fileupload",t.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png|svg\+xml)$/,loadImageMaxFileSize:1e7,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:!1,imageCrop:!1,disableImageResize:!0,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:!0,previewThumbnail:!0,previewCrop:!1,previewCanvas:!0},processActions:{loadImage:function(n,r){if(r.disabled)return n;var i=this,o=n.files[n.index],a=t.Deferred();return"number"===t.type(r.maxFileSize)&&o.size>r.maxFileSize||r.fileTypes&&!r.fileTypes.test(o.type)||!e(o,function(t){t.src&&(n.img=t),a.resolveWith(i,[n])},r)?n:a.promise()},resizeImage:function(n,r){if(r.disabled||!n.canvas&&!n.img)return n;r=t.extend({canvas:!0},r);var i,o=this,a=t.Deferred(),s=r.canvas&&n.canvas||n.img,u=function(t){t&&(t.width!==s.width||t.height!==s.height||r.forceResize)&&(n[t.getContext?"canvas":"img"]=t),n.preview=t,a.resolveWith(o,[n])};if(n.exif){if(r.orientation===!0&&(r.orientation=n.exif.get("Orientation")),r.thumbnail&&(i=n.exif.get("Thumbnail")))return e(i,u,r),a.promise();n.orientation?delete r.orientation:n.orientation=r.orientation}return s?(u(e.scale(s,r)),a.promise()):n},saveImage:function(e,n){if(!e.canvas||n.disabled)return e;var r=this,i=e.files[e.index],o=t.Deferred();return e.canvas.toBlob?(e.canvas.toBlob(function(t){t.name||(i.type===t.type?t.name=i.name:i.name&&(t.name=i.name.replace(/\..+$/,"."+t.type.substr(6)))),i.type!==t.type&&delete e.imageHead,e.files[e.index]=t,o.resolveWith(r,[e])},n.type||i.type,n.quality),o.promise()):e},loadImageMetaData:function(n,r){if(r.disabled)return n;var i=this,o=t.Deferred();return e.parseMetaData(n.files[n.index],function(e){t.extend(n,e),o.resolveWith(i,[n])},r),o.promise()},saveImageMetaData:function(t,e){if(!(t.imageHead&&t.canvas&&t.canvas.toBlob)||e.disabled)return t;var n=t.files[t.index],r=new Blob([t.imageHead,this._blobSlice.call(n,20)],{type:n.type});return r.name=n.name,t.files[t.index]=r,t},setImage:function(t,e){return t.preview&&!e.disabled&&(t.files[t.index][e.name||"preview"]=t.preview),t},deleteImageReferences:function(t,e){return e.disabled||(delete t.img,delete t.canvas,delete t.preview,delete t.imageHead),t}}})}),!function(){function t(t){return t&&(t.ownerDocument||t.document||t).documentElement}function e(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function n(t,e){return e>t?-1:t>e?1:t>=e?0:NaN}function r(t){return null===t?NaN:+t}function i(t){return!isNaN(t)}function o(t){return{left:function(e,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=e.length);i>r;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=e.length);i>r;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}function a(t){return t.length}function s(t){for(var e=1;t*e%1;)e*=10;return e}function u(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function l(){this._=Object.create(null)}function c(t){return(t+="")===ga||t[0]===ma?ma+t:t}function h(t){return(t+="")[0]===ma?t.slice(1):t}function f(t){return c(t)in this._}function d(t){return(t=c(t))in this._&&delete this._[t]}function p(){var t=[];for(var e in this._)t.push(h(e));return t}function g(){var t=0;for(var e in this._)++t;return t}function m(){for(var t in this._)return!1;return!0}function v(){this._=Object.create(null)}function y(t){return t}function b(t,e,n){return function(){var r=n.apply(e,arguments);return r===e?t:r}}function _(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,r=va.length;r>n;++n){var i=va[n]+e;if(i in t)return i}}function x(){}function w(){}function k(t){function e(){for(var e,r=n,i=-1,o=r.length;++i<o;)(e=r[i].on)&&e.apply(this,arguments);return t}var n=[],r=new l;return e.on=function(e,i){var o,a=r.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),r.remove(e)),i&&n.push(r.set(e,{on:i})),t)},e}function S(){na.event.preventDefault()}function C(){for(var t,e=na.event;t=e.sourceEvent;)e=t;return e}function E(t){for(var e=new w,n=0,r=arguments.length;++n<r;)e[arguments[n]]=k(e);return e.of=function(n,r){return function(i){try{var o=i.sourceEvent=na.event;i.target=t,na.event=i,e[i.type].apply(n,r)}finally{na.event=o}}},e}function M(t){return ba(t,ka),t}function A(t){return"function"==typeof t?t:function(){return _a(t,this)}}function P(t){return"function"==typeof t?t:function(){return xa(t,this)}}function j(t,e){function n(){this.removeAttribute(t)}function r(){this.removeAttributeNS(t.space,t.local)}function i(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function a(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=na.ns.qualify(t),null==e?t.local?r:n:"function"==typeof e?t.local?s:a:t.local?o:i}function T(t){return t.trim().replace(/\s+/g," ")}function N(t){return new RegExp("(?:^|\\s+)"+na.requote(t)+"(?:\\s+|$)","g")}function $(t){return(t+"").trim().split(/^|\s+/)}function I(t,e){function n(){for(var n=-1;++n<i;)t[n](this,e)}function r(){for(var n=-1,r=e.apply(this,arguments);++n<i;)t[n](this,r)}t=$(t).map(L);var i=t.length;return"function"==typeof e?r:n}function L(t){var e=N(t);return function(n,r){if(i=n.classList)return r?i.add(t):i.remove(t);var i=n.getAttribute("class")||"";r?(e.lastIndex=0,e.test(i)||n.setAttribute("class",T(i+" "+t))):n.setAttribute("class",T(i.replace(e," ")))}}function O(t,e,n){function r(){this.style.removeProperty(t)}function i(){this.style.setProperty(t,e,n)}function o(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}return null==e?r:"function"==typeof e?o:i}function D(t,e){function n(){delete this[t]}function r(){this[t]=e}function i(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?i:r}function z(t){function e(){var e=this.ownerDocument,n=this.namespaceURI;return n?e.createElementNS(n,t):e.createElement(t)}function n(){return this.ownerDocument.createElementNS(t.space,t.local)}return"function"==typeof t?t:(t=na.ns.qualify(t)).local?n:e}function F(){var t=this.parentNode;t&&t.removeChild(this)}function R(t){return{__data__:t}}function B(t){return function(){return wa(this,t)}}function q(t){return arguments.length||(t=n),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function V(t,e){for(var n=0,r=t.length;r>n;n++)for(var i,o=t[n],a=0,s=o.length;s>a;a++)(i=o[a])&&e(i,a,n);return t}function H(t){return ba(t,Ca),t}function U(t){var e,n;return function(r,i,o){var a,s=t[o].update,u=s.length;for(o!=n&&(n=o,e=0),i>=e&&(e=i+1);!(a=s[e])&&++e<u;);return a}}function G(t,e,n){function r(){var e=this[a];e&&(this.removeEventListener(t,e,e.$),delete this[a])}function i(){var i=u(e,ia(arguments));r.call(this),this.addEventListener(t,this[a]=i,i.$=n),i._=e}function o(){var e,n=new RegExp("^__on([^.]+)"+na.requote(t)+"$");for(var r in this)if(e=r.match(n)){var i=this[r];this.removeEventListener(e[1],i,i.$),delete this[r]}}var a="__on"+t,s=t.indexOf("."),u=W;s>0&&(t=t.slice(0,s));var l=Ea.get(t);return l&&(t=l,u=Y),s?e?i:r:e?x:o}function W(t,e){return function(n){var r=na.event;na.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{na.event=r}}}function Y(t,e){var n=W(t,e);return function(t){var e=this,r=t.relatedTarget;r&&(r===e||8&r.compareDocumentPosition(e))||n.call(e,t)}}function X(n){var r=".dragsuppress-"+ ++Aa,i="click"+r,o=na.select(e(n)).on("touchmove"+r,S).on("dragstart"+r,S).on("selectstart"+r,S);if(null==Ma&&(Ma="onselectstart"in n?!1:_(n.style,"userSelect")),Ma){var a=t(n).style,s=a[Ma];a[Ma]="none"}return function(t){if(o.on(r,null),Ma&&(a[Ma]=s),t){var e=function(){o.on(i,null)};o.on(i,function(){S(),e()},!0),setTimeout(e,0)}}}function J(t,n){n.changedTouches&&(n=n.changedTouches[0]);var r=t.ownerSVGElement||t;if(r.createSVGPoint){var i=r.createSVGPoint();if(0>Pa){var o=e(t);if(o.scrollX||o.scrollY){r=na.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var a=r[0][0].getScreenCTM();Pa=!(a.f||a.e),r.remove()}}return Pa?(i.x=n.pageX,i.y=n.pageY):(i.x=n.clientX,i.y=n.clientY),i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var s=t.getBoundingClientRect();return[n.clientX-s.left-t.clientLeft,n.clientY-s.top-t.clientTop]}function Q(){return na.event.changedTouches[0].identifier}function K(t){return t>0?1:0>t?-1:0}function Z(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function tt(t){return t>1?0:-1>t?Na:Math.acos(t)}function et(t){return t>1?La:-1>t?-La:Math.asin(t)}function nt(t){return((t=Math.exp(t))-1/t)/2}function rt(t){return((t=Math.exp(t))+1/t)/2}function it(t){return((t=Math.exp(2*t))-1)/(t+1)}function ot(t){return(t=Math.sin(t/2))*t}function at(){}function st(t,e,n){return this instanceof st?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof st?new st(t.h,t.s,t.l):xt(""+t,wt,st):new st(t,e,n)}function ut(t,e,n){function r(t){return t>360?t-=360:0>t&&(t+=360),60>t?o+(a-o)*t/60:180>t?a:240>t?o+(a-o)*(240-t)/60:o}function i(t){return Math.round(255*r(t))}var o,a;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,a=.5>=n?n*(1+e):n+e-n*e,o=2*n-a,new vt(i(t+120),i(t),i(t-120))}function lt(t,e,n){return this instanceof lt?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof lt?new lt(t.h,t.c,t.l):t instanceof ht?dt(t.l,t.a,t.b):dt((t=kt((t=na.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new lt(t,e,n)}function ct(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ht(n,Math.cos(t*=Oa)*e,Math.sin(t)*e)}function ht(t,e,n){return this instanceof ht?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof ht?new ht(t.l,t.a,t.b):t instanceof lt?ct(t.h,t.c,t.l):kt((t=vt(t)).r,t.g,t.b):new ht(t,e,n)}function ft(t,e,n){var r=(t+16)/116,i=r+e/500,o=r-n/200;return i=pt(i)*Wa,r=pt(r)*Ya,o=pt(o)*Xa,new vt(mt(3.2404542*i-1.5371385*r-.4985314*o),mt(-.969266*i+1.8760108*r+.041556*o),mt(.0556434*i-.2040259*r+1.0572252*o))}function dt(t,e,n){return t>0?new lt(Math.atan2(n,e)*Da,Math.sqrt(e*e+n*n),t):new lt(NaN,NaN,t)}function pt(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function gt(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function mt(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function vt(t,e,n){return this instanceof vt?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof vt?new vt(t.r,t.g,t.b):xt(""+t,vt,ut):new vt(t,e,n)}function yt(t){return new vt(t>>16,t>>8&255,255&t)}function bt(t){return yt(t)+""}function _t(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function xt(t,e,n){var r,i,o,a=0,s=0,u=0;if(r=/([a-z]+)\((.*)\)/i.exec(t))switch(i=r[2].split(","),r[1]){case"hsl":return n(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return e(Ct(i[0]),Ct(i[1]),Ct(i[2]))}return(o=Ka.get(t.toLowerCase()))?e(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&o)>>4,a=a>>4|a,s=240&o,s=s>>4|s,u=15&o,u=u<<4|u):7===t.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,u=255&o)),e(a,s,u))}function wt(t,e,n){var r,i,o=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),s=a-o,u=(a+o)/2;return s?(i=.5>u?s/(a+o):s/(2-a-o),r=t==a?(e-n)/s+(n>e?6:0):e==a?(n-t)/s+2:(t-e)/s+4,r*=60):(r=NaN,i=u>0&&1>u?0:r),new st(r,i,u)}function kt(t,e,n){t=St(t),e=St(e),n=St(n);var r=gt((.4124564*t+.3575761*e+.1804375*n)/Wa),i=gt((.2126729*t+.7151522*e+.072175*n)/Ya),o=gt((.0193339*t+.119192*e+.9503041*n)/Xa);return ht(116*i-16,500*(r-i),200*(i-o))}function St(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ct(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Et(t){return"function"==typeof t?t:function(){return t}}function Mt(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),At(e,n,t,r)}}function At(t,e,n,r){function i(){var t,e=u.status;if(!e&&jt(u)||e>=200&&300>e||304===e){try{t=n.call(o,u)}catch(r){return void a.error.call(o,r)}a.load.call(o,t)}else a.error.call(o,u)}var o={},a=na.dispatch("beforesend","progress","load","error"),s={},u=new XMLHttpRequest,l=null;return!this.XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(t)||(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=i:u.onreadystatechange=function(){u.readyState>3&&i()},u.onprogress=function(t){var e=na.event;na.event=t;try{a.progress.call(o,u)}finally{na.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?s[t]:(null==e?delete s[t]:s[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(l=t,o):l},o.response=function(t){return n=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(ia(arguments)))}}),o.send=function(n,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),u.open(n,t,!0),null==e||"accept"in s||(s.accept=e+",*/*"),u.setRequestHeader)for(var c in s)u.setRequestHeader(c,s[c]);return null!=e&&u.overrideMimeType&&u.overrideMimeType(e),null!=l&&(u.responseType=l),null!=i&&o.on("error",i).on("load",function(t){i(null,t)}),a.beforesend.call(o,u),u.send(null==r?null:r),o},o.abort=function(){return u.abort(),o},na.rebind(o,a,"on"),null==r?o:o.get(Pt(r))}function Pt(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function jt(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Tt(){var t=Nt(),e=$t()-t;e>24?(isFinite(e)&&(clearTimeout(ns),ns=setTimeout(Tt,e)),es=0):(es=1,is(Tt))}function Nt(){var t=Date.now();for(rs=Za;rs;)t>=rs.t&&(rs.f=rs.c(t-rs.t)),rs=rs.n;return t}function $t(){for(var t,e=Za,n=1/0;e;)e.f?e=t?t.n=e.n:Za=e.n:(e.t<n&&(n=e.t),e=(t=e).n);return ts=t,n}function It(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Lt(t,e){var n=Math.pow(10,3*pa(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function Ot(t){var e=t.decimal,n=t.thousands,r=t.grouping,i=t.currency,o=r&&n?function(t,e){for(var i=t.length,o=[],a=0,s=r[0],u=0;i>0&&s>0&&(u+s+1>e&&(s=Math.max(1,e-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>e));)s=r[a=(a+1)%r.length];return o.reverse().join(n)}:y;return function(t){var n=as.exec(t),r=n[1]||" ",a=n[2]||">",s=n[3]||"-",u=n[4]||"",l=n[5],c=+n[6],h=n[7],f=n[8],d=n[9],p=1,g="",m="",v=!1,y=!0;switch(f&&(f=+f.substring(1)),(l||"0"===r&&"="===a)&&(l=r="0",a="="),d){case"n":h=!0,d="g";break;case"%":p=100,m="%",d="f";break;case"p":p=100,m="%",d="r";break;case"b":case"o":case"x":case"X":"#"===u&&(g="0"+d.toLowerCase());case"c":y=!1;case"d":v=!0,f=0;break;case"s":p=-1,d="r"}"$"===u&&(g=i[0],m=i[1]),"r"!=d||f||(d="g"),null!=f&&("g"==d?f=Math.max(1,Math.min(21,f)):("e"==d||"f"==d)&&(f=Math.max(0,Math.min(20,f)))),d=ss.get(d)||Dt;var b=l&&h;return function(t){var n=m;if(v&&t%1)return"";var i=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===s?"":s;if(0>p){var u=na.formatPrefix(t,f);t=u.scale(t),n=u.symbol+m}else t*=p;t=d(t,f);var _,x,w=t.lastIndexOf(".");if(0>w){var k=y?t.lastIndexOf("e"):-1;0>k?(_=t,x=""):(_=t.substring(0,k),x=t.substring(k))}else _=t.substring(0,w),x=e+t.substring(w+1);!l&&h&&(_=o(_,1/0));var S=g.length+_.length+x.length+(b?0:i.length),C=c>S?new Array(S=c-S+1).join(r):"";return b&&(_=o(C+_,C.length?c-x.length:1/0)),i+=g,t=_+x,("<"===a?i+t+C:">"===a?C+i+t:"^"===a?C.substring(0,S>>=1)+i+t+C.substring(S):i+(b?t:C+t))+n}}}function Dt(t){return t+""}function zt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ft(t,e,n){function r(e){var n=t(e),r=o(n,1);return r-e>e-n?n:r}function i(n){return e(n=t(new ls(n-1)),1),n}function o(t,n){return e(t=new ls(+t),n),t}function a(t,r,o){var a=i(t),s=[];if(o>1)for(;r>a;)n(a)%o||s.push(new Date(+a)),e(a,1);else for(;r>a;)s.push(new Date(+a)),e(a,1);return s}function s(t,e,n){try{ls=zt;var r=new zt;return r._=t,a(r,e,n)}finally{ls=Date}}t.floor=t,t.round=r,t.ceil=i,t.offset=o,t.range=a;var u=t.utc=Rt(t);return u.floor=u,u.round=Rt(r),u.ceil=Rt(i),u.offset=Rt(o),u.range=s,t}function Rt(t){return function(e,n){try{ls=zt;var r=new zt;return r._=e,t(r,n)._}finally{ls=Date}}}function Bt(t){function e(t){function e(e){for(var n,i,o,a=[],s=-1,u=0;++s<r;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=hs[n=t.charAt(++s)])&&(n=t.charAt(++s)),(o=A[n])&&(n=o(e,null==i?"e"===n?" ":"0":i)),a.push(n),u=s+1);return a.push(t.slice(u,s)),a.join("")}var r=t.length;return e.parse=function(e){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=n(r,t,e,0);if(i!=e.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var o=null!=r.Z&&ls!==zt,a=new(o?zt:ls);
return"j"in r?a.setFullYear(r.y,0,r.j):"w"in r&&("W"in r||"U"in r)?(a.setFullYear(r.y,0,1),a.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(a.getDay()+5)%7:r.w+7*r.U-(a.getDay()+6)%7)):a.setFullYear(r.y,r.m,r.d),a.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),o?a._:a},e.toString=function(){return t},e}function n(t,e,n,r){for(var i,o,a,s=0,u=e.length,l=n.length;u>s;){if(r>=l)return-1;if(i=e.charCodeAt(s++),37===i){if(a=e.charAt(s++),o=P[a in hs?e.charAt(s++):a],!o||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function r(t,e,n){w.lastIndex=0;var r=w.exec(e.slice(n));return r?(t.w=k.get(r[0].toLowerCase()),n+r[0].length):-1}function i(t,e,n){_.lastIndex=0;var r=_.exec(e.slice(n));return r?(t.w=x.get(r[0].toLowerCase()),n+r[0].length):-1}function o(t,e,n){E.lastIndex=0;var r=E.exec(e.slice(n));return r?(t.m=M.get(r[0].toLowerCase()),n+r[0].length):-1}function a(t,e,n){S.lastIndex=0;var r=S.exec(e.slice(n));return r?(t.m=C.get(r[0].toLowerCase()),n+r[0].length):-1}function s(t,e,r){return n(t,A.c.toString(),e,r)}function u(t,e,r){return n(t,A.x.toString(),e,r)}function l(t,e,r){return n(t,A.X.toString(),e,r)}function c(t,e,n){var r=b.get(e.slice(n,n+=2).toLowerCase());return null==r?-1:(t.p=r,n)}var h=t.dateTime,f=t.date,d=t.time,p=t.periods,g=t.days,m=t.shortDays,v=t.months,y=t.shortMonths;e.utc=function(t){function n(t){try{ls=zt;var e=new ls;return e._=t,r(e)}finally{ls=Date}}var r=e(t);return n.parse=function(t){try{ls=zt;var e=r.parse(t);return e&&e._}finally{ls=Date}},n.toString=r.toString,n},e.multi=e.utc.multi=se;var b=na.map(),_=Vt(g),x=Ht(g),w=Vt(m),k=Ht(m),S=Vt(v),C=Ht(v),E=Vt(y),M=Ht(y);p.forEach(function(t,e){b.set(t.toLowerCase(),e)});var A={a:function(t){return m[t.getDay()]},A:function(t){return g[t.getDay()]},b:function(t){return y[t.getMonth()]},B:function(t){return v[t.getMonth()]},c:e(h),d:function(t,e){return qt(t.getDate(),e,2)},e:function(t,e){return qt(t.getDate(),e,2)},H:function(t,e){return qt(t.getHours(),e,2)},I:function(t,e){return qt(t.getHours()%12||12,e,2)},j:function(t,e){return qt(1+us.dayOfYear(t),e,3)},L:function(t,e){return qt(t.getMilliseconds(),e,3)},m:function(t,e){return qt(t.getMonth()+1,e,2)},M:function(t,e){return qt(t.getMinutes(),e,2)},p:function(t){return p[+(t.getHours()>=12)]},S:function(t,e){return qt(t.getSeconds(),e,2)},U:function(t,e){return qt(us.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return qt(us.mondayOfYear(t),e,2)},x:e(f),X:e(d),y:function(t,e){return qt(t.getFullYear()%100,e,2)},Y:function(t,e){return qt(t.getFullYear()%1e4,e,4)},Z:oe,"%":function(){return"%"}},P={a:r,A:i,b:o,B:a,c:s,d:Zt,e:Zt,H:ee,I:ee,j:te,L:ie,m:Kt,M:ne,p:c,S:re,U:Gt,w:Ut,W:Wt,x:u,X:l,y:Xt,Y:Yt,Z:Jt,"%":ae};return e}function qt(t,e,n){var r=0>t?"-":"",i=(r?-t:t)+"",o=i.length;return r+(n>o?new Array(n-o+1).join(e)+i:i)}function Vt(t){return new RegExp("^(?:"+t.map(na.requote).join("|")+")","i")}function Ht(t){for(var e=new l,n=-1,r=t.length;++n<r;)e.set(t[n].toLowerCase(),n);return e}function Ut(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Gt(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function Wt(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function Yt(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Xt(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+2));return r?(t.y=Qt(+r[0]),n+r[0].length):-1}function Jt(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function Qt(t){return t+(t>68?1900:2e3)}function Kt(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Zt(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function te(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+3));return r?(t.j=+r[0],n+r[0].length):-1}function ee(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ne(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function re(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function ie(t,e,n){fs.lastIndex=0;var r=fs.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function oe(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",r=pa(e)/60|0,i=pa(e)%60;return n+qt(r,"0",2)+qt(i,"0",2)}function ae(t,e,n){ds.lastIndex=0;var r=ds.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function se(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,r=t[n];!r[1](e);)r=t[++n];return r[0](e)}}function ue(){}function le(t,e,n){var r=n.s=t+e,i=r-t,o=r-i;n.t=t-o+(e-i)}function ce(t,e){t&&vs.hasOwnProperty(t.type)&&vs[t.type](t,e)}function he(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function fe(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)he(t[n],e,1);e.polygonEnd()}function de(){function t(t,e){t*=Oa,e=e*Oa/2+Na/4;var n=t-r,a=n>=0?1:-1,s=a*n,u=Math.cos(e),l=Math.sin(e),c=o*l,h=i*u+c*Math.cos(s),f=c*a*Math.sin(s);bs.add(Math.atan2(f,h)),r=t,i=u,o=l}var e,n,r,i,o;_s.point=function(a,s){_s.point=t,r=(e=a)*Oa,i=Math.cos(s=(n=s)*Oa/2+Na/4),o=Math.sin(s)},_s.lineEnd=function(){t(e,n)}}function pe(t){var e=t[0],n=t[1],r=Math.cos(n);return[r*Math.cos(e),r*Math.sin(e),Math.sin(n)]}function ge(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function me(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ve(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function ye(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function be(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function _e(t){return[Math.atan2(t[1],t[0]),et(t[2])]}function xe(t,e){return pa(t[0]-e[0])<ja&&pa(t[1]-e[1])<ja}function we(t,e){t*=Oa;var n=Math.cos(e*=Oa);ke(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function ke(t,e,n){++xs,ks+=(t-ks)/xs,Ss+=(e-Ss)/xs,Cs+=(n-Cs)/xs}function Se(){function t(t,i){t*=Oa;var o=Math.cos(i*=Oa),a=o*Math.cos(t),s=o*Math.sin(t),u=Math.sin(i),l=Math.atan2(Math.sqrt((l=n*u-r*s)*l+(l=r*a-e*u)*l+(l=e*s-n*a)*l),e*a+n*s+r*u);ws+=l,Es+=l*(e+(e=a)),Ms+=l*(n+(n=s)),As+=l*(r+(r=u)),ke(e,n,r)}var e,n,r;Ns.point=function(i,o){i*=Oa;var a=Math.cos(o*=Oa);e=a*Math.cos(i),n=a*Math.sin(i),r=Math.sin(o),Ns.point=t,ke(e,n,r)}}function Ce(){Ns.point=we}function Ee(){function t(t,e){t*=Oa;var n=Math.cos(e*=Oa),a=n*Math.cos(t),s=n*Math.sin(t),u=Math.sin(e),l=i*u-o*s,c=o*a-r*u,h=r*s-i*a,f=Math.sqrt(l*l+c*c+h*h),d=r*a+i*s+o*u,p=f&&-tt(d)/f,g=Math.atan2(f,d);Ps+=p*l,js+=p*c,Ts+=p*h,ws+=g,Es+=g*(r+(r=a)),Ms+=g*(i+(i=s)),As+=g*(o+(o=u)),ke(r,i,o)}var e,n,r,i,o;Ns.point=function(a,s){e=a,n=s,Ns.point=t,a*=Oa;var u=Math.cos(s*=Oa);r=u*Math.cos(a),i=u*Math.sin(a),o=Math.sin(s),ke(r,i,o)},Ns.lineEnd=function(){t(e,n),Ns.lineEnd=Ce,Ns.point=we}}function Me(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return n=e.invert(n,r),n&&t.invert(n[0],n[1])}),n}function Ae(){return!0}function Pe(t,e,n,r,i){var o=[],a=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],r=t[e];if(xe(n,r)){i.lineStart();for(var s=0;e>s;++s)i.point((n=t[s])[0],n[1]);return void i.lineEnd()}var u=new Te(n,t,null,!0),l=new Te(n,null,u,!1);u.o=l,o.push(u),a.push(l),u=new Te(r,t,null,!1),l=new Te(r,null,u,!0),u.o=l,o.push(u),a.push(l)}}),a.sort(e),je(o),je(a),o.length){for(var s=0,u=n,l=a.length;l>s;++s)a[s].e=u=!u;for(var c,h,f=o[0];;){for(var d=f,p=!0;d.v;)if((d=d.n)===f)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(var s=0,l=c.length;l>s;++s)i.point((h=c[s])[0],h[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(p){c=d.p.z;for(var s=c.length-1;s>=0;--s)i.point((h=c[s])[0],h[1])}else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,p=!p}while(!d.v);i.lineEnd()}}}function je(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function Te(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Ne(t,e,n,r){return function(i,o){function a(e,n){var r=i(e,n);t(e=r[0],n=r[1])&&o.point(e,n)}function s(t,e){var n=i(t,e);m.point(n[0],n[1])}function u(){y.point=s,m.lineStart()}function l(){y.point=a,m.lineEnd()}function c(t,e){g.push([t,e]);var n=i(t,e);_.point(n[0],n[1])}function h(){_.lineStart(),g=[]}function f(){c(g[0][0],g[0][1]),_.lineEnd();var t,e=_.clean(),n=b.buffer(),r=n.length;if(g.pop(),p.push(g),g=null,r)if(1&e){t=n[0];var i,r=t.length-1,a=-1;if(r>0){for(x||(o.polygonStart(),x=!0),o.lineStart();++a<r;)o.point((i=t[a])[0],i[1]);o.lineEnd()}}else r>1&&2&e&&n.push(n.pop().concat(n.shift())),d.push(n.filter($e))}var d,p,g,m=e(o),v=i.invert(r[0],r[1]),y={point:a,lineStart:u,lineEnd:l,polygonStart:function(){y.point=c,y.lineStart=h,y.lineEnd=f,d=[],p=[]},polygonEnd:function(){y.point=a,y.lineStart=u,y.lineEnd=l,d=na.merge(d);var t=Fe(v,p);d.length?(x||(o.polygonStart(),x=!0),Pe(d,Le,t,n,o)):t&&(x||(o.polygonStart(),x=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),x&&(o.polygonEnd(),x=!1),d=p=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}},b=Ie(),_=e(b),x=!1;return y}}function $e(t){return t.length>1}function Ie(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:x,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Le(t,e){return((t=t.x)[0]<0?t[1]-La-ja:La-t[1])-((e=e.x)[0]<0?e[1]-La-ja:La-e[1])}function Oe(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?Na:-Na,u=pa(o-n);pa(u-Na)<ja?(t.point(n,r=(r+a)/2>0?La:-La),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&u>=Na&&(pa(n-i)<ja&&(n-=i*ja),pa(o-s)<ja&&(o-=s*ja),r=De(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}function De(t,e,n,r){var i,o,a=Math.sin(t-n);return pa(a)>ja?Math.atan((Math.sin(e)*(o=Math.cos(r))*Math.sin(n)-Math.sin(r)*(i=Math.cos(e))*Math.sin(t))/(i*o*a)):(e+r)/2}function ze(t,e,n,r){var i;if(null==t)i=n*La,r.point(-Na,i),r.point(0,i),r.point(Na,i),r.point(Na,0),r.point(Na,-i),r.point(0,-i),r.point(-Na,-i),r.point(-Na,0),r.point(-Na,i);else if(pa(t[0]-e[0])>ja){var o=t[0]<e[0]?Na:-Na;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}function Fe(t,e){var n=t[0],r=t[1],i=[Math.sin(n),-Math.cos(n),0],o=0,a=0;bs.reset();for(var s=0,u=e.length;u>s;++s){var l=e[s],c=l.length;if(c)for(var h=l[0],f=h[0],d=h[1]/2+Na/4,p=Math.sin(d),g=Math.cos(d),m=1;;){m===c&&(m=0),t=l[m];var v=t[0],y=t[1]/2+Na/4,b=Math.sin(y),_=Math.cos(y),x=v-f,w=x>=0?1:-1,k=w*x,S=k>Na,C=p*b;if(bs.add(Math.atan2(C*w*Math.sin(k),g*_+C*Math.cos(k))),o+=S?x+w*$a:x,S^f>=n^v>=n){var E=me(pe(h),pe(t));be(E);var M=me(i,E);be(M);var A=(S^x>=0?-1:1)*et(M[2]);(r>A||r===A&&(E[0]||E[1]))&&(a+=S^x>=0?1:-1)}if(!m++)break;f=v,p=b,g=_,h=t}}return(-ja>o||ja>o&&0>bs)^1&a}function Re(t){function e(t,e){return Math.cos(t)*Math.cos(e)>o}function n(t){var n,o,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(h,f){var d,p=[h,f],g=e(h,f),m=a?g?0:i(h,f):g?i(h+(0>h?Na:-Na),f):0;if(!n&&(l=u=g)&&t.lineStart(),g!==u&&(d=r(n,p),(xe(n,d)||xe(p,d))&&(p[0]+=ja,p[1]+=ja,g=e(p[0],p[1]))),g!==u)c=0,g?(t.lineStart(),d=r(p,n),t.point(d[0],d[1])):(d=r(n,p),t.point(d[0],d[1]),t.lineEnd()),n=d;else if(s&&n&&a^g){var v;m&o||!(v=r(p,n,!0))||(c=0,a?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!g||n&&xe(n,p)||t.point(p[0],p[1]),n=p,u=g,o=m},lineEnd:function(){u&&t.lineEnd(),n=null},clean:function(){return c|(l&&u)<<1}}}function r(t,e,n){var r=pe(t),i=pe(e),a=[1,0,0],s=me(r,i),u=ge(s,s),l=s[0],c=u-l*l;if(!c)return!n&&t;var h=o*u/c,f=-o*l/c,d=me(a,s),p=ye(a,h),g=ye(s,f);ve(p,g);var m=d,v=ge(p,m),y=ge(m,m),b=v*v-y*(ge(p,p)-1);if(!(0>b)){var _=Math.sqrt(b),x=ye(m,(-v-_)/y);if(ve(x,p),x=_e(x),!n)return x;var w,k=t[0],S=e[0],C=t[1],E=e[1];k>S&&(w=k,k=S,S=w);var M=S-k,A=pa(M-Na)<ja,P=A||ja>M;if(!A&&C>E&&(w=C,C=E,E=w),P?A?C+E>0^x[1]<(pa(x[0]-k)<ja?C:E):C<=x[1]&&x[1]<=E:M>Na^(k<=x[0]&&x[0]<=S)){var j=ye(m,(-v+_)/y);return ve(j,p),[x,_e(j)]}}}function i(e,n){var r=a?t:Na-t,i=0;return-r>e?i|=1:e>r&&(i|=2),-r>n?i|=4:n>r&&(i|=8),i}var o=Math.cos(t),a=o>0,s=pa(o)>ja,u=pn(t,6*Oa);return Ne(e,n,u,a?[0,-t]:[-Na,t-Na])}function Be(t,e,n,r){return function(i){var o,a=i.a,s=i.b,u=a.x,l=a.y,c=s.x,h=s.y,f=0,d=1,p=c-u,g=h-l;if(o=t-u,p||!(o>0)){if(o/=p,0>p){if(f>o)return;d>o&&(d=o)}else if(p>0){if(o>d)return;o>f&&(f=o)}if(o=n-u,p||!(0>o)){if(o/=p,0>p){if(o>d)return;o>f&&(f=o)}else if(p>0){if(f>o)return;d>o&&(d=o)}if(o=e-l,g||!(o>0)){if(o/=g,0>g){if(f>o)return;d>o&&(d=o)}else if(g>0){if(o>d)return;o>f&&(f=o)}if(o=r-l,g||!(0>o)){if(o/=g,0>g){if(o>d)return;o>f&&(f=o)}else if(g>0){if(f>o)return;d>o&&(d=o)}return f>0&&(i.a={x:u+f*p,y:l+f*g}),1>d&&(i.b={x:u+d*p,y:l+d*g}),i}}}}}}function qe(t,e,n,r){function i(r,i){return pa(r[0]-t)<ja?i>0?0:3:pa(r[0]-n)<ja?i>0?2:1:pa(r[1]-e)<ja?i>0?1:0:i>0?3:2}function o(t,e){return a(t.x,e.x)}function a(t,e){var n=i(t,1),r=i(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){function u(t){for(var e=0,n=m.length,r=t[1],i=0;n>i;++i)for(var o,a=1,s=m[i],u=s.length,l=s[0];u>a;++a)o=s[a],l[1]<=r?o[1]>r&&Z(l,o,t)>0&&++e:o[1]<=r&&Z(l,o,t)<0&&--e,l=o;return 0!==e}function l(o,s,u,l){var c=0,h=0;if(null==o||(c=i(o,u))!==(h=i(s,u))||a(o,s)<0^u>0){do l.point(0===c||3===c?t:n,c>1?r:e);while((c=(c+u+4)%4)!==h)}else l.point(s[0],s[1])}function c(i,o){return i>=t&&n>=i&&o>=e&&r>=o}function h(t,e){c(t,e)&&s.point(t,e)}function f(){P.point=p,m&&m.push(v=[]),S=!0,k=!1,x=w=NaN}function d(){g&&(p(y,b),_&&k&&M.rejoin(),g.push(M.buffer())),P.point=h,k&&s.lineEnd()}function p(t,e){t=Math.max(-Is,Math.min(Is,t)),e=Math.max(-Is,Math.min(Is,e));var n=c(t,e);if(m&&v.push([t,e]),S)y=t,b=e,_=n,S=!1,n&&(s.lineStart(),s.point(t,e));else if(n&&k)s.point(t,e);else{var r={a:{x:x,y:w},b:{x:t,y:e}};A(r)?(k||(s.lineStart(),s.point(r.a.x,r.a.y)),s.point(r.b.x,r.b.y),n||s.lineEnd(),C=!1):n&&(s.lineStart(),s.point(t,e),C=!1)}x=t,w=e,k=n}var g,m,v,y,b,_,x,w,k,S,C,E=s,M=Ie(),A=Be(t,e,n,r),P={point:h,lineStart:f,lineEnd:d,polygonStart:function(){s=M,g=[],m=[],C=!0},polygonEnd:function(){s=E,g=na.merge(g);var e=u([t,r]),n=C&&e,i=g.length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),l(null,null,1,s),s.lineEnd()),i&&Pe(g,o,e,l,s),s.polygonEnd()),g=m=v=null}};return P}}function Ve(t){var e=0,n=Na/3,r=an(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*Na/180,n=t[1]*Na/180):[e/Na*180,n/Na*180]},i}function He(t,e){function n(t,e){var n=Math.sqrt(o-2*i*Math.sin(e))/i;return[n*Math.sin(t*=i),a-n*Math.cos(t)]}var r=Math.sin(t),i=(r+Math.sin(e))/2,o=1+r*(2*i-r),a=Math.sqrt(o)/i;return n.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/i,et((o-(t*t+n*n)*i*i)/(2*i))]},n}function Ue(){function t(t,e){Os+=i*t-r*e,r=t,i=e}var e,n,r,i;Bs.point=function(o,a){Bs.point=t,e=r=o,n=i=a},Bs.lineEnd=function(){t(e,n)}}function Ge(t,e){Ds>t&&(Ds=t),t>Fs&&(Fs=t),zs>e&&(zs=e),e>Rs&&(Rs=e)}function We(){function t(t,e){a.push("M",t,",",e,o)}function e(t,e){a.push("M",t,",",e),s.point=n}function n(t,e){a.push("L",t,",",e)}function r(){s.point=t}function i(){a.push("Z")}var o=Ye(4.5),a=[],s={point:t,lineStart:function(){s.point=e},lineEnd:r,polygonStart:function(){s.lineEnd=i},polygonEnd:function(){s.lineEnd=r,s.point=t},pointRadius:function(t){return o=Ye(t),s},result:function(){if(a.length){var t=a.join("");return a=[],t}}};return s}function Ye(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Xe(t,e){ks+=t,Ss+=e,++Cs}function Je(){function t(t,r){var i=t-e,o=r-n,a=Math.sqrt(i*i+o*o);Es+=a*(e+t)/2,Ms+=a*(n+r)/2,As+=a,Xe(e=t,n=r)}var e,n;Vs.point=function(r,i){Vs.point=t,Xe(e=r,n=i)}}function Qe(){Vs.point=Xe}function Ke(){function t(t,e){var n=t-r,o=e-i,a=Math.sqrt(n*n+o*o);Es+=a*(r+t)/2,Ms+=a*(i+e)/2,As+=a,a=i*t-r*e,Ps+=a*(r+t),js+=a*(i+e),Ts+=3*a,Xe(r=t,i=e)}var e,n,r,i;Vs.point=function(o,a){Vs.point=t,Xe(e=r=o,n=i=a)},Vs.lineEnd=function(){t(e,n)}}function Ze(t){function e(e,n){t.moveTo(e+a,n),t.arc(e,n,a,0,$a)}function n(e,n){t.moveTo(e,n),s.point=r}function r(e,n){t.lineTo(e,n)}function i(){s.point=e}function o(){t.closePath()}var a=4.5,s={point:e,lineStart:function(){s.point=n},lineEnd:i,polygonStart:function(){s.lineEnd=o},polygonEnd:function(){s.lineEnd=i,s.point=e},pointRadius:function(t){return a=t,s},result:x};return s}function tn(t){function e(t){return(s?r:n)(t)}function n(e){return rn(e,function(n,r){n=t(n,r),e.point(n[0],n[1])})}function r(e){function n(n,r){n=t(n,r),e.point(n[0],n[1])}function r(){b=NaN,S.point=o,e.lineStart()}function o(n,r){var o=pe([n,r]),a=t(n,r);i(b,_,y,x,w,k,b=a[0],_=a[1],y=n,x=o[0],w=o[1],k=o[2],s,e),e.point(b,_)}function a(){S.point=n,e.lineEnd()}function u(){r(),S.point=l,S.lineEnd=c}function l(t,e){o(h=t,f=e),d=b,p=_,g=x,m=w,v=k,S.point=o}function c(){i(b,_,y,x,w,k,d,p,h,g,m,v,s,e),S.lineEnd=a,a()}var h,f,d,p,g,m,v,y,b,_,x,w,k,S={point:n,lineStart:r,lineEnd:a,polygonStart:function(){e.polygonStart(),S.lineStart=u},polygonEnd:function(){e.polygonEnd(),S.lineStart=r}};return S}function i(e,n,r,s,u,l,c,h,f,d,p,g,m,v){var y=c-e,b=h-n,_=y*y+b*b;if(_>4*o&&m--){var x=s+d,w=u+p,k=l+g,S=Math.sqrt(x*x+w*w+k*k),C=Math.asin(k/=S),E=pa(pa(k)-1)<ja||pa(r-f)<ja?(r+f)/2:Math.atan2(w,x),M=t(E,C),A=M[0],P=M[1],j=A-e,T=P-n,N=b*j-y*T;(N*N/_>o||pa((y*j+b*T)/_-.5)>.3||a>s*d+u*p+l*g)&&(i(e,n,r,s,u,l,A,P,E,x/=S,w/=S,k,m,v),v.point(A,P),i(A,P,E,x,w,k,c,h,f,d,p,g,m,v))}}var o=.5,a=Math.cos(30*Oa),s=16;return e.precision=function(t){return arguments.length?(s=(o=t*t)>0&&16,e):Math.sqrt(o)},e}function en(t){var e=tn(function(e,n){return t([e*Da,n*Da])});return function(t){return sn(e(t))}}function nn(t){this.stream=t}function rn(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function on(t){return an(function(){return t})()}function an(t){function e(t){return t=s(t[0]*Oa,t[1]*Oa),[t[0]*f+u,l-t[1]*f]}function n(t){return t=s.invert((t[0]-u)/f,(l-t[1])/f),t&&[t[0]*Da,t[1]*Da]}function r(){s=Me(a=cn(v,b,_),o);var t=o(g,m);return u=d-t[0]*f,l=p+t[1]*f,i()}function i(){return c&&(c.valid=!1,c=null),e}var o,a,s,u,l,c,h=tn(function(t,e){return t=o(t,e),[t[0]*f+u,l-t[1]*f]}),f=150,d=480,p=250,g=0,m=0,v=0,b=0,_=0,x=$s,w=y,k=null,S=null;return e.stream=function(t){return c&&(c.valid=!1),c=sn(x(a,h(w(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(x=null==t?(k=t,$s):Re((k=+t)*Oa),i()):k},e.clipExtent=function(t){return arguments.length?(S=t,w=t?qe(t[0][0],t[0][1],t[1][0],t[1][1]):y,i()):S},e.scale=function(t){return arguments.length?(f=+t,r()):f},e.translate=function(t){return arguments.length?(d=+t[0],p=+t[1],r()):[d,p]},e.center=function(t){return arguments.length?(g=t[0]%360*Oa,m=t[1]%360*Oa,r()):[g*Da,m*Da]},e.rotate=function(t){return arguments.length?(v=t[0]%360*Oa,b=t[1]%360*Oa,_=t.length>2?t[2]%360*Oa:0,r()):[v*Da,b*Da,_*Da]},na.rebind(e,h,"precision"),function(){return o=t.apply(this,arguments),e.invert=o.invert&&n,r()}}function sn(t){return rn(t,function(e,n){t.point(e*Oa,n*Oa)})}function un(t,e){return[t,e]}function ln(t,e){return[t>Na?t-$a:-Na>t?t+$a:t,e]}function cn(t,e,n){return t?e||n?Me(fn(t),dn(e,n)):fn(t):e||n?dn(e,n):ln}function hn(t){return function(e,n){return e+=t,[e>Na?e-$a:-Na>e?e+$a:e,n]}}function fn(t){var e=hn(t);return e.invert=hn(-t),e}function dn(t,e){function n(t,e){var n=Math.cos(e),s=Math.cos(t)*n,u=Math.sin(t)*n,l=Math.sin(e),c=l*r+s*i;return[Math.atan2(u*o-c*a,s*r-l*i),et(c*o+u*a)]}var r=Math.cos(t),i=Math.sin(t),o=Math.cos(e),a=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),s=Math.cos(t)*n,u=Math.sin(t)*n,l=Math.sin(e),c=l*o-u*a;return[Math.atan2(u*o+l*a,s*r+c*i),et(c*r-s*i)]},n}function pn(t,e){var n=Math.cos(t),r=Math.sin(t);return function(i,o,a,s){var u=a*e;null!=i?(i=gn(n,i),o=gn(n,o),(a>0?o>i:i>o)&&(i+=a*$a)):(i=t+a*$a,o=t-.5*u);for(var l,c=i;a>0?c>o:o>c;c-=u)s.point((l=_e([n,-r*Math.cos(c),-r*Math.sin(c)]))[0],l[1])}}function gn(t,e){var n=pe(e);n[0]-=t,be(n);var r=tt(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-ja)%(2*Math.PI)}function mn(t,e,n){var r=na.range(t,e-ja,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function vn(t,e,n){var r=na.range(t,e-ja,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function yn(t){return t.source}function bn(t){return t.target}function _n(t,e,n,r){var i=Math.cos(e),o=Math.sin(e),a=Math.cos(r),s=Math.sin(r),u=i*Math.cos(t),l=i*Math.sin(t),c=a*Math.cos(n),h=a*Math.sin(n),f=2*Math.asin(Math.sqrt(ot(r-e)+i*a*ot(n-t))),d=1/Math.sin(f),p=f?function(t){var e=Math.sin(t*=f)*d,n=Math.sin(f-t)*d,r=n*u+e*c,i=n*l+e*h,a=n*o+e*s;return[Math.atan2(i,r)*Da,Math.atan2(a,Math.sqrt(r*r+i*i))*Da]}:function(){return[t*Da,e*Da]};return p.distance=f,p}function xn(){function t(t,i){var o=Math.sin(i*=Oa),a=Math.cos(i),s=pa((t*=Oa)-e),u=Math.cos(s);Hs+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=r*o-n*a*u)*s),n*o+r*a*u),e=t,n=o,r=a}var e,n,r;Us.point=function(i,o){e=i*Oa,n=Math.sin(o*=Oa),r=Math.cos(o),Us.point=t},Us.lineEnd=function(){Us.point=Us.lineEnd=x}}function wn(t,e){function n(e,n){var r=Math.cos(e),i=Math.cos(n),o=t(r*i);return[o*i*Math.sin(e),o*Math.sin(n)]}return n.invert=function(t,n){var r=Math.sqrt(t*t+n*n),i=e(r),o=Math.sin(i),a=Math.cos(i);return[Math.atan2(t*o,r*a),Math.asin(r&&n*o/r)]},n}function kn(t,e){function n(t,e){a>0?-La+ja>e&&(e=-La+ja):e>La-ja&&(e=La-ja);var n=a/Math.pow(i(e),o);return[n*Math.sin(o*t),a-n*Math.cos(o*t)]}var r=Math.cos(t),i=function(t){return Math.tan(Na/4+t/2)},o=t===e?Math.sin(t):Math.log(r/Math.cos(e))/Math.log(i(e)/i(t)),a=r*Math.pow(i(t),o)/o;return o?(n.invert=function(t,e){var n=a-e,r=K(o)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/o,2*Math.atan(Math.pow(a/r,1/o))-La]},n):Cn}function Sn(t,e){function n(t,e){var n=o-e;return[n*Math.sin(i*t),o-n*Math.cos(i*t)]}var r=Math.cos(t),i=t===e?Math.sin(t):(r-Math.cos(e))/(e-t),o=r/i+t;return pa(i)<ja?un:(n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/i,o-K(i)*Math.sqrt(t*t+n*n)]},n)}function Cn(t,e){return[t,Math.log(Math.tan(Na/4+e/2))]}function En(t){var e,n=on(t),r=n.scale,i=n.translate,o=n.clipExtent;return n.scale=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=o.apply(n,arguments);if(a===n){if(e=null==t){var s=Na*r(),u=i();o([[u[0]-s,u[1]-s],[u[0]+s,u[1]+s]])}}else e&&(a=null);return a},n.clipExtent(null)}function Mn(t,e){return[Math.log(Math.tan(Na/4+e/2)),-t]}function An(t){return t[0]}function Pn(t){return t[1]}function jn(t){for(var e=t.length,n=[0,1],r=2,i=2;e>i;i++){for(;r>1&&Z(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}function Tn(t,e){return t[0]-e[0]||t[1]-e[1]}function Nn(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function $n(t,e,n,r){var i=t[0],o=n[0],a=e[0]-i,s=r[0]-o,u=t[1],l=n[1],c=e[1]-u,h=r[1]-l,f=(s*(u-l)-h*(i-o))/(h*a-s*c);return[i+f*a,u+f*c]}function In(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function Ln(){nr(this),this.edge=this.site=this.circle=null}function On(t){var e=ru.pop()||new Ln;return e.site=t,e}function Dn(t){Wn(t),tu.remove(t),ru.push(t),nr(t)}function zn(t){var e=t.circle,n=e.x,r=e.cy,i={x:n,y:r},o=t.P,a=t.N,s=[t];Dn(t);for(var u=o;u.circle&&pa(n-u.circle.x)<ja&&pa(r-u.circle.cy)<ja;)o=u.P,s.unshift(u),Dn(u),u=o;s.unshift(u),Wn(u);for(var l=a;l.circle&&pa(n-l.circle.x)<ja&&pa(r-l.circle.cy)<ja;)a=l.N,s.push(l),Dn(l),l=a;s.push(l),Wn(l);var c,h=s.length;for(c=1;h>c;++c)l=s[c],u=s[c-1],Zn(l.edge,u.site,l.site,i);u=s[0],l=s[h-1],l.edge=Qn(u.site,l.site,null,i),Gn(u),Gn(l)}function Fn(t){for(var e,n,r,i,o=t.x,a=t.y,s=tu._;s;)if(r=Rn(s,a)-o,r>ja)s=s.L;else{if(i=o-Bn(s,a),!(i>ja)){r>-ja?(e=s.P,n=s):i>-ja?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}var u=On(t);if(tu.insert(e,u),e||n){if(e===n)return Wn(e),n=On(e.site),tu.insert(u,n),u.edge=n.edge=Qn(e.site,u.site),Gn(e),void Gn(n);if(!n)return void(u.edge=Qn(e.site,u.site));Wn(e),Wn(n);var l=e.site,c=l.x,h=l.y,f=t.x-c,d=t.y-h,p=n.site,g=p.x-c,m=p.y-h,v=2*(f*m-d*g),y=f*f+d*d,b=g*g+m*m,_={x:(m*y-d*b)/v+c,y:(f*b-g*y)/v+h};Zn(n.edge,l,p,_),u.edge=Qn(l,t,null,_),n.edge=Qn(t,p,null,_),Gn(e),Gn(n)}}function Rn(t,e){var n=t.site,r=n.x,i=n.y,o=i-e;if(!o)return r;var a=t.P;if(!a)return-(1/0);n=a.site;var s=n.x,u=n.y,l=u-e;if(!l)return s;var c=s-r,h=1/o-1/l,f=c/l;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*l)-u+l/2+i-o/2)))/h+r:(r+s)/2}function Bn(t,e){var n=t.N;if(n)return Rn(n,e);var r=t.site;return r.y===e?r.x:1/0}function qn(t){this.site=t,this.edges=[]}function Vn(t){for(var e,n,r,i,o,a,s,u,l,c,h=t[0][0],f=t[1][0],d=t[0][1],p=t[1][1],g=Zs,m=g.length;m--;)if(o=g[m],o&&o.prepare())for(s=o.edges,u=s.length,a=0;u>a;)c=s[a].end(),r=c.x,i=c.y,l=s[++a%u].start(),e=l.x,n=l.y,(pa(r-e)>ja||pa(i-n)>ja)&&(s.splice(a,0,new tr(Kn(o.site,c,pa(r-h)<ja&&p-i>ja?{x:h,y:pa(e-h)<ja?n:p}:pa(i-p)<ja&&f-r>ja?{x:pa(n-p)<ja?e:f,y:p}:pa(r-f)<ja&&i-d>ja?{x:f,y:pa(e-f)<ja?n:d}:pa(i-d)<ja&&r-h>ja?{x:pa(n-d)<ja?e:h,y:d}:null),o.site,null)),++u)}function Hn(t,e){return e.angle-t.angle}function Un(){nr(this),this.x=this.y=this.arc=this.site=this.cy=null}function Gn(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i.x,s=i.y,u=r.x-a,l=r.y-s,c=o.x-a,h=o.y-s,f=2*(u*h-l*c);if(!(f>=-Ta)){var d=u*u+l*l,p=c*c+h*h,g=(h*d-l*p)/f,m=(u*p-c*d)/f,h=m+s,v=iu.pop()||new Un;v.arc=t,v.site=i,v.x=g+a,v.y=h+Math.sqrt(g*g+m*m),v.cy=h,t.circle=v;for(var y=null,b=nu._;b;)if(v.y<b.y||v.y===b.y&&v.x<=b.x){if(!b.L){y=b.P;break}b=b.L}else{if(!b.R){y=b;break}b=b.R}nu.insert(y,v),y||(eu=v)}}}}function Wn(t){var e=t.circle;e&&(e.P||(eu=e.N),nu.remove(e),iu.push(e),nr(e),t.circle=null)}function Yn(t){for(var e,n=Ks,r=Be(t[0][0],t[0][1],t[1][0],t[1][1]),i=n.length;i--;)e=n[i],(!Xn(e,t)||!r(e)||pa(e.a.x-e.b.x)<ja&&pa(e.a.y-e.b.y)<ja)&&(e.a=e.b=null,n.splice(i,1))}function Xn(t,e){var n=t.b;if(n)return!0;var r,i,o=t.a,a=e[0][0],s=e[1][0],u=e[0][1],l=e[1][1],c=t.l,h=t.r,f=c.x,d=c.y,p=h.x,g=h.y,m=(f+p)/2,v=(d+g)/2;if(g===d){if(a>m||m>=s)return;if(f>p){if(o){if(o.y>=l)return}else o={x:m,y:u};n={x:m,y:l}}else{if(o){if(o.y<u)return}else o={x:m,y:l};n={x:m,y:u}}}else if(r=(f-p)/(g-d),i=v-r*m,-1>r||r>1)if(f>p){if(o){if(o.y>=l)return}else o={x:(u-i)/r,y:u};n={x:(l-i)/r,y:l}}else{if(o){if(o.y<u)return}else o={x:(l-i)/r,y:l};n={x:(u-i)/r,y:u}}else if(g>d){if(o){if(o.x>=s)return}else o={x:a,y:r*a+i};n={x:s,y:r*s+i}}else{if(o){if(o.x<a)return}else o={x:s,y:r*s+i};n={x:a,y:r*a+i}}return t.a=o,t.b=n,!0}function Jn(t,e){this.l=t,this.r=e,this.a=this.b=null}function Qn(t,e,n,r){var i=new Jn(t,e);return Ks.push(i),n&&Zn(i,t,e,n),r&&Zn(i,e,t,r),Zs[t.i].edges.push(new tr(i,t,e)),Zs[e.i].edges.push(new tr(i,e,t)),i}function Kn(t,e,n){var r=new Jn(t,null);return r.a=e,r.b=n,Ks.push(r),r}function Zn(t,e,n,r){t.a||t.b?t.l===n?t.b=r:t.a=r:(t.a=r,t.l=e,t.r=n)}function tr(t,e,n){var r=t.a,i=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function er(){this._=null}function nr(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function rr(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function ir(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function or(t){for(;t.L;)t=t.L;return t}function ar(t,e){var n,r,i,o=t.sort(sr).pop();for(Ks=[],Zs=new Array(t.length),tu=new er,nu=new er;;)if(i=eu,o&&(!i||o.y<i.y||o.y===i.y&&o.x<i.x))(o.x!==n||o.y!==r)&&(Zs[o.i]=new qn(o),Fn(o),n=o.x,r=o.y),o=t.pop();else{if(!i)break;zn(i.arc)}e&&(Yn(e),Vn(e));var a={cells:Zs,edges:Ks};return tu=nu=Ks=Zs=null,a}function sr(t,e){return e.y-t.y||e.x-t.x}function ur(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function lr(t){return t.x}function cr(t){return t.y}function hr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function fr(t,e,n,r,i,o){if(!t(e,n,r,i,o)){var a=.5*(n+i),s=.5*(r+o),u=e.nodes;u[0]&&fr(t,u[0],n,r,a,s),u[1]&&fr(t,u[1],a,r,i,s),u[2]&&fr(t,u[2],n,s,a,o),u[3]&&fr(t,u[3],a,s,i,o)}}function dr(t,e,n,r,i,o,a){var s,u=1/0;return function l(t,c,h,f,d){if(!(c>o||h>a||r>f||i>d)){if(p=t.point){var p,g=e-t.x,m=n-t.y,v=g*g+m*m;if(u>v){var y=Math.sqrt(u=v);r=e-y,i=n-y,o=e+y,a=n+y,s=p}}for(var b=t.nodes,_=.5*(c+f),x=.5*(h+d),w=e>=_,k=n>=x,S=k<<1|w,C=S+4;C>S;++S)if(t=b[3&S])switch(3&S){case 0:l(t,c,h,_,x);break;case 1:l(t,_,h,f,x);break;case 2:l(t,c,x,_,d);break;case 3:l(t,_,x,f,d)}}}(t,r,i,o,a),s}function pr(t,e){t=na.rgb(t),e=na.rgb(e);var n=t.r,r=t.g,i=t.b,o=e.r-n,a=e.g-r,s=e.b-i;return function(t){return"#"+_t(Math.round(n+o*t))+_t(Math.round(r+a*t))+_t(Math.round(i+s*t))}}function gr(t,e){var n,r={},i={};for(n in t)n in e?r[n]=yr(t[n],e[n]):i[n]=t[n];for(n in e)n in t||(i[n]=e[n]);return function(t){for(n in r)i[n]=r[n](t);return i}}function mr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function vr(t,e){var n,r,i,o=au.lastIndex=su.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=au.exec(t))&&(r=su.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:mr(n,r)})),o=su.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?(e=u[0].x,function(t){return e(t)+""}):function(){return e}:(e=u.length,function(t){for(var n,r=0;e>r;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})}function yr(t,e){for(var n,r=na.interpolators.length;--r>=0&&!(n=na.interpolators[r](t,e)););return n}function br(t,e){var n,r=[],i=[],o=t.length,a=e.length,s=Math.min(t.length,e.length);for(n=0;s>n;++n)r.push(yr(t[n],e[n]));for(;o>n;++n)i[n]=t[n];for(;a>n;++n)i[n]=e[n];return function(t){for(n=0;s>n;++n)i[n]=r[n](t);return i}}function _r(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function xr(t){return function(e){return 1-t(1-e)}}function wr(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function kr(t){return t*t}function Sr(t){return t*t*t}function Cr(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function Er(t){return function(e){return Math.pow(e,t)}}function Mr(t){return 1-Math.cos(t*La)}function Ar(t){return Math.pow(2,10*(t-1))}function Pr(t){return 1-Math.sqrt(1-t*t)}function jr(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/$a*Math.asin(1/t):(t=1,n=e/4),function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-n)*$a/e)}}function Tr(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Nr(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function $r(t,e){t=na.hcl(t),e=na.hcl(e);var n=t.h,r=t.c,i=t.l,o=e.h-n,a=e.c-r,s=e.l-i;return isNaN(a)&&(a=0,r=isNaN(r)?e.c:r),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return ct(n+o*t,r+a*t,i+s*t)+""}}function Ir(t,e){t=na.hsl(t),e=na.hsl(e);var n=t.h,r=t.s,i=t.l,o=e.h-n,a=e.s-r,s=e.l-i;return isNaN(a)&&(a=0,r=isNaN(r)?e.s:r),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return ut(n+o*t,r+a*t,i+s*t)+""}}function Lr(t,e){t=na.lab(t),e=na.lab(e);var n=t.l,r=t.a,i=t.b,o=e.l-n,a=e.a-r,s=e.b-i;return function(t){return ft(n+o*t,r+a*t,i+s*t)+""}}function Or(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function Dr(t){var e=[t.a,t.b],n=[t.c,t.d],r=Fr(e),i=zr(e,n),o=Fr(Rr(n,e,-i))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Da,this.translate=[t.e,t.f],this.scale=[r,o],this.skew=o?Math.atan2(i,o)*Da:0}function zr(t,e){return t[0]*e[0]+t[1]*e[1]}function Fr(t){var e=Math.sqrt(zr(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Rr(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function Br(t,e){var n,r=[],i=[],o=na.transform(t),a=na.transform(e),s=o.translate,u=a.translate,l=o.rotate,c=a.rotate,h=o.skew,f=a.skew,d=o.scale,p=a.scale;return s[0]!=u[0]||s[1]!=u[1]?(r.push("translate(",null,",",null,")"),i.push({i:1,x:mr(s[0],u[0])},{i:3,x:mr(s[1],u[1])})):u[0]||u[1]?r.push("translate("+u+")"):r.push(""),l!=c?(l-c>180?c+=360:c-l>180&&(l+=360),i.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:mr(l,c)})):c&&r.push(r.pop()+"rotate("+c+")"),h!=f?i.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:mr(h,f)}):f&&r.push(r.pop()+"skewX("+f+")"),
d[0]!=p[0]||d[1]!=p[1]?(n=r.push(r.pop()+"scale(",null,",",null,")"),i.push({i:n-4,x:mr(d[0],p[0])},{i:n-2,x:mr(d[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),n=i.length,function(t){for(var e,o=-1;++o<n;)r[(e=i[o]).i]=e.x(t);return r.join("")}}function qr(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Vr(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Hr(t){for(var e=t.source,n=t.target,r=Gr(e,n),i=[e];e!==r;)e=e.parent,i.push(e);for(var o=i.length;n!==r;)i.splice(o,0,n),n=n.parent;return i}function Ur(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Gr(t,e){if(t===e)return t;for(var n=Ur(t),r=Ur(e),i=n.pop(),o=r.pop(),a=null;i===o;)a=i,i=n.pop(),o=r.pop();return a}function Wr(t){t.fixed|=2}function Yr(t){t.fixed&=-7}function Xr(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Jr(t){t.fixed&=-5}function Qr(t,e,n){var r=0,i=0;if(t.charge=0,!t.leaf)for(var o,a=t.nodes,s=a.length,u=-1;++u<s;)o=a[u],null!=o&&(Qr(o,e,n),t.charge+=o.charge,r+=o.charge*o.cx,i+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var l=e*n[t.point.index];t.charge+=t.pointCharge=l,r+=l*t.point.x,i+=l*t.point.y}t.cx=r/t.charge,t.cy=i/t.charge}function Kr(t,e){return na.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=ii,t}function Zr(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(i=t.children)&&(r=i.length))for(var r,i;--r>=0;)n.push(i[r])}function ti(t,e){for(var n=[t],r=[];null!=(t=n.pop());)if(r.push(t),(o=t.children)&&(i=o.length))for(var i,o,a=-1;++a<i;)n.push(o[a]);for(;null!=(t=r.pop());)e(t)}function ei(t){return t.children}function ni(t){return t.value}function ri(t,e){return e.value-t.value}function ii(t){return na.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function oi(t){return t.x}function ai(t){return t.y}function si(t,e,n){t.y0=e,t.y=n}function ui(t){return na.range(t.length)}function li(t){for(var e=-1,n=t[0].length,r=[];++e<n;)r[e]=0;return r}function ci(t){for(var e,n=1,r=0,i=t[0][1],o=t.length;o>n;++n)(e=t[n][1])>i&&(r=n,i=e);return r}function hi(t){return t.reduce(fi,0)}function fi(t,e){return t+e[1]}function di(t,e){return pi(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function pi(t,e){for(var n=-1,r=+t[0],i=(t[1]-r)/e,o=[];++n<=e;)o[n]=i*n+r;return o}function gi(t){return[na.min(t),na.max(t)]}function mi(t,e){return t.value-e.value}function vi(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function yi(t,e){t._pack_next=e,e._pack_prev=t}function bi(t,e){var n=e.x-t.x,r=e.y-t.y,i=t.r+e.r;return.999*i*i>n*n+r*r}function _i(t){function e(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),f=Math.min(t.y-t.r,f),d=Math.max(t.y+t.r,d)}if((n=t.children)&&(l=n.length)){var n,r,i,o,a,s,u,l,c=1/0,h=-(1/0),f=1/0,d=-(1/0);if(n.forEach(xi),r=n[0],r.x=-r.r,r.y=0,e(r),l>1&&(i=n[1],i.x=i.r,i.y=0,e(i),l>2))for(o=n[2],Si(r,i,o),e(o),vi(r,o),r._pack_prev=o,vi(o,i),i=r._pack_next,a=3;l>a;a++){Si(r,i,o=n[a]);var p=0,g=1,m=1;for(s=i._pack_next;s!==i;s=s._pack_next,g++)if(bi(s,o)){p=1;break}if(1==p)for(u=r._pack_prev;u!==s._pack_prev&&!bi(u,o);u=u._pack_prev,m++);p?(m>g||g==m&&i.r<r.r?yi(r,i=s):yi(r=u,i),a--):(vi(r,o),i=o,e(o))}var v=(c+h)/2,y=(f+d)/2,b=0;for(a=0;l>a;a++)o=n[a],o.x-=v,o.y-=y,b=Math.max(b,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=b,n.forEach(wi)}}function xi(t){t._pack_next=t._pack_prev=t}function wi(t){delete t._pack_next,delete t._pack_prev}function ki(t,e,n,r){var i=t.children;if(t.x=e+=r*t.x,t.y=n+=r*t.y,t.r*=r,i)for(var o=-1,a=i.length;++o<a;)ki(i[o],e,n,r)}function Si(t,e,n){var r=t.r+n.r,i=e.x-t.x,o=e.y-t.y;if(r&&(i||o)){var a=e.r+n.r,s=i*i+o*o;a*=a,r*=r;var u=.5+(r-a)/(2*s),l=Math.sqrt(Math.max(0,2*a*(r+s)-(r-=s)*r-a*a))/(2*s);n.x=t.x+u*i+l*o,n.y=t.y+u*o-l*i}else n.x=t.x+r,n.y=t.y}function Ci(t,e){return t.parent==e.parent?1:2}function Ei(t){var e=t.children;return e.length?e[0]:t.t}function Mi(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function Ai(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Pi(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)e=i[o],e.z+=n,e.m+=n,n+=e.s+(r+=e.c)}function ji(t,e,n){return t.a.parent===e.parent?t.a:n}function Ti(t){return 1+na.max(t,function(t){return t.y})}function Ni(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function $i(t){var e=t.children;return e&&e.length?$i(e[0]):t}function Ii(t){var e,n=t.children;return n&&(e=n.length)?Ii(n[e-1]):t}function Li(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Oi(t,e){var n=t.x+e[3],r=t.y+e[0],i=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return 0>i&&(n+=i/2,i=0),0>o&&(r+=o/2,o=0),{x:n,y:r,dx:i,dy:o}}function Di(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function zi(t){return t.rangeExtent?t.rangeExtent():Di(t.range())}function Fi(t,e,n,r){var i=n(t[0],t[1]),o=r(e[0],e[1]);return function(t){return o(i(t))}}function Ri(t,e){var n,r=0,i=t.length-1,o=t[r],a=t[i];return o>a&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t}function Bi(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:yu}function qi(t,e,n,r){var i=[],o=[],a=0,s=Math.min(t.length,e.length)-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<=s;)i.push(n(t[a-1],t[a])),o.push(r(e[a-1],e[a]));return function(e){var n=na.bisect(t,e,1,s)-1;return o[n](i[n](e))}}function Vi(t,e,n,r){function i(){var i=Math.min(t.length,e.length)>2?qi:Fi,u=r?Vr:qr;return a=i(t,e,u,n),s=i(e,t,u,yr),o}function o(t){return a(t)}var a,s;return o.invert=function(t){return s(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),i()):t},o.range=function(t){return arguments.length?(e=t,i()):e},o.rangeRound=function(t){return o.range(t).interpolate(Or)},o.clamp=function(t){return arguments.length?(r=t,i()):r},o.interpolate=function(t){return arguments.length?(n=t,i()):n},o.ticks=function(e){return Wi(t,e)},o.tickFormat=function(e,n){return Yi(t,e,n)},o.nice=function(e){return Ui(t,e),i()},o.copy=function(){return Vi(t,e,n,r)},i()}function Hi(t,e){return na.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Ui(t,e){return Ri(t,Bi(Gi(t,e)[2]))}function Gi(t,e){null==e&&(e=10);var n=Di(t),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/e)/Math.LN10)),o=e/r*i;return.15>=o?i*=10:.35>=o?i*=5:.75>=o&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+.5*i,n[2]=i,n}function Wi(t,e){return na.range.apply(na,Gi(t,e))}function Yi(t,e,n){var r=Gi(t,e);if(n){var i=as.exec(n);if(i.shift(),"s"===i[8]){var o=na.formatPrefix(Math.max(pa(r[0]),pa(r[1])));return i[7]||(i[7]="."+Xi(o.scale(r[2]))),i[8]="f",n=na.format(i.join("")),function(t){return n(o.scale(t))+o.symbol}}i[7]||(i[7]="."+Ji(i[8],r)),n=i.join("")}else n=",."+Xi(r[2])+"f";return na.format(n)}function Xi(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Ji(t,e){var n=Xi(e[2]);return t in bu?Math.abs(n-Xi(Math.max(pa(e[0]),pa(e[1]))))+ +("e"!==t):n-2*("%"===t)}function Qi(t,e,n,r){function i(t){return(n?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function o(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function a(e){return t(i(e))}return a.invert=function(e){return o(t.invert(e))},a.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((r=e.map(Number)).map(i)),a):r},a.base=function(n){return arguments.length?(e=+n,t.domain(r.map(i)),a):e},a.nice=function(){var e=Ri(r.map(i),n?Math:xu);return t.domain(e),r=e.map(o),a},a.ticks=function(){var t=Di(r),a=[],s=t[0],u=t[1],l=Math.floor(i(s)),c=Math.ceil(i(u)),h=e%1?2:e;if(isFinite(c-l)){if(n){for(;c>l;l++)for(var f=1;h>f;f++)a.push(o(l)*f);a.push(o(l))}else for(a.push(o(l));l++<c;)for(var f=h-1;f>0;f--)a.push(o(l)*f);for(l=0;a[l]<s;l++);for(c=a.length;a[c-1]>u;c--);a=a.slice(l,c)}return a},a.tickFormat=function(t,e){if(!arguments.length)return _u;arguments.length<2?e=_u:"function"!=typeof e&&(e=na.format(e));var r,s=Math.max(.1,t/a.ticks().length),u=n?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(t){return t/o(u(i(t)+r))<=s?e(t):""}},a.copy=function(){return Qi(t.copy(),e,n,r)},Hi(a,t)}function Ki(t,e,n){function r(e){return t(i(e))}var i=Zi(e),o=Zi(1/e);return r.invert=function(e){return o(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(i)),r):n},r.ticks=function(t){return Wi(n,t)},r.tickFormat=function(t,e){return Yi(n,t,e)},r.nice=function(t){return r.domain(Ui(n,t))},r.exponent=function(a){return arguments.length?(i=Zi(e=a),o=Zi(1/e),t.domain(n.map(i)),r):e},r.copy=function(){return Ki(t.copy(),e,n)},Hi(r,t)}function Zi(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function to(t,e){function n(n){return o[((i.get(n)||("range"===e.t?i.set(n,t.push(n)):NaN))-1)%o.length]}function r(e,n){return na.range(t.length).map(function(t){return e+n*t})}var i,o,a;return n.domain=function(r){if(!arguments.length)return t;t=[],i=new l;for(var o,a=-1,s=r.length;++a<s;)i.has(o=r[a])||i.set(o,t.push(o));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(o=t,a=0,e={t:"range",a:arguments},n):o},n.rangePoints=function(i,s){arguments.length<2&&(s=0);var u=i[0],l=i[1],c=t.length<2?(u=(u+l)/2,0):(l-u)/(t.length-1+s);return o=r(u+c*s/2,c),a=0,e={t:"rangePoints",a:arguments},n},n.rangeRoundPoints=function(i,s){arguments.length<2&&(s=0);var u=i[0],l=i[1],c=t.length<2?(u=l=Math.round((u+l)/2),0):(l-u)/(t.length-1+s)|0;return o=r(u+Math.round(c*s/2+(l-u-(t.length-1+s)*c)/2),c),a=0,e={t:"rangeRoundPoints",a:arguments},n},n.rangeBands=function(i,s,u){arguments.length<2&&(s=0),arguments.length<3&&(u=s);var l=i[1]<i[0],c=i[l-0],h=i[1-l],f=(h-c)/(t.length-s+2*u);return o=r(c+f*u,f),l&&o.reverse(),a=f*(1-s),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(i,s,u){arguments.length<2&&(s=0),arguments.length<3&&(u=s);var l=i[1]<i[0],c=i[l-0],h=i[1-l],f=Math.floor((h-c)/(t.length-s+2*u));return o=r(c+Math.round((h-c-(t.length-s)*f)/2),f),l&&o.reverse(),a=Math.round(f*(1-s)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return a},n.rangeExtent=function(){return Di(e.a[0])},n.copy=function(){return to(t,e)},n.domain(t)}function eo(t,e){function o(){var n=0,r=e.length;for(s=[];++n<r;)s[n-1]=na.quantile(t,n/r);return a}function a(t){return isNaN(t=+t)?void 0:e[na.bisect(s,t)]}var s;return a.domain=function(e){return arguments.length?(t=e.map(r).filter(i).sort(n),o()):t},a.range=function(t){return arguments.length?(e=t,o()):e},a.quantiles=function(){return s},a.invertExtent=function(n){return n=e.indexOf(n),0>n?[NaN,NaN]:[n>0?s[n-1]:t[0],n<s.length?s[n]:t[t.length-1]]},a.copy=function(){return eo(t,e)},o()}function no(t,e,n){function r(e){return n[Math.max(0,Math.min(a,Math.floor(o*(e-t))))]}function i(){return o=n.length/(e-t),a=n.length-1,r}var o,a;return r.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],i()):[t,e]},r.range=function(t){return arguments.length?(n=t,i()):n},r.invertExtent=function(e){return e=n.indexOf(e),e=0>e?NaN:e/o+t,[e,e+1/o]},r.copy=function(){return no(t,e,n)},i()}function ro(t,e){function n(n){return n>=n?e[na.bisect(t,n)]:void 0}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return ro(t,e)},n}function io(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Wi(t,e)},e.tickFormat=function(e,n){return Yi(t,e,n)},e.copy=function(){return io(t)},e}function oo(){return 0}function ao(t){return t.innerRadius}function so(t){return t.outerRadius}function uo(t){return t.startAngle}function lo(t){return t.endAngle}function co(t){return t&&t.padAngle}function ho(t,e,n,r){return(t-n)*e-(e-r)*t>0?0:1}function fo(t,e,n,r,i){var o=t[0]-e[0],a=t[1]-e[1],s=(i?r:-r)/Math.sqrt(o*o+a*a),u=s*a,l=-s*o,c=t[0]+u,h=t[1]+l,f=e[0]+u,d=e[1]+l,p=(c+f)/2,g=(h+d)/2,m=f-c,v=d-h,y=m*m+v*v,b=n-r,_=c*d-f*h,x=(0>v?-1:1)*Math.sqrt(b*b*y-_*_),w=(_*v-m*x)/y,k=(-_*m-v*x)/y,S=(_*v+m*x)/y,C=(-_*m+v*x)/y,E=w-p,M=k-g,A=S-p,P=C-g;return E*E+M*M>A*A+P*P&&(w=S,k=C),[[w-u,k-l],[w*n/b,k*n/b]]}function po(t){function e(e){function a(){l.push("M",o(t(c),s))}for(var u,l=[],c=[],h=-1,f=e.length,d=Et(n),p=Et(r);++h<f;)i.call(this,u=e[h],h)?c.push([+d.call(this,u,h),+p.call(this,u,h)]):c.length&&(a(),c=[]);return c.length&&a(),l.length?l.join(""):null}var n=An,r=Pn,i=Ae,o=go,a=o.key,s=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e.defined=function(t){return arguments.length?(i=t,e):i},e.interpolate=function(t){return arguments.length?(a="function"==typeof t?o=t:(o=Mu.get(t)||go).key,e):a},e.tension=function(t){return arguments.length?(s=t,e):s},e}function go(t){return t.join("L")}function mo(t){return go(t)+"Z"}function vo(t){for(var e=0,n=t.length,r=t[0],i=[r[0],",",r[1]];++e<n;)i.push("H",(r[0]+(r=t[e])[0])/2,"V",r[1]);return n>1&&i.push("H",r[0]),i.join("")}function yo(t){for(var e=0,n=t.length,r=t[0],i=[r[0],",",r[1]];++e<n;)i.push("V",(r=t[e])[1],"H",r[0]);return i.join("")}function bo(t){for(var e=0,n=t.length,r=t[0],i=[r[0],",",r[1]];++e<n;)i.push("H",(r=t[e])[0],"V",r[1]);return i.join("")}function _o(t,e){return t.length<4?go(t):t[1]+ko(t.slice(1,-1),So(t,e))}function xo(t,e){return t.length<3?go(t):t[0]+ko((t.push(t[0]),t),So([t[t.length-2]].concat(t,[t[1]]),e))}function wo(t,e){return t.length<3?go(t):t[0]+ko(t,So(t,e))}function ko(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return go(t);var n=t.length!=e.length,r="",i=t[0],o=t[1],a=e[0],s=a,u=1;if(n&&(r+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],i=t[1],u=2),e.length>1){s=e[1],o=t[u],u++,r+="C"+(i[0]+a[0])+","+(i[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var l=2;l<e.length;l++,u++)o=t[u],s=e[l],r+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(n){var c=t[u];r+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return r}function So(t,e){for(var n,r=[],i=(1-e)/2,o=t[0],a=t[1],s=1,u=t.length;++s<u;)n=o,o=a,a=t[s],r.push([i*(a[0]-n[0]),i*(a[1]-n[1])]);return r}function Co(t){if(t.length<3)return go(t);var e=1,n=t.length,r=t[0],i=r[0],o=r[1],a=[i,i,i,(r=t[1])[0]],s=[o,o,o,r[1]],u=[i,",",o,"L",Po(ju,a),",",Po(ju,s)];for(t.push(t[n-1]);++e<=n;)r=t[e],a.shift(),a.push(r[0]),s.shift(),s.push(r[1]),jo(u,a,s);return t.pop(),u.push("L",r),u.join("")}function Eo(t){if(t.length<4)return go(t);for(var e,n=[],r=-1,i=t.length,o=[0],a=[0];++r<3;)e=t[r],o.push(e[0]),a.push(e[1]);for(n.push(Po(ju,o)+","+Po(ju,a)),--r;++r<i;)e=t[r],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),jo(n,o,a);return n.join("")}function Mo(t){for(var e,n,r=-1,i=t.length,o=i+4,a=[],s=[];++r<4;)n=t[r%i],a.push(n[0]),s.push(n[1]);for(e=[Po(ju,a),",",Po(ju,s)],--r;++r<o;)n=t[r%i],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),jo(e,a,s);return e.join("")}function Ao(t,e){var n=t.length-1;if(n)for(var r,i,o=t[0][0],a=t[0][1],s=t[n][0]-o,u=t[n][1]-a,l=-1;++l<=n;)r=t[l],i=l/n,r[0]=e*r[0]+(1-e)*(o+i*s),r[1]=e*r[1]+(1-e)*(a+i*u);return Co(t)}function Po(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function jo(t,e,n){t.push("C",Po(Au,e),",",Po(Au,n),",",Po(Pu,e),",",Po(Pu,n),",",Po(ju,e),",",Po(ju,n))}function To(t,e){return(e[1]-t[1])/(e[0]-t[0])}function No(t){for(var e=0,n=t.length-1,r=[],i=t[0],o=t[1],a=r[0]=To(i,o);++e<n;)r[e]=(a+(a=To(i=o,o=t[e+1])))/2;return r[e]=a,r}function $o(t){for(var e,n,r,i,o=[],a=No(t),s=-1,u=t.length-1;++s<u;)e=To(t[s],t[s+1]),pa(e)<ja?a[s]=a[s+1]=0:(n=a[s]/e,r=a[s+1]/e,i=n*n+r*r,i>9&&(i=3*e/Math.sqrt(i),a[s]=i*n,a[s+1]=i*r));for(s=-1;++s<=u;)i=(t[Math.min(u,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([i||0,a[s]*i||0]);return o}function Io(t){return t.length<3?go(t):t[0]+ko(t,$o(t))}function Lo(t){for(var e,n,r,i=-1,o=t.length;++i<o;)e=t[i],n=e[0],r=e[1]-La,e[0]=n*Math.cos(r),e[1]=n*Math.sin(r);return t}function Oo(t){function e(e){function u(){g.push("M",s(t(v),h),c,l(t(m.reverse()),h),"Z")}for(var f,d,p,g=[],m=[],v=[],y=-1,b=e.length,_=Et(n),x=Et(i),w=n===r?function(){return d}:Et(r),k=i===o?function(){return p}:Et(o);++y<b;)a.call(this,f=e[y],y)?(m.push([d=+_.call(this,f,y),p=+x.call(this,f,y)]),v.push([+w.call(this,f,y),+k.call(this,f,y)])):m.length&&(u(),m=[],v=[]);return m.length&&u(),g.length?g.join(""):null}var n=An,r=An,i=0,o=Pn,a=Ae,s=go,u=s.key,l=s,c="L",h=.7;return e.x=function(t){return arguments.length?(n=r=t,e):r},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(r=t,e):r},e.y=function(t){return arguments.length?(i=o=t,e):o},e.y0=function(t){return arguments.length?(i=t,e):i},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(a=t,e):a},e.interpolate=function(t){return arguments.length?(u="function"==typeof t?s=t:(s=Mu.get(t)||go).key,l=s.reverse||s,c=s.closed?"M":"L",e):u},e.tension=function(t){return arguments.length?(h=t,e):h},e}function Do(t){return t.radius}function zo(t){return[t.x,t.y]}function Fo(t){return function(){var e=t.apply(this,arguments),n=e[0],r=e[1]-La;return[n*Math.cos(r),n*Math.sin(r)]}}function Ro(){return 64}function Bo(){return"circle"}function qo(t){var e=Math.sqrt(t/Na);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Vo(t){return function(){var e,n;(e=this[t])&&(n=e[e.active])&&(--e.count?delete e[e.active]:delete this[t],e.active+=.5,n.event&&n.event.interrupt.call(this,this.__data__,n.index))}}function Ho(t,e,n){return ba(t,Du),t.namespace=e,t.id=n,t}function Uo(t,e,n,r){var i=t.id,o=t.namespace;return V(t,"function"==typeof n?function(t,a,s){t[o][i].tween.set(e,r(n.call(t,t.__data__,a,s)))}:(n=r(n),function(t){t[o][i].tween.set(e,n)}))}function Go(t){return null==t&&(t=""),function(){this.textContent=t}}function Wo(t){return null==t?"__transition__":"__transition_"+t+"__"}function Yo(t,e,n,r,i){var o=t[n]||(t[n]={active:0,count:0}),a=o[r];if(!a){var s=i.time;a=o[r]={tween:new l,time:s,delay:i.delay,duration:i.duration,ease:i.ease,index:e},i=null,++o.count,na.timer(function(i){function u(n){if(o.active>r)return c();var i=o[o.active];i&&(--o.count,delete o[o.active],i.event&&i.event.interrupt.call(t,t.__data__,i.index)),o.active=r,a.event&&a.event.start.call(t,t.__data__,e),a.tween.forEach(function(n,r){(r=r.call(t,t.__data__,e))&&g.push(r)}),f=a.ease,h=a.duration,na.timer(function(){return p.c=l(n||1)?Ae:l,1},0,s)}function l(n){if(o.active!==r)return 1;for(var i=n/h,s=f(i),u=g.length;u>0;)g[--u].call(t,s);return i>=1?(a.event&&a.event.end.call(t,t.__data__,e),c()):void 0}function c(){return--o.count?delete o[r]:delete t[n],1}var h,f,d=a.delay,p=rs,g=[];return p.t=d+s,i>=d?u(i-d):void(p.c=u)},0,s)}}function Xo(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate("+(isFinite(r)?r:n(t))+",0)"})}function Jo(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate(0,"+(isFinite(r)?r:n(t))+")"})}function Qo(t){return t.toISOString()}function Ko(t,e,n){function r(e){return t(e)}function i(t,n){var r=t[1]-t[0],i=r/n,o=na.bisect(Gu,i);return o==Gu.length?[e.year,Gi(t.map(function(t){return t/31536e6}),n)[2]]:o?e[i/Gu[o-1]<Gu[o]/i?o-1:o]:[Xu,Gi(t,n)[2]]}return r.invert=function(e){return Zo(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain(e),r):t.domain().map(Zo)},r.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,Zo(+n+1),e).length}var o=r.domain(),a=Di(o),s=null==t?i(a,10):"number"==typeof t&&i(a,t);return s&&(t=s[0],e=s[1]),r.domain(Ri(o,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=Zo(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=Zo(+e+1);return e}}:t))},r.ticks=function(t,e){var n=Di(r.domain()),o=null==t?i(n,10):"number"==typeof t?i(n,t):!t.range&&[{range:t},e];return o&&(t=o[0],e=o[1]),t.range(n[0],Zo(+n[1]+1),1>e?1:e)},r.tickFormat=function(){return n},r.copy=function(){return Ko(t.copy(),e,n)},Hi(r,t)}function Zo(t){return new Date(t)}function ta(t){return JSON.parse(t.responseText)}function ea(t){var e=oa.createRange();return e.selectNode(oa.body),e.createContextualFragment(t.responseText)}var na={version:"3.5.5"},ra=[].slice,ia=function(t){return ra.call(t)},oa=this.document;if(oa)try{ia(oa.documentElement.childNodes)[0].nodeType}catch(aa){ia=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),oa)try{oa.createElement("DIV").style.setProperty("opacity",0,"")}catch(sa){var ua=this.Element.prototype,la=ua.setAttribute,ca=ua.setAttributeNS,ha=this.CSSStyleDeclaration.prototype,fa=ha.setProperty;ua.setAttribute=function(t,e){la.call(this,t,e+"")},ua.setAttributeNS=function(t,e,n){ca.call(this,t,e,n+"")},ha.setProperty=function(t,e,n){fa.call(this,t,e+"",n)}}na.ascending=n,na.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:NaN},na.min=function(t,e){var n,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<o;)null!=(r=t[i])&&n>r&&(n=r)}else{for(;++i<o;)if(null!=(r=e.call(t,t[i],i))&&r>=r){n=r;break}for(;++i<o;)null!=(r=e.call(t,t[i],i))&&n>r&&(n=r)}return n},na.max=function(t,e){var n,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<o;)null!=(r=t[i])&&r>n&&(n=r)}else{for(;++i<o;)if(null!=(r=e.call(t,t[i],i))&&r>=r){n=r;break}for(;++i<o;)null!=(r=e.call(t,t[i],i))&&r>n&&(n=r)}return n},na.extent=function(t,e){var n,r,i,o=-1,a=t.length;if(1===arguments.length){for(;++o<a;)if(null!=(r=t[o])&&r>=r){n=i=r;break}for(;++o<a;)null!=(r=t[o])&&(n>r&&(n=r),r>i&&(i=r))}else{for(;++o<a;)if(null!=(r=e.call(t,t[o],o))&&r>=r){n=i=r;break}for(;++o<a;)null!=(r=e.call(t,t[o],o))&&(n>r&&(n=r),r>i&&(i=r))}return[n,i]},na.sum=function(t,e){var n,r=0,o=t.length,a=-1;if(1===arguments.length)for(;++a<o;)i(n=+t[a])&&(r+=n);else for(;++a<o;)i(n=+e.call(t,t[a],a))&&(r+=n);return r},na.mean=function(t,e){var n,o=0,a=t.length,s=-1,u=a;if(1===arguments.length)for(;++s<a;)i(n=r(t[s]))?o+=n:--u;else for(;++s<a;)i(n=r(e.call(t,t[s],s)))?o+=n:--u;return u?o/u:void 0},na.quantile=function(t,e){var n=(t.length-1)*e+1,r=Math.floor(n),i=+t[r-1],o=n-r;return o?i+o*(t[r]-i):i},na.median=function(t,e){var o,a=[],s=t.length,u=-1;if(1===arguments.length)for(;++u<s;)i(o=r(t[u]))&&a.push(o);else for(;++u<s;)i(o=r(e.call(t,t[u],u)))&&a.push(o);return a.length?na.quantile(a.sort(n),.5):void 0},na.variance=function(t,e){var n,o,a=t.length,s=0,u=0,l=-1,c=0;if(1===arguments.length)for(;++l<a;)i(n=r(t[l]))&&(o=n-s,s+=o/++c,u+=o*(n-s));else for(;++l<a;)i(n=r(e.call(t,t[l],l)))&&(o=n-s,s+=o/++c,u+=o*(n-s));return c>1?u/(c-1):void 0},na.deviation=function(){var t=na.variance.apply(this,arguments);return t?Math.sqrt(t):t};var da=o(n);na.bisectLeft=da.left,na.bisect=na.bisectRight=da.right,na.bisector=function(t){return o(1===t.length?function(e,r){return n(t(e),r)}:t)},na.shuffle=function(t,e,n){(o=arguments.length)<3&&(n=t.length,2>o&&(e=0));for(var r,i,o=n-e;o;)i=Math.random()*o--|0,r=t[o+e],t[o+e]=t[i+e],t[i+e]=r;return t},na.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},na.pairs=function(t){for(var e,n=0,r=t.length-1,i=t[0],o=new Array(0>r?0:r);r>n;)o[n]=[e=i,i=t[++n]];return o},na.zip=function(){if(!(r=arguments.length))return[];for(var t=-1,e=na.min(arguments,a),n=new Array(e);++t<e;)for(var r,i=-1,o=n[t]=new Array(r);++i<r;)o[i]=arguments[i][t];return n},na.transpose=function(t){return na.zip.apply(na,t)},na.keys=function(t){var e=[];for(var n in t)e.push(n);return e},na.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},na.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},na.merge=function(t){for(var e,n,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(n=new Array(a);--i>=0;)for(r=t[i],e=r.length;--e>=0;)n[--a]=r[e];return n};var pa=Math.abs;na.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n===1/0)throw new Error("infinite range");var r,i=[],o=s(pa(n)),a=-1;if(t*=o,e*=o,n*=o,0>n)for(;(r=t+n*++a)>e;)i.push(r/o);else for(;(r=t+n*++a)<e;)i.push(r/o);return i},na.map=function(t,e){var n=new l;if(t instanceof l)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(1===arguments.length)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e.call(t,r=t[i],i),r)}else for(var a in t)n.set(a,t[a]);return n};var ga="__proto__",ma="\x00";u(l,{has:f,get:function(t){return this._[c(t)]},set:function(t,e){return this._[c(t)]=e},remove:d,keys:p,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:h(e),value:this._[e]});return t},size:g,empty:m,forEach:function(t){for(var e in this._)t.call(this,h(e),this._[e])}}),na.nest=function(){function t(e,a,s){if(s>=o.length)return r?r.call(i,a):n?a.sort(n):a;for(var u,c,h,f,d=-1,p=a.length,g=o[s++],m=new l;++d<p;)(f=m.get(u=g(c=a[d])))?f.push(c):m.set(u,[c]);return e?(c=e(),h=function(n,r){c.set(n,t(e,r,s))}):(c={},h=function(n,r){c[n]=t(e,r,s)}),m.forEach(h),c}function e(t,n){if(n>=o.length)return t;var r=[],i=a[n++];return t.forEach(function(t,i){r.push({key:t,values:e(i,n)})}),i?r.sort(function(t,e){return i(t.key,e.key)}):r}var n,r,i={},o=[],a=[];return i.map=function(e,n){return t(n,e,0)},i.entries=function(n){return e(t(na.map,n,0),0)},i.key=function(t){return o.push(t),i},i.sortKeys=function(t){return a[o.length-1]=t,i},i.sortValues=function(t){return n=t,i},i.rollup=function(t){return r=t,i},i},na.set=function(t){var e=new v;if(t)for(var n=0,r=t.length;r>n;++n)e.add(t[n]);return e},u(v,{has:f,add:function(t){return this._[c(t+="")]=!0,t},remove:d,values:p,size:g,empty:m,forEach:function(t){for(var e in this._)t.call(this,h(e))}}),na.behavior={},na.rebind=function(t,e){for(var n,r=1,i=arguments.length;++r<i;)t[n=arguments[r]]=b(t,e,e[n]);return t};var va=["webkit","ms","moz","Moz","o","O"];na.dispatch=function(){for(var t=new w,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=k(t);return t},w.prototype.on=function(t,e){var n=t.indexOf("."),r="";if(n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(r):this[t].on(r,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},na.event=null,na.requote=function(t){return t.replace(ya,"\\$&")};var ya=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ba={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},_a=function(t,e){return e.querySelector(t)},xa=function(t,e){return e.querySelectorAll(t)},wa=function(t,e){var n=t.matches||t[_(t,"matchesSelector")];return(wa=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(_a=function(t,e){return Sizzle(t,e)[0]||null},xa=Sizzle,wa=Sizzle.matchesSelector),na.selection=function(){return na.select(oa.documentElement)};var ka=na.selection.prototype=[];ka.select=function(t){var e,n,r,i,o=[];t=A(t);for(var a=-1,s=this.length;++a<s;){o.push(e=[]),e.parentNode=(r=this[a]).parentNode;for(var u=-1,l=r.length;++u<l;)(i=r[u])?(e.push(n=t.call(i,i.__data__,u,a)),n&&"__data__"in i&&(n.__data__=i.__data__)):e.push(null)}return M(o)},ka.selectAll=function(t){var e,n,r=[];t=P(t);for(var i=-1,o=this.length;++i<o;)for(var a=this[i],s=-1,u=a.length;++s<u;)(n=a[s])&&(r.push(e=ia(t.call(n,n.__data__,s,i))),e.parentNode=n);return M(r)};var Sa={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};na.ns={prefix:Sa,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.slice(0,e),t=t.slice(e+1)),Sa.hasOwnProperty(n)?{space:Sa[n],local:t}:t}},ka.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=na.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(j(e,t[e]));return this}return this.each(j(t,e))},ka.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),r=(t=$(t)).length,i=-1;if(e=n.classList){for(;++i<r;)if(!e.contains(t[i]))return!1}else for(e=n.getAttribute("class");++i<r;)if(!N(t[i]).test(e))return!1;return!0}for(e in t)this.each(I(e,t[e]));return this}return this.each(I(t,e))},ka.style=function(t,n,r){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(n="");for(r in t)this.each(O(r,t[r],n));return this}if(2>i){var o=this.node();return e(o).getComputedStyle(o,null).getPropertyValue(t)}r=""}return this.each(O(t,n,r))},ka.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(D(e,t[e]));return this}return this.each(D(t,e))},ka.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},ka.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},ka.append=function(t){return t=z(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},ka.insert=function(t,e){return t=z(t),e=A(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},ka.remove=function(){return this.each(F)},ka.data=function(t,e){function n(t,n){var r,i,o,a=t.length,h=n.length,f=Math.min(a,h),d=new Array(h),p=new Array(h),g=new Array(a);if(e){var m,v=new l,y=new Array(a);for(r=-1;++r<a;)v.has(m=e.call(i=t[r],i.__data__,r))?g[r]=i:v.set(m,i),y[r]=m;for(r=-1;++r<h;)(i=v.get(m=e.call(n,o=n[r],r)))?i!==!0&&(d[r]=i,i.__data__=o):p[r]=R(o),v.set(m,!0);for(r=-1;++r<a;)v.get(y[r])!==!0&&(g[r]=t[r])}else{for(r=-1;++r<f;)i=t[r],o=n[r],i?(i.__data__=o,d[r]=i):p[r]=R(o);for(;h>r;++r)p[r]=R(n[r]);for(;a>r;++r)g[r]=t[r]}p.update=d,p.parentNode=d.parentNode=g.parentNode=t.parentNode,s.push(p),u.push(d),c.push(g)}var r,i,o=-1,a=this.length;if(!arguments.length){for(t=new Array(a=(r=this[0]).length);++o<a;)(i=r[o])&&(t[o]=i.__data__);return t}var s=H([]),u=M([]),c=M([]);if("function"==typeof t)for(;++o<a;)n(r=this[o],t.call(r,r.parentNode.__data__,o));else for(;++o<a;)n(r=this[o],t);return u.enter=function(){return s},u.exit=function(){return c},u},ka.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},ka.filter=function(t){var e,n,r,i=[];"function"!=typeof t&&(t=B(t));for(var o=0,a=this.length;a>o;o++){i.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var s=0,u=n.length;u>s;s++)(r=n[s])&&t.call(r,r.__data__,s,o)&&e.push(r)}return M(i)},ka.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,r=this[t],i=r.length-1,o=r[i];--i>=0;)(n=r[i])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},ka.sort=function(t){t=q.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},ka.each=function(t){return V(this,function(e,n,r){t.call(e,e.__data__,n,r)})},ka.call=function(t){var e=ia(arguments);return t.apply(e[0]=this,e),this},ka.empty=function(){return!this.node()},ka.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],r=0,i=n.length;i>r;r++){var o=n[r];if(o)return o}return null},ka.size=function(){var t=0;return V(this,function(){++t}),t};var Ca=[];na.selection.enter=H,na.selection.enter.prototype=Ca,Ca.append=ka.append,Ca.empty=ka.empty,Ca.node=ka.node,Ca.call=ka.call,Ca.size=ka.size,Ca.select=function(t){for(var e,n,r,i,o,a=[],s=-1,u=this.length;++s<u;){r=(i=this[s]).update,a.push(e=[]),e.parentNode=i.parentNode;for(var l=-1,c=i.length;++l<c;)(o=i[l])?(e.push(r[l]=n=t.call(i.parentNode,o.__data__,l,s)),n.__data__=o.__data__):e.push(null)}return M(a)},Ca.insert=function(t,e){return arguments.length<2&&(e=U(this)),ka.insert.call(this,t,e)},na.select=function(e){var n;return"string"==typeof e?(n=[_a(e,oa)],n.parentNode=oa.documentElement):(n=[e],n.parentNode=t(e)),M([n])},na.selectAll=function(t){var e;return"string"==typeof t?(e=ia(xa(t,oa)),e.parentNode=oa.documentElement):(e=t,e.parentNode=null),M([e])},ka.on=function(t,e,n){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e=!1);for(n in t)this.each(G(n,t[n],e));return this}if(2>r)return(r=this.node()["__on"+t])&&r._;n=!1}return this.each(G(t,e,n))};var Ea=na.map({mouseenter:"mouseover",mouseleave:"mouseout"});oa&&Ea.forEach(function(t){"on"+t in oa&&Ea.remove(t)});var Ma,Aa=0;na.mouse=function(t){return J(t,C())};var Pa=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;na.touch=function(t,e,n){if(arguments.length<3&&(n=e,
e=C().changedTouches),e)for(var r,i=0,o=e.length;o>i;++i)if((r=e[i]).identifier===n)return J(t,r)},na.behavior.drag=function(){function t(){this.on("mousedown.drag",o).on("touchstart.drag",a)}function n(t,e,n,o,a){return function(){function s(){var t,n,r=e(f,g);r&&(t=r[0]-b[0],n=r[1]-b[1],p|=t|n,b=r,d({type:"drag",x:r[0]+l[0],y:r[1]+l[1],dx:t,dy:n}))}function u(){e(f,g)&&(v.on(o+m,null).on(a+m,null),y(p&&na.event.target===h),d({type:"dragend"}))}var l,c=this,h=na.event.target,f=c.parentNode,d=r.of(c,arguments),p=0,g=t(),m=".drag"+(null==g?"":"-"+g),v=na.select(n(h)).on(o+m,s).on(a+m,u),y=X(h),b=e(f,g);i?(l=i.apply(c,arguments),l=[l.x-b[0],l.y-b[1]]):l=[0,0],d({type:"dragstart"})}}var r=E(t,"drag","dragstart","dragend"),i=null,o=n(x,na.mouse,e,"mousemove","mouseup"),a=n(Q,na.touch,y,"touchmove","touchend");return t.origin=function(e){return arguments.length?(i=e,t):i},na.rebind(t,r,"on")},na.touches=function(t,e){return arguments.length<2&&(e=C().touches),e?ia(e).map(function(e){var n=J(t,e);return n.identifier=e.identifier,n}):[]};var ja=1e-6,Ta=ja*ja,Na=Math.PI,$a=2*Na,Ia=$a-ja,La=Na/2,Oa=Na/180,Da=180/Na,za=Math.SQRT2,Fa=2,Ra=4;na.interpolateZoom=function(t,e){function n(t){var e=t*y;if(v){var n=rt(g),a=o/(Fa*f)*(n*it(za*e+g)-nt(g));return[r+a*l,i+a*c,o*n/rt(za*e+g)]}return[r+t*l,i+t*c,o*Math.exp(za*e)]}var r=t[0],i=t[1],o=t[2],a=e[0],s=e[1],u=e[2],l=a-r,c=s-i,h=l*l+c*c,f=Math.sqrt(h),d=(u*u-o*o+Ra*h)/(2*o*Fa*f),p=(u*u-o*o-Ra*h)/(2*u*Fa*f),g=Math.log(Math.sqrt(d*d+1)-d),m=Math.log(Math.sqrt(p*p+1)-p),v=m-g,y=(v||Math.log(u/o))/za;return n.duration=1e3*y,n},na.behavior.zoom=function(){function t(t){t.on(T,h).on(qa+".zoom",d).on("dblclick.zoom",p).on(I,f)}function n(t){return[(t[0]-C.x)/C.k,(t[1]-C.y)/C.k]}function r(t){return[t[0]*C.k+C.x,t[1]*C.k+C.y]}function i(t){C.k=Math.max(A[0],Math.min(A[1],t))}function o(t,e){e=r(e),C.x+=t[0]-e[0],C.y+=t[1]-e[1]}function a(e,n,r,a){e.__chart__={x:C.x,y:C.y,k:C.k},i(Math.pow(2,a)),o(m=n,r),e=na.select(e),P>0&&(e=e.transition().duration(P)),e.call(t.event)}function s(){x&&x.domain(_.range().map(function(t){return(t-C.x)/C.k}).map(_.invert)),k&&k.domain(w.range().map(function(t){return(t-C.y)/C.k}).map(w.invert))}function u(t){j++||t({type:"zoomstart"})}function l(t){s(),t({type:"zoom",scale:C.k,translate:[C.x,C.y]})}function c(t){--j||t({type:"zoomend"}),m=null}function h(){function t(){h=1,o(na.mouse(i),d),l(s)}function r(){f.on(N,null).on($,null),p(h&&na.event.target===a),c(s)}var i=this,a=na.event.target,s=L.of(i,arguments),h=0,f=na.select(e(i)).on(N,t).on($,r),d=n(na.mouse(i)),p=X(i);Ou.call(i),u(s)}function f(){function t(){var t=na.touches(p);return d=C.k,t.forEach(function(t){t.identifier in m&&(m[t.identifier]=n(t))}),t}function e(){var e=na.event.target;na.select(e).on(_,r).on(x,s),w.push(e);for(var n=na.event.changedTouches,i=0,o=n.length;o>i;++i)m[n[i].identifier]=null;var u=t(),l=Date.now();if(1===u.length){if(500>l-b){var c=u[0];a(p,c,m[c.identifier],Math.floor(Math.log(C.k)/Math.LN2)+1),S()}b=l}else if(u.length>1){var c=u[0],h=u[1],f=c[0]-h[0],d=c[1]-h[1];v=f*f+d*d}}function r(){var t,e,n,r,a=na.touches(p);Ou.call(p);for(var s=0,u=a.length;u>s;++s,r=null)if(n=a[s],r=m[n.identifier]){if(e)break;t=n,e=r}if(r){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,h=v&&Math.sqrt(c/v);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+r[0])/2,(e[1]+r[1])/2],i(h*d)}b=null,o(t,e),l(g)}function s(){if(na.event.touches.length){for(var e=na.event.changedTouches,n=0,r=e.length;r>n;++n)delete m[e[n].identifier];for(var i in m)return void t()}na.selectAll(w).on(y,null),k.on(T,h).on(I,f),E(),c(g)}var d,p=this,g=L.of(p,arguments),m={},v=0,y=".zoom-"+na.event.changedTouches[0].identifier,_="touchmove"+y,x="touchend"+y,w=[],k=na.select(p),E=X(p);e(),u(g),k.on(T,null).on(I,e)}function d(){var t=L.of(this,arguments);y?clearTimeout(y):(g=n(m=v||na.mouse(this)),Ou.call(this),u(t)),y=setTimeout(function(){y=null,c(t)},50),S(),i(Math.pow(2,.002*Ba())*C.k),o(m,g),l(t)}function p(){var t=na.mouse(this),e=Math.log(C.k)/Math.LN2;a(this,t,n(t),na.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}var g,m,v,y,b,_,x,w,k,C={x:0,y:0,k:1},M=[960,500],A=Va,P=250,j=0,T="mousedown.zoom",N="mousemove.zoom",$="mouseup.zoom",I="touchstart.zoom",L=E(t,"zoomstart","zoom","zoomend");return qa||(qa="onwheel"in oa?(Ba=function(){return-na.event.deltaY*(na.event.deltaMode?120:1)},"wheel"):"onmousewheel"in oa?(Ba=function(){return na.event.wheelDelta},"mousewheel"):(Ba=function(){return-na.event.detail},"MozMousePixelScroll")),t.event=function(t){t.each(function(){var t=L.of(this,arguments),e=C;Iu?na.select(this).transition().each("start.zoom",function(){C=this.__chart__||{x:0,y:0,k:1},u(t)}).tween("zoom:zoom",function(){var n=M[0],r=M[1],i=m?m[0]:n/2,o=m?m[1]:r/2,a=na.interpolateZoom([(i-C.x)/C.k,(o-C.y)/C.k,n/C.k],[(i-e.x)/e.k,(o-e.y)/e.k,n/e.k]);return function(e){var r=a(e),s=n/r[2];this.__chart__=C={x:i-r[0]*s,y:o-r[1]*s,k:s},l(t)}}).each("interrupt.zoom",function(){c(t)}).each("end.zoom",function(){c(t)}):(this.__chart__=C,u(t),l(t),c(t))})},t.translate=function(e){return arguments.length?(C={x:+e[0],y:+e[1],k:C.k},s(),t):[C.x,C.y]},t.scale=function(e){return arguments.length?(C={x:C.x,y:C.y,k:+e},s(),t):C.k},t.scaleExtent=function(e){return arguments.length?(A=null==e?Va:[+e[0],+e[1]],t):A},t.center=function(e){return arguments.length?(v=e&&[+e[0],+e[1]],t):v},t.size=function(e){return arguments.length?(M=e&&[+e[0],+e[1]],t):M},t.duration=function(e){return arguments.length?(P=+e,t):P},t.x=function(e){return arguments.length?(x=e,_=e.copy(),C={x:0,y:0,k:1},t):x},t.y=function(e){return arguments.length?(k=e,w=e.copy(),C={x:0,y:0,k:1},t):k},na.rebind(t,L,"on")};var Ba,qa,Va=[0,1/0];na.color=at,at.prototype.toString=function(){return this.rgb()+""},na.hsl=st;var Ha=st.prototype=new at;Ha.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,this.l/t)},Ha.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,t*this.l)},Ha.rgb=function(){return ut(this.h,this.s,this.l)},na.hcl=lt;var Ua=lt.prototype=new at;Ua.brighter=function(t){return new lt(this.h,this.c,Math.min(100,this.l+Ga*(arguments.length?t:1)))},Ua.darker=function(t){return new lt(this.h,this.c,Math.max(0,this.l-Ga*(arguments.length?t:1)))},Ua.rgb=function(){return ct(this.h,this.c,this.l).rgb()},na.lab=ht;var Ga=18,Wa=.95047,Ya=1,Xa=1.08883,Ja=ht.prototype=new at;Ja.brighter=function(t){return new ht(Math.min(100,this.l+Ga*(arguments.length?t:1)),this.a,this.b)},Ja.darker=function(t){return new ht(Math.max(0,this.l-Ga*(arguments.length?t:1)),this.a,this.b)},Ja.rgb=function(){return ft(this.l,this.a,this.b)},na.rgb=vt;var Qa=vt.prototype=new at;Qa.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,r=this.b,i=30;return e||n||r?(e&&i>e&&(e=i),n&&i>n&&(n=i),r&&i>r&&(r=i),new vt(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,r/t))):new vt(i,i,i)},Qa.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new vt(t*this.r,t*this.g,t*this.b)},Qa.hsl=function(){return wt(this.r,this.g,this.b)},Qa.toString=function(){return"#"+_t(this.r)+_t(this.g)+_t(this.b)};var Ka=na.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ka.forEach(function(t,e){Ka.set(t,yt(e))}),na.functor=Et,na.xhr=Mt(y),na.dsv=function(t,e){function n(t,n,o){arguments.length<3&&(o=n,n=null);var a=At(t,e,null==n?r:i(n),o);return a.row=function(t){return arguments.length?a.response(null==(n=t)?r:i(t)):n},a}function r(t){return n.parse(t.responseText)}function i(t){return function(e){return n.parse(e.responseText,t)}}function o(e){return e.map(a).join(t)}function a(t){return s.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var s=new RegExp('["'+t+"\n]"),u=t.charCodeAt(0);return n.parse=function(t,e){var r;return n.parseRows(t,function(t,n){if(r)return r(t,n-1);var i=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");r=e?function(t,n){return e(i(t),n)}:i})},n.parseRows=function(t,e){function n(){if(c>=l)return a;if(i)return i=!1,o;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var r=t.charCodeAt(n+1);return 13===r?(i=!0,10===t.charCodeAt(n+2)&&++c):10===r&&(i=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;l>c;){var r=t.charCodeAt(c++),s=1;if(10===r)i=!0;else if(13===r)i=!0,10===t.charCodeAt(c)&&(++c,++s);else if(r!==u)continue;return t.slice(e,c-s)}return t.slice(e)}for(var r,i,o={},a={},s=[],l=t.length,c=0,h=0;(r=n())!==a;){for(var f=[];r!==o&&r!==a;)f.push(r),r=n();e&&null==(f=e(f,h++))||s.push(f)}return s},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var r=new v,i=[];return e.forEach(function(t){for(var e in t)r.has(e)||i.push(r.add(e))}),[i.map(a).join(t)].concat(e.map(function(e){return i.map(function(t){return a(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(o).join("\n")},n},na.csv=na.dsv(",","text/csv"),na.tsv=na.dsv("	","text/tab-separated-values");var Za,ts,es,ns,rs,is=this[_(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};na.timer=function(t,e,n){var r=arguments.length;2>r&&(e=0),3>r&&(n=Date.now());var i=n+e,o={c:t,t:i,f:!1,n:null};ts?ts.n=o:Za=o,ts=o,es||(ns=clearTimeout(ns),es=1,is(Tt))},na.timer.flush=function(){Nt(),$t()},na.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var os=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Lt);na.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=na.round(t,It(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),os[8+n/3]};var as=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ss=na.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=na.round(t,It(t,e))).toFixed(Math.max(0,Math.min(20,It(t*(1+1e-15),e))))}}),us=na.time={},ls=Date;zt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){cs.setUTCDate.apply(this._,arguments)},setDay:function(){cs.setUTCDay.apply(this._,arguments)},setFullYear:function(){cs.setUTCFullYear.apply(this._,arguments)},setHours:function(){cs.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){cs.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){cs.setUTCMinutes.apply(this._,arguments)},setMonth:function(){cs.setUTCMonth.apply(this._,arguments)},setSeconds:function(){cs.setUTCSeconds.apply(this._,arguments)},setTime:function(){cs.setTime.apply(this._,arguments)}};var cs=Date.prototype;us.year=Ft(function(t){return t=us.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),us.years=us.year.range,us.years.utc=us.year.utc.range,us.day=Ft(function(t){var e=new ls(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),us.days=us.day.range,us.days.utc=us.day.utc.range,us.dayOfYear=function(t){var e=us.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=us[t]=Ft(function(t){return(t=us.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=us.year(t).getDay();return Math.floor((us.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});us[t+"s"]=n.range,us[t+"s"].utc=n.utc.range,us[t+"OfYear"]=function(t){var n=us.year(t).getDay();return Math.floor((us.dayOfYear(t)+(n+e)%7)/7)}}),us.week=us.sunday,us.weeks=us.sunday.range,us.weeks.utc=us.sunday.utc.range,us.weekOfYear=us.sundayOfYear;var hs={"-":"",_:" ",0:"0"},fs=/^\s*\d+/,ds=/^%/;na.locale=function(t){return{numberFormat:Ot(t),timeFormat:Bt(t)}};var ps=na.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});na.format=ps.numberFormat,na.geo={},ue.prototype={s:0,t:0,add:function(t){le(t,this.t,gs),le(gs.s,this.s,this),this.s?this.t+=gs.t:this.s=gs.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var gs=new ue;na.geo.stream=function(t,e){t&&ms.hasOwnProperty(t.type)?ms[t.type](t,e):ce(t,e)};var ms={Feature:function(t,e){ce(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)ce(n[r].geometry,e)}},vs={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){he(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)he(n[r],e,0)},Polygon:function(t,e){fe(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)fe(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)ce(n[r],e)}};na.geo.area=function(t){return ys=0,na.geo.stream(t,_s),ys};var ys,bs=new ue,_s={sphere:function(){ys+=4*Na},point:x,lineStart:x,lineEnd:x,polygonStart:function(){bs.reset(),_s.lineStart=de},polygonEnd:function(){var t=2*bs;ys+=0>t?4*Na+t:t,_s.lineStart=_s.lineEnd=_s.point=x}};na.geo.bounds=function(){function t(t,e){b.push(_=[c=t,f=t]),h>e&&(h=e),e>d&&(d=e)}function e(e,n){var r=pe([e*Oa,n*Oa]);if(v){var i=me(v,r),o=[i[1],-i[0],0],a=me(o,i);be(a),a=_e(a);var u=e-p,l=u>0?1:-1,g=a[0]*Da*l,m=pa(u)>180;if(m^(g>l*p&&l*e>g)){var y=a[1]*Da;y>d&&(d=y)}else if(g=(g+360)%360-180,m^(g>l*p&&l*e>g)){var y=-a[1]*Da;h>y&&(h=y)}else h>n&&(h=n),n>d&&(d=n);m?p>e?s(c,e)>s(c,f)&&(f=e):s(e,f)>s(c,f)&&(c=e):f>=c?(c>e&&(c=e),e>f&&(f=e)):e>p?s(c,e)>s(c,f)&&(f=e):s(e,f)>s(c,f)&&(c=e)}else t(e,n);v=r,p=e}function n(){x.point=e}function r(){_[0]=c,_[1]=f,x.point=t,v=null}function i(t,n){if(v){var r=t-p;y+=pa(r)>180?r+(r>0?360:-360):r}else g=t,m=n;_s.point(t,n),e(t,n)}function o(){_s.lineStart()}function a(){i(g,m),_s.lineEnd(),pa(y)>ja&&(c=-(f=180)),_[0]=c,_[1]=f,v=null}function s(t,e){return(e-=t)<0?e+360:e}function u(t,e){return t[0]-e[0]}function l(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,h,f,d,p,g,m,v,y,b,_,x={point:t,lineStart:n,lineEnd:r,polygonStart:function(){x.point=i,x.lineStart=o,x.lineEnd=a,y=0,_s.polygonStart()},polygonEnd:function(){_s.polygonEnd(),x.point=t,x.lineStart=n,x.lineEnd=r,0>bs?(c=-(f=180),h=-(d=90)):y>ja?d=90:-ja>y&&(h=-90),_[0]=c,_[1]=f}};return function(t){d=f=-(c=h=1/0),b=[],na.geo.stream(t,x);var e=b.length;if(e){b.sort(u);for(var n,r=1,i=b[0],o=[i];e>r;++r)n=b[r],l(n[0],i)||l(n[1],i)?(s(i[0],n[1])>s(i[0],i[1])&&(i[1]=n[1]),s(n[0],i[1])>s(i[0],i[1])&&(i[0]=n[0])):o.push(i=n);for(var a,n,p=-(1/0),e=o.length-1,r=0,i=o[e];e>=r;i=n,++r)n=o[r],(a=s(i[1],n[0]))>p&&(p=a,c=n[0],f=i[1])}return b=_=null,c===1/0||h===1/0?[[NaN,NaN],[NaN,NaN]]:[[c,h],[f,d]]}}(),na.geo.centroid=function(t){xs=ws=ks=Ss=Cs=Es=Ms=As=Ps=js=Ts=0,na.geo.stream(t,Ns);var e=Ps,n=js,r=Ts,i=e*e+n*n+r*r;return Ta>i&&(e=Es,n=Ms,r=As,ja>ws&&(e=ks,n=Ss,r=Cs),i=e*e+n*n+r*r,Ta>i)?[NaN,NaN]:[Math.atan2(n,e)*Da,et(r/Math.sqrt(i))*Da]};var xs,ws,ks,Ss,Cs,Es,Ms,As,Ps,js,Ts,Ns={sphere:x,point:we,lineStart:Se,lineEnd:Ce,polygonStart:function(){Ns.lineStart=Ee},polygonEnd:function(){Ns.lineStart=Se}},$s=Ne(Ae,Oe,ze,[-Na,-Na/2]),Is=1e9;na.geo.clipExtent=function(){var t,e,n,r,i,o,a={stream:function(t){return i&&(i.valid=!1),i=o(t),i.valid=!0,i},extent:function(s){return arguments.length?(o=qe(t=+s[0][0],e=+s[0][1],n=+s[1][0],r=+s[1][1]),i&&(i.valid=!1,i=null),a):[[t,e],[n,r]]}};return a.extent([[0,0],[960,500]])},(na.geo.conicEqualArea=function(){return Ve(He)}).raw=He,na.geo.albers=function(){return na.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},na.geo.albersUsa=function(){function t(t){var o=t[0],a=t[1];return e=null,n(o,a),e||(r(o,a),e)||i(o,a),e}var e,n,r,i,o=na.geo.albers(),a=na.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=na.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&.234>i&&r>=-.425&&-.214>r?a:i>=.166&&.234>i&&r>=-.214&&-.115>r?s:o).invert(t)},t.stream=function(t){var e=o.stream(t),n=a.stream(t),r=s.stream(t);return{point:function(t,i){e.point(t,i),n.point(t,i),r.point(t,i)},sphere:function(){e.sphere(),n.sphere(),r.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},t.precision=function(e){return arguments.length?(o.precision(e),a.precision(e),s.precision(e),t):o.precision()},t.scale=function(e){return arguments.length?(o.scale(e),a.scale(.35*e),s.scale(e),t.translate(o.translate())):o.scale()},t.translate=function(e){if(!arguments.length)return o.translate();var l=o.scale(),c=+e[0],h=+e[1];return n=o.translate(e).clipExtent([[c-.455*l,h-.238*l],[c+.455*l,h+.238*l]]).stream(u).point,r=a.translate([c-.307*l,h+.201*l]).clipExtent([[c-.425*l+ja,h+.12*l+ja],[c-.214*l-ja,h+.234*l-ja]]).stream(u).point,i=s.translate([c-.205*l,h+.212*l]).clipExtent([[c-.214*l+ja,h+.166*l+ja],[c-.115*l-ja,h+.234*l-ja]]).stream(u).point,t},t.scale(1070)};var Ls,Os,Ds,zs,Fs,Rs,Bs={point:x,lineStart:x,lineEnd:x,polygonStart:function(){Os=0,Bs.lineStart=Ue},polygonEnd:function(){Bs.lineStart=Bs.lineEnd=Bs.point=x,Ls+=pa(Os/2)}},qs={point:Ge,lineStart:x,lineEnd:x,polygonStart:x,polygonEnd:x},Vs={point:Xe,lineStart:Je,lineEnd:Qe,polygonStart:function(){Vs.lineStart=Ke},polygonEnd:function(){Vs.point=Xe,Vs.lineStart=Je,Vs.lineEnd=Qe}};na.geo.path=function(){function t(t){return t&&("function"==typeof s&&o.pointRadius(+s.apply(this,arguments)),a&&a.valid||(a=i(o)),na.geo.stream(t,a)),o.result()}function e(){return a=null,t}var n,r,i,o,a,s=4.5;return t.area=function(t){return Ls=0,na.geo.stream(t,i(Bs)),Ls},t.centroid=function(t){return ks=Ss=Cs=Es=Ms=As=Ps=js=Ts=0,na.geo.stream(t,i(Vs)),Ts?[Ps/Ts,js/Ts]:As?[Es/As,Ms/As]:Cs?[ks/Cs,Ss/Cs]:[NaN,NaN]},t.bounds=function(t){return Fs=Rs=-(Ds=zs=1/0),na.geo.stream(t,i(qs)),[[Ds,zs],[Fs,Rs]]},t.projection=function(t){return arguments.length?(i=(n=t)?t.stream||en(t):y,e()):n},t.context=function(t){return arguments.length?(o=null==(r=t)?new We:new Ze(t),"function"!=typeof s&&o.pointRadius(s),e()):r},t.pointRadius=function(e){return arguments.length?(s="function"==typeof e?e:(o.pointRadius(+e),+e),t):s},t.projection(na.geo.albersUsa()).context(null)},na.geo.transform=function(t){return{stream:function(e){var n=new nn(e);for(var r in t)n[r]=t[r];return n}}},nn.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},na.geo.projection=on,na.geo.projectionMutator=an,(na.geo.equirectangular=function(){return on(un)}).raw=un.invert=un,na.geo.rotation=function(t){function e(e){return e=t(e[0]*Oa,e[1]*Oa),e[0]*=Da,e[1]*=Da,e}return t=cn(t[0]%360*Oa,t[1]*Oa,t.length>2?t[2]*Oa:0),e.invert=function(e){return e=t.invert(e[0]*Oa,e[1]*Oa),e[0]*=Da,e[1]*=Da,e},e},ln.invert=un,na.geo.circle=function(){function t(){var t="function"==typeof r?r.apply(this,arguments):r,e=cn(-t[0]*Oa,-t[1]*Oa,0).invert,i=[];return n(null,null,1,{point:function(t,n){i.push(t=e(t,n)),t[0]*=Da,t[1]*=Da}}),{type:"Polygon",coordinates:[i]}}var e,n,r=[0,0],i=6;return t.origin=function(e){return arguments.length?(r=e,t):r},t.angle=function(r){return arguments.length?(n=pn((e=+r)*Oa,i*Oa),t):e},t.precision=function(r){return arguments.length?(n=pn(e*Oa,(i=+r)*Oa),t):i},t.angle(90)},na.geo.distance=function(t,e){var n,r=(e[0]-t[0])*Oa,i=t[1]*Oa,o=e[1]*Oa,a=Math.sin(r),s=Math.cos(r),u=Math.sin(i),l=Math.cos(i),c=Math.sin(o),h=Math.cos(o);return Math.atan2(Math.sqrt((n=h*a)*n+(n=l*c-u*h*s)*n),u*c+l*h*s)},na.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return na.range(Math.ceil(o/m)*m,i,m).map(f).concat(na.range(Math.ceil(l/v)*v,u,v).map(d)).concat(na.range(Math.ceil(r/p)*p,n,p).filter(function(t){return pa(t%m)>ja}).map(c)).concat(na.range(Math.ceil(s/g)*g,a,g).filter(function(t){return pa(t%v)>ja}).map(h))}var n,r,i,o,a,s,u,l,c,h,f,d,p=10,g=p,m=90,v=360,y=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[f(o).concat(d(u).slice(1),f(i).reverse().slice(1),d(l).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(o=+e[0][0],i=+e[1][0],l=+e[0][1],u=+e[1][1],o>i&&(e=o,o=i,i=e),l>u&&(e=l,l=u,u=e),t.precision(y)):[[o,l],[i,u]]},t.minorExtent=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],r>n&&(e=r,r=n,n=e),s>a&&(e=s,s=a,a=e),t.precision(y)):[[r,s],[n,a]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(m=+e[0],v=+e[1],t):[m,v]},t.minorStep=function(e){return arguments.length?(p=+e[0],g=+e[1],t):[p,g]},t.precision=function(e){return arguments.length?(y=+e,c=mn(s,a,90),h=vn(r,n,y),f=mn(l,u,90),d=vn(o,i,y),t):y},t.majorExtent([[-180,-90+ja],[180,90-ja]]).minorExtent([[-180,-80-ja],[180,80+ja]])},na.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||r.apply(this,arguments),n||i.apply(this,arguments)]}}var e,n,r=yn,i=bn;return t.distance=function(){return na.geo.distance(e||r.apply(this,arguments),n||i.apply(this,arguments))},t.source=function(n){return arguments.length?(r=n,e="function"==typeof n?null:n,t):r},t.target=function(e){return arguments.length?(i=e,n="function"==typeof e?null:e,t):i},t.precision=function(){return arguments.length?t:0},t},na.geo.interpolate=function(t,e){return _n(t[0]*Oa,t[1]*Oa,e[0]*Oa,e[1]*Oa)},na.geo.length=function(t){return Hs=0,na.geo.stream(t,Us),Hs};var Hs,Us={sphere:x,point:x,lineStart:xn,lineEnd:x,polygonStart:x,polygonEnd:x},Gs=wn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(na.geo.azimuthalEqualArea=function(){return on(Gs)}).raw=Gs;var Ws=wn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},y);(na.geo.azimuthalEquidistant=function(){return on(Ws)}).raw=Ws,(na.geo.conicConformal=function(){return Ve(kn)}).raw=kn,(na.geo.conicEquidistant=function(){return Ve(Sn)}).raw=Sn;var Ys=wn(function(t){return 1/t},Math.atan);(na.geo.gnomonic=function(){return on(Ys)}).raw=Ys,Cn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-La]},(na.geo.mercator=function(){return En(Cn)}).raw=Cn;var Xs=wn(function(){return 1},Math.asin);(na.geo.orthographic=function(){return on(Xs)}).raw=Xs;var Js=wn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(na.geo.stereographic=function(){return on(Js)}).raw=Js,Mn.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-La]},(na.geo.transverseMercator=function(){var t=En(Mn),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90])}).raw=Mn,na.geom={},na.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,i=Et(n),o=Et(r),a=t.length,s=[],u=[];for(e=0;a>e;e++)s.push([+i.call(this,t[e],e),+o.call(this,t[e],e),e]);for(s.sort(Tn),e=0;a>e;e++)u.push([s[e][0],-s[e][1]]);var l=jn(s),c=jn(u),h=c[0]===l[0],f=c[c.length-1]===l[l.length-1],d=[];for(e=l.length-1;e>=0;--e)d.push(t[s[l[e]][2]]);for(e=+h;e<c.length-f;++e)d.push(t[s[c[e]][2]]);return d}var n=An,r=Pn;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e)},na.geom.polygon=function(t){return ba(t,Qs),t};var Qs=na.geom.polygon.prototype=[];Qs.area=function(){for(var t,e=-1,n=this.length,r=this[n-1],i=0;++e<n;)t=r,r=this[e],i+=t[1]*r[0]-t[0]*r[1];return.5*i},Qs.centroid=function(t){var e,n,r=-1,i=this.length,o=0,a=0,s=this[i-1];for(arguments.length||(t=-1/(6*this.area()));++r<i;)e=s,s=this[r],n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[o*t,a*t]},Qs.clip=function(t){for(var e,n,r,i,o,a,s=In(t),u=-1,l=this.length-In(this),c=this[l-1];++u<l;){for(e=t.slice(),t.length=0,i=this[u],o=e[(r=e.length-s)-1],n=-1;++n<r;)a=e[n],Nn(a,c,i)?(Nn(o,c,i)||t.push($n(o,a,c,i)),t.push(a)):Nn(o,c,i)&&t.push($n(o,a,c,i)),o=a;s&&t.push(t[0]),c=i}return t};var Ks,Zs,tu,eu,nu,ru=[],iu=[];qn.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort(Hn),e.length},tr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},er.prototype={insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=or(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(rr(this,n),t=n,n=t.U),n.C=!1,r.C=!0,ir(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(ir(this,n),t=n,n=t.U),n.C=!1,r.C=!0,rr(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?or(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===i.L){if(e=i.R,e.C&&(e.C=!1,i.C=!0,rr(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,ir(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,rr(this,i),t=this._;break}}else if(e=i.L,e.C&&(e.C=!1,i.C=!0,ir(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,rr(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,ir(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}},na.geom.voronoi=function(t){function e(t){var e=new Array(t.length),r=s[0][0],i=s[0][1],o=s[1][0],a=s[1][1];return ar(n(t),s).cells.forEach(function(n,s){var u=n.edges,l=n.site,c=e[s]=u.length?u.map(function(t){var e=t.start();return[e.x,e.y]}):l.x>=r&&l.x<=o&&l.y>=i&&l.y<=a?[[r,a],[o,a],[o,i],[r,i]]:[];c.point=t[s]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(o(t,e)/ja)*ja,y:Math.round(a(t,e)/ja)*ja,i:e}})}var r=An,i=Pn,o=r,a=i,s=ou;return t?e(t):(e.links=function(t){return ar(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return ar(n(t)).cells.forEach(function(n,r){for(var i,o,a=n.site,s=n.edges.sort(Hn),u=-1,l=s.length,c=s[l-1].edge,h=c.l===a?c.r:c.l;++u<l;)i=c,o=h,c=s[u].edge,h=c.l===a?c.r:c.l,r<o.i&&r<h.i&&ur(a,o,h)<0&&e.push([t[r],t[o.i],t[h.i]])}),e},e.x=function(t){return arguments.length?(o=Et(r=t),e):r},e.y=function(t){return arguments.length?(a=Et(i=t),e):i},e.clipExtent=function(t){return arguments.length?(s=null==t?ou:t,e):s===ou?null:s},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):s===ou?null:s&&s[1]},e)};var ou=[[-1e6,-1e6],[1e6,1e6]];na.geom.delaunay=function(t){return na.geom.voronoi().triangles(t)},na.geom.quadtree=function(t,e,n,r,i){function o(t){function o(t,e,n,r,i,o,a,s){if(!isNaN(n)&&!isNaN(r))if(t.leaf){var u=t.x,c=t.y;if(null!=u)if(pa(u-n)+pa(c-r)<.01)l(t,e,n,r,i,o,a,s);else{var h=t.point;t.x=t.y=t.point=null,l(t,h,u,c,i,o,a,s),l(t,e,n,r,i,o,a,s)}else t.x=n,t.y=r,t.point=e}else l(t,e,n,r,i,o,a,s)}function l(t,e,n,r,i,a,s,u){var l=.5*(i+s),c=.5*(a+u),h=n>=l,f=r>=c,d=f<<1|h;t.leaf=!1,t=t.nodes[d]||(t.nodes[d]=hr()),h?i=l:s=l,f?a=c:u=c,o(t,e,n,r,i,a,s,u)}var c,h,f,d,p,g,m,v,y,b=Et(s),_=Et(u);if(null!=e)g=e,m=n,v=r,y=i;else if(v=y=-(g=m=1/0),h=[],f=[],p=t.length,a)for(d=0;p>d;++d)c=t[d],c.x<g&&(g=c.x),c.y<m&&(m=c.y),c.x>v&&(v=c.x),c.y>y&&(y=c.y),h.push(c.x),f.push(c.y);else for(d=0;p>d;++d){var x=+b(c=t[d],d),w=+_(c,d);g>x&&(g=x),m>w&&(m=w),x>v&&(v=x),w>y&&(y=w),h.push(x),f.push(w)}var k=v-g,S=y-m;k>S?y=m+k:v=g+S;var C=hr();if(C.add=function(t){o(C,t,+b(t,++d),+_(t,d),g,m,v,y)},C.visit=function(t){fr(t,C,g,m,v,y)},C.find=function(t){return dr(C,t[0],t[1],g,m,v,y)},d=-1,null==e){for(;++d<p;)o(C,t[d],h[d],f[d],g,m,v,y);--d}else t.forEach(C.add);return h=f=t=c=null,C}var a,s=An,u=Pn;return(a=arguments.length)?(s=lr,u=cr,3===a&&(i=n,r=e,n=e=0),o(t)):(o.x=function(t){return arguments.length?(s=t,o):s},o.y=function(t){return arguments.length?(u=t,o):u},o.extent=function(t){return arguments.length?(null==t?e=n=r=i=null:(e=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),o):null==e?null:[[e,n],[r,i]]},o.size=function(t){
return arguments.length?(null==t?e=n=r=i=null:(e=n=0,r=+t[0],i=+t[1]),o):null==e?null:[r-e,i-n]},o)},na.interpolateRgb=pr,na.interpolateObject=gr,na.interpolateNumber=mr,na.interpolateString=vr;var au=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,su=new RegExp(au.source,"g");na.interpolate=yr,na.interpolators=[function(t,e){var n=typeof e;return("string"===n?Ka.has(e)||/^(#|rgb\(|hsl\()/.test(e)?pr:vr:e instanceof at?pr:Array.isArray(e)?br:"object"===n&&isNaN(e)?gr:mr)(t,e)}],na.interpolateArray=br;var uu=function(){return y},lu=na.map({linear:uu,poly:Er,quad:function(){return kr},cubic:function(){return Sr},sin:function(){return Mr},exp:function(){return Ar},circle:function(){return Pr},elastic:jr,back:Tr,bounce:function(){return Nr}}),cu=na.map({"in":y,out:xr,"in-out":wr,"out-in":function(t){return wr(xr(t))}});na.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,r=e>=0?t.slice(e+1):"in";return n=lu.get(n)||uu,r=cu.get(r)||y,_r(r(n.apply(null,ra.call(arguments,1))))},na.interpolateHcl=$r,na.interpolateHsl=Ir,na.interpolateLab=Lr,na.interpolateRound=Or,na.transform=function(t){var e=oa.createElementNS(na.ns.prefix.svg,"g");return(na.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new Dr(n?n.matrix:hu)})(t)},Dr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var hu={a:1,b:0,c:0,d:1,e:0,f:0};na.interpolateTransform=Br,na.layout={},na.layout.bundle=function(){return function(t){for(var e=[],n=-1,r=t.length;++n<r;)e.push(Hr(t[n]));return e}},na.layout.chord=function(){function t(){var t,l,h,f,d,p={},g=[],m=na.range(o),v=[];for(n=[],r=[],t=0,f=-1;++f<o;){for(l=0,d=-1;++d<o;)l+=i[f][d];g.push(l),v.push(na.range(o)),t+=l}for(a&&m.sort(function(t,e){return a(g[t],g[e])}),s&&v.forEach(function(t,e){t.sort(function(t,n){return s(i[e][t],i[e][n])})}),t=($a-c*o)/t,l=0,f=-1;++f<o;){for(h=l,d=-1;++d<o;){var y=m[f],b=v[y][d],_=i[y][b],x=l,w=l+=_*t;p[y+"-"+b]={index:y,subindex:b,startAngle:x,endAngle:w,value:_}}r[y]={index:y,startAngle:h,endAngle:l,value:(l-h)/t},l+=c}for(f=-1;++f<o;)for(d=f-1;++d<o;){var k=p[f+"-"+d],S=p[d+"-"+f];(k.value||S.value)&&n.push(k.value<S.value?{source:S,target:k}:{source:k,target:S})}u&&e()}function e(){n.sort(function(t,e){return u((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,r,i,o,a,s,u,l={},c=0;return l.matrix=function(t){return arguments.length?(o=(i=t)&&i.length,n=r=null,l):i},l.padding=function(t){return arguments.length?(c=t,n=r=null,l):c},l.sortGroups=function(t){return arguments.length?(a=t,n=r=null,l):a},l.sortSubgroups=function(t){return arguments.length?(s=t,n=null,l):s},l.sortChords=function(t){return arguments.length?(u=t,n&&e(),l):u},l.chords=function(){return n||t(),n},l.groups=function(){return r||t(),r},l},na.layout.force=function(){function t(t){return function(e,n,r,i){if(e.point!==t){var o=e.cx-t.x,a=e.cy-t.y,s=i-n,u=o*o+a*a;if(u>s*s/m){if(p>u){var l=e.charge/u;t.px-=o*l,t.py-=a*l}return!0}if(e.point&&u&&p>u){var l=e.pointCharge/u;t.px-=o*l,t.py-=a*l}}return!e.charge}}function e(t){t.px=na.event.x,t.py=na.event.y,s.resume()}var n,r,i,o,a,s={},u=na.dispatch("start","tick","end"),l=[1,1],c=.9,h=fu,f=du,d=-30,p=pu,g=.1,m=.64,v=[],b=[];return s.tick=function(){if((r*=.99)<.005)return u.end({type:"end",alpha:r=0}),!0;var e,n,s,h,f,p,m,y,_,x=v.length,w=b.length;for(n=0;w>n;++n)s=b[n],h=s.source,f=s.target,y=f.x-h.x,_=f.y-h.y,(p=y*y+_*_)&&(p=r*o[n]*((p=Math.sqrt(p))-i[n])/p,y*=p,_*=p,f.x-=y*(m=h.weight/(f.weight+h.weight)),f.y-=_*m,h.x+=y*(m=1-m),h.y+=_*m);if((m=r*g)&&(y=l[0]/2,_=l[1]/2,n=-1,m))for(;++n<x;)s=v[n],s.x+=(y-s.x)*m,s.y+=(_-s.y)*m;if(d)for(Qr(e=na.geom.quadtree(v),r,a),n=-1;++n<x;)(s=v[n]).fixed||e.visit(t(s));for(n=-1;++n<x;)s=v[n],s.fixed?(s.x=s.px,s.y=s.py):(s.x-=(s.px-(s.px=s.x))*c,s.y-=(s.py-(s.py=s.y))*c);u.tick({type:"tick",alpha:r})},s.nodes=function(t){return arguments.length?(v=t,s):v},s.links=function(t){return arguments.length?(b=t,s):b},s.size=function(t){return arguments.length?(l=t,s):l},s.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,s):h},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,s):f},s.friction=function(t){return arguments.length?(c=+t,s):c},s.charge=function(t){return arguments.length?(d="function"==typeof t?t:+t,s):d},s.chargeDistance=function(t){return arguments.length?(p=t*t,s):Math.sqrt(p)},s.gravity=function(t){return arguments.length?(g=+t,s):g},s.theta=function(t){return arguments.length?(m=t*t,s):Math.sqrt(m)},s.alpha=function(t){return arguments.length?(t=+t,r?r=t>0?t:0:t>0&&(u.start({type:"start",alpha:r=t}),na.timer(s.tick)),s):r},s.start=function(){function t(t,r){if(!n){for(n=new Array(u),s=0;u>s;++s)n[s]=[];for(s=0;c>s;++s){var i=b[s];n[i.source.index].push(i.target),n[i.target.index].push(i.source)}}for(var o,a=n[e],s=-1,l=a.length;++s<l;)if(!isNaN(o=a[s][t]))return o;return Math.random()*r}var e,n,r,u=v.length,c=b.length,p=l[0],g=l[1];for(e=0;u>e;++e)(r=v[e]).index=e,r.weight=0;for(e=0;c>e;++e)r=b[e],"number"==typeof r.source&&(r.source=v[r.source]),"number"==typeof r.target&&(r.target=v[r.target]),++r.source.weight,++r.target.weight;for(e=0;u>e;++e)r=v[e],isNaN(r.x)&&(r.x=t("x",p)),isNaN(r.y)&&(r.y=t("y",g)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(i=[],"function"==typeof h)for(e=0;c>e;++e)i[e]=+h.call(this,b[e],e);else for(e=0;c>e;++e)i[e]=h;if(o=[],"function"==typeof f)for(e=0;c>e;++e)o[e]=+f.call(this,b[e],e);else for(e=0;c>e;++e)o[e]=f;if(a=[],"function"==typeof d)for(e=0;u>e;++e)a[e]=+d.call(this,v[e],e);else for(e=0;u>e;++e)a[e]=d;return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){return n||(n=na.behavior.drag().origin(y).on("dragstart.force",Wr).on("drag.force",e).on("dragend.force",Yr)),arguments.length?void this.on("mouseover.force",Xr).on("mouseout.force",Jr).call(n):n},na.rebind(s,u,"on")};var fu=20,du=1,pu=1/0;na.layout.hierarchy=function(){function t(i){var o,a=[i],s=[];for(i.depth=0;null!=(o=a.pop());)if(s.push(o),(l=n.call(t,o,o.depth))&&(u=l.length)){for(var u,l,c;--u>=0;)a.push(c=l[u]),c.parent=o,c.depth=o.depth+1;r&&(o.value=0),o.children=l}else r&&(o.value=+r.call(t,o,o.depth)||0),delete o.children;return ti(i,function(t){var n,i;e&&(n=t.children)&&n.sort(e),r&&(i=t.parent)&&(i.value+=t.value)}),s}var e=ri,n=ei,r=ni;return t.sort=function(n){return arguments.length?(e=n,t):e},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(r=e,t):r},t.revalue=function(e){return r&&(Zr(e,function(t){t.children&&(t.value=0)}),ti(e,function(e){var n;e.children||(e.value=+r.call(t,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value)})),e},t},na.layout.partition=function(){function t(e,n,r,i){var o=e.children;if(e.x=n,e.y=e.depth*i,e.dx=r,e.dy=i,o&&(a=o.length)){var a,s,u,l=-1;for(r=e.value?r/e.value:0;++l<a;)t(s=o[l],n,u=s.value*r,i),n+=u}}function e(t){var n=t.children,r=0;if(n&&(i=n.length))for(var i,o=-1;++o<i;)r=Math.max(r,e(n[o]));return 1+r}function n(n,o){var a=r.call(this,n,o);return t(a[0],0,i[0],i[1]/e(a[0])),a}var r=na.layout.hierarchy(),i=[1,1];return n.size=function(t){return arguments.length?(i=t,n):i},Kr(n,r)},na.layout.pie=function(){function t(a){var s,u=a.length,l=a.map(function(n,r){return+e.call(t,n,r)}),c=+("function"==typeof r?r.apply(this,arguments):r),h=("function"==typeof i?i.apply(this,arguments):i)-c,f=Math.min(Math.abs(h)/u,+("function"==typeof o?o.apply(this,arguments):o)),d=f*(0>h?-1:1),p=(h-u*d)/na.sum(l),g=na.range(u),m=[];return null!=n&&g.sort(n===gu?function(t,e){return l[e]-l[t]}:function(t,e){return n(a[t],a[e])}),g.forEach(function(t){m[t]={data:a[t],value:s=l[t],startAngle:c,endAngle:c+=s*p+d,padAngle:f}}),m}var e=Number,n=gu,r=0,i=$a,o=0;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(r=e,t):r},t.endAngle=function(e){return arguments.length?(i=e,t):i},t.padAngle=function(e){return arguments.length?(o=e,t):o},t};var gu={};na.layout.stack=function(){function t(s,u){if(!(f=s.length))return s;var l=s.map(function(n,r){return e.call(t,n,r)}),c=l.map(function(e){return e.map(function(e,n){return[o.call(t,e,n),a.call(t,e,n)]})}),h=n.call(t,c,u);l=na.permute(l,h),c=na.permute(c,h);var f,d,p,g,m=r.call(t,c,u),v=l[0].length;for(p=0;v>p;++p)for(i.call(t,l[0][p],g=m[p],c[0][p][1]),d=1;f>d;++d)i.call(t,l[d][p],g+=c[d-1][p][1],c[d][p][1]);return s}var e=y,n=ui,r=li,i=si,o=oi,a=ai;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:mu.get(e)||ui,t):n},t.offset=function(e){return arguments.length?(r="function"==typeof e?e:vu.get(e)||li,t):r},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(a=e,t):a},t.out=function(e){return arguments.length?(i=e,t):i},t};var mu=na.map({"inside-out":function(t){var e,n,r=t.length,i=t.map(ci),o=t.map(hi),a=na.range(r).sort(function(t,e){return i[t]-i[e]}),s=0,u=0,l=[],c=[];for(e=0;r>e;++e)n=a[e],u>s?(s+=o[n],l.push(n)):(u+=o[n],c.push(n));return c.reverse().concat(l)},reverse:function(t){return na.range(t.length).reverse()},"default":ui}),vu=na.map({silhouette:function(t){var e,n,r,i=t.length,o=t[0].length,a=[],s=0,u=[];for(n=0;o>n;++n){for(e=0,r=0;i>e;e++)r+=t[e][n][1];r>s&&(s=r),a.push(r)}for(n=0;o>n;++n)u[n]=(s-a[n])/2;return u},wiggle:function(t){var e,n,r,i,o,a,s,u,l,c=t.length,h=t[0],f=h.length,d=[];for(d[0]=u=l=0,n=1;f>n;++n){for(e=0,i=0;c>e;++e)i+=t[e][n][1];for(e=0,o=0,s=h[n][0]-h[n-1][0];c>e;++e){for(r=0,a=(t[e][n][1]-t[e][n-1][1])/(2*s);e>r;++r)a+=(t[r][n][1]-t[r][n-1][1])/s;o+=a*t[e][n][1]}d[n]=u-=i?o/i*s:0,l>u&&(l=u)}for(n=0;f>n;++n)d[n]-=l;return d},expand:function(t){var e,n,r,i=t.length,o=t[0].length,a=1/i,s=[];for(n=0;o>n;++n){for(e=0,r=0;i>e;e++)r+=t[e][n][1];if(r)for(e=0;i>e;e++)t[e][n][1]/=r;else for(e=0;i>e;e++)t[e][n][1]=a}for(n=0;o>n;++n)s[n]=0;return s},zero:li});na.layout.histogram=function(){function t(t,o){for(var a,s,u=[],l=t.map(n,this),c=r.call(this,l,o),h=i.call(this,c,l,o),o=-1,f=l.length,d=h.length-1,p=e?1:1/f;++o<d;)a=u[o]=[],a.dx=h[o+1]-(a.x=h[o]),a.y=0;if(d>0)for(o=-1;++o<f;)s=l[o],s>=c[0]&&s<=c[1]&&(a=u[na.bisect(h,s,1,d)-1],a.y+=p,a.push(t[o]));return u}var e=!0,n=Number,r=gi,i=di;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(r=Et(e),t):r},t.bins=function(e){return arguments.length?(i="number"==typeof e?function(t){return pi(t,e)}:Et(e),t):i},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},na.layout.pack=function(){function t(t,o){var a=n.call(this,t,o),s=a[0],u=i[0],l=i[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(s.x=s.y=0,ti(s,function(t){t.r=+c(t.value)}),ti(s,_i),r){var h=r*(e?1:Math.max(2*s.r/u,2*s.r/l))/2;ti(s,function(t){t.r+=h}),ti(s,_i),ti(s,function(t){t.r-=h})}return ki(s,u/2,l/2,e?1:1/Math.max(2*s.r/u,2*s.r/l)),a}var e,n=na.layout.hierarchy().sort(mi),r=0,i=[1,1];return t.size=function(e){return arguments.length?(i=e,t):i},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(r=+e,t):r},Kr(t,n)},na.layout.tree=function(){function t(t,i){var c=a.call(this,t,i),h=c[0],f=e(h);if(ti(f,n),f.parent.m=-f.z,Zr(f,r),l)Zr(h,o);else{var d=h,p=h,g=h;Zr(h,function(t){t.x<d.x&&(d=t),t.x>p.x&&(p=t),t.depth>g.depth&&(g=t)});var m=s(d,p)/2-d.x,v=u[0]/(p.x+s(p,d)/2+m),y=u[1]/(g.depth||1);Zr(h,function(t){t.x=(t.x+m)*v,t.y=t.depth*y})}return c}function e(t){for(var e,n={A:null,children:[t]},r=[n];null!=(e=r.pop());)for(var i,o=e.children,a=0,s=o.length;s>a;++a)r.push((o[a]=i={_:o[a],parent:e,children:(i=o[a].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=i);return n.children[0]}function n(t){var e=t.children,n=t.parent.children,r=t.i?n[t.i-1]:null;if(e.length){Pi(t);var o=(e[0].z+e[e.length-1].z)/2;r?(t.z=r.z+s(t._,r._),t.m=t.z-o):t.z=o}else r&&(t.z=r.z+s(t._,r._));t.parent.A=i(t,r,t.parent.A||n[0])}function r(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function i(t,e,n){if(e){for(var r,i=t,o=t,a=e,u=i.parent.children[0],l=i.m,c=o.m,h=a.m,f=u.m;a=Mi(a),i=Ei(i),a&&i;)u=Ei(u),o=Mi(o),o.a=t,r=a.z+h-i.z-l+s(a._,i._),r>0&&(Ai(ji(a,t,n),t,r),l+=r,c+=r),h+=a.m,l+=i.m,f+=u.m,c+=o.m;a&&!Mi(o)&&(o.t=a,o.m+=h-c),i&&!Ei(u)&&(u.t=i,u.m+=l-f,n=t)}return n}function o(t){t.x*=u[0],t.y=t.depth*u[1]}var a=na.layout.hierarchy().sort(null).value(null),s=Ci,u=[1,1],l=null;return t.separation=function(e){return arguments.length?(s=e,t):s},t.size=function(e){return arguments.length?(l=null==(u=e)?o:null,t):l?null:u},t.nodeSize=function(e){return arguments.length?(l=null==(u=e)?null:o,t):l?u:null},Kr(t,a)},na.layout.cluster=function(){function t(t,o){var a,s=e.call(this,t,o),u=s[0],l=0;ti(u,function(t){var e=t.children;e&&e.length?(t.x=Ni(e),t.y=Ti(e)):(t.x=a?l+=n(t,a):0,t.y=0,a=t)});var c=$i(u),h=Ii(u),f=c.x-n(c,h)/2,d=h.x+n(h,c)/2;return ti(u,i?function(t){t.x=(t.x-u.x)*r[0],t.y=(u.y-t.y)*r[1]}:function(t){t.x=(t.x-f)/(d-f)*r[0],t.y=(1-(u.y?t.y/u.y:1))*r[1]}),s}var e=na.layout.hierarchy().sort(null).value(null),n=Ci,r=[1,1],i=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(i=null==(r=e),t):i?null:r},t.nodeSize=function(e){return arguments.length?(i=null!=(r=e),t):i?r:null},Kr(t,e)},na.layout.treemap=function(){function t(t,e){for(var n,r,i=-1,o=t.length;++i<o;)r=(n=t[i]).value*(0>e?0:e),n.area=isNaN(r)||0>=r?0:r}function e(n){var o=n.children;if(o&&o.length){var a,s,u,l=h(n),c=[],f=o.slice(),p=1/0,g="slice"===d?l.dx:"dice"===d?l.dy:"slice-dice"===d?1&n.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(t(f,l.dx*l.dy/n.value),c.area=0;(u=f.length)>0;)c.push(a=f[u-1]),c.area+=a.area,"squarify"!==d||(s=r(c,g))<=p?(f.pop(),p=s):(c.area-=c.pop().area,i(c,g,l,!1),g=Math.min(l.dx,l.dy),c.length=c.area=0,p=1/0);c.length&&(i(c,g,l,!0),c.length=c.area=0),o.forEach(e)}}function n(e){var r=e.children;if(r&&r.length){var o,a=h(e),s=r.slice(),u=[];for(t(s,a.dx*a.dy/e.value),u.area=0;o=s.pop();)u.push(o),u.area+=o.area,null!=o.z&&(i(u,o.z?a.dx:a.dy,a,!s.length),u.length=u.area=0);r.forEach(n)}}function r(t,e){for(var n,r=t.area,i=0,o=1/0,a=-1,s=t.length;++a<s;)(n=t[a].area)&&(o>n&&(o=n),n>i&&(i=n));return r*=r,e*=e,r?Math.max(e*i*p/r,r/(e*o*p)):1/0}function i(t,e,n,r){var i,o=-1,a=t.length,s=n.x,l=n.y,c=e?u(t.area/e):0;if(e==n.dx){for((r||c>n.dy)&&(c=n.dy);++o<a;)i=t[o],i.x=s,i.y=l,i.dy=c,s+=i.dx=Math.min(n.x+n.dx-s,c?u(i.area/c):0);i.z=!0,i.dx+=n.x+n.dx-s,n.y+=c,n.dy-=c}else{for((r||c>n.dx)&&(c=n.dx);++o<a;)i=t[o],i.x=s,i.y=l,i.dx=c,l+=i.dy=Math.min(n.y+n.dy-l,c?u(i.area/c):0);i.z=!1,i.dy+=n.y+n.dy-l,n.x+=c,n.dx-=c}}function o(r){var i=a||s(r),o=i[0];return o.x=0,o.y=0,o.dx=l[0],o.dy=l[1],a&&s.revalue(o),t([o],o.dx*o.dy/o.value),(a?n:e)(o),f&&(a=i),i}var a,s=na.layout.hierarchy(),u=Math.round,l=[1,1],c=null,h=Li,f=!1,d="squarify",p=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(l=t,o):l},o.padding=function(t){function e(e){var n=t.call(o,e,e.depth);return null==n?Li(e):Oi(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Oi(e,t)}if(!arguments.length)return c;var r;return h=null==(c=t)?Li:"function"==(r=typeof t)?e:"number"===r?(t=[t,t,t,t],n):n,o},o.round=function(t){return arguments.length?(u=t?Math.round:Number,o):u!=Number},o.sticky=function(t){return arguments.length?(f=t,a=null,o):f},o.ratio=function(t){return arguments.length?(p=t,o):p},o.mode=function(t){return arguments.length?(d=t+"",o):d},Kr(o,s)},na.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,r,i;do n=2*Math.random()-1,r=2*Math.random()-1,i=n*n+r*r;while(!i||i>1);return t+e*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var t=na.random.normal.apply(na,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=na.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e}}},na.scale={};var yu={floor:y,ceil:y};na.scale.linear=function(){return Vi([0,1],[0,1],yr,!1)};var bu={s:1,g:1,p:1,r:1,e:1};na.scale.log=function(){return Qi(na.scale.linear().domain([0,1]),10,!0,[1,10])};var _u=na.format(".0e"),xu={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};na.scale.pow=function(){return Ki(na.scale.linear(),1,[0,1])},na.scale.sqrt=function(){return na.scale.pow().exponent(.5)},na.scale.ordinal=function(){return to([],{t:"range",a:[[]]})},na.scale.category10=function(){return na.scale.ordinal().range(wu)},na.scale.category20=function(){return na.scale.ordinal().range(ku)},na.scale.category20b=function(){return na.scale.ordinal().range(Su)},na.scale.category20c=function(){return na.scale.ordinal().range(Cu)};var wu=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(bt),ku=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(bt),Su=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(bt),Cu=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(bt);na.scale.quantile=function(){return eo([],[])},na.scale.quantize=function(){return no(0,1,[0,1])},na.scale.threshold=function(){return ro([.5],[0,1])},na.scale.identity=function(){return io([0,1])},na.svg={},na.svg.arc=function(){function t(){var t=Math.max(0,+n.apply(this,arguments)),l=Math.max(0,+r.apply(this,arguments)),c=a.apply(this,arguments)-La,h=s.apply(this,arguments)-La,f=Math.abs(h-c),d=c>h?0:1;if(t>l&&(p=l,l=t,t=p),f>=Ia)return e(l,d)+(t?e(t,1-d):"")+"Z";var p,g,m,v,y,b,_,x,w,k,S,C,E=0,M=0,A=[];if((v=(+u.apply(this,arguments)||0)/2)&&(m=o===Eu?Math.sqrt(t*t+l*l):+o.apply(this,arguments),d||(M*=-1),l&&(M=et(m/l*Math.sin(v))),t&&(E=et(m/t*Math.sin(v)))),l){y=l*Math.cos(c+M),b=l*Math.sin(c+M),_=l*Math.cos(h-M),x=l*Math.sin(h-M);var P=Math.abs(h-c-2*M)<=Na?0:1;if(M&&ho(y,b,_,x)===d^P){var j=(c+h)/2;y=l*Math.cos(j),b=l*Math.sin(j),_=x=null}}else y=b=0;if(t){w=t*Math.cos(h-E),k=t*Math.sin(h-E),S=t*Math.cos(c+E),C=t*Math.sin(c+E);var T=Math.abs(c-h+2*E)<=Na?0:1;if(E&&ho(w,k,S,C)===1-d^T){var N=(c+h)/2;w=t*Math.cos(N),k=t*Math.sin(N),S=C=null}}else w=k=0;if((p=Math.min(Math.abs(l-t)/2,+i.apply(this,arguments)))>.001){g=l>t^d?0:1;var $=null==S?[w,k]:null==_?[y,b]:$n([y,b],[S,C],[_,x],[w,k]),I=y-$[0],L=b-$[1],O=_-$[0],D=x-$[1],z=1/Math.sin(Math.acos((I*O+L*D)/(Math.sqrt(I*I+L*L)*Math.sqrt(O*O+D*D)))/2),F=Math.sqrt($[0]*$[0]+$[1]*$[1]);if(null!=_){var R=Math.min(p,(l-F)/(z+1)),B=fo(null==S?[w,k]:[S,C],[y,b],l,R,d),q=fo([_,x],[w,k],l,R,d);p===R?A.push("M",B[0],"A",R,",",R," 0 0,",g," ",B[1],"A",l,",",l," 0 ",1-d^ho(B[1][0],B[1][1],q[1][0],q[1][1]),",",d," ",q[1],"A",R,",",R," 0 0,",g," ",q[0]):A.push("M",B[0],"A",R,",",R," 0 1,",g," ",q[0])}else A.push("M",y,",",b);if(null!=S){var V=Math.min(p,(t-F)/(z-1)),H=fo([y,b],[S,C],t,-V,d),U=fo([w,k],null==_?[y,b]:[_,x],t,-V,d);p===V?A.push("L",U[0],"A",V,",",V," 0 0,",g," ",U[1],"A",t,",",t," 0 ",d^ho(U[1][0],U[1][1],H[1][0],H[1][1]),",",1-d," ",H[1],"A",V,",",V," 0 0,",g," ",H[0]):A.push("L",U[0],"A",V,",",V," 0 0,",g," ",H[0])}else A.push("L",w,",",k)}else A.push("M",y,",",b),null!=_&&A.push("A",l,",",l," 0 ",P,",",d," ",_,",",x),A.push("L",w,",",k),null!=S&&A.push("A",t,",",t," 0 ",T,",",1-d," ",S,",",C);return A.push("Z"),A.join("")}function e(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}var n=ao,r=so,i=oo,o=Eu,a=uo,s=lo,u=co;return t.innerRadius=function(e){return arguments.length?(n=Et(e),t):n},t.outerRadius=function(e){return arguments.length?(r=Et(e),t):r},t.cornerRadius=function(e){return arguments.length?(i=Et(e),t):i},t.padRadius=function(e){return arguments.length?(o=e==Eu?Eu:Et(e),t):o},t.startAngle=function(e){return arguments.length?(a=Et(e),t):a},t.endAngle=function(e){return arguments.length?(s=Et(e),t):s},t.padAngle=function(e){return arguments.length?(u=Et(e),t):u},t.centroid=function(){var t=(+n.apply(this,arguments)+ +r.apply(this,arguments))/2,e=(+a.apply(this,arguments)+ +s.apply(this,arguments))/2-La;return[Math.cos(e)*t,Math.sin(e)*t]},t};var Eu="auto";na.svg.line=function(){return po(y)};var Mu=na.map({linear:go,"linear-closed":mo,step:vo,"step-before":yo,"step-after":bo,basis:Co,"basis-open":Eo,"basis-closed":Mo,bundle:Ao,cardinal:wo,"cardinal-open":_o,"cardinal-closed":xo,monotone:Io});Mu.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Au=[0,2/3,1/3,0],Pu=[0,1/3,2/3,0],ju=[0,1/6,2/3,1/6];na.svg.line.radial=function(){var t=po(Lo);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},yo.reverse=bo,bo.reverse=yo,na.svg.area=function(){return Oo(y)},na.svg.area.radial=function(){var t=Oo(Lo);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},na.svg.chord=function(){function t(t,s){var u=e(this,o,t,s),l=e(this,a,t,s);return"M"+u.p0+r(u.r,u.p1,u.a1-u.a0)+(n(u,l)?i(u.r,u.p1,u.r,u.p0):i(u.r,u.p1,l.r,l.p0)+r(l.r,l.p1,l.a1-l.a0)+i(l.r,l.p1,u.r,u.p0))+"Z"}function e(t,e,n,r){var i=e.call(t,n,r),o=s.call(t,i,r),a=u.call(t,i,r)-La,c=l.call(t,i,r)-La;return{r:o,a0:a,a1:c,p0:[o*Math.cos(a),o*Math.sin(a)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function r(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Na)+",1 "+e}function i(t,e,n,r){return"Q 0,0 "+r}var o=yn,a=bn,s=Do,u=uo,l=lo;return t.radius=function(e){return arguments.length?(s=Et(e),t):s},t.source=function(e){return arguments.length?(o=Et(e),t):o},t.target=function(e){return arguments.length?(a=Et(e),t):a},t.startAngle=function(e){return arguments.length?(u=Et(e),t):u},t.endAngle=function(e){return arguments.length?(l=Et(e),t):l},t},na.svg.diagonal=function(){function t(t,i){var o=e.call(this,t,i),a=n.call(this,t,i),s=(o.y+a.y)/2,u=[o,{x:o.x,y:s},{x:a.x,y:s},a];return u=u.map(r),"M"+u[0]+"C"+u[1]+" "+u[2]+" "+u[3]}var e=yn,n=bn,r=zo;return t.source=function(n){return arguments.length?(e=Et(n),t):e},t.target=function(e){return arguments.length?(n=Et(e),t):n},t.projection=function(e){return arguments.length?(r=e,t):r},t},na.svg.diagonal.radial=function(){var t=na.svg.diagonal(),e=zo,n=t.projection;return t.projection=function(t){return arguments.length?n(Fo(e=t)):e},t},na.svg.symbol=function(){function t(t,r){return(Tu.get(e.call(this,t,r))||qo)(n.call(this,t,r))}var e=Bo,n=Ro;return t.type=function(n){return arguments.length?(e=Et(n),t):e},t.size=function(e){return arguments.length?(n=Et(e),t):n},t};var Tu=na.map({circle:qo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*$u)),n=e*$u;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Nu),n=e*Nu/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Nu),n=e*Nu/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});na.svg.symbolTypes=Tu.keys();var Nu=Math.sqrt(3),$u=Math.tan(30*Oa);ka.transition=function(t){for(var e,n,r=Iu||++zu,i=Wo(t),o=[],a=Lu||{time:Date.now(),ease:Cr,delay:0,duration:250},s=-1,u=this.length;++s<u;){o.push(e=[]);for(var l=this[s],c=-1,h=l.length;++c<h;)(n=l[c])&&Yo(n,c,i,r,a),e.push(n)}return Ho(o,i,r)},ka.interrupt=function(t){return this.each(null==t?Ou:Vo(Wo(t)))};var Iu,Lu,Ou=Vo(Wo()),Du=[],zu=0;Du.call=ka.call,Du.empty=ka.empty,Du.node=ka.node,Du.size=ka.size,na.transition=function(t,e){return t&&t.transition?Iu?t.transition(e):t:na.selection().transition(t)},na.transition.prototype=Du,Du.select=function(t){var e,n,r,i=this.id,o=this.namespace,a=[];t=A(t);for(var s=-1,u=this.length;++s<u;){a.push(e=[]);for(var l=this[s],c=-1,h=l.length;++c<h;)(r=l[c])&&(n=t.call(r,r.__data__,c,s))?("__data__"in r&&(n.__data__=r.__data__),Yo(n,c,o,i,r[o][i]),e.push(n)):e.push(null)}return Ho(a,o,i)},Du.selectAll=function(t){var e,n,r,i,o,a=this.id,s=this.namespace,u=[];t=P(t);for(var l=-1,c=this.length;++l<c;)for(var h=this[l],f=-1,d=h.length;++f<d;)if(r=h[f]){o=r[s][a],n=t.call(r,r.__data__,f,l),u.push(e=[]);for(var p=-1,g=n.length;++p<g;)(i=n[p])&&Yo(i,p,s,a,o),e.push(i)}return Ho(u,s,a)},Du.filter=function(t){var e,n,r,i=[];"function"!=typeof t&&(t=B(t));for(var o=0,a=this.length;a>o;o++){i.push(e=[]);for(var n=this[o],s=0,u=n.length;u>s;s++)(r=n[s])&&t.call(r,r.__data__,s,o)&&e.push(r)}return Ho(i,this.namespace,this.id)},Du.tween=function(t,e){var n=this.id,r=this.namespace;return arguments.length<2?this.node()[r][n].tween.get(t):V(this,null==e?function(e){e[r][n].tween.remove(t)}:function(i){i[r][n].tween.set(t,e)})},Du.attr=function(t,e){function n(){this.removeAttribute(s)}function r(){this.removeAttributeNS(s.space,s.local)}function i(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(s);return n!==t&&(e=a(n,t),function(t){this.setAttribute(s,e(t))})})}function o(t){return null==t?r:(t+="",function(){var e,n=this.getAttributeNS(s.space,s.local);return n!==t&&(e=a(n,t),function(t){this.setAttributeNS(s.space,s.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var a="transform"==t?Br:yr,s=na.ns.qualify(t);return Uo(this,"attr."+t,e,s.local?o:i)},Du.attrTween=function(t,e){function n(t,n){var r=e.call(this,t,n,this.getAttribute(i));return r&&function(t){this.setAttribute(i,r(t))}}function r(t,n){var r=e.call(this,t,n,this.getAttributeNS(i.space,i.local));return r&&function(t){this.setAttributeNS(i.space,i.local,r(t))}}var i=na.ns.qualify(t);return this.tween("attr."+t,i.local?r:n)},Du.style=function(t,n,r){function i(){this.style.removeProperty(t)}function o(n){return null==n?i:(n+="",function(){var i,o=e(this).getComputedStyle(this,null).getPropertyValue(t);return o!==n&&(i=yr(o,n),function(e){this.style.setProperty(t,i(e),r)})})}var a=arguments.length;if(3>a){if("string"!=typeof t){2>a&&(n="");for(r in t)this.style(r,t[r],n);return this}r=""}return Uo(this,"style."+t,n,o)},Du.styleTween=function(t,n,r){function i(i,o){var a=n.call(this,i,o,e(this).getComputedStyle(this,null).getPropertyValue(t));return a&&function(e){this.style.setProperty(t,a(e),r)}}return arguments.length<3&&(r=""),this.tween("style."+t,i)},Du.text=function(t){return Uo(this,"text",t,Go)},Du.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},Du.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=na.ease.apply(na,arguments)),V(this,function(r){r[n][e].ease=t}))},Du.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:V(this,"function"==typeof t?function(r,i,o){r[n][e].delay=+t.call(r,r.__data__,i,o)}:(t=+t,function(r){r[n][e].delay=t}))},Du.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:V(this,"function"==typeof t?function(r,i,o){r[n][e].duration=Math.max(1,t.call(r,r.__data__,i,o))}:(t=Math.max(1,t),function(r){r[n][e].duration=t}))},Du.each=function(t,e){var n=this.id,r=this.namespace;if(arguments.length<2){var i=Lu,o=Iu;try{Iu=n,V(this,function(e,i,o){Lu=e[r][n],t.call(e,e.__data__,i,o)})}finally{Lu=i,Iu=o}}else V(this,function(i){var o=i[r][n];(o.event||(o.event=na.dispatch("start","end","interrupt"))).on(t,e)});return this},Du.transition=function(){for(var t,e,n,r,i=this.id,o=++zu,a=this.namespace,s=[],u=0,l=this.length;l>u;u++){s.push(t=[]);for(var e=this[u],c=0,h=e.length;h>c;c++)(n=e[c])&&(r=n[a][i],Yo(n,c,a,o,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),t.push(n)}return Ho(s,a,o)},na.svg.axis=function(){function t(t){t.each(function(){var t,l=na.select(this),c=this.__chart__||n,h=this.__chart__=n.copy(),f=null==u?h.ticks?h.ticks.apply(h,s):h.domain():u,d=null==e?h.tickFormat?h.tickFormat.apply(h,s):y:e,p=l.selectAll(".tick").data(f,h),g=p.enter().insert("g",".domain").attr("class","tick").style("opacity",ja),m=na.transition(p.exit()).style("opacity",ja).remove(),v=na.transition(p.order()).style("opacity",1),b=Math.max(i,0)+a,_=zi(h),x=l.selectAll(".domain").data([0]),w=(x.enter().append("path").attr("class","domain"),na.transition(x));g.append("line"),g.append("text");var k,S,C,E,M=g.select("line"),A=v.select("line"),P=p.select("text").text(d),j=g.select("text"),T=v.select("text"),N="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(t=Xo,k="x",C="y",S="x2",E="y2",P.attr("dy",0>N?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+_[0]+","+N*o+"V0H"+_[1]+"V"+N*o)):(t=Jo,k="y",C="x",S="y2",E="x2",P.attr("dy",".32em").style("text-anchor",0>N?"end":"start"),w.attr("d","M"+N*o+","+_[0]+"H0V"+_[1]+"H"+N*o)),M.attr(E,N*i),j.attr(C,N*b),A.attr(S,0).attr(E,N*i),T.attr(k,0).attr(C,N*b),h.rangeBand){var $=h,I=$.rangeBand()/2;c=h=function(t){return $(t)+I}}else c.rangeBand?c=h:m.call(t,h,c);g.call(t,c,h),v.call(t,h,h)})}var e,n=na.scale.linear(),r=Fu,i=6,o=6,a=3,s=[10],u=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(r=e in Ru?e+"":Fu,t):r},t.ticks=function(){return arguments.length?(s=arguments,t):s},t.tickValues=function(e){return arguments.length?(u=e,t):u},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(i=+e,o=+arguments[n-1],t):i},t.innerTickSize=function(e){return arguments.length?(i=+e,t):i},t.outerTickSize=function(e){return arguments.length?(o=+e,t):o},t.tickPadding=function(e){return arguments.length?(a=+e,t):a},t.tickSubdivide=function(){return arguments.length&&t},t};var Fu="bottom",Ru={top:1,right:1,bottom:1,left:1};na.svg.brush=function(){function t(e){e.each(function(){var e=na.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",o).on("touchstart.brush",o),a=e.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=e.selectAll(".resize").data(g,y);s.exit().remove(),s.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Bu[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",t.empty()?"none":null);var u,h=na.transition(e),f=na.transition(a);l&&(u=zi(l),f.attr("x",u[0]).attr("width",u[1]-u[0]),r(h)),c&&(u=zi(c),f.attr("y",u[0]).attr("height",u[1]-u[0]),i(h)),n(h)})}function n(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+h[+/e$/.test(t)]+","+f[+/^s/.test(t)]+")"})}function r(t){t.select(".extent").attr("x",h[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1]-h[0])}function i(t){t.select(".extent").attr("y",f[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1]-f[0])}function o(){function o(){32==na.event.keyCode&&(P||(b=null,T[0]-=h[1],T[1]-=f[1],P=2),S())}function g(){32==na.event.keyCode&&2==P&&(T[0]+=h[1],T[1]+=f[1],P=0,S())}function m(){var t=na.mouse(x),e=!1;_&&(t[0]+=_[0],t[1]+=_[1]),P||(na.event.altKey?(b||(b=[(h[0]+h[1])/2,(f[0]+f[1])/2]),T[0]=h[+(t[0]<b[0])],T[1]=f[+(t[1]<b[1])]):b=null),M&&v(t,l,0)&&(r(C),e=!0),A&&v(t,c,1)&&(i(C),e=!0),e&&(n(C),k({type:"brush",mode:P?"move":"resize"}))}function v(t,e,n){var r,i,o=zi(e),u=o[0],l=o[1],c=T[n],g=n?f:h,m=g[1]-g[0];return P&&(u-=c,l-=m+c),r=(n?p:d)?Math.max(u,Math.min(l,t[n])):t[n],P?i=(r+=c)+m:(b&&(c=Math.max(u,Math.min(l,2*b[n]-r))),r>c?(i=r,r=c):i=c),g[0]!=r||g[1]!=i?(n?s=null:a=null,g[0]=r,g[1]=i,!0):void 0}function y(){m(),C.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),na.select("body").style("cursor",null),N.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),
j(),k({type:"brushend"})}var b,_,x=this,w=na.select(na.event.target),k=u.of(x,arguments),C=na.select(x),E=w.datum(),M=!/^(n|s)$/.test(E)&&l,A=!/^(e|w)$/.test(E)&&c,P=w.classed("extent"),j=X(x),T=na.mouse(x),N=na.select(e(x)).on("keydown.brush",o).on("keyup.brush",g);if(na.event.changedTouches?N.on("touchmove.brush",m).on("touchend.brush",y):N.on("mousemove.brush",m).on("mouseup.brush",y),C.interrupt().selectAll("*").interrupt(),P)T[0]=h[0]-T[0],T[1]=f[0]-T[1];else if(E){var $=+/w$/.test(E),I=+/^n/.test(E);_=[h[1-$]-T[0],f[1-I]-T[1]],T[0]=h[$],T[1]=f[I]}else na.event.altKey&&(b=T.slice());C.style("pointer-events","none").selectAll(".resize").style("display",null),na.select("body").style("cursor",w.style("cursor")),k({type:"brushstart"}),m()}var a,s,u=E(t,"brushstart","brush","brushend"),l=null,c=null,h=[0,0],f=[0,0],d=!0,p=!0,g=qu[0];return t.event=function(t){t.each(function(){var t=u.of(this,arguments),e={x:h,y:f,i:a,j:s},n=this.__chart__||e;this.__chart__=e,Iu?na.select(this).transition().each("start.brush",function(){a=n.i,s=n.j,h=n.x,f=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=br(h,e.x),r=br(f,e.y);return a=s=null,function(i){h=e.x=n(i),f=e.y=r(i),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){a=e.i,s=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(l=e,g=qu[!l<<1|!c],t):l},t.y=function(e){return arguments.length?(c=e,g=qu[!l<<1|!c],t):c},t.clamp=function(e){return arguments.length?(l&&c?(d=!!e[0],p=!!e[1]):l?d=!!e:c&&(p=!!e),t):l&&c?[d,p]:l?d:c?p:null},t.extent=function(e){var n,r,i,o,u;return arguments.length?(l&&(n=e[0],r=e[1],c&&(n=n[0],r=r[0]),a=[n,r],l.invert&&(n=l(n),r=l(r)),n>r&&(u=n,n=r,r=u),(n!=h[0]||r!=h[1])&&(h=[n,r])),c&&(i=e[0],o=e[1],l&&(i=i[1],o=o[1]),s=[i,o],c.invert&&(i=c(i),o=c(o)),i>o&&(u=i,i=o,o=u),(i!=f[0]||o!=f[1])&&(f=[i,o])),t):(l&&(a?(n=a[0],r=a[1]):(n=h[0],r=h[1],l.invert&&(n=l.invert(n),r=l.invert(r)),n>r&&(u=n,n=r,r=u))),c&&(s?(i=s[0],o=s[1]):(i=f[0],o=f[1],c.invert&&(i=c.invert(i),o=c.invert(o)),i>o&&(u=i,i=o,o=u))),l&&c?[[n,i],[r,o]]:l?[n,r]:c&&[i,o])},t.clear=function(){return t.empty()||(h=[0,0],f=[0,0],a=s=null),t},t.empty=function(){return!!l&&h[0]==h[1]||!!c&&f[0]==f[1]},na.rebind(t,u,"on")};var Bu={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},qu=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Vu=us.format=ps.timeFormat,Hu=Vu.utc,Uu=Hu("%Y-%m-%dT%H:%M:%S.%LZ");Vu.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Qo:Uu,Qo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Qo.toString=Uu.toString,us.second=Ft(function(t){return new ls(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),us.seconds=us.second.range,us.seconds.utc=us.second.utc.range,us.minute=Ft(function(t){return new ls(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),us.minutes=us.minute.range,us.minutes.utc=us.minute.utc.range,us.hour=Ft(function(t){var e=t.getTimezoneOffset()/60;return new ls(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),us.hours=us.hour.range,us.hours.utc=us.hour.utc.range,us.month=Ft(function(t){return t=us.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),us.months=us.month.range,us.months.utc=us.month.utc.range;var Gu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Wu=[[us.second,1],[us.second,5],[us.second,15],[us.second,30],[us.minute,1],[us.minute,5],[us.minute,15],[us.minute,30],[us.hour,1],[us.hour,3],[us.hour,6],[us.hour,12],[us.day,1],[us.day,2],[us.week,1],[us.month,1],[us.month,3],[us.year,1]],Yu=Vu.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Ae]]),Xu={range:function(t,e,n){return na.range(Math.ceil(t/n)*n,+e,n).map(Zo)},floor:y,ceil:y};Wu.year=us.year,us.scale=function(){return Ko(na.scale.linear(),Wu,Yu)};var Ju=Wu.map(function(t){return[t[0].utc,t[1]]}),Qu=Hu.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Ae]]);Ju.year=us.year.utc,us.scale.utc=function(){return Ko(na.scale.linear(),Ju,Qu)},na.text=Mt(function(t){return t.responseText}),na.json=function(t,e){return At(t,"application/json",ta,e)},na.html=function(t,e){return At(t,"text/html",ea,e)},na.xml=Mt(function(t){return t.responseXML}),"function"==typeof define&&define.amd?define(na):"object"==typeof module&&module.exports&&(module.exports=na),this.d3=na}(),function(){function t(t){function e(e,n,r,i,o,a){for(;o>=0&&a>o;o+=t){var s=i?i[o]:o;r=n(r,e[s],s,e)}return r}return function(n,r,i,o){r=b(r,o,4);var a=!E(n)&&y.keys(n),s=(a||n).length,u=t>0?0:s-1;return arguments.length<3&&(i=n[a?a[u]:u],u+=t),e(n,r,i,a,u,s)}}function e(t){return function(e,n,r){n=_(n,r);for(var i=C(e),o=t>0?0:i-1;o>=0&&i>o;o+=t)if(n(e[o],o,e))return o;return-1}}function n(t,e,n){return function(r,i,o){var a=0,s=C(r);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return o=n(r,i),r[o]===i?o:-1;if(i!==i)return o=e(c.call(r,a,s),y.isNaN),o>=0?o+a:-1;for(o=t>0?a:s-1;o>=0&&s>o;o+=t)if(r[o]===i)return o;return-1}}function r(t,e){var n=T.length,r=t.constructor,i=y.isFunction(r)&&r.prototype||s,o="constructor";for(y.has(t,o)&&!y.contains(e,o)&&e.push(o);n--;)o=T[n],o in t&&t[o]!==i[o]&&!y.contains(e,o)&&e.push(o)}var i=this,o=i._,a=Array.prototype,s=Object.prototype,u=Function.prototype,l=a.push,c=a.slice,h=s.toString,f=s.hasOwnProperty,d=Array.isArray,p=Object.keys,g=u.bind,m=Object.create,v=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=y),exports._=y):i._=y,y.VERSION="1.8.3";var b=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}},_=function(t,e,n){return null==t?y.identity:y.isFunction(t)?b(t,e,n):y.isObject(t)?y.matcher(t):y.property(t)};y.iteratee=function(t,e){return _(t,e,1/0)};var x=function(t,e){return function(n){var r=arguments.length;if(2>r||null==n)return n;for(var i=1;r>i;i++)for(var o=arguments[i],a=t(o),s=a.length,u=0;s>u;u++){var l=a[u];e&&void 0!==n[l]||(n[l]=o[l])}return n}},w=function(t){if(!y.isObject(t))return{};if(m)return m(t);v.prototype=t;var e=new v;return v.prototype=null,e},k=function(t){return function(e){return null==e?void 0:e[t]}},S=Math.pow(2,53)-1,C=k("length"),E=function(t){var e=C(t);return"number"==typeof e&&e>=0&&S>=e};y.each=y.forEach=function(t,e,n){e=b(e,n);var r,i;if(E(t))for(r=0,i=t.length;i>r;r++)e(t[r],r,t);else{var o=y.keys(t);for(r=0,i=o.length;i>r;r++)e(t[o[r]],o[r],t)}return t},y.map=y.collect=function(t,e,n){e=_(e,n);for(var r=!E(t)&&y.keys(t),i=(r||t).length,o=Array(i),a=0;i>a;a++){var s=r?r[a]:a;o[a]=e(t[s],s,t)}return o},y.reduce=y.foldl=y.inject=t(1),y.reduceRight=y.foldr=t(-1),y.find=y.detect=function(t,e,n){var r;return r=E(t)?y.findIndex(t,e,n):y.findKey(t,e,n),void 0!==r&&-1!==r?t[r]:void 0},y.filter=y.select=function(t,e,n){var r=[];return e=_(e,n),y.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r},y.reject=function(t,e,n){return y.filter(t,y.negate(_(e)),n)},y.every=y.all=function(t,e,n){e=_(e,n);for(var r=!E(t)&&y.keys(t),i=(r||t).length,o=0;i>o;o++){var a=r?r[o]:o;if(!e(t[a],a,t))return!1}return!0},y.some=y.any=function(t,e,n){e=_(e,n);for(var r=!E(t)&&y.keys(t),i=(r||t).length,o=0;i>o;o++){var a=r?r[o]:o;if(e(t[a],a,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,n,r){return E(t)||(t=y.values(t)),("number"!=typeof n||r)&&(n=0),y.indexOf(t,e,n)>=0},y.invoke=function(t,e){var n=c.call(arguments,2),r=y.isFunction(e);return y.map(t,function(t){var i=r?e:t[e];return null==i?i:i.apply(t,n)})},y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,n){var r,i,o=-(1/0),a=-(1/0);if(null==e&&null!=t){t=E(t)?t:y.values(t);for(var s=0,u=t.length;u>s;s++)r=t[s],r>o&&(o=r)}else e=_(e,n),y.each(t,function(t,n,r){i=e(t,n,r),(i>a||i===-(1/0)&&o===-(1/0))&&(o=t,a=i)});return o},y.min=function(t,e,n){var r,i,o=1/0,a=1/0;if(null==e&&null!=t){t=E(t)?t:y.values(t);for(var s=0,u=t.length;u>s;s++)r=t[s],o>r&&(o=r)}else e=_(e,n),y.each(t,function(t,n,r){i=e(t,n,r),(a>i||i===1/0&&o===1/0)&&(o=t,a=i)});return o},y.shuffle=function(t){for(var e,n=E(t)?t:y.values(t),r=n.length,i=Array(r),o=0;r>o;o++)e=y.random(0,o),e!==o&&(i[o]=i[e]),i[e]=n[o];return i},y.sample=function(t,e,n){return null==e||n?(E(t)||(t=y.values(t)),t[y.random(t.length-1)]):y.shuffle(t).slice(0,Math.max(0,e))},y.sortBy=function(t,e,n){return e=_(e,n),y.pluck(y.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index-e.index}),"value")};var M=function(t){return function(e,n,r){var i={};return n=_(n,r),y.each(e,function(r,o){var a=n(r,o,e);t(i,r,a)}),i}};y.groupBy=M(function(t,e,n){y.has(t,n)?t[n].push(e):t[n]=[e]}),y.indexBy=M(function(t,e,n){t[n]=e}),y.countBy=M(function(t,e,n){y.has(t,n)?t[n]++:t[n]=1}),y.toArray=function(t){return t?y.isArray(t)?c.call(t):E(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:E(t)?t.length:y.keys(t).length},y.partition=function(t,e,n){e=_(e,n);var r=[],i=[];return y.each(t,function(t,n,o){(e(t,n,o)?r:i).push(t)}),[r,i]},y.first=y.head=y.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,n){return c.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},y.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,n){return c.call(t,null==e||n?1:e)},y.compact=function(t){return y.filter(t,y.identity)};var A=function(t,e,n,r){for(var i=[],o=0,a=r||0,s=C(t);s>a;a++){var u=t[a];if(E(u)&&(y.isArray(u)||y.isArguments(u))){e||(u=A(u,e,n));var l=0,c=u.length;for(i.length+=c;c>l;)i[o++]=u[l++]}else n||(i[o++]=u)}return i};y.flatten=function(t,e){return A(t,e,!1)},y.without=function(t){return y.difference(t,c.call(arguments,1))},y.uniq=y.unique=function(t,e,n,r){y.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=_(n,r));for(var i=[],o=[],a=0,s=C(t);s>a;a++){var u=t[a],l=n?n(u,a,t):u;e?(a&&o===l||i.push(u),o=l):n?y.contains(o,l)||(o.push(l),i.push(u)):y.contains(i,u)||i.push(u)}return i},y.union=function(){return y.uniq(A(arguments,!0,!0))},y.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=C(t);i>r;r++){var o=t[r];if(!y.contains(e,o)){for(var a=1;n>a&&y.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},y.difference=function(t){var e=A(arguments,!0,!0,1);return y.filter(t,function(t){return!y.contains(e,t)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(t){for(var e=t&&y.max(t,C).length||0,n=Array(e),r=0;e>r;r++)n[r]=y.pluck(t,r);return n},y.object=function(t,e){for(var n={},r=0,i=C(t);i>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},y.findIndex=e(1),y.findLastIndex=e(-1),y.sortedIndex=function(t,e,n,r){n=_(n,r,1);for(var i=n(e),o=0,a=C(t);a>o;){var s=Math.floor((o+a)/2);n(t[s])<i?o=s+1:a=s}return o},y.indexOf=n(1,y.findIndex,y.sortedIndex),y.lastIndexOf=n(-1,y.findLastIndex),y.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;r>o;o++,t+=n)i[o]=t;return i};var P=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=w(t.prototype),a=t.apply(o,i);return y.isObject(a)?a:o};y.bind=function(t,e){if(g&&t.bind===g)return g.apply(t,c.call(arguments,1));if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var n=c.call(arguments,2),r=function(){return P(t,r,e,this,n.concat(c.call(arguments)))};return r},y.partial=function(t){var e=c.call(arguments,1),n=function(){for(var r=0,i=e.length,o=Array(i),a=0;i>a;a++)o[a]=e[a]===y?arguments[r++]:e[a];for(;r<arguments.length;)o.push(arguments[r++]);return P(t,n,this,this,o)};return n},y.bindAll=function(t){var e,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(e=1;r>e;e++)n=arguments[e],t[n]=y.bind(t[n],t);return t},y.memoize=function(t,e){var n=function(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return y.has(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n},y.delay=function(t,e){var n=c.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,n){var r,i,o,a=null,s=0;n||(n={});var u=function(){s=n.leading===!1?0:y.now(),a=null,o=t.apply(r,i),a||(r=i=null)};return function(){var l=y.now();s||n.leading!==!1||(s=l);var c=e-(l-s);return r=this,i=arguments,0>=c||c>e?(a&&(clearTimeout(a),a=null),s=l,o=t.apply(r,i),a||(r=i=null)):a||n.trailing===!1||(a=setTimeout(u,c)),o}},y.debounce=function(t,e,n){var r,i,o,a,s,u=function(){var l=y.now()-a;e>l&&l>=0?r=setTimeout(u,e-l):(r=null,n||(s=t.apply(o,i),r||(o=i=null)))};return function(){o=this,i=arguments,a=y.now();var l=n&&!r;return r||(r=setTimeout(u,e)),l&&(s=t.apply(o,i),o=i=null),s}},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},y.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},y.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},y.once=y.partial(y.before,2);var j=!{toString:null}.propertyIsEnumerable("toString"),T=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(t){if(!y.isObject(t))return[];if(p)return p(t);var e=[];for(var n in t)y.has(t,n)&&e.push(n);return j&&r(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var n in t)e.push(n);return j&&r(t,e),e},y.values=function(t){for(var e=y.keys(t),n=e.length,r=Array(n),i=0;n>i;i++)r[i]=t[e[i]];return r},y.mapObject=function(t,e,n){e=_(e,n);for(var r,i=y.keys(t),o=i.length,a={},s=0;o>s;s++)r=i[s],a[r]=e(t[r],r,t);return a},y.pairs=function(t){for(var e=y.keys(t),n=e.length,r=Array(n),i=0;n>i;i++)r[i]=[e[i],t[e[i]]];return r},y.invert=function(t){for(var e={},n=y.keys(t),r=0,i=n.length;i>r;r++)e[t[n[r]]]=n[r];return e},y.functions=y.methods=function(t){var e=[];for(var n in t)y.isFunction(t[n])&&e.push(n);return e.sort()},y.extend=x(y.allKeys),y.extendOwn=y.assign=x(y.keys),y.findKey=function(t,e,n){e=_(e,n);for(var r,i=y.keys(t),o=0,a=i.length;a>o;o++)if(r=i[o],e(t[r],r,t))return r},y.pick=function(t,e,n){var r,i,o={},a=t;if(null==a)return o;y.isFunction(e)?(i=y.allKeys(a),r=b(e,n)):(i=A(arguments,!1,!1,1),r=function(t,e,n){return e in n},a=Object(a));for(var s=0,u=i.length;u>s;s++){var l=i[s],c=a[l];r(c,l,a)&&(o[l]=c)}return o},y.omit=function(t,e,n){if(y.isFunction(e))e=y.negate(e);else{var r=y.map(A(arguments,!1,!1,1),String);e=function(t,e){return!y.contains(r,e)}}return y.pick(t,e,n)},y.defaults=x(y.allKeys,!0),y.create=function(t,e){var n=w(t);return e&&y.extendOwn(n,e),n},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var n=y.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;r>o;o++){var a=n[o];if(e[a]!==i[a]||!(a in i))return!1}return!0};var N=function(t,e,n,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var i=h.call(t);if(i!==h.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(y.isFunction(a)&&a instanceof a&&y.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],r=r||[];for(var u=n.length;u--;)if(n[u]===t)return r[u]===e;if(n.push(t),r.push(e),o){if(u=t.length,u!==e.length)return!1;for(;u--;)if(!N(t[u],e[u],n,r))return!1}else{var l,c=y.keys(t);if(u=c.length,y.keys(e).length!==u)return!1;for(;u--;)if(l=c[u],!y.has(e,l)||!N(t[l],e[l],n,r))return!1}return n.pop(),r.pop(),!0};y.isEqual=function(t,e){return N(t,e)},y.isEmpty=function(t){return null==t?!0:E(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=d||function(t){return"[object Array]"===h.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){y["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return y.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&t!==+t},y.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===h.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){return null!=t&&f.call(t,e)},y.noConflict=function(){return i._=o,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=k,y.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,n){var r=Array(Math.max(0,t));e=b(e,n,1);for(var i=0;t>i;i++)r[i]=e(i);return r},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var $={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},I=y.invert($),L=function(t){var e=function(e){return t[e]},n="(?:"+y.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};y.escape=L($),y.unescape=L(I),y.result=function(t,e,n){var r=null==t?void 0:t[e];return void 0===r&&(r=n),y.isFunction(r)?r.call(t):r};var O=0;y.uniqueId=function(t){var e=++O+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\u2028|\u2029/g,R=function(t){return"\\"+z[t]};y.template=function(t,e,n){!e&&n&&(e=n),e=y.defaults({},e,y.templateSettings);var r=RegExp([(e.escape||D).source,(e.interpolate||D).source,(e.evaluate||D).source].join("|")+"|$","g"),i=0,o="__p+='";t.replace(r,function(e,n,r,a,s){return o+=t.slice(i,s).replace(F,R),i=s+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(e.variable||"obj","_",o)}catch(s){throw s.source=o,s}var u=function(t){return a.call(this,t,y)},l=e.variable||"obj";return u.source="function("+l+"){\n"+o+"}",u},y.chain=function(t){var e=y(t);return e._chain=!0,e};var B=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){y.each(y.functions(t),function(e){var n=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return l.apply(t,arguments),B(this,n.apply(y,t))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=a[t];y.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],B(this,n)}}),y.each(["concat","join","slice"],function(t){var e=a[t];y.prototype[t]=function(){return B(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}.call(this),function(t){"use strict";var e,n=t.Base64,r="2.1.9";if("undefined"!=typeof module&&module.exports)try{e=require("buffer").Buffer}catch(i){}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(t){for(var e={},n=0,r=t.length;r>n;n++)e[t.charAt(n)]=n;return e}(o),s=String.fromCharCode,u=function(t){if(t.length<2){var e=t.charCodeAt(0);return 128>e?t:2048>e?s(192|e>>>6)+s(128|63&e):s(224|e>>>12&15)+s(128|e>>>6&63)+s(128|63&e)}var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return s(240|e>>>18&7)+s(128|e>>>12&63)+s(128|e>>>6&63)+s(128|63&e)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(t){return t.replace(l,u)},h=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0),r=[o.charAt(n>>>18),o.charAt(n>>>12&63),e>=2?"=":o.charAt(n>>>6&63),e>=1?"=":o.charAt(63&n)];return r.join("")},f=t.btoa?function(e){return t.btoa(e)}:function(t){return t.replace(/[\s\S]{1,3}/g,h)},d=e?function(t){return(t.constructor===e.constructor?t:new e(t)).toString("base64")}:function(t){return f(c(t))},p=function(t,e){return e?d(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):d(String(t))},g=function(t){return p(t,!0)},m=new RegExp(["[\xc0-\xdf][\x80-\xbf]","[\xe0-\xef][\x80-\xbf]{2}","[\xf0-\xf7][\x80-\xbf]{3}"].join("|"),"g"),v=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return s((n>>>10)+55296)+s((1023&n)+56320);case 3:return s((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return s((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},y=function(t){return t.replace(m,v)},b=function(t){var e=t.length,n=e%4,r=(e>0?a[t.charAt(0)]<<18:0)|(e>1?a[t.charAt(1)]<<12:0)|(e>2?a[t.charAt(2)]<<6:0)|(e>3?a[t.charAt(3)]:0),i=[s(r>>>16),s(r>>>8&255),s(255&r)];return i.length-=[0,0,2,1][n],i.join("")},_=t.atob?function(e){return t.atob(e)}:function(t){return t.replace(/[\s\S]{1,4}/g,b)},x=e?function(t){return(t.constructor===e.constructor?t:new e(t,"base64")).toString()}:function(t){return y(_(t))},w=function(t){return x(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},k=function(){var e=t.Base64;return t.Base64=n,e};if(t.Base64={VERSION:r,atob:_,btoa:f,fromBase64:w,toBase64:p,utob:c,encode:p,encodeURI:g,btou:y,decode:w,noConflict:k},"function"==typeof Object.defineProperty){var S=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",S(function(){return w(this)})),Object.defineProperty(String.prototype,"toBase64",S(function(t){return p(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",S(function(){return p(this,!0)}))}}t.Meteor&&(Base64=t.Base64)}(this),!function(){"use strict";function t(t,e,n,r){function i(t,e){return t-=r,e-=r,0>t||t>=a||0>e||e>=a?!1:o.isDark(t,e)}var o=b(n,e);o.addData(t),o.make(),r=r||0;var a=o.getModuleCount(),s=o.getModuleCount()+2*r,u=function(t,e,n,r){var i=this.isDark,o=1/s;this.isDark=function(a,s){var u=s*o,l=a*o,c=u+o,h=l+o;return i(a,s)&&(t>c||u>n||e>h||l>r)}};this.text=t,this.level=e,this.version=n,this.moduleCount=s,this.isDark=i,this.addBlank=u}function e(e,n,r,i,o){r=Math.max(1,r||1),i=Math.min(40,i||40);for(var a=r;i>=a;a+=1)try{return new t(e,n,a,o)}catch(s){}}function n(t,e,n){var r=n.size,i="bold "+n.mSize*r+"px "+n.fontname,o=g("<canvas/>")[0].getContext("2d");o.font=i;var a=o.measureText(n.label).width,s=n.mSize,u=a/r,l=(1-u)*n.mPosX,c=(1-s)*n.mPosY,h=l+u,f=c+s,d=.01;1===n.mode?t.addBlank(0,c-d,r,f+d):t.addBlank(l-d,c-d,h+d,f+d),e.fillStyle=n.fontcolor,e.font=i,e.fillText(n.label,l*r,c*r+.75*n.mSize*r)}function r(t,e,n){var r=n.size,i=n.image.naturalWidth||1,o=n.image.naturalHeight||1,a=n.mSize,s=a*i/o,u=(1-s)*n.mPosX,l=(1-a)*n.mPosY,c=u+s,h=l+a,f=.01;3===n.mode?t.addBlank(0,l-f,r,h+f):t.addBlank(u-f,l-f,c+f,h+f),e.drawImage(n.image,u*r,l*r,s*r,a*r)}function i(t,e,i){g(i.background).is("img")?e.drawImage(i.background,0,0,i.size,i.size):i.background&&(e.fillStyle=i.background,e.fillRect(i.left,i.top,i.size,i.size));var o=i.mode;1===o||2===o?n(t,e,i):(3===o||4===o)&&r(t,e,i)}function o(t,e,n,r,i,o,a,s){t.isDark(a,s)&&e.rect(r,i,o,o)}function a(t,e,n,r,i,o,a,s,u,l){a?t.moveTo(e+o,n):t.moveTo(e,n),s?(t.lineTo(r-o,n),t.arcTo(r,n,r,i,o)):t.lineTo(r,n),u?(t.lineTo(r,i-o),t.arcTo(r,i,e,i,o)):t.lineTo(r,i),l?(t.lineTo(e+o,i),t.arcTo(e,i,e,n,o)):t.lineTo(e,i),a?(t.lineTo(e,n+o),t.arcTo(e,n,r,n,o)):t.lineTo(e,n)}function s(t,e,n,r,i,o,a,s,u,l){a&&(t.moveTo(e+o,n),t.lineTo(e,n),t.lineTo(e,n+o),t.arcTo(e,n,e+o,n,o)),s&&(t.moveTo(r-o,n),t.lineTo(r,n),t.lineTo(r,n+o),t.arcTo(r,n,r-o,n,o)),u&&(t.moveTo(r-o,i),t.lineTo(r,i),t.lineTo(r,i-o),t.arcTo(r,i,r-o,i,o)),l&&(t.moveTo(e+o,i),t.lineTo(e,i),t.lineTo(e,i-o),t.arcTo(e,i,e+o,i,o))}function u(t,e,n,r,i,o,u,l){var c=t.isDark,h=r+o,f=i+o,d=n.radius*o,p=u-1,g=u+1,m=l-1,v=l+1,y=c(u,l),b=c(p,m),_=c(p,l),x=c(p,v),w=c(u,v),k=c(g,v),S=c(g,l),C=c(g,m),E=c(u,m);y?a(e,r,i,h,f,d,!_&&!E,!_&&!w,!S&&!w,!S&&!E):s(e,r,i,h,f,d,_&&E&&b,_&&w&&x,S&&w&&k,S&&E&&C)}function l(t,e,n){var r,i,a=t.moduleCount,s=n.size/a,l=o;for(v&&n.radius>0&&n.radius<=.5&&(l=u),e.beginPath(),r=0;a>r;r+=1)for(i=0;a>i;i+=1){var c=n.left+i*s,h=n.top+r*s,f=s;l(t,e,n,c,h,f,r,i)}if(g(n.fill).is("img")){e.strokeStyle="rgba(0,0,0,0.5)",e.lineWidth=2,e.stroke();var d=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",e.fill(),e.globalCompositeOperation=d,e.clip(),e.drawImage(n.fill,0,0,n.size,n.size),e.restore()}else e.fillStyle=n.fill,e.fill()}function c(t,n){var r=e(n.text,n.ecLevel,n.minVersion,n.maxVersion,n.quiet);if(!r)return null;var o=g(t).data("qrcode",r),a=o[0].getContext("2d");return i(r,a,n),l(r,a,n),o}function h(t){var e=g("<canvas/>").attr("width",t.size).attr("height",t.size);return c(e,t)}function f(t){return g("<img/>").attr("src",h(t)[0].toDataURL("image/png"))}function d(t){var n=e(t.text,t.ecLevel,t.minVersion,t.maxVersion,t.quiet);if(!n)return null;var r,i,o=t.size,a=t.background,s=Math.floor,u=n.moduleCount,l=s(o/u),c=s(.5*(o-l*u)),h={position:"relative",left:0,top:0,padding:0,margin:0,width:o,height:o},f={position:"absolute",padding:0,margin:0,width:l,height:l,"background-color":t.fill},d=g("<div/>").data("qrcode",n).css(h);for(a&&d.css("background-color",a),r=0;u>r;r+=1)for(i=0;u>i;i+=1)n.isDark(r,i)&&g("<div/>").css(f).css({left:c+i*l,top:c+r*l}).appendTo(d);return d}function p(t){return m&&"canvas"===t.render?h(t):m&&"image"===t.render?f(t):d(t)}var g=jQuery,m=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}(),v="[object Opera]"!==Object.prototype.toString.call(window.opera),y={render:"canvas",minVersion:1,maxVersion:40,ecLevel:"L",left:0,top:0,size:200,fill:"#000",background:null,text:"no text",radius:0,quiet:0,mode:0,mSize:.1,mPosX:.5,mPosY:.5,label:"no label",fontname:"sans",fontcolor:"#000",image:null};g.fn.qrcode=function(t){var e=g.extend({},y,t);return this.each(function(){"canvas"===this.nodeName.toLowerCase()?c(this,e):g(this).append(p(e))})};var b=function(){function t(e,n){if("undefined"==typeof e.length)throw new Error(e.length+"/"+n);var r=function(){for(var t=0;t<e.length&&0==e[t];)t+=1;for(var r=new Array(e.length-t+n),i=0;i<e.length-t;i+=1)r[i]=e[i+t];return r}(),i={};return i.get=function(t){return r[t]},i.getLength=function(){return r.length},i.multiply=function(e){for(var n=new Array(i.getLength()+e.getLength()-1),r=0;r<i.getLength();r+=1)for(var o=0;o<e.getLength();o+=1)n[r+o]^=a.gexp(a.glog(i.get(r))+a.glog(e.get(o)));return t(n,0)},i.mod=function(e){if(i.getLength()-e.getLength()<0)return i;for(var n=a.glog(i.get(0))-a.glog(e.get(0)),r=new Array(i.getLength()),o=0;o<i.getLength();o+=1)r[o]=i.get(o);for(var o=0;o<e.getLength();o+=1)r[o]^=a.gexp(a.glog(e.get(o))+n);return t(r,0).mod(e)},i}var e=function(e,n){var i=236,a=17,c=e,h=r[n],f=null,d=0,g=null,m=new Array,v={},y=function(t,e){d=4*c+17,f=function(t){for(var e=new Array(t),n=0;t>n;n+=1){e[n]=new Array(t);for(var r=0;t>r;r+=1)e[n][r]=null}return e}(d),b(0,0),b(d-7,0),b(0,d-7),w(),x(),S(t,e),c>=7&&k(t),null==g&&(g=M(c,h,m)),C(g,e)},b=function(t,e){for(var n=-1;7>=n;n+=1)if(!(-1>=t+n||t+n>=d))for(var r=-1;7>=r;r+=1)-1>=e+r||e+r>=d||(f[t+n][e+r]=n>=0&&6>=n&&(0==r||6==r)||r>=0&&6>=r&&(0==n||6==n)||n>=2&&4>=n&&r>=2&&4>=r?!0:!1)},_=function(){for(var t=0,e=0,n=0;8>n;n+=1){y(!0,n);var r=o.getLostPoint(v);(0==n||t>r)&&(t=r,e=n)}return e},x=function(){for(var t=8;d-8>t;t+=1)null==f[t][6]&&(f[t][6]=t%2==0);for(var e=8;d-8>e;e+=1)null==f[6][e]&&(f[6][e]=e%2==0)},w=function(){for(var t=o.getPatternPosition(c),e=0;e<t.length;e+=1)for(var n=0;n<t.length;n+=1){var r=t[e],i=t[n];if(null==f[r][i])for(var a=-2;2>=a;a+=1)for(var s=-2;2>=s;s+=1)f[r+a][i+s]=-2==a||2==a||-2==s||2==s||0==a&&0==s?!0:!1}},k=function(t){for(var e=o.getBCHTypeNumber(c),n=0;18>n;n+=1){var r=!t&&1==(e>>n&1);f[Math.floor(n/3)][n%3+d-8-3]=r}for(var n=0;18>n;n+=1){var r=!t&&1==(e>>n&1);f[n%3+d-8-3][Math.floor(n/3)]=r}},S=function(t,e){for(var n=h<<3|e,r=o.getBCHTypeInfo(n),i=0;15>i;i+=1){var a=!t&&1==(r>>i&1);6>i?f[i][8]=a:8>i?f[i+1][8]=a:f[d-15+i][8]=a}for(var i=0;15>i;i+=1){var a=!t&&1==(r>>i&1);8>i?f[8][d-i-1]=a:9>i?f[8][15-i-1+1]=a:f[8][15-i-1]=a}f[d-8][8]=!t},C=function(t,e){for(var n=-1,r=d-1,i=7,a=0,s=o.getMaskFunction(e),u=d-1;u>0;u-=2)for(6==u&&(u-=1);;){for(var l=0;2>l;l+=1)if(null==f[r][u-l]){var c=!1;a<t.length&&(c=1==(t[a]>>>i&1));var h=s(r,u-l);h&&(c=!c),f[r][u-l]=c,i-=1,-1==i&&(a+=1,i=7)}if(r+=n,0>r||r>=d){r-=n,n=-n;break}}},E=function(e,n){for(var r=0,i=0,a=0,s=new Array(n.length),u=new Array(n.length),l=0;l<n.length;l+=1){var c=n[l].dataCount,h=n[l].totalCount-c;i=Math.max(i,c),a=Math.max(a,h),s[l]=new Array(c);for(var f=0;f<s[l].length;f+=1)s[l][f]=255&e.getBuffer()[f+r];r+=c;var d=o.getErrorCorrectPolynomial(h),p=t(s[l],d.getLength()-1),g=p.mod(d);u[l]=new Array(d.getLength()-1);for(var f=0;f<u[l].length;f+=1){var m=f+g.getLength()-u[l].length;u[l][f]=m>=0?g.get(m):0}}for(var v=0,f=0;f<n.length;f+=1)v+=n[f].totalCount;for(var y=new Array(v),b=0,f=0;i>f;f+=1)for(var l=0;l<n.length;l+=1)f<s[l].length&&(y[b]=s[l][f],b+=1);for(var f=0;a>f;f+=1)for(var l=0;l<n.length;l+=1)f<u[l].length&&(y[b]=u[l][f],b+=1);return y},M=function(t,e,n){for(var r=s.getRSBlocks(t,e),l=u(),c=0;c<n.length;c+=1){var h=n[c];l.put(h.getMode(),4),l.put(h.getLength(),o.getLengthInBits(h.getMode(),t)),h.write(l)}for(var f=0,c=0;c<r.length;c+=1)f+=r[c].dataCount;if(l.getLengthInBits()>8*f)throw new Error("code length overflow. ("+l.getLengthInBits()+">"+8*f+")");for(l.getLengthInBits()+4<=8*f&&l.put(0,4);l.getLengthInBits()%8!=0;)l.putBit(!1);for(;!(l.getLengthInBits()>=8*f)&&(l.put(i,8),!(l.getLengthInBits()>=8*f));)l.put(a,8);return E(l,r)};return v.addData=function(t){var e=l(t);m.push(e),g=null},v.isDark=function(t,e){if(0>t||t>=d||0>e||e>=d)throw new Error(t+","+e);return f[t][e]},v.getModuleCount=function(){return d},v.make=function(){y(!1,_())},v.createTableTag=function(t,e){t=t||2,e="undefined"==typeof e?4*t:e;var n="";n+='<table style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",
n+=" padding: 0px; margin: "+e+"px;",n+='">',n+="<tbody>";for(var r=0;r<v.getModuleCount();r+=1){n+="<tr>";for(var i=0;i<v.getModuleCount();i+=1)n+='<td style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: 0px;",n+=" width: "+t+"px;",n+=" height: "+t+"px;",n+=" background-color: ",n+=v.isDark(r,i)?"#000000":"#ffffff",n+=";",n+='"/>';n+="</tr>"}return n+="</tbody>",n+="</table>"},v.createImgTag=function(t,e){t=t||2,e="undefined"==typeof e?4*t:e;var n=v.getModuleCount()*t+2*e,r=e,i=n-e;return p(n,n,function(e,n){if(e>=r&&i>e&&n>=r&&i>n){var o=Math.floor((e-r)/t),a=Math.floor((n-r)/t);return v.isDark(a,o)?0:1}return 1})},v};e.stringToBytes=function(t){for(var e=new Array,n=0;n<t.length;n+=1){var r=t.charCodeAt(n);e.push(255&r)}return e},e.createStringToBytes=function(t,e){var n=function(){for(var n=f(t),r=function(){var t=n.read();if(-1==t)throw new Error;return t},i=0,o={};;){var a=n.read();if(-1==a)break;var s=r(),u=r(),l=r(),c=String.fromCharCode(a<<8|s),h=u<<8|l;o[c]=h,i+=1}if(i!=e)throw new Error(i+" != "+e);return o}(),r="?".charCodeAt(0);return function(t){for(var e=new Array,i=0;i<t.length;i+=1){var o=t.charCodeAt(i);if(128>o)e.push(o);else{var a=n[t.charAt(i)];"number"==typeof a?(255&a)==a?e.push(a):(e.push(a>>>8),e.push(255&a)):e.push(r)}}return e}};var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},r={L:1,M:0,Q:3,H:2},i={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},o=function(){var e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],r=1335,o=7973,s=21522,u={},l=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e};return u.getBCHTypeInfo=function(t){for(var e=t<<10;l(e)-l(r)>=0;)e^=r<<l(e)-l(r);return(t<<10|e)^s},u.getBCHTypeNumber=function(t){for(var e=t<<12;l(e)-l(o)>=0;)e^=o<<l(e)-l(o);return t<<12|e},u.getPatternPosition=function(t){return e[t-1]},u.getMaskFunction=function(t){switch(t){case i.PATTERN000:return function(t,e){return(t+e)%2==0};case i.PATTERN001:return function(t){return t%2==0};case i.PATTERN010:return function(t,e){return e%3==0};case i.PATTERN011:return function(t,e){return(t+e)%3==0};case i.PATTERN100:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case i.PATTERN101:return function(t,e){return t*e%2+t*e%3==0};case i.PATTERN110:return function(t,e){return(t*e%2+t*e%3)%2==0};case i.PATTERN111:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw new Error("bad maskPattern:"+t)}},u.getErrorCorrectPolynomial=function(e){for(var n=t([1],0),r=0;e>r;r+=1)n=n.multiply(t([1,a.gexp(r)],0));return n},u.getLengthInBits=function(t,e){if(e>=1&&10>e)switch(t){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:return 8;case n.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(27>e)switch(t){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(41>e))throw new Error("type:"+e);switch(t){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},u.getLostPoint=function(t){for(var e=t.getModuleCount(),n=0,r=0;e>r;r+=1)for(var i=0;e>i;i+=1){for(var o=0,a=t.isDark(r,i),s=-1;1>=s;s+=1)if(!(0>r+s||r+s>=e))for(var u=-1;1>=u;u+=1)0>i+u||i+u>=e||(0!=s||0!=u)&&a==t.isDark(r+s,i+u)&&(o+=1);o>5&&(n+=3+o-5)}for(var r=0;e-1>r;r+=1)for(var i=0;e-1>i;i+=1){var l=0;t.isDark(r,i)&&(l+=1),t.isDark(r+1,i)&&(l+=1),t.isDark(r,i+1)&&(l+=1),t.isDark(r+1,i+1)&&(l+=1),(0==l||4==l)&&(n+=3)}for(var r=0;e>r;r+=1)for(var i=0;e-6>i;i+=1)t.isDark(r,i)&&!t.isDark(r,i+1)&&t.isDark(r,i+2)&&t.isDark(r,i+3)&&t.isDark(r,i+4)&&!t.isDark(r,i+5)&&t.isDark(r,i+6)&&(n+=40);for(var i=0;e>i;i+=1)for(var r=0;e-6>r;r+=1)t.isDark(r,i)&&!t.isDark(r+1,i)&&t.isDark(r+2,i)&&t.isDark(r+3,i)&&t.isDark(r+4,i)&&!t.isDark(r+5,i)&&t.isDark(r+6,i)&&(n+=40);for(var c=0,i=0;e>i;i+=1)for(var r=0;e>r;r+=1)t.isDark(r,i)&&(c+=1);var h=Math.abs(100*c/e/e-50)/5;return n+=10*h},u}(),a=function(){for(var t=new Array(256),e=new Array(256),n=0;8>n;n+=1)t[n]=1<<n;for(var n=8;256>n;n+=1)t[n]=t[n-4]^t[n-5]^t[n-6]^t[n-8];for(var n=0;255>n;n+=1)e[t[n]]=n;var r={};return r.glog=function(t){if(1>t)throw new Error("glog("+t+")");return e[t]},r.gexp=function(e){for(;0>e;)e+=255;for(;e>=256;)e-=255;return t[e]},r}(),s=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var n={};return n.totalCount=t,n.dataCount=e,n},n={},i=function(e,n){switch(n){case r.L:return t[4*(e-1)+0];case r.M:return t[4*(e-1)+1];case r.Q:return t[4*(e-1)+2];case r.H:return t[4*(e-1)+3];default:return void 0}};return n.getRSBlocks=function(t,n){var r=i(t,n);if("undefined"==typeof r)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+n);for(var o=r.length/3,a=new Array,s=0;o>s;s+=1)for(var u=r[3*s+0],l=r[3*s+1],c=r[3*s+2],h=0;u>h;h+=1)a.push(e(l,c));return a},n}(),u=function(){var t=new Array,e=0,n={};return n.getBuffer=function(){return t},n.get=function(e){var n=Math.floor(e/8);return 1==(t[n]>>>7-e%8&1)},n.put=function(t,e){for(var r=0;e>r;r+=1)n.putBit(1==(t>>>e-r-1&1))},n.getLengthInBits=function(){return e},n.putBit=function(n){var r=Math.floor(e/8);t.length<=r&&t.push(0),n&&(t[r]|=128>>>e%8),e+=1},n},l=function(t){var r=n.MODE_8BIT_BYTE,i=e.stringToBytes(t),o={};return o.getMode=function(){return r},o.getLength=function(){return i.length},o.write=function(t){for(var e=0;e<i.length;e+=1)t.put(i[e],8)},o},c=function(){var t=new Array,e={};return e.writeByte=function(e){t.push(255&e)},e.writeShort=function(t){e.writeByte(t),e.writeByte(t>>>8)},e.writeBytes=function(t,n,r){n=n||0,r=r||t.length;for(var i=0;r>i;i+=1)e.writeByte(t[i+n])},e.writeString=function(t){for(var n=0;n<t.length;n+=1)e.writeByte(t.charCodeAt(n))},e.toByteArray=function(){return t},e.toString=function(){var e="";e+="[";for(var n=0;n<t.length;n+=1)n>0&&(e+=","),e+=t[n];return e+="]"},e},h=function(){var t=0,e=0,n=0,r="",i={},o=function(t){r+=String.fromCharCode(a(63&t))},a=function(t){if(0>t);else{if(26>t)return 65+t;if(52>t)return 97+(t-26);if(62>t)return 48+(t-52);if(62==t)return 43;if(63==t)return 47}throw new Error("n:"+t)};return i.writeByte=function(r){for(t=t<<8|255&r,e+=8,n+=1;e>=6;)o(t>>>e-6),e-=6},i.flush=function(){if(e>0&&(o(t<<6-e),t=0,e=0),n%3!=0)for(var i=3-n%3,a=0;i>a;a+=1)r+="="},i.toString=function(){return r},i},f=function(t){var e=t,n=0,r=0,i=0,o={};o.read=function(){for(;8>i;){if(n>=e.length){if(0==i)return-1;throw new Error("unexpected end of file./"+i)}var t=e.charAt(n);if(n+=1,"="==t)return i=0,-1;t.match(/^\s$/)||(r=r<<6|a(t.charCodeAt(0)),i+=6)}var o=r>>>i-8&255;return i-=8,o};var a=function(t){if(t>=65&&90>=t)return t-65;if(t>=97&&122>=t)return t-97+26;if(t>=48&&57>=t)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw new Error("c:"+t)};return o},d=function(t,e){var n=t,r=e,i=new Array(t*e),o={};o.setPixel=function(t,e,r){i[e*n+t]=r},o.write=function(t){t.writeString("GIF87a"),t.writeShort(n),t.writeShort(r),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(","),t.writeShort(0),t.writeShort(0),t.writeShort(n),t.writeShort(r),t.writeByte(0);var e=2,i=s(e);t.writeByte(e);for(var o=0;i.length-o>255;)t.writeByte(255),t.writeBytes(i,o,255),o+=255;t.writeByte(i.length-o),t.writeBytes(i,o,i.length-o),t.writeByte(0),t.writeString(";")};var a=function(t){var e=t,n=0,r=0,i={};return i.write=function(t,i){if(t>>>i!=0)throw new Error("length over");for(;n+i>=8;)e.writeByte(255&(t<<n|r)),i-=8-n,t>>>=8-n,r=0,n=0;r=t<<n|r,n+=i},i.flush=function(){n>0&&e.writeByte(r)},i},s=function(t){for(var e=1<<t,n=(1<<t)+1,r=t+1,o=u(),s=0;e>s;s+=1)o.add(String.fromCharCode(s));o.add(String.fromCharCode(e)),o.add(String.fromCharCode(n));var l=c(),h=a(l);h.write(e,r);var f=0,d=String.fromCharCode(i[f]);for(f+=1;f<i.length;){var p=String.fromCharCode(i[f]);f+=1,o.contains(d+p)?d+=p:(h.write(o.indexOf(d),r),o.size()<4095&&(o.size()==1<<r&&(r+=1),o.add(d+p)),d=p)}return h.write(o.indexOf(d),r),h.write(n,r),h.flush(),l.toByteArray()},u=function(){var t={},e=0,n={};return n.add=function(r){if(n.contains(r))throw new Error("dup key:"+r);t[r]=e,e+=1},n.size=function(){return e},n.indexOf=function(e){return t[e]},n.contains=function(e){return"undefined"!=typeof t[e]},n};return o},p=function(t,e,n,r){for(var i=d(t,e),o=0;e>o;o+=1)for(var a=0;t>a;a+=1)i.setPixel(a,o,n(a,o));var s=c();i.write(s);for(var u=h(),l=s.toByteArray(),f=0;f<l.length;f+=1)u.writeByte(l[f]);u.flush();var p="";return p+="<img",p+=' src="',p+="data:image/gif;base64,",p+=u,p+='"',p+=' width="',p+=t,p+='"',p+=' height="',p+=e,p+='"',r&&(p+=' alt="',p+=r,p+='"'),p+="/>"};return e}()}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e,r){var i,o,a,s=e.nodeName.toLowerCase();return"area"===s?(i=e.parentNode,o=i.name,e.href&&o&&"map"===i.nodeName.toLowerCase()?(a=t("img[usemap='#"+o+"']")[0],!!a&&n(a)):!1):(/^(input|select|textarea|button|object)$/.test(s)?!e.disabled:"a"===s?e.href||r:r)&&n(e)}function n(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var n=this.css("position"),r="absolute"===n,i=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);return r&&"static"===e.css("position")?!1:i.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==n&&o.length?o:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(n){return!!t.data(n,e)}}):function(e,n,r){return!!t.data(e,r[3])},focusable:function(n){return e(n,!isNaN(t.attr(n,"tabindex")))},tabbable:function(n){var r=t.attr(n,"tabindex"),i=isNaN(r);return(i||r>=0)&&e(n,!i)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,n){function r(e,n,r,o){return t.each(i,function(){n-=parseFloat(t.css(e,"padding"+this))||0,r&&(n-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(n-=parseFloat(t.css(e,"margin"+this))||0)}),n}var i="Width"===n?["Left","Right"]:["Top","Bottom"],o=n.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+n]=function(e){return void 0===e?a["inner"+n].call(this):this.each(function(){t(this).css(o,r(this,e)+"px")})},t.fn["outer"+n]=function(e,i){return"number"!=typeof e?a["outer"+n].call(this,e):this.each(function(){t(this).css(o,r(this,e,!0,i)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(n){return arguments.length?e.call(this,t.camelCase(n)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(n,r){return"number"==typeof n?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),r&&r.call(e)},n)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var n,r,i=t(this[0]);i.length&&i[0]!==document;){if(n=i.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(r=parseInt(i.css("zIndex"),10),!isNaN(r)&&0!==r))return r;i=i.parent()}return 0}}),t.ui.plugin={add:function(e,n,r){var i,o=t.ui[e].prototype;for(i in r)o.plugins[i]=o.plugins[i]||[],o.plugins[i].push([n,r[i]])},call:function(t,e,n,r){var i,o=t.plugins[e];if(o&&(r||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(i=0;i<o.length;i++)t.options[o[i][0]]&&o[i][1].apply(t.element,n)}}}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){var e=0,n=Array.prototype.slice;return t.cleanData=function(e){return function(n){var r,i,o;for(o=0;null!=(i=n[o]);o++)try{r=t._data(i,"events"),r&&r.remove&&t(i).triggerHandler("remove")}catch(a){}e(n)}}(t.cleanData),t.widget=function(e,n,r){var i,o,a,s,u={},l=e.split(".")[0];return e=e.split(".")[1],i=l+"-"+e,r||(r=n,n=t.Widget),t.expr[":"][i.toLowerCase()]=function(e){return!!t.data(e,i)},t[l]=t[l]||{},o=t[l][e],a=t[l][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new a(t,e)},t.extend(a,o,{version:r.version,_proto:t.extend({},r),_childConstructors:[]}),s=new n,s.options=t.widget.extend({},s.options),t.each(r,function(e,r){return t.isFunction(r)?void(u[e]=function(){var t=function(){return n.prototype[e].apply(this,arguments)},i=function(t){return n.prototype[e].apply(this,t)};return function(){var e,n=this._super,o=this._superApply;return this._super=t,this._superApply=i,e=r.apply(this,arguments),this._super=n,this._superApply=o,e}}()):void(u[e]=r)}),a.prototype=t.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix||e:e},u,{constructor:a,namespace:l,widgetName:e,widgetFullName:i}),o?(t.each(o._childConstructors,function(e,n){var r=n.prototype;t.widget(r.namespace+"."+r.widgetName,a,n._proto)}),delete o._childConstructors):n._childConstructors.push(a),t.widget.bridge(e,a),a},t.widget.extend=function(e){for(var r,i,o=n.call(arguments,1),a=0,s=o.length;s>a;a++)for(r in o[a])i=o[a][r],o[a].hasOwnProperty(r)&&void 0!==i&&(t.isPlainObject(i)?e[r]=t.isPlainObject(e[r])?t.widget.extend({},e[r],i):t.widget.extend({},i):e[r]=i);return e},t.widget.bridge=function(e,r){var i=r.prototype.widgetFullName||e;t.fn[e]=function(o){var a="string"==typeof o,s=n.call(arguments,1),u=this;return a?this.each(function(){var n,r=t.data(this,i);return"instance"===o?(u=r,!1):r?t.isFunction(r[o])&&"_"!==o.charAt(0)?(n=r[o].apply(r,s),n!==r&&void 0!==n?(u=n&&n.jquery?u.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")}):(s.length&&(o=t.widget.extend.apply(null,[o].concat(s))),this.each(function(){var e=t.data(this,i);e?(e.option(o||{}),e._init&&e._init()):t.data(this,i,new r(o,this))})),u}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(n,r){r=t(r||this.defaultElement||this)[0],this.element=t(r),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),r!==this&&(t.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===r&&this.destroy()}}),this.document=t(r.style?r.ownerDocument:r.document||r),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),n),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,n){var r,i,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},r=e.split("."),e=r.shift(),r.length){for(i=a[e]=t.widget.extend({},this.options[e]),o=0;o<r.length-1;o++)i[r[o]]=i[r[o]]||{},i=i[r[o]];if(e=r.pop(),1===arguments.length)return void 0===i[e]?null:i[e];i[e]=n}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=n}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,n,r){var i,o=this;"boolean"!=typeof e&&(r=n,n=e,e=!1),r?(n=i=t(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),t.each(r,function(r,a){function s(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||t.guid++);var u=r.match(/^([\w:-]*)\s*(.*)$/),l=u[1]+o.eventNamespace,c=u[2];c?i.delegate(c,l,s):n.bind(l,s)})},_off:function(e,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(n).undelegate(n),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function n(){return("string"==typeof t?r[t]:t).apply(r,arguments)}var r=this;return setTimeout(n,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,n,r){var i,o,a=this.options[e];if(r=r||{},n=t.Event(n),n.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(i in o)i in n||(n[i]=o[i]);return this.element.trigger(n,r),!(t.isFunction(a)&&a.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,n){t.Widget.prototype["_"+e]=function(r,i,o){"string"==typeof i&&(i={effect:i});var a,s=i?i===!0||"number"==typeof i?n:i.effect||n:e;i=i||{},"number"==typeof i&&(i={duration:i}),a=!t.isEmptyObject(i),i.complete=o,i.delay&&r.delay(i.delay),a&&t.effects&&t.effects.effect[s]?r[e](i):s!==e&&r[s]?r[s](i.duration,i.easing,o):r.queue(function(n){t(this)[e](),o&&o.call(r[0]),n()})}}),t.widget}),function(t){"function"==typeof define&&define.amd?define(["jquery","./widget"],t):t(jQuery)}(function(t){var e=!1;return t(document).mouseup(function(){e=!1}),t.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(n){return!0===t.data(n.target,e.widgetName+".preventClickEvent")?(t.removeData(n.target,e.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!e){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var r=this,i=1===n.which,o="string"==typeof this.options.cancel&&n.target.nodeName?t(n.target).closest(this.options.cancel).length:!1;return i&&!o&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===t.data(n.target,this.widgetName+".preventClickEvent")&&t.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return r._mouseMove(t)},this._mouseUpDelegate=function(t){return r._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(n){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,n.target===this._mouseDownEvent.target&&t.data(n.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(n)),e=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}),function(t){"function"==typeof define&&define.amd?define(["jquery","./core","./mouse","./widget"],t):t(jQuery)}(function(t){return t.widget("ui.sortable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,n){return t>=e&&e+n>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,n){var r=null,i=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(r=t(this),!1):void 0}),t.data(e.target,o.widgetName+"-item")===o&&(r=t(e.target)),r&&(!this.options.handle||n||(t(this.options.handle,r).find("*").addBack().each(function(){this===e.target&&(i=!0)}),i))?(this.currentItem=r,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(e,n,r){var i,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var n,r,i,o,a=this.options,s=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-this.document.scrollTop()<a.scrollSensitivity?s=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<a.scrollSensitivity&&(s=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),e.pageX-this.document.scrollLeft()<a.scrollSensitivity?s=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(s=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),s!==!1&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(r=this.items[n],i=r.item[0],o=this._intersectsWithPointer(r),o&&r.instance===this.currentContainer&&i!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==i&&!t.contains(this.placeholder[0],i)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],i):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(e,r),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,n){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var r=this,i=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){r._clear(e);
})}else this._clear(e,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var n=this._getItemsAsjQuery(e&&e.connected),r=[];return e=e||{},t(n).each(function(){var n=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);n&&r.push((e.key||n[1]+"[]")+"="+(e.key&&e.expression?n[1]:n[2]))}),!r.length&&e.key&&r.push(e.key+"="),r.join("&")},toArray:function(e){var n=this._getItemsAsjQuery(e&&e.connected),r=[];return e=e||{},n.each(function(){r.push(t(e.item||this).attr(e.attribute||"id")||"")}),r},_intersectsWith:function(t){var e=this.positionAbs.left,n=e+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,o=t.left,a=o+t.width,s=t.top,u=s+t.height,l=this.offset.click.top,c=this.offset.click.left,h="x"===this.options.axis||r+l>s&&u>r+l,f="y"===this.options.axis||e+c>o&&a>e+c,d=h&&f;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?d:o<e+this.helperProportions.width/2&&n-this.helperProportions.width/2<a&&s<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<u},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),r=e&&n,i=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return r?this.floating?o&&"right"===o||"down"===i?2:1:i&&("down"===i?2:1):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),r=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();return this.floating&&i?"right"===i&&n||"left"===i&&!n:r&&("down"===r&&e||"up"===r&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function n(){s.push(this)}var r,i,o,a,s=[],u=[],l=this._connectWith();if(l&&e)for(r=l.length-1;r>=0;r--)for(o=t(l[r],this.document[0]),i=o.length-1;i>=0;i--)a=t.data(o[i],this.widgetFullName),a&&a!==this&&!a.options.disabled&&u.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(u.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),r=u.length-1;r>=0;r--)u[r][0].each(n);return t(s)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var n=0;n<e.length;n++)if(e[n]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var n,r,i,o,a,s,u,l,c=this.items,h=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],f=this._connectWith();if(f&&this.ready)for(n=f.length-1;n>=0;n--)for(i=t(f[n],this.document[0]),r=i.length-1;r>=0;r--)o=t.data(i[r],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(h.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(n=h.length-1;n>=0;n--)for(a=h[n][1],s=h[n][0],r=0,l=s.length;l>r;r++)u=t(s[r]),u.data(this.widgetName+"-item",a),c.push({item:u,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,o;for(n=this.items.length-1;n>=0;n--)r=this.items[n],r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?t(this.options.toleranceElement,r.item):r.item,e||(r.width=i.outerWidth(),r.height=i.outerHeight()),o=i.offset(),r.left=o.left,r.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)o=this.containers[n].element.offset(),this.containers[n].containerCache.left=o.left,this.containers[n].containerCache.top=o.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var n,r=e.options;r.placeholder&&r.placeholder.constructor!==String||(n=r.placeholder,r.placeholder={element:function(){var r=e.currentItem[0].nodeName.toLowerCase(),i=t("<"+r+">",e.document[0]).addClass(n||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===r?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(i)):"tr"===r?e._createTrPlaceholder(e.currentItem,i):"img"===r&&i.attr("src",e.currentItem.attr("src")),n||i.css("visibility","hidden"),i},update:function(t,i){(!n||r.forcePlaceholderSize)&&(i.height()||i.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(r.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),r.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,n){var r=this;e.children().each(function(){t("<td>&#160;</td>",r.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(n)})},_contactContainers:function(e){var n,r,i,o,a,s,u,l,c,h,f=null,d=null;for(n=this.containers.length-1;n>=0;n--)if(!t.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(f&&t.contains(this.containers[n].element[0],f.element[0]))continue;f=this.containers[n],d=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",e,this._uiHash(this)),this.containers[n].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[d].containerCache.over||(this.containers[d]._trigger("over",e,this._uiHash(this)),this.containers[d].containerCache.over=1);else{for(i=1e4,o=null,c=f.floating||this._isFloating(this.currentItem),a=c?"left":"top",s=c?"width":"height",h=c?"clientX":"clientY",r=this.items.length-1;r>=0;r--)t.contains(this.containers[d].element[0],this.items[r].item[0])&&this.items[r].item[0]!==this.currentItem[0]&&(u=this.items[r].item.offset()[a],l=!1,e[h]-u>this.items[r][s]/2&&(l=!0),Math.abs(e[h]-u)<i&&(i=Math.abs(e[h]-u),o=this.items[r],this.direction=l?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[d])return void(this.currentContainer.containerCache.over||(this.containers[d]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[d].element,!0),this._trigger("change",e,this._uiHash()),this.containers[d]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[d],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",e,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(e){var n=this.options,r=t.isFunction(n.helper)?t(n.helper.apply(this.element[0],[e,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return r.parents("body").length||t("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,n,r,i=this.options;"parent"===i.containment&&(i.containment=this.helper[0].parentNode),("document"===i.containment||"window"===i.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===i.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===i.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(e=t(i.containment)[0],n=t(i.containment).offset(),r="hidden"!==t(e).css("overflow"),this.containment=[n.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,n){n||(n=this.position);var r="absolute"===e?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:i.scrollLeft())*r}},_generatePosition:function(e){var n,r,i=this.options,o=e.pageX,a=e.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,u=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((a-this.originalPageY)/i.grid[1])*i.grid[1],a=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((o-this.originalPageX)/i.grid[0])*i.grid[0],o=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():u?0:s.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():u?0:s.scrollLeft())}},_rearrange:function(t,e,n,r){n?n[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(t,e){function n(t,e,n){return function(r){n._trigger(t,r,e._uiHash(e))}}this.reverting=!1;var r,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(r in this._storedCSS)("auto"===this._storedCSS[r]||"static"===this._storedCSS[r])&&(this._storedCSS[r]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&i.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||i.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(i.push(function(t){this._trigger("remove",t,this._uiHash())}),i.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),r=this.containers.length-1;r>=0;r--)e||i.push(n("deactivate",this,this.containers[r])),this.containers[r].containerCache.over&&(i.push(n("out",this,this.containers[r])),this.containers[r].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(r=0;r<i.length;r++)i[r].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var n=e||this;return{helper:n.helper,placeholder:n.placeholder||t([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:e?e.element:null}}})}),function(){function t(t,e,n){for(var r=(n||0)-1,i=t?t.length:0;++r<i;)if(t[r]===e)return r;return-1}function e(e,n){var r=typeof n;if(e=e.cache,"boolean"==r||null==n)return e[n]?0:-1;"number"!=r&&"string"!=r&&(r="object");var i="number"==r?n:y+n;return e=(e=e[r])&&e[i],"object"==r?e&&t(e,n)>-1?0:-1:e?0:-1}function n(t){var e=this.cache,n=typeof t;if("boolean"==n||null==t)e[t]=!0;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?t:y+t,i=e[n]||(e[n]={});"object"==n?(i[r]||(i[r]=[])).push(t):i[r]=!0}}function r(t){return t.charCodeAt(0)}function i(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||"undefined"==typeof n)return 1;if(r>n||"undefined"==typeof r)return-1}return t.index-e.index}function o(t){var e=-1,r=t.length,i=t[0],o=t[r/2|0],a=t[r-1];if(i&&"object"==typeof i&&o&&"object"==typeof o&&a&&"object"==typeof a)return!1;var s=u();s["false"]=s["null"]=s["true"]=s.undefined=!1;var l=u();for(l.array=t,l.cache=s,l.push=n;++e<r;)l.push(t[e]);return l}function a(t){return"\\"+Y[t]}function s(){return g.pop()||[]}function u(){return m.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function l(){}function c(t){t.length=0,g.length<_&&g.push(t)}function h(t){var e=t.cache;e&&h(e),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,m.length<_&&m.push(t)}function f(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,o=Array(0>i?0:i);++r<i;)o[r]=t[e+r];return o}function d(n){function g(t){return t&&"object"==typeof t&&!Jn(t)&&Cn.call(t,"__wrapped__")?t:new m(t)}function m(t,e){this.__chain__=!!e,this.__wrapped__=t}function _(t,e,n,r,i){if(n){var o=n(t);if("undefined"!=typeof o)return o}var a=Et(t);if(!a)return t;var u=Tn.call(t);if(!H[u])return t;var l=Wn[u];switch(u){case D:case z:return new l(+t);case R:case V:return new l(t);case q:return o=l(t.source,E.exec(t)),o.lastIndex=t.lastIndex,o}var h=Jn(t);if(e){var d=!r;r||(r=s()),i||(i=s());for(var p=r.length;p--;)if(r[p]==t)return i[p];o=h?l(t.length):{}}else o=h?f(t):rr({},t);return h&&(Cn.call(t,"index")&&(o.index=t.index),Cn.call(t,"input")&&(o.input=t.input)),e?(r.push(t),i.push(o),(h?Ut:ar)(t,function(t,a){o[a]=_(t,e,n,r,i)}),d&&(c(r),c(i)),o):o}function Y(t,e,n){if("function"!=typeof t)return Ue;if("undefined"==typeof e)return t;var r=t.__bindData__||Yn.funcNames&&!t.name;if("undefined"==typeof r){var i=T&&kn.call(t);Yn.funcNames||!i||M.test(i)||(r=!0),(Yn.funcNames||!r)&&(r=!Yn.funcDecomp||T.test(i),Xn(t,r))}if(r!==!0&&r&&1&r[1])return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return Pe(t,e)}function J(t,e,n,r){for(var i=(r||0)-1,o=t?t.length:0,a=[];++i<o;){var s=t[i];if(s&&"object"==typeof s&&"number"==typeof s.length&&(Jn(s)||lt(s))){e||(s=J(s,e,n));var u=-1,l=s.length,c=a.length;for(a.length+=l;++u<l;)a[c++]=s[u]}else n||a.push(s)}return a}function Q(t,e,n,r,i,o){if(n){var a=n(t,e);if("undefined"!=typeof a)return!!a}if(t===e)return 0!==t||1/t==1/e;var u=typeof t,l=typeof e;if(!(t!==t||t&&W[u]||e&&W[l]))return!1;if(null==t||null==e)return t===e;var h=Tn.call(t),f=Tn.call(e);if(h==L&&(h=B),f==L&&(f=B),h!=f)return!1;switch(h){case D:case z:return+t==+e;case R:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case q:case V:return t==pn(e)}var d=h==O;if(!d){if(Cn.call(t,"__wrapped__ ")||Cn.call(e,"__wrapped__"))return Q(t.__wrapped__||t,e.__wrapped__||e,n,r,i,o);if(h!=B)return!1;var p=t.constructor,g=e.constructor;if(p!=g&&!(Ct(p)&&p instanceof p&&Ct(g)&&g instanceof g))return!1}var m=!i;i||(i=s()),o||(o=s());for(var v=i.length;v--;)if(i[v]==t)return o[v]==e;var y=0;if(a=!0,i.push(t),o.push(e),d){if(v=t.length,y=e.length,a=y==t.length,!a&&!r)return a;for(;y--;){var b=v,_=e[y];if(r)for(;b--&&!(a=Q(t[b],_,n,r,i,o)););else if(!(a=Q(t[y],_,n,r,i,o)))break}return a}return or(e,function(e,s,u){return Cn.call(u,s)?(y++,a=Cn.call(t,s)&&Q(t[s],e,n,r,i,o)):void 0}),a&&!r&&or(t,function(t,e,n){return Cn.call(n,e)?a=--y>-1:void 0}),m&&(c(i),c(o)),a}function Z(t,e,n,r,i){(Jn(e)?Ut:ar)(e,function(e,o){var a,s,u=e,l=t[o];if(e&&((s=Jn(e))||sr(e))){for(var c=r.length;c--;)if(a=r[c]==e){l=i[c];break}if(!a){var h;n&&(u=n(l,e),(h="undefined"!=typeof u)&&(l=u)),h||(l=s?Jn(l)?l:[]:sr(l)?l:{}),r.push(e),i.push(l),h||Z(l,e,n,r,i)}}else n&&(u=n(l,e),"undefined"==typeof u&&(u=e)),"undefined"!=typeof u&&(l=u);t[o]=l})}function et(n,r,i){var a=-1,u=at(),l=n?n.length:0,f=[],d=!r&&l>=b&&u===t,p=i||d?s():f;if(d){var g=o(p);g?(u=e,p=g):(d=!1,p=i?p:(c(p),f))}for(;++a<l;){var m=n[a],v=i?i(m,a,n):m;(r?!a||p[p.length-1]!==v:u(p,v)<0)&&((i||d)&&p.push(v),f.push(m))}return d?(c(p.array),h(p)):i&&c(p),f}function nt(t){return function(e,n,r){var i={};n=g.createCallback(n,r,3);var o=-1,a=e?e.length:0;if("number"==typeof a)for(;++o<a;){var s=e[o];t(i,s,n(s,o,e),e)}else ar(e,function(e,r,o){t(i,e,n(e,r,o),o)});return i}}function rt(t,e,n,r,i,o){var a=1&e,s=2&e,u=4&e,l=8&e,c=16&e,h=32&e,f=t;if(!s&&!Ct(t))throw new gn;c&&!n.length&&(e&=-17,c=n=!1),h&&!r.length&&(e&=-33,h=r=!1);var d=t&&t.__bindData__;if(d)return!a||1&d[1]||(d[4]=i),!a&&1&d[1]&&(e|=8),!u||4&d[1]||(d[5]=o),c&&Mn.apply(d[2]||(d[2]=[]),n),h&&Mn.apply(d[3]||(d[3]=[]),r),d[1]|=e,rt.apply(null,d);if(a&&!(s||u||h)&&(Yn.fastBind||In&&c)){if(c){var p=[i];Mn.apply(p,n)}var g=c?In.apply(t,p):In.call(t,i)}else g=function(){var d=arguments,p=a?i:this;if((u||c||h)&&(d=Hn.call(d),c&&Nn.apply(d,n),h&&Mn.apply(d,r),u&&d.length<o))return e|=16,rt(t,l?e:-4&e,d,null,i,o);if(s&&(t=p[f]),this instanceof g){p=it(t.prototype);var m=t.apply(p,d);return Et(m)?m:p}return t.apply(p,d)};return Xn(g,Hn.call(arguments)),g}function it(t){return Et(t)?Ln(t):{}}function ot(t){return Zn[t]}function at(){var e=(e=g.indexOf)===de?t:e;return e}function st(t){var e,n;return t&&Tn.call(t)==B&&(e=t.constructor,!Ct(e)||e instanceof e)?(or(t,function(t,e){n=e}),"undefined"==typeof n||Cn.call(t,n)):!1}function ut(t){return tr[t]}function lt(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Tn.call(t)==L||!1}function ct(t,e,n,r){return"boolean"!=typeof e&&null!=e&&(r=n,n=e,e=!1),_(t,e,"function"==typeof n&&Y(n,r,1))}function ht(t,e,n){return _(t,!0,"function"==typeof e&&Y(e,n,1))}function ft(t,e,n){var r;return e=g.createCallback(e,n,3),ar(t,function(t,n,i){return e(t,n,i)?(r=n,!1):void 0}),r}function dt(t,e,n){var r;return e=g.createCallback(e,n,3),gt(t,function(t,n,i){return e(t,n,i)?(r=n,!1):void 0}),r}function pt(t,e,n){var r=[];or(t,function(t,e){r.push(e,t)});var i=r.length;for(e=Y(e,n,3);i--&&e(r[i--],r[i],t)!==!1;);return t}function gt(t,e,n){var r=Kn(t),i=r.length;for(e=Y(e,n,3);i--;){var o=r[i];if(e(t[o],o,t)===!1)break}return t}function mt(t){var e=[];return or(t,function(t,n){Ct(t)&&e.push(n)}),e.sort()}function vt(t,e){return t?Cn.call(t,e):!1}function yt(t){for(var e=-1,n=Kn(t),r=n.length,i={};++e<r;){var o=n[e];i[t[o]]=o}return i}function bt(t){return t===!0||t===!1||Tn.call(t)==D}function _t(t){return t?"object"==typeof t&&Tn.call(t)==z:!1}function xt(t){return t?1===t.nodeType:!1}function wt(t){var e=!0;if(!t)return e;var n=Tn.call(t),r=t.length;return n==O||n==V||n==L||n==B&&"number"==typeof r&&Ct(t.splice)?!r:(ar(t,function(){return e=!1}),e)}function kt(t,e,n,r){return Q(t,e,"function"==typeof n&&Y(n,r,2))}function St(t){return Dn(t)&&!zn(parseFloat(t))}function Ct(t){return"function"==typeof t}function Et(t){return!(!t||!W[typeof t])}function Mt(t){return Pt(t)&&t!=+t}function At(t){return null===t}function Pt(t){return"number"==typeof t||Tn.call(t)==R}function jt(t){return t?"object"==typeof t&&Tn.call(t)==q:!1}function Tt(t){return"string"==typeof t||Tn.call(t)==V}function Nt(t){return"undefined"==typeof t}function $t(t){var e=arguments,n=2;if(!Et(t))return t;if("number"!=typeof e[2]&&(n=e.length),n>3&&"function"==typeof e[n-2])var r=Y(e[--n-1],e[n--],2);else n>2&&"function"==typeof e[n-1]&&(r=e[--n]);for(var i=Hn.call(arguments,1,n),o=-1,a=s(),u=s();++o<n;)Z(t,i[o],r,a,u);return c(a),c(u),t}function It(t,e,n){var r=at(),i="function"==typeof e,o={};if(i)e=g.createCallback(e,n,3);else var a=J(arguments,!0,!1,1);return or(t,function(t,n,s){(i?!e(t,n,s):r(a,n)<0)&&(o[n]=t)}),o}function Lt(t){for(var e=-1,n=Kn(t),r=n.length,i=an(r);++e<r;){var o=n[e];i[e]=[o,t[o]]}return i}function Ot(t,e,n){var r={};if("function"!=typeof e)for(var i=-1,o=J(arguments,!0,!1,1),a=Et(t)?o.length:0;++i<a;){var s=o[i];s in t&&(r[s]=t[s])}else e=g.createCallback(e,n,3),or(t,function(t,n,i){e(t,n,i)&&(r[n]=t)});return r}function Dt(t,e,n,r){var i=Jn(t);if(e=Y(e,r,4),null==n)if(i)n=[];else{var o=t&&t.constructor,a=o&&o.prototype;n=it(a)}return(i?Ut:ar)(t,function(t,r,i){return e(n,t,r,i)}),n}function zt(t){for(var e=-1,n=Kn(t),r=n.length,i=an(r);++e<r;)i[e]=t[n[e]];return i}function Ft(t){for(var e=arguments,n=-1,r=J(e,!0,!1,1),i=e[2]&&e[2][e[1]]===t?1:r.length,o=an(i);++n<i;)o[n]=t[r[n]];return o}function Rt(t,e,n){var r=-1,i=at(),o=t?t.length:0,a=!1;return n=(0>n?Rn(0,o+n):n)||0,Jn(t)?a=i(t,e,n)>-1:"number"==typeof o?a=(Tt(t)?t.indexOf(e,n):i(t,e,n))>-1:ar(t,function(t){return++r>=n?!(a=t===e):void 0}),a}function Bt(t,e,n){var r=!0;e=g.createCallback(e,n,3);var i=-1,o=t?t.length:0;if("number"==typeof o)for(;++i<o&&(r=!!e(t[i],i,t)););else ar(t,function(t,n,i){return r=!!e(t,n,i)});return r}function qt(t,e,n){var r=[];e=g.createCallback(e,n,3);var i=-1,o=t?t.length:0;if("number"==typeof o)for(;++i<o;){var a=t[i];e(a,i,t)&&r.push(a)}else ar(t,function(t,n,i){e(t,n,i)&&r.push(t)});return r}function Vt(t,e,n){e=g.createCallback(e,n,3);var r=-1,i=t?t.length:0;if("number"!=typeof i){var o;return ar(t,function(t,n,r){return e(t,n,r)?(o=t,!1):void 0}),o}for(;++r<i;){var a=t[r];if(e(a,r,t))return a}}function Ht(t,e,n){var r;return e=g.createCallback(e,n,3),Gt(t,function(t,n,i){return e(t,n,i)?(r=t,!1):void 0}),r}function Ut(t,e,n){var r=-1,i=t?t.length:0;if(e=e&&"undefined"==typeof n?e:Y(e,n,3),"number"==typeof i)for(;++r<i&&e(t[r],r,t)!==!1;);else ar(t,e);return t}function Gt(t,e,n){var r=t?t.length:0;if(e=e&&"undefined"==typeof n?e:Y(e,n,3),"number"==typeof r)for(;r--&&e(t[r],r,t)!==!1;);else{var i=Kn(t);r=i.length,ar(t,function(t,n,o){return n=i?i[--r]:--r,e(o[n],n,o)})}return t}function Wt(t,e){var n=Hn.call(arguments,2),r=-1,i="function"==typeof e,o=t?t.length:0,a=an("number"==typeof o?o:0);return Ut(t,function(t){a[++r]=(i?e:t[e]).apply(t,n)}),a}function Yt(t,e,n){var r=-1,i=t?t.length:0;if(e=g.createCallback(e,n,3),"number"==typeof i)for(var o=an(i);++r<i;)o[r]=e(t[r],r,t);else o=[],ar(t,function(t,n,i){o[++r]=e(t,n,i)});return o}function Xt(t,e,n){var i=-(1/0),o=i;if(!e&&Jn(t))for(var a=-1,s=t.length;++a<s;){var u=t[a];u>o&&(o=u)}else e=!e&&Tt(t)?r:g.createCallback(e,n,3),Ut(t,function(t,n,r){var a=e(t,n,r);a>i&&(i=a,o=t)});return o}function Jt(t,e,n){var i=1/0,o=i;if(!e&&Jn(t))for(var a=-1,s=t.length;++a<s;){var u=t[a];o>u&&(o=u)}else e=!e&&Tt(t)?r:g.createCallback(e,n,3),Ut(t,function(t,n,r){var a=e(t,n,r);i>a&&(i=a,o=t)});return o}function Qt(t,e){var n=-1,r=t?t.length:0;if("number"==typeof r)for(var i=an(r);++n<r;)i[n]=t[n][e];return i||Yt(t,e)}function Kt(t,e,n,r){if(!t)return n;var i=arguments.length<3;e=Y(e,r,4);var o=-1,a=t.length;if("number"==typeof a)for(i&&(n=t[++o]);++o<a;)n=e(n,t[o],o,t);else ar(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)});return n}function Zt(t,e,n,r){var i=arguments.length<3;return e=Y(e,r,4),Gt(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)}),n}function te(t,e,n){return e=g.createCallback(e,n,3),qt(t,function(t,n,r){return!e(t,n,r)})}function ee(t,e,n){var r=t?t.length:0;if("number"!=typeof r&&(t=zt(t)),null==e||n)return t?t[Ye(r-1)]:p;var i=ne(t);return i.length=Bn(Rn(0,e),i.length),i}function ne(t){var e=-1,n=t?t.length:0,r=an("number"==typeof n?n:0);return Ut(t,function(t){var n=Ye(++e);r[e]=r[n],r[n]=t}),r}function re(t){var e=t?t.length:0;return"number"==typeof e?e:Kn(t).length}function ie(t,e,n){var r;e=g.createCallback(e,n,3);var i=-1,o=t?t.length:0;if("number"==typeof o)for(;++i<o&&!(r=e(t[i],i,t)););else ar(t,function(t,n,i){return!(r=e(t,n,i))});return!!r}function oe(t,e,n){var r=-1,o=t?t.length:0,a=an("number"==typeof o?o:0);for(e=g.createCallback(e,n,3),Ut(t,function(t,n,i){var o=a[++r]=u();o.criteria=e(t,n,i),o.index=r,o.value=t}),o=a.length,a.sort(i);o--;){var s=a[o];a[o]=s.value,h(s)}return a}function ae(t){return t&&"number"==typeof t.length?f(t):zt(t)}function se(t){for(var e=-1,n=t?t.length:0,r=[];++e<n;){var i=t[e];i&&r.push(i)}return r}function ue(n){var r=-1,i=at(),a=n?n.length:0,s=J(arguments,!0,!0,1),u=[],l=a>=b&&i===t;if(l){var c=o(s);c?(i=e,s=c):l=!1}for(;++r<a;){var f=n[r];i(s,f)<0&&u.push(f)}return l&&h(s),u}function le(t,e,n){var r=-1,i=t?t.length:0;for(e=g.createCallback(e,n,3);++r<i;)if(e(t[r],r,t))return r;return-1}function ce(t,e,n){var r=t?t.length:0;for(e=g.createCallback(e,n,3);r--;)if(e(t[r],r,t))return r;return-1}function he(t,e,n){var r=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var o=-1;for(e=g.createCallback(e,n,3);++o<i&&e(t[o],o,t);)r++}else if(r=e,null==r||n)return t?t[0]:p;return f(t,0,Bn(Rn(0,r),i))}function fe(t,e,n,r){return"boolean"!=typeof e&&null!=e&&(r=n,n=r&&r[e]===t?null:e,e=!1),null!=n&&(t=Yt(t,n,r)),J(t,e)}function de(e,n,r){if("number"==typeof r){var i=e?e.length:0;r=0>r?Rn(0,i+r):r||0}else if(r){var o=we(e,n);return e[o]===n?o:-1}return t(e,n,r)}function pe(t,e,n){var r=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var o=i;for(e=g.createCallback(e,n,3);o--&&e(t[o],o,t);)r++}else r=null==e||n?1:e||r;return f(t,0,Bn(Rn(0,i-r),i))}function ge(n){for(var r=arguments,i=r.length,a=-1,u=s(),l=-1,f=at(),d=n?n.length:0,p=[],g=s();++a<i;){var m=r[a];u[a]=f===t&&(m?m.length:0)>=b&&o(a?r[a]:g)}t:for(;++l<d;){var v=u[0];if(m=n[l],(v?e(v,m):f(g,m))<0){for(a=i,(v||g).push(m);--a;)if(v=u[a],(v?e(v,m):f(r[a],m))<0)continue t;p.push(m)}}for(;i--;)v=u[i],v&&h(v);return c(u),c(g),p}function me(t,e,n){var r=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var o=i;for(e=g.createCallback(e,n,3);o--&&e(t[o],o,t);)r++}else if(r=e,null==r||n)return t?t[i-1]:p;return f(t,Rn(0,i-r))}function ve(t,e,n){var r=t?t.length:0;for("number"==typeof n&&(r=(0>n?Rn(0,r+n):Bn(n,r-1))+1);r--;)if(t[r]===e)return r;return-1}function ye(t){for(var e=arguments,n=0,r=e.length,i=t?t.length:0;++n<r;)for(var o=-1,a=e[n];++o<i;)t[o]===a&&(jn.call(t,o--,1),i--);return t}function be(t,e,n){t=+t||0,n="number"==typeof n?n:+n||1,null==e&&(e=t,t=0);for(var r=-1,i=Rn(0,_n((e-t)/(n||1))),o=an(i);++r<i;)o[r]=t,t+=n;return o}function _e(t,e,n){var r=-1,i=t?t.length:0,o=[];for(e=g.createCallback(e,n,3);++r<i;){var a=t[r];e(a,r,t)&&(o.push(a),jn.call(t,r--,1),i--)}return o}function xe(t,e,n){if("number"!=typeof e&&null!=e){var r=0,i=-1,o=t?t.length:0;for(e=g.createCallback(e,n,3);++i<o&&e(t[i],i,t);)r++}else r=null==e||n?1:Rn(0,e);return f(t,r)}function we(t,e,n,r){var i=0,o=t?t.length:i;for(n=n?g.createCallback(n,r,1):Ue,e=n(e);o>i;){var a=i+o>>>1;n(t[a])<e?i=a+1:o=a}return i}function ke(t){return et(J(arguments,!0,!0))}function Se(t,e,n,r){return"boolean"!=typeof e&&null!=e&&(r=n,n=r&&r[e]===t?null:e,e=!1),null!=n&&(n=g.createCallback(n,r,3)),et(t,e,n)}function Ce(t){
return ue(t,Hn.call(arguments,1))}function Ee(){for(var t=arguments.length>1?arguments:arguments[0],e=-1,n=t?Xt(Qt(t,"length")):0,r=an(0>n?0:n);++e<n;)r[e]=Qt(t,e);return r}function Me(t,e){for(var n=-1,r=t?t.length:0,i={};++n<r;){var o=t[n];e?i[o]=e[n]:o&&(i[o[0]]=o[1])}return i}function Ae(t,e){if(!Ct(e))throw new gn;return function(){return--t<1?e.apply(this,arguments):void 0}}function Pe(t,e){return arguments.length>2?rt(t,17,Hn.call(arguments,2),null,e):rt(t,1,null,null,e)}function je(t){for(var e=arguments.length>1?J(arguments,!0,!1,1):mt(t),n=-1,r=e.length;++n<r;){var i=e[n];t[i]=rt(t[i],1,null,null,t)}return t}function Te(t,e){return arguments.length>2?rt(e,19,Hn.call(arguments,2),null,t):rt(e,3,null,null,t)}function Ne(){for(var t=arguments,e=t.length;e--;)if(!Ct(t[e]))throw new gn;return function(){for(var e=arguments,n=t.length;n--;)e=[t[n].apply(this,e)];return e[0]}}function $e(t,e,n){var r=typeof t;if(null==t||"function"==r)return Y(t,e,n);if("object"!=r)return function(e){return e[t]};var i=Kn(t),o=i[0],a=t[o];return 1!=i.length||a!==a||Et(a)?function(e){for(var n=i.length,r=!1;n--&&(r=Q(e[i[n]],t[i[n]],null,!0)););return r}:function(t){var e=t[o];return a===e&&(0!==a||1/a==1/e)}}function Ie(t,e){return e="number"==typeof e?e:+e||t.length,rt(t,4,null,null,null,e)}function Le(t,e,n){var r,i,o,a,s,u,l,c=0,h=!1,f=!0;if(!Ct(t))throw new gn;if(e=Rn(0,e)||0,n===!0){var d=!0;f=!1}else Et(n)&&(d=n.leading,h="maxWait"in n&&(Rn(e,n.maxWait)||0),f="trailing"in n?n.trailing:f);var g=function(){var n=e-(En()-a);if(0>=n){i&&xn(i);var h=l;i=u=l=p,h&&(c=En(),o=t.apply(s,r))}else u=Pn(g,n)},m=function(){u&&xn(u),i=u=l=p,(f||h!==e)&&(c=En(),o=t.apply(s,r))};return function(){if(r=arguments,a=En(),s=this,l=f&&(u||!d),h===!1)var n=d&&!u;else{i||d||(c=a);var p=h-(a-c);0>=p?(i&&(i=xn(i)),c=a,o=t.apply(s,r)):i||(i=Pn(m,p))}return u||e===h||(u=Pn(g,e)),n&&(o=t.apply(s,r)),o}}function Oe(t){if(!Ct(t))throw new gn;var e=Hn.call(arguments,1);return Pn(function(){t.apply(p,e)},1)}function De(t,e){if(!Ct(t))throw new gn;var n=Hn.call(arguments,2);return Pn(function(){t.apply(p,n)},e)}function ze(t,e){if(!Ct(t))throw new gn;var n=function(){var r=n.cache,i=e?e.apply(this,arguments):y+arguments[0];return Cn.call(r,i)?r[i]:r[i]=t.apply(this,arguments)};return n.cache={},n}function Fe(t){var e,n;if(!Ct(t))throw new gn;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}}function Re(t){return rt(t,16,Hn.call(arguments,1))}function Be(t){return rt(t,32,null,Hn.call(arguments,1))}function qe(t,e,n){var r=!0,i=!0;if(!Ct(t))throw new gn;n===!1?r=!1:Et(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),U.leading=r,U.maxWait=e,U.trailing=i;var o=Le(t,e,U);return o}function Ve(t,e){if(!Ct(e))throw new gn;return function(){var n=[t];return Mn.apply(n,arguments),e.apply(this,n)}}function He(t){return null==t?"":pn(t).replace(nr,ot)}function Ue(t){return t}function Ge(t,e){var n=t,r=!e||Ct(n);e||(n=m,e=t,t=g),Ut(mt(e),function(i){var o=t[i]=e[i];r&&(n.prototype[i]=function(){var e=this.__wrapped__,r=[e];Mn.apply(r,arguments);var i=o.apply(t,r);return e&&"object"==typeof e&&e===i?this:(i=new n(i),i.__chain__=this.__chain__,i)})})}function We(){return n._=yn,this}function Ye(t,e,n){var r=null==t,i=null==e;null==n&&("boolean"==typeof t&&i?(n=t,t=1):i||"boolean"!=typeof e||(n=e,i=!0)),r&&i&&(e=1),t=+t||0,i?(e=t,t=0):e=+e||0;var o=Vn();return n||t%1||e%1?Bn(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e):t+wn(o*(e-t+1))}function Xe(t,e){if(t){var n=t[e];return Ct(n)?t[e]():n}}function Je(t,e,n){var r=g.templateSettings;t||(t=""),n=ir({},n,r);var i,o=ir({},n.imports,r.imports),s=Kn(o),u=zt(o),l=0,c=n.interpolate||j,h="__p += '",f=dn((n.escape||j).source+"|"+c.source+"|"+(c===A?C:j).source+"|"+(n.evaluate||j).source+"|$","g");t.replace(f,function(e,n,r,o,s,u){return r||(r=o),h+=t.slice(l,u).replace(N,a),n&&(h+="' +\n__e("+n+") +\n'"),s&&(i=!0,h+="';\n"+s+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+e.length,e}),h+="';\n";var d=n.variable,m=d;m||(d="obj",h="with ("+d+") {\n"+h+"\n}\n"),h=(i?h.replace(w,""):h).replace(k,"$1").replace(S,"$1;"),h="function("+d+") {\n"+(m?"":d+" || ("+d+" = {});\n")+"var __t, __p = '', __e = _.escape"+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var v="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+I++ +"]")+"\n*/";try{var y=ln(s,"return "+h+v).apply(p,u)}catch(b){throw b.source=h,b}return e?y(e):(y.source=h,y)}function Qe(t,e,n){t=(t=+t)>-1?t:0;var r=-1,i=an(t);for(e=Y(e,n,1);++r<t;)i[r]=e(r);return i}function Ke(t){return null==t?"":pn(t).replace(er,ut)}function Ze(t){var e=++v;return pn(null==t?"":t)+e}function tn(t){return t=new m(t),t.__chain__=!0,t}function en(t,e){return e(t),t}function nn(){return this.__chain__=!0,this}function rn(){return pn(this.__wrapped__)}function on(){return this.__wrapped__}n=n?tt.defaults(X.Object(),n,tt.pick(X,$)):X;var an=n.Array,sn=n.Boolean,un=n.Date,ln=n.Function,cn=n.Math,hn=n.Number,fn=n.Object,dn=n.RegExp,pn=n.String,gn=n.TypeError,mn=[],vn=fn.prototype,yn=n._,bn=dn("^"+pn(vn.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),_n=cn.ceil,xn=n.clearTimeout,wn=cn.floor,kn=ln.prototype.toString,Sn=bn.test(Sn=fn.getPrototypeOf)&&Sn,Cn=vn.hasOwnProperty,En=bn.test(En=un.now)&&En||function(){return+new un},Mn=mn.push,An=n.setImmediate,Pn=n.setTimeout,jn=mn.splice,Tn=vn.toString,Nn=mn.unshift,$n=function(){try{var t={},e=bn.test(e=fn.defineProperty)&&e,n=e(t,t,t)&&e}catch(r){}return n}(),In=bn.test(In=Tn.bind)&&In,Ln=bn.test(Ln=fn.create)&&Ln,On=bn.test(On=an.isArray)&&On,Dn=n.isFinite,zn=n.isNaN,Fn=bn.test(Fn=fn.keys)&&Fn,Rn=cn.max,Bn=cn.min,qn=n.parseInt,Vn=cn.random,Hn=mn.slice,Un=bn.test(n.attachEvent),Gn=In&&!/\n|true/.test(In+Un),Wn={};Wn[O]=an,Wn[D]=sn,Wn[z]=un,Wn[F]=ln,Wn[B]=fn,Wn[R]=hn,Wn[q]=dn,Wn[V]=pn,m.prototype=g.prototype;var Yn=g.support={};Yn.fastBind=In&&!Gn,Yn.funcDecomp=!bn.test(n.WinRTError)&&T.test(d),Yn.funcNames="string"==typeof ln.name,g.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:A,variable:"",imports:{_:g}},Ln||(it=function(t){if(Et(t)){l.prototype=t;var e=new l;l.prototype=null}return e||{}});var Xn=$n?function(t,e){G.value=e,$n(t,"__bindData__",G)}:l,Jn=On||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Tn.call(t)==O||!1},Qn=function(t){var e,n=t,r=[];if(!n)return r;if(!W[typeof t])return r;for(e in n)Cn.call(n,e)&&r.push(e);return r},Kn=Fn?function(t){return Et(t)?Fn(t):[]}:Qn,Zn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tr=yt(Zn),er=dn("("+Kn(tr).join("|")+")","g"),nr=dn("["+Kn(Zn).join("")+"]","g"),rr=function(t,e,n){var r,i=t,o=i;if(!i)return o;var a=arguments,s=0,u="number"==typeof n?2:a.length;if(u>3&&"function"==typeof a[u-2])var l=Y(a[--u-1],a[u--],2);else u>2&&"function"==typeof a[u-1]&&(l=a[--u]);for(;++s<u;)if(i=a[s],i&&W[typeof i])for(var c=-1,h=W[typeof i]&&Kn(i),f=h?h.length:0;++c<f;)r=h[c],o[r]=l?l(o[r],i[r]):i[r];return o},ir=function(t,e,n){var r,i=t,o=i;if(!i)return o;for(var a=arguments,s=0,u="number"==typeof n?2:a.length;++s<u;)if(i=a[s],i&&W[typeof i])for(var l=-1,c=W[typeof i]&&Kn(i),h=c?c.length:0;++l<h;)r=c[l],"undefined"==typeof o[r]&&(o[r]=i[r]);return o},or=function(t,e,n){var r,i=t,o=i;if(!i)return o;if(!W[typeof i])return o;e=e&&"undefined"==typeof n?e:Y(e,n,3);for(r in i)if(e(i[r],r,t)===!1)return o;return o},ar=function(t,e,n){var r,i=t,o=i;if(!i)return o;if(!W[typeof i])return o;e=e&&"undefined"==typeof n?e:Y(e,n,3);for(var a=-1,s=W[typeof i]&&Kn(i),u=s?s.length:0;++a<u;)if(r=s[a],e(i[r],r,t)===!1)return o;return o},sr=function(t){if(!t||Tn.call(t)!=B)return!1;var e=t.valueOf,n="function"==typeof e&&(n=Sn(e))&&Sn(n);return n?t==n||Sn(t)==n:st(t)},ur=nt(function(t,e,n){Cn.call(t,n)?t[n]++:t[n]=1}),lr=nt(function(t,e,n){(Cn.call(t,n)?t[n]:t[n]=[]).push(e)}),cr=nt(function(t,e,n){t[n]=e}),hr=qt;Gn&&K&&"function"==typeof An&&(Oe=function(t){if(!Ct(t))throw new gn;return An.apply(n,arguments)});var fr=8==qn(x+"08")?qn:function(t,e){return qn(Tt(t)?t.replace(P,""):t,e||0)};return g.after=Ae,g.assign=rr,g.at=Ft,g.bind=Pe,g.bindAll=je,g.bindKey=Te,g.chain=tn,g.compact=se,g.compose=Ne,g.countBy=ur,g.createCallback=$e,g.curry=Ie,g.debounce=Le,g.defaults=ir,g.defer=Oe,g.delay=De,g.difference=ue,g.filter=qt,g.flatten=fe,g.forEach=Ut,g.forEachRight=Gt,g.forIn=or,g.forInRight=pt,g.forOwn=ar,g.forOwnRight=gt,g.functions=mt,g.groupBy=lr,g.indexBy=cr,g.initial=pe,g.intersection=ge,g.invert=yt,g.invoke=Wt,g.keys=Kn,g.map=Yt,g.max=Xt,g.memoize=ze,g.merge=$t,g.min=Jt,g.omit=It,g.once=Fe,g.pairs=Lt,g.partial=Re,g.partialRight=Be,g.pick=Ot,g.pluck=Qt,g.pull=ye,g.range=be,g.reject=te,g.remove=_e,g.rest=xe,g.shuffle=ne,g.sortBy=oe,g.tap=en,g.throttle=qe,g.times=Qe,g.toArray=ae,g.transform=Dt,g.union=ke,g.uniq=Se,g.values=zt,g.where=hr,g.without=Ce,g.wrap=Ve,g.zip=Ee,g.zipObject=Me,g.collect=Yt,g.drop=xe,g.each=Ut,g.eachRight=Gt,g.extend=rr,g.methods=mt,g.object=Me,g.select=qt,g.tail=xe,g.unique=Se,g.unzip=Ee,Ge(g),g.clone=ct,g.cloneDeep=ht,g.contains=Rt,g.escape=He,g.every=Bt,g.find=Vt,g.findIndex=le,g.findKey=ft,g.findLast=Ht,g.findLastIndex=ce,g.findLastKey=dt,g.has=vt,g.identity=Ue,g.indexOf=de,g.isArguments=lt,g.isArray=Jn,g.isBoolean=bt,g.isDate=_t,g.isElement=xt,g.isEmpty=wt,g.isEqual=kt,g.isFinite=St,g.isFunction=Ct,g.isNaN=Mt,g.isNull=At,g.isNumber=Pt,g.isObject=Et,g.isPlainObject=sr,g.isRegExp=jt,g.isString=Tt,g.isUndefined=Nt,g.lastIndexOf=ve,g.mixin=Ge,g.noConflict=We,g.parseInt=fr,g.random=Ye,g.reduce=Kt,g.reduceRight=Zt,g.result=Xe,g.runInContext=d,g.size=re,g.some=ie,g.sortedIndex=we,g.template=Je,g.unescape=Ke,g.uniqueId=Ze,g.all=Bt,g.any=ie,g.detect=Vt,g.findWhere=Vt,g.foldl=Kt,g.foldr=Zt,g.include=Rt,g.inject=Kt,ar(g,function(t,e){g.prototype[e]||(g.prototype[e]=function(){var e=[this.__wrapped__],n=this.__chain__;Mn.apply(e,arguments);var r=t.apply(g,e);return n?new m(r,n):r})}),g.first=he,g.last=me,g.sample=ee,g.take=he,g.head=he,ar(g,function(t,e){var n="sample"!==e;g.prototype[e]||(g.prototype[e]=function(e,r){var i=this.__chain__,o=t(this.__wrapped__,e,r);return i||null!=e&&(!r||n&&"function"==typeof e)?new m(o,i):o})}),g.VERSION="2.2.1",g.prototype.chain=nn,g.prototype.toString=rn,g.prototype.value=on,g.prototype.valueOf=on,Ut(["join","pop","shift"],function(t){var e=mn[t];g.prototype[t]=function(){var t=this.__chain__,n=e.apply(this.__wrapped__,arguments);return t?new m(n,t):n}}),Ut(["push","reverse","sort","unshift"],function(t){var e=mn[t];g.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),Ut(["concat","slice","splice"],function(t){var e=mn[t];g.prototype[t]=function(){return new m(e.apply(this.__wrapped__,arguments),this.__chain__)}}),g}var p,g=[],m=[],v=0,y=+new Date+"",b=75,_=40,x=" 	\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000",w=/\b__p \+= '';/g,k=/\b(__p \+=) '' \+/g,S=/(__e\(.*?\)|\b__t\)) \+\n'';/g,C=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,E=/\w*$/,M=/^function[ \n\r\t]+\w/,A=/<%=([\s\S]+?)%>/g,P=RegExp("^["+x+"]*0+(?=.$)"),j=/($^)/,T=/\bthis\b/,N=/['\n\r\t\u2028\u2029\\]/g,$=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],I=0,L="[object Arguments]",O="[object Array]",D="[object Boolean]",z="[object Date]",F="[object Function]",R="[object Number]",B="[object Object]",q="[object RegExp]",V="[object String]",H={};H[F]=!1,H[L]=H[O]=H[D]=H[z]=H[R]=H[B]=H[q]=H[V]=!0;var U={leading:!1,maxWait:0,trailing:!1},G={configurable:!1,enumerable:!1,value:null,writable:!1},W={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Y={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},X=W[typeof window]&&window||this,J=W[typeof exports]&&exports&&!exports.nodeType&&exports,Q=W[typeof module]&&module&&!module.nodeType&&module,K=Q&&Q.exports===J&&J,Z=W[typeof global]&&global;!Z||Z.global!==Z&&Z.window!==Z||(X=Z);var tt=d();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(X._=tt,define(function(){return tt})):J&&Q?K?(Q.exports=tt)._=tt:J._=tt:X._=tt}.call(this),function(t,e){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(n,r,i){t.Backbone=e(t,i,n,r)});else if("undefined"!=typeof exports){var n=require("underscore");e(t,exports,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,n,r){var i=t.Backbone,o=[],a=(o.push,o.slice);o.splice;e.VERSION="1.1.2",e.$=r,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=e.Events={on:function(t,e,n){if(!l(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,r){if(!l(this,"once",t,[e,r])||!e)return this;var i=this,o=n.once(function(){i.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,r)},off:function(t,e,r){var i,o,a,s,u,c,h,f;if(!this._events||!l(this,"off",t,[e,r]))return this;if(!t&&!e&&!r)return this._events=void 0,this;for(s=t?[t]:n.keys(this._events),u=0,c=s.length;c>u;u++)if(t=s[u],a=this._events[t]){if(this._events[t]=i=[],e||r)for(h=0,f=a.length;f>h;h++)o=a[h],(e&&e!==o.callback&&e!==o.callback._callback||r&&r!==o.context)&&i.push(o);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!l(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&c(n,e),r&&c(r,arguments),this},stopListening:function(t,e,r){var i=this._listeningTo;if(!i)return this;var o=!e&&!r;r||"object"!=typeof e||(r=this),t&&((i={})[t._listenId]=t);for(var a in i)t=i[a],t.off(e,r,this),(o||n.isEmpty(t._events))&&delete this._listeningTo[a];return this}},u=/\s+/,l=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(r));return!1}if(u.test(n)){for(var o=n.split(u),a=0,s=o.length;s>a;a++)t[e].apply(t,[o[a]].concat(r));return!1}return!0},c=function(t,e){var n,r=-1,i=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,a);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,a,s);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e);return}},h={listenTo:"on",listenToOnce:"once"};n.each(h,function(t,e){s[e]=function(e,r,i){var o=this._listeningTo||(this._listeningTo={}),a=e._listenId||(e._listenId=n.uniqueId("l"));return o[a]=e,i||"object"!=typeof r||(i=this),e[t](r,i,this),this}}),s.bind=s.on,s.unbind=s.off,n.extend(e,s);var f=e.Model=function(t,e){var r=t||{};e||(e={}),this.cid=n.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(r=this.parse(r,e)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(f.prototype,s,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,r){var i,o,a,s,u,l,c,h;if(null==t)return this;if("object"==typeof t?(o=t,r=e):(o={})[t]=e,r||(r={}),!this._validate(o,r))return!1;a=r.unset,u=r.silent,s=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={}),h=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(i in o)e=o[i],n.isEqual(h[i],e)||s.push(i),n.isEqual(c[i],e)?delete this.changed[i]:this.changed[i]=e,a?delete h[i]:h[i]=e;if(!u){s.length&&(this._pending=r);for(var f=0,d=s.length;d>f;f++)this.trigger("change:"+s[f],this,h[s[f]],r)}if(l)return this;if(!u)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var r in this.attributes)e[r]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?n.clone(this.changed):!1;var e,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var o in t)n.isEqual(i[o],e=t[o])||((r||(r={}))[o]=e);return r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,r=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(r&&r(e,n,t),void e.trigger("sync",e,n,t)):!1},D(this,t),this.sync("read",this,t)},save:function(t,e,r){var i,o,a,s=this.attributes;if(null==t||"object"==typeof t?(i=t,r=e):(i={})[t]=e,r=n.extend({validate:!0},r),i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},s,i)),void 0===r.parse&&(r.parse=!0);var u=this,l=r.success;return r.success=function(t){u.attributes=s;var e=u.parse(t,r);return r.wait&&(e=n.extend(i||{},e)),n.isObject(e)&&!u.set(e,r)?!1:(l&&l(u,t,r),void u.trigger("sync",u,t,r))},D(this,r),o=this.isNew()?"create":r.patch?"patch":"update","patch"===o&&(r.attrs=i),a=this.sync(o,this,r),i&&r.wait&&(this.attributes=s),a},destroy:function(t){t=t?n.clone(t):{};var e=this,r=t.success,i=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&i(),r&&r(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;D(this,t);var o=this.sync("delete",this,t);return t.wait||i(),o},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||O();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var r=this.validationError=this.validate(t,e)||null;return r?(this.trigger("invalid",this,r,n.extend(e,{validationError:r})),!1):!0}});var d=["keys","values","pairs","invert","pick","omit"];n.each(d,function(t){f.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),n[t].apply(n,e)}});var p=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},g={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(p.prototype,s,{model:f,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,m))},remove:function(t,e){var r=!n.isArray(t);t=r?[t]:n.clone(t),e||(e={});var i,o,a,s;for(i=0,o=t.length;o>i;i++)s=t[i]=this.get(t[i]),s&&(delete this._byId[s.id],delete this._byId[s.cid],a=this.indexOf(s),this.models.splice(a,1),this.length--,e.silent||(e.index=a,s.trigger("remove",s,this,e)),this._removeReference(s,e));return r?t[0]:t},set:function(t,e){e=n.defaults({},e,g),e.parse&&(t=this.parse(t,e));var r=!n.isArray(t);t=r?t?[t]:[]:n.clone(t);var i,o,a,s,u,l,c,h=e.at,d=this.model,p=this.comparator&&null==h&&e.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},_=e.add,x=e.merge,w=e.remove,k=!p&&_&&w?[]:!1;for(i=0,o=t.length;o>i;i++){if(u=t[i]||{},a=u instanceof f?s=u:u[d.prototype.idAttribute||"id"],l=this.get(a))w&&(b[l.cid]=!0),x&&(u=u===s?s.attributes:u,e.parse&&(u=l.parse(u,e)),l.set(u,e),p&&!c&&l.hasChanged(m)&&(c=!0)),t[i]=l;else if(_){if(s=t[i]=this._prepareModel(u,e),!s)continue;v.push(s),this._addReference(s,e)}s=l||s,!k||!s.isNew()&&b[s.id]||k.push(s),b[s.id]=!0}if(w){for(i=0,o=this.length;o>i;++i)b[(s=this.models[i]).cid]||y.push(s);y.length&&this.remove(y,e)}if(v.length||k&&k.length)if(p&&(c=!0),this.length+=v.length,null!=h)for(i=0,o=v.length;o>i;i++)this.models.splice(h+i,0,v[i]);else{k&&(this.models.length=0);var S=k||v;for(i=0,o=S.length;o>i;i++)this.models.push(S[i])}if(c&&this.sort({silent:!0}),!e.silent){for(i=0,o=v.length;o>i;i++)(s=v[i]).trigger("add",s,this,e);(c||k&&k.length)&&this.trigger("sort",this,e)}return r?t[0]:t},reset:function(t,e){e||(e={});for(var r=0,i=this.models.length;i>r;r++)this._removeReference(this.models[r],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return n.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,r=this;return t.success=function(n){var i=t.reset?"reset":"set";r[i](n,t),e&&e(r,n,t),r.trigger("sync",r,n,t)},D(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?n.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var r=this,i=e.success;return e.success=function(t,n){e.wait&&r.add(t,e),i&&i(t,n,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof f)return t;e=e?n.clone(e):{},e.collection=this;var r=new this.model(t,e);return r.validationError?(this.trigger("invalid",this,r.validationError,e),!1):r},_addReference:function(t,e){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,r),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(v,function(t){p.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),n[t].apply(n,e)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(t){p.prototype[t]=function(e,r){var i=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,i,r)}});var b=e.View=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},_=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,s,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var r=t[e];if(n.isFunction(r)||(r=this[t[e]]),r){var i=e.match(_),o=i[1],a=i[2];r=n.bind(r,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,r):this.$el.on(o,a,r)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className"));var r=e.$("<"+n.result(this,"tagName")+">").attr(t);this.setElement(r,!1)}}}),e.sync=function(t,r,i){var o=k[t];n.defaults(i||(i={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:o,dataType:"json"};if(i.url||(a.url=n.result(r,"url")||O()),null!=i.data||!r||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),i.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",i.emulateJSON&&(a.data._method=o);var s=i.beforeSend;i.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",o),s?s.apply(this,arguments):void 0}}"GET"===a.type||i.emulateJSON||(a.processData=!1),"PATCH"===a.type&&w&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=i.xhr=e.ajax(n.extend(a,i));return r.trigger("request",r,u,i),u};var w=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var S=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,M=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(S.prototype,s,{initialize:function(){},route:function(t,r,i){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var o=this;return e.history.route(t,function(n){var a=o._extractParameters(t,n);o.execute(i,a),o.trigger.apply(o,["route:"+r].concat(a)),o.trigger("route",r,a),e.history.trigger("route",o,r,a)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(A,"\\$&").replace(C,"(?:$1)?").replace(E,function(t,e){return e?t:"([^/?]+)"}).replace(M,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var r=t.exec(e).slice(1);return n.map(r,function(t,e){return e===r.length-1?t||null:t?decodeURIComponent(t):null})}});var P=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},j=/^[#\/]|\s+$/g,T=/^\/+|\/+$/g,N=/msie [\w.]+/,$=/\/$/,I=/#.*$/;P.started=!1,n.extend(P.prototype,s,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace($,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace(j,"")},start:function(t){if(P.started)throw new Error("Backbone.history has already been started");P.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),i=document.documentMode,o=N.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);if(this.root=("/"+this.root+"/").replace(T,"/"),o&&this._wantsHashChange){var a=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=a.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var s=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&s.hash&&(this.fragment=this.getHash().replace(j,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),P.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),n.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!P.started)return!1;e&&e!==!0||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(I,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else t.hash="#"+e}}),e.history=new P;var L=function(t,e){var r,i=this;r=t&&n.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},n.extend(r,i,e);var o=function(){this.constructor=r};return o.prototype=i.prototype,r.prototype=new o,t&&n.extend(r.prototype,t),r.__super__=i.prototype,r};f.extend=p.extend=S.extend=b.extend=P.extend=L;var O=function(){throw new Error('A "url" property or function must be specified')},D=function(t,e){var n=e.error;e.error=function(r){n&&n(t,r,e),t.trigger("error",t,r,e)}};return e}),function(t,e){"function"==typeof define&&define.amd?define([],e):t.Vectorizer=t.V=e()}(this,function(){function t(){var t=++h+"";return"v-"+t}function e(t){var e='<svg xmlns="'+l.xmlns+'" xmlns:xlink="'+l.xlink+'" version="'+c+'">'+(t||"")+"</svg>",n=new DOMParser;return n.async=!1,n.parseFromString(e,"text/xml").documentElement}function n(t,n,i){if(!t)return void 0;if("object"==typeof t)return new s(t);if(n=n||{},"svg"===t.toLowerCase())return new s(e());if("<"===t[0]){var o=e(t);if(o.childNodes.length>1){for(var a=[],u=0,c=o.childNodes.length;c>u;u++){var h=o.childNodes[u];a.push(new s(document.importNode(h,!0)))}return a}return new s(document.importNode(o.firstChild,!0))}t=document.createElementNS(l.xmlns,t);for(var f in n)r(t,f,n[f]);"[object Array]"!=Object.prototype.toString.call(i)&&(i=[i]);for(var d,u=0,c=i[0]&&i.length||0;c>u;u++)d=i[u],t.appendChild(d instanceof s?d.node:d);return new s(t)}function r(t,e,n){if(e.indexOf(":")>-1){var r=e.split(":");t.setAttributeNS(l[r[0]],r[1],n)}else"id"===e?t.id=n:t.setAttribute(e,n)}function i(t){var e,n,r;if(t){var i=/[ ,]+/,o=t.match(/translate\((.*)\)/);o&&(e=o[1].split(i));var a=t.match(/rotate\((.*)\)/);a&&(n=a[1].split(i));
var s=t.match(/scale\((.*)\)/);s&&(r=s[1].split(i))}var u=r&&r[0]?parseFloat(r[0]):1;return{translate:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotate:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:u,sy:r&&r[1]?parseFloat(r[1]):u}}}function o(t,e){var n=e.x*t.a+e.y*t.c+0,r=e.x*t.b+e.y*t.d+0;return{x:n,y:r}}function a(t){var e=o(t,{x:0,y:1}),n=o(t,{x:1,y:0}),r=180/Math.PI*Math.atan2(e.y,e.x)-90,i=180/Math.PI*Math.atan2(n.y,n.x);return{translateX:t.e,translateY:t.f,scaleX:Math.sqrt(t.a*t.a+t.b*t.b),scaleY:Math.sqrt(t.c*t.c+t.d*t.d),skewX:r,skewY:i,rotation:r}}function s(e){this.node=e,this.node.id||(this.node.id=t())}function u(t){var e=t.rx||t["top-rx"]||0,n=t.rx||t["bottom-rx"]||0,r=t.ry||t["top-ry"]||0,i=t.ry||t["bottom-ry"]||0;return["M",t.x,t.y+r,"v",t.height-r-i,"a",n,i,0,0,0,n,i,"h",t.width-2*n,"a",n,i,0,0,0,n,-i,"v",-(t.height-i-r),"a",e,r,0,0,0,-e,-r,"h",-(t.width-2*e),"a",e,r,0,0,0,-e,r].join(" ")}var l=(!(!window.SVGAngle&&!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")),{xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"}),c="1.1",h=0;s.prototype={translate:function(t,e,n){n=n||{},e=e||0;var r=this.attr("transform")||"",o=i(r);if("undefined"==typeof t)return o.translate;r=r.replace(/translate\([^\)]*\)/g,"").trim();var a=n.absolute?t:o.translate.tx+t,s=n.absolute?e:o.translate.ty+e,u="translate("+a+","+s+")";return this.attr("transform",(u+" "+r).trim()),this},rotate:function(t,e,n,r){r=r||{};var o=this.attr("transform")||"",a=i(o);if("undefined"==typeof t)return a.rotate;o=o.replace(/rotate\([^\)]*\)/g,"").trim(),t%=360;var s=r.absolute?t:a.rotate.angle+t,u=void 0!==e&&void 0!==n?","+e+","+n:"",l="rotate("+s+u+")";return this.attr("transform",(o+" "+l).trim()),this},scale:function(t,e){e="undefined"==typeof e?t:e;var n=this.attr("transform")||"",r=i(n);if("undefined"==typeof t)return r.scale;n=n.replace(/scale\([^\)]*\)/g,"").trim();var o="scale("+t+","+e+")";return this.attr("transform",(n+" "+o).trim()),this},bbox:function(t,e){if(!this.node.ownerSVGElement)return{x:0,y:0,width:0,height:0};var n;try{n=this.node.getBBox(),n={x:0|n.x,y:0|n.y,width:0|n.width,height:0|n.height}}catch(r){n={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}if(t)return n;var i=this.node.getTransformToElement(e||this.node.ownerSVGElement);return f.transformRect(n,i)},text:function(t,e){e=e||{};var r,i=t.split("\n"),o=0;this.attr("y","0.8em"),this.attr("display",t?null:"none"),this.node.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.node.textContent="";var a=this.node;if(e.textPath){var s=this.find("defs");0===s.length&&(s=n("defs"),this.append(s));var u=Object(e.textPath)===e.textPath?e.textPath.d:e.textPath;if(u){var l=n("path",{d:u});s.append(l)}var c=n("textPath");!e.textPath["xlink:href"]&&l&&c.attr("xlink:href","#"+l.node.id),Object(e.textPath)===e.textPath&&c.attr(e.textPath),this.append(c),a=c.node}if(1===i.length)return a.textContent=t,this;for(;o<i.length;o++)r=f("tspan",{dy:0==o?"0em":e.lineHeight||"1em",x:this.attr("x")||0}),r.addClass("line"),i[o]||r.addClass("empty-line"),r.node.textContent=i[o]||" ",f(a).append(r);return this},attr:function(t,e){if("string"==typeof t&&"undefined"==typeof e)return this.node.getAttribute(t);if("object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&r(this.node,n,t[n]);else r(this.node,t,e);return this},remove:function(){this.node.parentNode&&this.node.parentNode.removeChild(this.node)},append:function(t){var e=t;"[object Array]"!==Object.prototype.toString.call(t)&&(e=[t]);for(var n=0,r=e.length;r>n;n++)t=e[n],this.node.appendChild(t instanceof s?t.node:t);return this},prepend:function(t){this.node.insertBefore(t instanceof s?t.node:t,this.node.firstChild)},svg:function(){return this.node instanceof window.SVGSVGElement?this:f(this.node.ownerSVGElement)},defs:function(){var t=this.svg().node.getElementsByTagName("defs");return t&&t.length?f(t[0]):void 0},clone:function(){var e=f(this.node.cloneNode(!0));return e.node.id=t(),e},findOne:function(t){var e=this.node.querySelector(t);return e?f(e):void 0},find:function(t){for(var e=this.node.querySelectorAll(t),n=0,r=e.length;r>n;n++)e[n]=f(e[n]);return e},toLocalPoint:function(t,e){var n=this.svg().node,r=n.createSVGPoint();r.x=t,r.y=e;try{var i=r.matrixTransform(n.getScreenCTM().inverse()),o=this.node.getTransformToElement(n).inverse()}catch(a){return r}return i.matrixTransform(o)},translateCenterToPoint:function(t){var e=this.bbox(),n=g.rect(e).center();this.translate(t.x-n.x,t.y-n.y)},translateAndAutoOrient:function(t,e,n){var r=this.scale();this.attr("transform",""),this.scale(r.sx,r.sy);var i=this.svg().node,o=this.bbox(!1,n),s=i.createSVGTransform();s.setTranslate(-o.x-o.width/2,-o.y-o.height/2);var u=i.createSVGTransform(),l=g.point(t).changeInAngle(t.x-e.x,t.y-e.y,e);u.setRotate(l,0,0);var c=i.createSVGTransform(),h=g.point(t).move(e,o.width/2);c.setTranslate(t.x+(t.x-h.x),t.y+(t.y-h.y));var f=this.node.getTransformToElement(n),d=i.createSVGTransform();d.setMatrix(c.matrix.multiply(u.matrix.multiply(s.matrix.multiply(f))));var p=a(d.matrix);return this.translate(p.translateX,p.translateY),this.rotate(p.rotation),this},animateAlongPath:function(t,e){var n=f("animateMotion",t),r=f("mpath",{"xlink:href":"#"+f(e).node.id});n.append(r),this.append(n);try{n.node.beginElement()}catch(i){if("fake"===document.documentElement.getAttribute("smiling")){var o=n.node;o.animators=[];var a=o.getAttribute("id");a&&(id2anim[a]=o);for(var s=getTargets(o),u=0,l=s.length;l>u;u++){var c=s[u],h=new Animator(o,c,u);animators.push(h),o.animators[u]=h,h.register()}}}},hasClass:function(t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(this.node.getAttribute("class"))},addClass:function(t){if(!this.hasClass(t)){var e=this.node.getAttribute("class")||"";this.node.setAttribute("class",(e+" "+t).trim())}return this},removeClass:function(t){if(this.hasClass(t)){var e=this.node.getAttribute("class").replace(new RegExp("(\\s|^)"+t+"(\\s|$)","g"),"$2");this.node.setAttribute("class",e)}return this},toggleClass:function(t,e){var n="undefined"==typeof e?this.hasClass(t):!e;return n?this.removeClass(t):this.addClass(t),this}};var f=n;f.decomposeMatrix=a,f.rectToPath=u;var d=f("svg").node;return f.createSVGMatrix=function(t){var e=d.createSVGMatrix();for(var n in t)e[n]=t[n];return e},f.createSVGTransform=function(){return d.createSVGTransform()},f.createSVGPoint=function(t,e){var n=d.createSVGPoint();return n.x=t,n.y=e,n},f.transformRect=function(t,e){var n=d.createSVGPoint();n.x=t.x,n.y=t.y;var r=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y;var i=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y+t.height;var o=n.matrixTransform(e);n.x=t.x,n.y=t.y+t.height;var a=n.matrixTransform(e),s=Math.min(r.x,i.x,o.x,a.x),u=Math.max(r.x,i.x,o.x,a.x),l=Math.min(r.y,i.y,o.y,a.y),c=Math.max(r.y,i.y,o.y,a.y);return{x:s,y:l,width:u-s,height:c-l}},f}),function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.g=e()}(this,function(){function t(e,n){if(!(this instanceof t))return new t(e,n);var r;void 0===n&&Object(e)!==e?(r=e.split(-1===e.indexOf("@")?" ":"@"),this.x=parseInt(r[0],10),this.y=parseInt(r[1],10)):Object(e)===e?(this.x=e.x,this.y=e.y):(this.x=e,this.y=n)}function e(n,r){return this instanceof e?(this.start=t(n),void(this.end=t(r))):new e(n,r)}function n(t,e,r,i){return this instanceof n?(void 0===e&&(e=t.y,r=t.width,i=t.height,t=t.x),this.x=t,this.y=e,this.width=r,void(this.height=i)):new n(t,e,r,i)}function r(e,n,i){return this instanceof r?(e=t(e),this.x=e.x,this.y=e.y,this.a=n,void(this.b=i)):new r(e,n,i)}var i=Math,o=i.abs,a=i.cos,s=i.sin,u=i.sqrt,l=i.min,c=i.max,h=(i.atan,i.atan2),f=(i.acos,i.round),d=i.floor,p=i.PI,g=i.random,m=function(t){return 180*t/p%360},v=function(t,e){return e=e||!1,t=e?t:t%360,t*p/180},y=function(t,e){return e*Math.round(t/e)},b=function(t){return t%360+(0>t?360:0)};t.prototype={toString:function(){return this.x+"@"+this.y},adhereToRect:function(t){return t.containsPoint(this)?this:(this.x=l(c(this.x,t.x),t.x+t.width),this.y=l(c(this.y,t.y),t.y+t.height),this)},theta:function(e){e=t(e);var n=-(e.y-this.y),r=e.x-this.x,i=10,o=0==n.toFixed(i)&&0==r.toFixed(i)?0:h(n,r);return 0>o&&(o=2*p+o),180*o/p},distance:function(t){return e(this,t).length()},manhattanDistance:function(t){return o(t.x-this.x)+o(t.y-this.y)},offset:function(t,e){return this.x+=t||0,this.y+=e||0,this},magnitude:function(){return u(this.x*this.x+this.y*this.y)||.01},update:function(t,e){return this.x=t||0,this.y=e||0,this},round:function(t){return this.x=t?this.x.toFixed(t):f(this.x),this.y=t?this.y.toFixed(t):f(this.y),this},normalize:function(t){var e=(t||1)/this.magnitude();return this.x=e*this.x,this.y=e*this.y,this},difference:function(e){return t(this.x-e.x,this.y-e.y)},bearing:function(t){return e(this,t).bearing()},toPolar:function(e){e=e&&t(e)||t(0,0);var n=this.x,r=this.y;return this.x=u((n-e.x)*(n-e.x)+(r-e.y)*(r-e.y)),this.y=v(e.theta(t(n,r))),this},rotate:function(e,n){n=(n+360)%360,this.toPolar(e),this.y+=v(n);var r=t.fromPolar(this.x,this.y,e);return this.x=r.x,this.y=r.y,this},move:function(e,n){var r=v(t(e).theta(this));return this.offset(a(r)*n,-s(r)*n)},changeInAngle:function(e,n,r){return t(this).offset(-e,-n).theta(r)-this.theta(r)},equals:function(t){return this.x===t.x&&this.y===t.y},snapToGrid:function(t,e){return this.x=y(this.x,t),this.y=y(this.y,e||t),this},reflection:function(e){return t(e).move(this,this.distance(e))}},t.fromPolar=function(e,n,r){r=r&&t(r)||t(0,0);var i=o(e*a(n)),u=o(e*s(n)),l=b(m(n));return 90>l?u=-u:180>l?(i=-i,u=-u):270>l&&(i=-i),t(r.x+i,r.y+u)},t.random=function(e,n,r,i){return t(d(g()*(n-e+1)+e),d(g()*(i-r+1)+r))},e.prototype={toString:function(){return this.start.toString()+" "+this.end.toString()},length:function(){return u(this.squaredLength())},squaredLength:function(){var t=this.start.x,e=this.start.y,n=this.end.x,r=this.end.y;return(t-=n)*t+(e-=r)*e},midpoint:function(){return t((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},intersection:function(e){var n=t(this.end.x-this.start.x,this.end.y-this.start.y),r=t(e.end.x-e.start.x,e.end.y-e.start.y),i=n.x*r.y-n.y*r.x,o=t(e.start.x-this.start.x,e.start.y-this.start.y),a=o.x*r.y-o.y*r.x,s=o.x*n.y-o.y*n.x;if(0===i||0>a*i||0>s*i)return null;if(i>0){if(a>i||s>i)return null}else if(i>a||i>s)return null;return t(this.start.x+a*n.x/i,this.start.y+a*n.y/i)},bearing:function(){var t=v(this.start.y),e=v(this.end.y),n=this.start.x,r=this.end.x,i=v(r-n),o=s(i)*a(e),u=a(t)*s(e)-s(t)*a(e)*a(i),l=m(h(o,u)),c=["NE","E","SE","S","SW","W","NW","N"],f=l-22.5;return 0>f&&(f+=360),f=parseInt(f/45),c[f]},pointAt:function(e){var n=(1-e)*this.start.x+e*this.end.x,r=(1-e)*this.start.y+e*this.end.y;return t(n,r)}},n.prototype={toString:function(){return this.origin().toString()+" "+this.corner().toString()},origin:function(){return t(this.x,this.y)},corner:function(){return t(this.x+this.width,this.y+this.height)},topRight:function(){return t(this.x+this.width,this.y)},bottomLeft:function(){return t(this.x,this.y+this.height)},center:function(){return t(this.x+this.width/2,this.y+this.height/2)},intersect:function(t){var e=this.origin(),n=this.corner(),r=t.origin(),i=t.corner();return i.x<=e.x||i.y<=e.y||r.x>=n.x||r.y>=n.y?!1:!0},sideNearestToPoint:function(e){e=t(e);var n=e.x-this.x,r=this.x+this.width-e.x,i=e.y-this.y,o=this.y+this.height-e.y,a=n,s="left";return a>r&&(a=r,s="right"),a>i&&(a=i,s="top"),a>o&&(a=o,s="bottom"),s},containsPoint:function(e){return e=t(e),e.x>=this.x&&e.x<=this.x+this.width&&e.y>=this.y&&e.y<=this.y+this.height?!0:!1},containsRect:function(t){var e=n(t).normalize(),r=e.width,i=e.height,o=e.x,a=e.y,s=this.width,u=this.height;if(0>(s|u|r|i))return!1;var l=this.x,c=this.y;if(l>o||c>a)return!1;if(s+=l,r+=o,o>=r){if(s>=l||r>s)return!1}else if(s>=l&&r>s)return!1;if(u+=c,i+=a,a>=i){if(u>=c||i>u)return!1}else if(u>=c&&i>u)return!1;return!0},pointNearestToPoint:function(e){if(e=t(e),this.containsPoint(e)){var n=this.sideNearestToPoint(e);switch(n){case"right":return t(this.x+this.width,e.y);case"left":return t(this.x,e.y);case"bottom":return t(e.x,this.y+this.height);case"top":return t(e.x,this.y)}}return e.adhereToRect(this)},intersectionWithLineFromCenterToPoint:function(n,r){n=t(n);var i,o=t(this.x+this.width/2,this.y+this.height/2);r&&n.rotate(o,r);for(var a=[e(this.origin(),this.topRight()),e(this.topRight(),this.corner()),e(this.corner(),this.bottomLeft()),e(this.bottomLeft(),this.origin())],s=e(o,n),u=a.length-1;u>=0;--u){var l=a[u].intersection(s);if(null!==l){i=l;break}}return i&&r&&i.rotate(o,-r),i},moveAndExpand:function(t){return this.x+=t.x,this.y+=t.y,this.width+=t.width,this.height+=t.height,this},round:function(t){return this.x=t?this.x.toFixed(t):f(this.x),this.y=t?this.y.toFixed(t):f(this.y),this.width=t?this.width.toFixed(t):f(this.width),this.height=t?this.height.toFixed(t):f(this.height),this},normalize:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,r=-this.height),this.x=t,this.y=e,this.width=n,this.height=r,this},bbox:function(t){var e=v(t||0),r=o(s(e)),i=o(a(e)),u=this.width*i+this.height*r,l=this.width*r+this.height*i;return n(this.x+(this.width-u)/2,this.y+(this.height-l)/2,u,l)}},r.prototype={toString:function(){return t(this.x,this.y).toString()+" "+this.a+" "+this.b},bbox:function(){return n(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},intersectionWithLineFromCenterToPoint:function(e,n){e=t(e),n&&e.rotate(t(this.x,this.y),n);var r,i=e.x-this.x,o=e.y-this.y;if(0===i)return r=this.bbox().pointNearestToPoint(e),n?r.rotate(t(this.x,this.y),-n):r;var a=o/i,s=a*a,l=this.a*this.a,c=this.b*this.b,h=u(1/(1/l+s/c));h=0>i?-h:h;var f=a*h;return r=t(this.x+h,this.y+f),n?r.rotate(t(this.x,this.y),-n):r}};var _={curveThroughPoints:function(t){for(var e=this.getCurveControlPoints(t),n=["M",t[0].x,t[0].y],r=0;r<e[0].length;r++)n.push("C",e[0][r].x,e[0][r].y,e[1][r].x,e[1][r].y,t[r+1].x,t[r+1].y);return n},getCurveControlPoints:function(e){var n,r=[],i=[],o=e.length-1;if(1==o)return r[0]=t((2*e[0].x+e[1].x)/3,(2*e[0].y+e[1].y)/3),i[0]=t(2*r[0].x-e[0].x,2*r[0].y-e[0].y),[r,i];var a=[];for(n=1;o-1>n;n++)a[n]=4*e[n].x+2*e[n+1].x;a[0]=e[0].x+2*e[1].x,a[o-1]=(8*e[o-1].x+e[o].x)/2;var s=this.getFirstControlPoints(a);for(n=1;o-1>n;++n)a[n]=4*e[n].y+2*e[n+1].y;a[0]=e[0].y+2*e[1].y,a[o-1]=(8*e[o-1].y+e[o].y)/2;var u=this.getFirstControlPoints(a);for(n=0;o>n;n++)r.push(t(s[n],u[n])),o-1>n?i.push(t(2*e[n+1].x-s[n+1],2*e[n+1].y-u[n+1])):i.push(t((e[o].x+s[o-1])/2,(e[o].y+u[o-1])/2));return[r,i]},getFirstControlPoints:function(t){var e=t.length,n=[],r=[],i=2;n[0]=t[0]/i;for(var o=1;e>o;o++)r[o]=1/i,i=(e-1>o?4:3.5)-r[o],n[o]=(t[o]-n[o-1])/i;for(o=1;e>o;o++)n[e-o-1]-=r[e-o]*n[e-o];return n},getInversionSolver:function(t,e,n,r){function i(t,e){var n=o[t],r=o[e];return function(i){var o=(t%3?3:1)*(e%3?3:1),a=i.x*(n.y-r.y)+i.y*(r.x-n.x)+n.x*r.y-n.y*r.x;return o*a}}var o=arguments;return function(n){var r=3*i(2,3)(e),o=i(1,3)(t)/r,a=-i(2,3)(t)/r,s=o*i(3,1)(n)+a*(i(3,0)(n)+i(2,1)(n))+i(2,0)(n),u=o*i(3,0)(n)+a*i(2,0)(n)+i(1,0)(n);return u/(u-s)}},getCurveDivider:function(t,n,r,i){return function(o){var a=e(t,n).pointAt(o),s=e(n,r).pointAt(o),u=e(r,i).pointAt(o),l=e(a,s).pointAt(o),c=e(s,u).pointAt(o),h=e(l,c).pointAt(o);return[{p0:t,p1:a,p2:l,p3:h},{p0:h,p1:c,p2:u,p3:i}]}}},x={linear:function(t,e,n){var r=t[1]-t[0],i=e[1]-e[0];return(n-t[0])/r*i+e[0]||0}};return{toDeg:m,toRad:v,snapToGrid:y,normalizeAngle:b,point:t,line:e,rect:n,ellipse:r,bezier:_,scale:x}}),"object"==typeof exports)var _=require("lodash");var joint={version:"0.9.3",dia:{},ui:{},layout:{},shapes:{},format:{},connectors:{},routers:{},util:{hashCode:function(t){var e=0;if(0==t.length)return e;for(var n=0;n<t.length;n++){var r=t.charCodeAt(n);e=(e<<5)-e+r,e&=e}return e},getByPath:function(t,e,n){n=n||".";for(var r,i=e.split(n);i.length;){if(r=i.shift(),!(Object(t)===t&&r in t))return void 0;t=t[r]}return t},setByPath:function(t,e,n,r){r=r||".";var i=e.split(r),o=t,a=0;if(e.indexOf(r)>-1){for(var s=i.length;s-1>a;a++)o=o[i[a]]||(o[i[a]]={});o[i[s-1]]=n}else t[e]=n;return t},unsetByPath:function(t,e,n){n=n||".";var r=e.lastIndexOf(n);if(r>-1){var i=joint.util.getByPath(t,e.substr(0,r),n);i&&delete i[e.slice(r+1)]}else delete t[e];return t},flattenObject:function(t,e,n){e=e||".";var r={};for(var i in t)if(t.hasOwnProperty(i)){var o="object"==typeof t[i];if(o&&n&&n(t[i])&&(o=!1),o){var a=this.flattenObject(t[i],e,n);for(var s in a)a.hasOwnProperty(s)&&(r[i+e+s]=a[s])}else r[i]=t[i]}return r},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})},guid:function(t){return this.guid.id=this.guid.id||1,t.id=void 0===t.id?"j_"+this.guid.id++:t.id,t.id},mixin:function(){for(var t=arguments[0],e=1,n=arguments.length;n>e;e++){var r=arguments[e];(Object(r)===r||_.isFunction(r)||null!==r&&void 0!==r)&&_.each(r,function(e,n){return this.mixin.deep&&Object(e)===e?(t[n]||(t[n]=_.isArray(e)?[]:{}),void this.mixin(t[n],e)):void(t[n]!==e&&(this.mixin.supplement&&t.hasOwnProperty(n)||(t[n]=e)))},this)}return t},supplement:function(){this.mixin.supplement=!0;var t=this.mixin.apply(this,arguments);return this.mixin.supplement=!1,t},deepMixin:function(){this.mixin.deep=!0;var t=this.mixin.apply(this,arguments);return this.mixin.deep=!1,t},deepSupplement:function(){this.mixin.deep=this.mixin.supplement=!0;var t=this.mixin.apply(this,arguments);return this.mixin.deep=this.mixin.supplement=!1,t},normalizeEvent:function(t){return t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches.length?t.originalEvent.changedTouches[0]:t},nextFrame:function(){var t,e="undefined"!=typeof window;if(e&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame),!t){var n=0;t=function(t){var e=(new Date).getTime(),r=Math.max(0,16-(e-n)),i=setTimeout(function(){t(e+r)},r);return n=e+r,i}}return e?_.bind(t,window):t}(),cancelFrame:function(){var t,e="undefined"!=typeof window;return e&&(t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame),t=t||clearTimeout,e?_.bind(t,window):t}(),findIntersection:function(t,e){var n=g.rect(V(t).bbox()).moveAndExpand(g.rect(-5,-5,10,10)),r=n.center(),i=g.rect(n).intersectionWithLineFromCenterToPoint(e);if(!i)return void 0;if(!_.contains(["PATH","CIRCLE","ELLIPSE","RECT","POLYGON","LINE","POLYLINE"],t.localName.toUpperCase()))return i;if(!t.isPointInStroke||!t.isPointInFill)return i;for(var o=i,a=t.getCTM(),s=V.createSVGPoint(0,0),u=i.distance(r);u>1;){if(i=i.move(r,-1),u=i.distance(r),s.x=i.x,s.y=i.y,s=s.matrixTransform(a.inverse()),t.isPointInStroke(s)||t.isPointInFill(s))return o;o=g.point(i)}return void 0},shapePerimeterConnectionPoint:function(t,e,n,r){var i,o=g.rect(e.getBBox());if(!n){var a=e.$(".scalable")[0],s=e.$(".rotatable")[0];a&&a.firstChild?n=a.firstChild:s&&s.firstChild&&(n=s.firstChild)}return i=n?joint.util.findIntersection(n,r):o.intersectionWithLineFromCenterToPoint(r),i||o.center()},breakText:function(t,e,n,r){r=r||{};var i=e.width,o=e.height,a=r.svgDocument||V("svg").node,s=V("<text><tspan></tspan></text>").attr(n||{}).node,u=s.firstChild,l=document.createTextNode("");u.appendChild(l),a.appendChild(s),r.svgDocument||document.body.appendChild(a);for(var c,h=t.split(" "),f=[],d=[],p=0,g=0,m=h.length;m>p;p++){var v=h[p];if(l.data=d[g]?d[g]+" "+v:v,u.getComputedTextLength()<=i)d[g]=l.data,c&&(f[g++]=!0,c=0);else{if(!d[g]||c){var y=!!c;if(c=v.length-1,y||!c){if(!c){if(!d[g]){d=[];break}h.splice(p,2,v+h[p+1]),m--,f[g++]=!0,p--;continue}h[p]=v.substring(0,c),h[p+1]=v.substring(c)+h[p+1]}else h.splice(p,1,v.substring(0,c),v.substring(c)),m++,g&&!f[g-1]&&g--;p--;continue}g++,p--}if("undefined"!=typeof o){var b=b||1.25*s.getBBox().height;if(b*d.length>o){d.splice(Math.floor(o/b));break}}}return r.svgDocument?a.removeChild(s):document.body.removeChild(a),d.join("\n")},imageToDataUri:function(t,e){if(!t||"data:"===t.substr(0,"data:".length))return setTimeout(function(){e(null,t)},0);var n=document.createElement("canvas"),r=document.createElement("img");r.onload=function(){var i=n.getContext("2d");n.width=r.width,n.height=r.height,i.drawImage(r,0,0);try{var o=(t.split(".").pop()||"png","jpeg"),a=n.toDataURL(o)}catch(s){if(/\.svg$/.test(t)){var u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");u.open("GET",t,!1),u.send(null);var l=u.responseText;return e(null,"data:image/svg+xml,"+encodeURIComponent(l))}console.error(r.src,"fails to convert",s)}e(null,a)},r.ononerror=function(){e(new Error("Failed to load image."))},r.src=t},timing:{linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e=0,n=1;1;e+=n,n/=2)if(t>=(7-4*e)/11){var r=(11-6*e-11*t)/4;return-r*r+n*n}},reverse:function(t){return function(e){return 1-t(1-e)}},reflect:function(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}},clamp:function(t,e,n){return e=e||0,n=n||1,function(r){var i=t(r);return e>i?e:i>n?n:i}},back:function(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}},elastic:function(t){return t||(t=1.5),function(e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}},interpolate:{number:function(t,e){var n=e-t;return function(e){return t+n*e}},object:function(t,e){var n=_.keys(t);return function(r){var i,o,a={};for(i=n.length-1;-1!=i;i--)o=n[i],a[o]=t[o]+(e[o]-t[o])*r;return a}},hexColor:function(t,e){var n=parseInt(t.slice(1),16),r=parseInt(e.slice(1),16),i=255&n,o=(255&r)-i,a=65280&n,s=(65280&r)-a,u=16711680&n,l=(16711680&r)-u;return function(t){var e=i+o*t&255,n=a+s*t&65280,r=u+l*t&16711680;return"#"+(1<<24|e|n|r).toString(16).slice(1)}},unit:function(t,e){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,r=n.exec(t),i=n.exec(e),o=i[1].indexOf("."),a=o>0?i[1].length-o-1:0,t=+r[1],s=+i[1]-t,u=r[2];return function(e){return(t+s*e).toFixed(a)+u}}},filter:{blur:function(t){var e=_.isFinite(t.x)?t.x:2;return _.template('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>',{stdDeviation:_.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return _.template(e,{dx:t.dx||0,dy:t.dy||0,opacity:_.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:_.isFinite(t.blur)?t.blur:4})},grayscale:function(t){var e=_.isFinite(t.amount)?t.amount:1;return _.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>',{a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},sepia:function(t){var e=_.isFinite(t.amount)?t.amount:1;return _.template('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>',{a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},saturate:function(t){var e=_.isFinite(t.amount)?t.amount:1;return _.template('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>',{amount:1-e})},hueRotate:function(t){return _.template('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>',{angle:t.angle||0})},invert:function(t){var e=_.isFinite(t.amount)?t.amount:1;return _.template('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>',{amount:e,amount2:1-e})},brightness:function(t){return _.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>',{amount:_.isFinite(t.amount)?t.amount:1})},contrast:function(t){var e=_.isFinite(t.amount)?t.amount:1;return _.template('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>',{amount:e,amount2:.5-e/2})}},format:{number:function(t,e,n){function r(t){for(var e=t.length,r=[],i=0,o=n.grouping[0];e>0&&o>0;)r.push(t.substring(e-=o,e+o)),o=n.grouping[i=(i+1)%n.grouping.length];return r.reverse().join(n.thousands)}n=n||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var i=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,o=i.exec(t),a=o[1]||" ",s=o[2]||">",u=o[3]||"",l=o[4]||"",c=o[5],h=+o[6],f=o[7],d=o[8],p=o[9],g=1,m="",v="",y=!1;switch(d&&(d=+d.substring(1)),(c||"0"===a&&"="===s)&&(c=a="0",s="=",f&&(h-=Math.floor((h-1)/4))),p){case"n":f=!0,p="g";break;case"%":g=100,v="%",p="f";break;case"p":g=100,v="%",p="r";break;case"b":case"o":case"x":case"X":"#"===l&&(m="0"+p.toLowerCase());case"c":case"d":y=!0,d=0;break;case"s":g=-1,p="r"}"$"===l&&(m=n.currency[0],v=n.currency[1]),"r"!=p||d||(p="g"),null!=d&&("g"==p?d=Math.max(1,Math.min(21,d)):("e"==p||"f"==p)&&(d=Math.max(0,Math.min(20,d))));var b=c&&f;if(y&&e%1)return"";var _=0>e||0===e&&0>1/e?(e=-e,"-"):u,x=v;if(0>g){var w=this.prefix(e,d);e=w.scale(e),x=w.symbol+v}else e*=g;e=this.convert(p,e,d);var k=e.lastIndexOf("."),S=0>k?e:e.substring(0,k),C=0>k?"":n.decimal+e.substring(k+1);!c&&f&&n.grouping&&(S=r(S));var E=m.length+S.length+C.length+(b?0:_.length),M=h>E?new Array(E=h-E+1).join(a):"";return b&&(S=r(M+S)),_+=m,e=S+C,("<"===s?_+e+M:">"===s?M+_+e:"^"===s?M.substring(0,E>>=1)+_+e+M.substring(E):_+(b?e:M+e))+x},string:function(t,e){for(var n,r="{",i=!1,o=[];-1!==(n=t.indexOf(r));){var a,s,u;if(a=t.slice(0,n),i){s=a.split(":"),u=s.shift().split("."),a=e;for(var l=0;l<u.length;l++)a=a[u[l]];s.length&&(a=this.number(s,a))}o.push(a),t=t.slice(n+1),r=(i=!i)?"}":"{"}return o.push(t),o.join("")},convert:function(t,e,n){switch(t){case"b":return e.toString(2);case"c":return String.fromCharCode(e);case"o":return e.toString(8);case"x":return e.toString(16);case"X":return e.toString(16).toUpperCase();case"g":return e.toPrecision(n);case"e":return e.toExponential(n);case"f":return e.toFixed(n);case"r":return(e=this.round(e,this.precision(e,n))).toFixed(Math.max(0,Math.min(20,this.precision(e*(1+1e-15),n))));default:return e+""}},round:function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},precision:function(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)},prefix:function(t,e){var n=_.map(["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],function(t,e){var n=Math.pow(10,3*abs(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}),r=0;return t&&(0>t&&(t*=-1),e&&(t=this.round(t,this.precision(t,e))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((0>=r?r+1:r-1)/3)))),n[8+r/3]}}}};if("object"==typeof exports&&(module.exports=joint),"object"==typeof exports)var joint={dia:{Link:require("./joint.dia.link").Link,Element:require("./joint.dia.element").Element},shapes:require("../plugins/shapes")},Backbone=require("backbone"),_=require("lodash"),g=require("./geometry");if(joint.dia.GraphCells=Backbone.Collection.extend({initialize:function(){this.on("change:z",this.sort,this)},model:function(t,e){if("link"===t.type)return new joint.dia.Link(t,e);var n=t.type.split(".")[0],r=t.type.split(".")[1];return joint.shapes[n]&&joint.shapes[n][r]?new joint.shapes[n][r](t,e):new joint.dia.Element(t,e)},comparator:function(t){return t.get("z")||0},getConnectedLinks:function(t,e){e=e||{},_.isUndefined(e.inbound)&&_.isUndefined(e.outbound)&&(e.inbound=e.outbound=!0);var n=this.filter(function(n){var r=n.get("source"),i=n.get("target");return r&&r.id===t.id&&e.outbound||i&&i.id===t.id&&e.inbound});if(e.deep){var r=t.getEmbeddedCells({deep:!0});_.each(this.difference(n,r),function(t){if(e.outbound){var i=t.get("source");if(i&&i.id&&_.find(r,{id:i.id}))return void n.push(t)}if(e.inbound){var o=t.get("target");o&&o.id&&_.find(r,{id:o.id})&&n.push(t)}})}return n},getCommonAncestor:function(){var t=_.map(arguments,function(t){for(var e=[t.id],n=t.get("parent");n;)e.push(n),n=this.get(n).get("parent");return e},this);t=_.sortBy(t,"length");var e=_.find(t.shift(),function(e){return _.every(t,function(t){return _.contains(t,e)})});return this.get(e)}}),joint.dia.Graph=Backbone.Model.extend({initialize:function(t,e){this.set("cells",new joint.dia.GraphCells([],{model:e&&e.cellModel})),this.get("cells").on("all",this.trigger,this),this.get("cells").on("remove",this.removeCell,this)},toJSON:function(){var t=Backbone.Model.prototype.toJSON.apply(this,arguments);return t.cells=this.get("cells").toJSON(),t},fromJSON:function(t,e){if(!t.cells)throw new Error("Graph JSON must contain cells array.");this.set(_.omit(t,"cells"),e),this.resetCells(t.cells,e)},clear:function(t){this.trigger("batch:start"),this.get("cells").remove(this.get("cells").models,t),this.trigger("batch:stop")},_prepareCell:function(t){return t instanceof Backbone.Model&&_.isUndefined(t.get("z"))?t.set("z",this.maxZIndex()+1,{silent:!0}):_.isUndefined(t.z)&&(t.z=this.maxZIndex()+1),t},maxZIndex:function(){var t=this.get("cells").last();return t?t.get("z")||0:0},addCell:function(t,e){return _.isArray(t)?this.addCells(t,e):(this.get("cells").add(this._prepareCell(t),e||{}),this)},addCells:function(t,e){return e=e||{},e.position=t.length,_.each(t,function(t){e.position--,this.addCell(t,e)},this),this},resetCells:function(t,e){return this.get("cells").reset(_.map(t,this._prepareCell,this),e),this},removeCell:function(t,e,n){n&&n.disconnectLinks?this.disconnectLinks(t,n):this.removeLinks(t,n),this.get("cells").remove(t,{silent:!0})},getCell:function(t){return this.get("cells").get(t)},getElements:function(){return this.get("cells").filter(function(t){return t instanceof joint.dia.Element})},getLinks:function(){return this.get("cells").filter(function(t){return t instanceof joint.dia.Link})},getConnectedLinks:function(t,e){return this.get("cells").getConnectedLinks(t,e)},getNeighbors:function(t){var e=this.getConnectedLinks(t),n=[],r=this.get("cells");return _.each(e,function(e){var i=e.get("source"),o=e.get("target");if(!i.x){var a=r.get(i.id);a!==t&&n.push(a)}if(!o.x){var s=r.get(o.id);s!==t&&n.push(s)}}),n},disconnectLinks:function(t,e){_.each(this.getConnectedLinks(t),function(n){n.set(n.get("source").id===t.id?"source":"target",g.point(0,0),e)})},removeLinks:function(t,e){_.invoke(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(t){return _.filter(this.getElements(),function(e){return e.getBBox().containsPoint(t)})},findModelsInArea:function(t){return _.filter(this.getElements(),function(e){return e.getBBox().intersect(t)})},getBBox:function(t){var e={x:1/0,y:1/0},n={x:0,y:0};return _.each(t,function(t){var r=t.getBBox();e.x=Math.min(e.x,r.x),e.y=Math.min(e.y,r.y),n.x=Math.max(n.x,r.x+r.width),n.y=Math.max(n.y,r.y+r.height)}),g.rect(e.x,e.y,n.x-e.x,n.y-e.y)},getCommonAncestor:function(){var t=this.get("cells");return t.getCommonAncestor.apply(t,arguments)}}),"object"==typeof exports&&(module.exports.Graph=joint.dia.Graph),"object"==typeof exports)var joint={util:require("./core").util,dia:{Link:require("./joint.dia.link").Link}},Backbone=require("backbone"),_=require("lodash");if(joint.dia.Cell=Backbone.Model.extend({constructor:function(t,e){
var n,r=t||{};this.cid=_.uniqueId("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(r=this.parse(r,e)||{}),(n=_.result(this,"defaults"))&&(r=_.merge({},n,r)),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(){var t=this.constructor.prototype.defaults.attrs||{},e=this.attributes.attrs,n={};_.each(e,function(e,r){var i=t[r];_.each(e,function(t,e){_.isObject(t)&&!_.isArray(t)?_.each(t,function(t,o){i&&i[e]&&_.isEqual(i[e][o],t)||(n[r]=n[r]||{},(n[r][e]||(n[r][e]={}))[o]=t)}):i&&_.isEqual(i[e],t)||(n[r]=n[r]||{},n[r][e]=t)})});var r=_.cloneDeep(_.omit(this.attributes,"attrs"));return r.attrs=n,r},initialize:function(t){t&&t.id||this.set("id",joint.util.uuid(),{silent:!0}),this._transitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},processPorts:function(){var t=this.ports,e={};_.each(this.get("attrs"),function(t,n){t&&t.port&&(_.isUndefined(t.port.id)?e[t.port]={id:t.port}:e[t.port.id]=t.port)});var n={};if(_.each(t,function(t,r){e[r]||(n[r]=!0)}),this.collection&&!_.isEmpty(n)){var r=this.collection.getConnectedLinks(this,{inbound:!0});_.each(r,function(t){n[t.get("target").port]&&t.remove()});var i=this.collection.getConnectedLinks(this,{outbound:!0});_.each(i,function(t){n[t.get("source").port]&&t.remove()})}this.ports=e},remove:function(t){var e=this.collection;e&&e.trigger("batch:start");var n=this.get("parent");if(n){var r=this.collection&&this.collection.get(n);r.unembed(this)}return _.invoke(this.getEmbeddedCells(),"remove",t),this.trigger("remove",this,this.collection,t),e&&e.trigger("batch:stop"),this},toFront:function(t){if(this.collection){t=t||{};var e=(this.collection.last().get("z")||0)+1;if(this.trigger("batch:start").set("z",e,t),t.deep){var n=this.getEmbeddedCells({deep:!0,breadthFirst:!0});_.each(n,function(n){n.set("z",++e,t)})}this.trigger("batch:stop")}return this},toBack:function(t){if(this.collection){t=t||{};var e=(this.collection.first().get("z")||0)-1;if(this.trigger("batch:start"),t.deep){var n=this.getEmbeddedCells({deep:!0,breadthFirst:!0});_.eachRight(n,function(n){n.set("z",e--,t)})}this.set("z",e,t).trigger("batch:stop")}return this},embed:function(t,e){if(this==t||this.isEmbeddedIn(t))throw new Error("Recursive embedding not allowed.");this.trigger("batch:start");var n=_.clone(this.get("embeds")||[]);return n[t.isLink()?"unshift":"push"](t.id),t.set("parent",this.id,e),this.set("embeds",_.uniq(n),e),this.trigger("batch:stop"),this},unembed:function(t,e){return this.trigger("batch:start"),t.unset("parent",e),this.set("embeds",_.without(this.get("embeds"),t.id),e),this.trigger("batch:stop"),this},getEmbeddedCells:function(t){if(t=t||{},this.collection){var e;if(t.deep)if(t.breadthFirst){e=[];for(var n=this.getEmbeddedCells();n.length>0;){var r=n.shift();e.push(r),n.push.apply(n,r.getEmbeddedCells())}}else e=this.getEmbeddedCells(),_.each(e,function(n){e.push.apply(e,n.getEmbeddedCells(t))});else e=_.map(this.get("embeds"),this.collection.get,this.collection);return e}return[]},isEmbeddedIn:function(t,e){var n=_.isString(t)?t:t.id;e=_.defaults({deep:!0},e);var r=this.get("parent");if(this.collection&&e.deep){for(;r;){if(r==n)return!0;r=this.collection.get(r).get("parent")}return!1}return r==n},clone:function(t){t=t||{};var e=Backbone.Model.prototype.clone.apply(this,arguments);if(e.set("id",joint.util.uuid(),{silent:!0}),e.set("embeds",""),!t.deep)return e;var n=_.sortBy(this.getEmbeddedCells(),function(t){return t instanceof joint.dia.Element}),r=[e],i={};return _.each(n,function(t){var n=t.clone({deep:!0});e.embed(n[0]),_.each(n,function(n){if(n instanceof joint.dia.Link)return n.get("source").id==this.id&&n.prop("source",{id:e.id}),n.get("target").id==this.id&&n.prop("target",{id:e.id}),void(i[t.id]=n);r.push(n);var o=this.collection.getConnectedLinks(t,{inbound:!0});_.each(o,function(t){var e=i[t.id]||t.clone();i[t.id]=e,e.prop("target",{id:n.id})});var a=this.collection.getConnectedLinks(t,{outbound:!0});_.each(a,function(t){var e=i[t.id]||t.clone();i[t.id]=e,e.prop("source",{id:n.id})})},this)},this),r=r.concat(_.values(i))},prop:function(t,e,n){var r="/";if(_.isString(t)){if("undefined"!=typeof e){var i=t,o=i.split("/"),a=o[0];if(n=n||{},n.propertyPath=i,n.propertyValue=e,1==o.length)return this.set(a,e,n);var s={},u=s,l=a;_.each(_.rest(o),function(t){u=u[l]=_.isFinite(Number(t))?[]:{},l=t}),s=joint.util.setByPath(s,i,e,"/");var c=_.merge({},this.attributes);n.rewrite&&joint.util.unsetByPath(c,i,"/");var h=_.merge(c,s);return this.set(a,h[a],n)}return joint.util.getByPath(this.attributes,t,r)}return this.set(_.merge({},this.attributes,t),e)},attr:function(t,e,n){return _.isString(t)?this.prop("attrs/"+t,e,n):this.prop({attrs:t},e)},removeAttr:function(t,e){if(_.isArray(t))return _.each(t,function(t){this.removeAttr(t,e)},this),this;var n=joint.util.unsetByPath(_.merge({},this.get("attrs")),t,"/");return this.set("attrs",n,_.extend({dirty:!0},e))},transition:function(t,e,n,r){r=r||"/";var i={duration:100,delay:10,timingFunction:joint.util.timing.linear,valueFunction:joint.util.interpolate.number};n=_.extend(i,n);var o,a=0,s=_.bind(function(e){var r,i,u;a=a||e,e-=a,i=e/n.duration,1>i?this._transitionIds[t]=r=joint.util.nextFrame(s):(i=1,delete this._transitionIds[t]),u=o(n.timingFunction(i)),n.transitionId=r,this.prop(t,u,n),r||this.trigger("transition:end",this,t)},this),u=_.bind(function(i){this.stopTransitions(t),o=n.valueFunction(joint.util.getByPath(this.attributes,t,r),e),this._transitionIds[t]=joint.util.nextFrame(i),this.trigger("transition:start",this,t)},this);return _.delay(u,n.delay,s)},getTransitions:function(){return _.keys(this._transitionIds)},stopTransitions:function(t,e){e=e||"/";var n=t&&t.split(e);return _(this._transitionIds).keys().filter(n&&function(t){return _.isEqual(n,t.split(e).slice(0,n.length))}).each(function(t){joint.util.cancelFrame(this._transitionIds[t]),delete this._transitionIds[t],this.trigger("transition:end",this,t)},this),this},addTo:function(t){return t.addCell(this),this},findView:function(t){return t.findViewByModel(this)},isLink:function(){return!1}}),joint.dia.CellView=Backbone.View.extend({tagName:"g",attributes:function(){return{"model-id":this.model.id}},constructor:function(t){this._configure(t),Backbone.View.apply(this,arguments)},_configure:function(t){this.options&&(t=_.extend({},_.result(this,"options"),t)),this.options=t,this.options.id=this.options.id||joint.util.guid(this)},initialize:function(){_.bindAll(this,"remove","update"),this.$el.data("view",this),this.listenTo(this.model,"remove",this.remove),this.listenTo(this.model,"change:attrs",this.onChangeAttrs)},onChangeAttrs:function(t,e,n){return n.dirty?this.render():this.update()},_ensureElement:function(){var t;if(this.el)t=_.result(this,"el");else{var e=_.extend({id:this.id},_.result(this,"attributes"));this.className&&(e["class"]=_.result(this,"className")),t=V(_.result(this,"tagName"),e).node}this.setElement(t,!1)},findBySelector:function(t){var e="."===t?this.$el:this.$el.find(t);return e},notify:function(t){if(this.paper){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t].concat(e)),this.paper.trigger.apply(this.paper,[t,this].concat(e))}},getStrokeBBox:function(t){var e=!!t;t=t||this.el;var n,r=V(t).bbox(!1,this.paper.viewport);return n=e?V(t).attr("stroke-width"):this.model.attr("rect/stroke-width")||this.model.attr("circle/stroke-width")||this.model.attr("ellipse/stroke-width")||this.model.attr("path/stroke-width"),n=parseFloat(n)||0,g.rect(r).moveAndExpand({x:-n/2,y:-n/2,width:n,height:n})},getBBox:function(){return V(this.el).bbox()},highlight:function(t,e){return t=t?this.$(t)[0]||this.el:this.el,e=e||{},e.partial=t!=this.el,this.notify("cell:highlight",t,e),this},unhighlight:function(t,e){return t=t?this.$(t)[0]||this.el:this.el,e=e||{},e.partial=t!=this.el,this.notify("cell:unhighlight",t,e),this},findMagnet:function(t){var e=this.$(t);if(0===e.length||e[0]===this.el){var n=this.model.get("attrs")||{};return n["."]&&n["."].magnet===!1?void 0:this.el}return e.attr("magnet")?e[0]:this.findMagnet(e.parent())},applyFilter:function(t,e){var n=this.findBySelector(t),r=e.name+this.paper.svg.id+joint.util.hashCode(JSON.stringify(e));if(!this.paper.svg.getElementById(r)){var i=joint.util.filter[e.name]&&joint.util.filter[e.name](e.args||{});if(!i)throw new Error("Non-existing filter "+e.name);var o=V(i);o.attr({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3}),e.attrs&&o.attr(e.attrs),o.node.id=r,V(this.paper.svg).defs().append(o)}n.each(function(){V(this).attr("filter","url(#"+r+")")})},applyGradient:function(t,e,n){var r=this.findBySelector(t),i=n.type+this.paper.svg.id+joint.util.hashCode(JSON.stringify(n));if(!this.paper.svg.getElementById(i)){var o=["<"+n.type+">",_.map(n.stops,function(t){return'<stop offset="'+t.offset+'" stop-color="'+t.color+'" stop-opacity="'+(_.isFinite(t.opacity)?t.opacity:1)+'" />'}).join(""),"</"+n.type+">"].join(""),a=V(o);n.attrs&&a.attr(n.attrs),a.node.id=i,V(this.paper.svg).defs().append(a)}r.each(function(){V(this).attr(e,"url(#"+i+")")})},getSelector:function(t,e){if(t===this.el)return e;var n=$(t).index();return e=t.tagName+":nth-child("+(n+1)+") "+(e||""),this.getSelector($(t).parent()[0],e+" ")},pointerdblclick:function(t,e,n){this.notify("cell:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){this.notify("cell:pointerclick",t,e,n)},pointerdown:function(t,e,n){this.model.collection&&(this.model.trigger("batch:start"),this._collection=this.model.collection),this.notify("cell:pointerdown",t,e,n)},pointermove:function(t,e,n){this.notify("cell:pointermove",t,e,n)},pointerup:function(t,e,n){this.notify("cell:pointerup",t,e,n),this._collection&&(this._collection.trigger("batch:stop"),delete this._collection)},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)}}),"object"==typeof exports&&(module.exports.Cell=joint.dia.Cell,module.exports.CellView=joint.dia.CellView),"object"==typeof exports)var joint={util:require("./core").util,dia:{Cell:require("./joint.dia.cell").Cell,CellView:require("./joint.dia.cell").CellView}},Backbone=require("backbone"),_=require("lodash");if(joint.dia.Element=joint.dia.Cell.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},position:function(t,e,n){var r=_.isNumber(e);if(n=(r?n:t)||{},n.parentRelative){if(!this.collection)throw new Error("Element must be part of a collection.");var i=this.collection.get(this.get("parent")),o=i&&!i.isLink()?i.get("position"):{x:0,y:0}}if(r)return n.parentRelative&&(t+=o.x,e+=o.y),this.set("position",{x:t,y:e},n);var a=g.point(this.get("position"));return n.parentRelative?a.difference(o):a},translate:function(t,e,n){if(e=e||0,0===t&&0===e)return this;n=n||{},n.translateBy=n.translateBy||this.id,n.tx=t,n.ty=e;var r=this.get("position")||{x:0,y:0},i={x:r.x+t||0,y:r.y+e||0};return n.transition?(_.isObject(n.transition)||(n.transition={}),this.transition("position",i,_.extend({},n.transition,{valueFunction:joint.util.interpolate.object}))):(this.set("position",i,n),_.invoke(this.getEmbeddedCells(),"translate",t,e,n)),this},resize:function(t,e){return this.trigger("batch:start"),this.set("size",{width:t,height:e}),this.trigger("batch:stop"),this},rotate:function(t,e,n){if(n){var r=this.getBBox().center(),i=this.get("size"),o=this.get("position");r.rotate(n,(this.get("angle")||0)-t);var a=r.x-i.width/2-o.x,s=r.y-i.height/2-o.y;this.trigger("batch:start"),this.translate(a,s),this.rotate(t,e),this.trigger("batch:stop")}else this.set("angle",e?t:((this.get("angle")||0)+t)%360);return this},getBBox:function(){var t=this.get("position"),e=this.get("size");return g.rect(t.x,t.y,e.width,e.height)}}),joint.dia.ElementView=joint.dia.CellView.extend({className:function(){return"element "+this.model.get("type").split(".").join(" ")},initialize:function(){_.bindAll(this,"translate","resize","rotate"),joint.dia.CellView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:position",this.translate),this.listenTo(this.model,"change:size",this.resize),this.listenTo(this.model,"change:angle",this.rotate)},update:function(t,e){var n=this.model.get("attrs"),r=V(this.$(".rotatable")[0]);if(r){var i=r.attr("transform");r.attr("transform","")}var o=[];_.each(e||n,function(t,e){var n=this.findBySelector(e);if(0!==n.length){var r=["style","text","html","ref-x","ref-y","ref-dx","ref-dy","ref-width","ref-height","ref","x-alignment","y-alignment","port"];_.isObject(t.filter)&&(r.push("filter"),this.applyFilter(e,t.filter)),_.isObject(t.fill)&&(r.push("fill"),this.applyGradient(e,"fill",t.fill)),_.isObject(t.stroke)&&(r.push("stroke"),this.applyGradient(e,"stroke",t.stroke)),_.isUndefined(t.text)||(n.each(function(){V(this).text(t.text+"",{lineHeight:t.lineHeight,textPath:t.textPath})}),r.push("lineHeight","textPath"));var i=_.omit(t,r);n.each(function(){V(this).attr(i)}),t.port&&n.attr("port",_.isUndefined(t.port.id)?t.port:t.port.id),t.style&&n.css(t.style),_.isUndefined(t.html)||n.each(function(){$(this).html(t.html+"")}),_.isUndefined(t["ref-x"])&&_.isUndefined(t["ref-y"])&&_.isUndefined(t["ref-dx"])&&_.isUndefined(t["ref-dy"])&&_.isUndefined(t["x-alignment"])&&_.isUndefined(t["y-alignment"])&&_.isUndefined(t["ref-width"])&&_.isUndefined(t["ref-height"])||_.each(n,function(t,e,n){var r=$(t);r.selector=n.selector,o.push(r)})}},this);var a=this.el.getBBox();e=e||{},_.each(o,function(t){var r=e[t.selector],i=r?_.merge({},n[t.selector],r):n[t.selector];this.positionRelative(t,a,i)},this),r&&r.attr("transform",i||"")},positionRelative:function(t,e,n){function r(t){return _.isNumber(t)&&!_.isNaN(t)}var i=n.ref,o=parseFloat(n["ref-x"]),a=parseFloat(n["ref-y"]),s=parseFloat(n["ref-dx"]),u=parseFloat(n["ref-dy"]),l=n["y-alignment"],c=n["x-alignment"],h=parseFloat(n["ref-width"]),f=parseFloat(n["ref-height"]),d=_.contains(_.pluck(_.pluck(t.parents("g"),"className"),"baseVal"),"scalable");i&&(e=V(this.findBySelector(i)[0]).bbox(!1,this.el));var p=V(t[0]);p.attr("transform")&&p.attr("transform",p.attr("transform").replace(/translate\([^)]*\)/g,"").trim()||"");var g=0,m=0;if(r(h)&&(h>=0&&1>=h?p.attr("width",h*e.width):p.attr("width",Math.max(h+e.width,0))),r(f)&&(f>=0&&1>=f?p.attr("height",f*e.height):p.attr("height",Math.max(f+e.height,0))),r(s))if(d){var v=V(this.$(".scalable")[0]).scale();g=e.x+e.width+s/v.sx}else g=e.x+e.width+s;if(r(u))if(d){var v=V(this.$(".scalable")[0]).scale();m=e.y+e.height+u/v.sy}else m=e.y+e.height+u;if(r(o))if(o>0&&1>o)g=e.x+e.width*o;else if(d){var v=V(this.$(".scalable")[0]).scale();g=e.x+o/v.sx}else g=e.x+o;if(r(a))if(a>0&&1>a)m=e.y+e.height*a;else if(d){var v=V(this.$(".scalable")[0]).scale();m=e.y+a/v.sy}else m=e.y+a;var y=p.bbox(!1,this.paper.viewport);"middle"===l?m-=y.height/2:r(l)&&(m+=l>-1&&1>l?y.height*l:l),"middle"===c?g-=y.width/2:r(c)&&(g+=c>-1&&1>c?y.width*c:c),p.translate(g,m)},renderMarkup:function(){var t=this.model.markup||this.model.get("markup");if(!t)throw new Error("properties.markup is missing while the default render() implementation is used.");var e=V(t);V(this.el).append(e)},render:function(){return this.$el.empty(),this.renderMarkup(),this.update(),this.resize(),this.rotate(),this.translate(),this},scale:function(t,e){V(this.el).scale(t,e)},resize:function(){var t=this.model.get("size")||{width:1,height:1},e=this.model.get("angle")||0,n=V(this.$(".scalable")[0]);if(n){var r=n.bbox(!0);n.attr("transform","scale("+t.width/(r.width||1)+","+t.height/(r.height||1)+")");var i=V(this.$(".rotatable")[0]),o=i&&i.attr("transform");if(o&&"null"!==o){i.attr("transform",o+" rotate("+-e+","+t.width/2+","+t.height/2+")");var a=n.bbox(!1,this.paper.viewport);this.model.set("position",{x:a.x,y:a.y}),this.rotate()}this.update()}},translate:function(t,e,n){var r=this.model.get("position")||{x:0,y:0};V(this.el).attr("transform","translate("+r.x+","+r.y+")")},rotate:function(){var t=V(this.$(".rotatable")[0]);if(t){var e=this.model.get("angle")||0,n=this.model.get("size")||{width:1,height:1},r=n.width/2,i=n.height/2;t.attr("transform","rotate("+e+","+r+","+i+")")}},getBBox:function(t){if(t&&t.useModelGeometry){var e=this.model.getBBox().bbox(this.model.get("angle")),n=this.paper.viewport.getCTM();return V.transformRect(e,n)}return joint.dia.CellView.prototype.getBBox.apply(this,arguments)},findParentsByKey:function(t){var e=this.model.getBBox();return"bbox"==t?this.paper.model.findModelsInArea(e):this.paper.model.findModelsFromPoint(e[t]())},prepareEmbedding:function(){this.model.toFront({deep:!0,ui:!0}),_.invoke(this.paper.model.getConnectedLinks(this.model,{deep:!0}),"toFront",{ui:!0});var t=this.model.get("parent");t&&this.paper.model.getCell(t).unembed(this.model,{ui:!0})},processEmbedding:function(t){t=t||this.paper.options;var e=this.findParentsByKey(t.findParentBy);e=_.reject(e,function(t){return this.model.id==t.id||t.isEmbeddedIn(this.model)},this),t.frontParentOnly&&(e=e.slice(-1));for(var n=null,r=this._candidateEmbedView,i=e.length-1;i>=0;i--){var o=e[i];if(r&&r.model.id==o.id){n=r;break}var a=o.findView(this.paper);if(t.validateEmbedding.call(this.paper,this,a)){n=a;break}}n&&n!=r&&(r&&r.unhighlight(null,{embedding:!0}),this._candidateEmbedView=n.highlight(null,{embedding:!0})),!n&&r&&(r.unhighlight(null,{embedding:!0}),delete this._candidateEmbedView)},finalizeEmbedding:function(){var t=this._candidateEmbedView;t&&(t.model.embed(this.model,{ui:!0}),t.unhighlight(null,{embedding:!0}),delete this._candidateEmbedView),_.invoke(this.paper.model.getConnectedLinks(this.model,{deep:!0}),"reparent",{ui:!0})},pointerdown:function(t,e,n){if(this.model.trigger("batch:start"),t.target.getAttribute("magnet")&&this.paper.options.validateMagnet.call(this.paper,this,t.target)){var r=this.paper.getDefaultLink(this,t.target);r.set({source:{id:this.model.id,selector:this.getSelector(t.target),port:$(t.target).attr("port")},target:{x:e,y:n}}),this.paper.model.addCell(r),this._linkView=this.paper.findViewByModel(r),this._linkView.startArrowheadMove("target")}else this._dx=e,this._dy=n,joint.dia.CellView.prototype.pointerdown.apply(this,arguments)},pointermove:function(t,e,n){if(this._linkView)this._linkView.pointermove(t,e,n);else{var r=this.paper.options.gridSize,i=_.isFunction(this.options.interactive)?this.options.interactive(this,"pointermove"):this.options.interactive;if(i!==!1){var o=this.model.get("position");this.model.translate(g.snapToGrid(o.x,r)-o.x+g.snapToGrid(e-this._dx,r),g.snapToGrid(o.y,r)-o.y+g.snapToGrid(n-this._dy,r)),this.paper.options.embeddingMode&&(this._inProcessOfEmbedding||(this.prepareEmbedding(),this._inProcessOfEmbedding=!0),this.processEmbedding())}this._dx=g.snapToGrid(e,r),this._dy=g.snapToGrid(n,r),joint.dia.CellView.prototype.pointermove.apply(this,arguments)}},pointerup:function(t,e,n){this._linkView?(this._linkView.pointerup(t,e,n),delete this._linkView):(this._inProcessOfEmbedding&&(this.finalizeEmbedding(),this._inProcessOfEmbedding=!1),joint.dia.CellView.prototype.pointerup.apply(this,arguments)),this.model.trigger("batch:stop")}}),"object"==typeof exports&&(module.exports.Element=joint.dia.Element,module.exports.ElementView=joint.dia.ElementView),"object"==typeof exports)var joint={dia:{Cell:require("./joint.dia.cell").Cell,CellView:require("./joint.dia.cell").CellView}},Backbone=require("backbone"),_=require("lodash"),g=require("./geometry");if(joint.dia.Link=joint.dia.Cell.extend({markup:['<path class="connection" stroke="black"/>','<path class="marker-source" fill="black" stroke="black" />','<path class="marker-target" fill="black" stroke="black" />','<path class="connection-wrap"/>','<g class="labels"/>','<g class="marker-vertices"/>','<g class="marker-arrowheads"/>','<g class="link-tools"/>'].join(""),labelMarkup:['<g class="label">',"<rect />","<text />","</g>"].join(""),toolMarkup:['<g class="link-tool">','<g class="tool-remove" event="remove">','<circle r="11" />','<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z"/>',"<title>Remove link.</title>","</g>",'<g class="tool-options" event="link:options">','<circle r="11" transform="translate(25)"/>','<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',"<title>Link options.</title>","</g>","</g>"].join(""),vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>"].join(""),arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',"</g>"].join(""),defaults:{type:"link",source:{},target:{}},disconnect:function(){return this.set({source:g.point(0,0),target:g.point(0,0)})},label:function(t,e){t=t||0;var n=this.get("labels")||[];if(0===arguments.length||1===arguments.length)return n[t];var r=_.merge({},n[t],e),i=n.slice();return i[t]=r,this.set({labels:i})},translate:function(t,e,n){var r={},i=this.get("source"),o=this.get("target"),a=this.get("vertices");return i.id||(r.source={x:i.x+t,y:i.y+e}),o.id||(r.target={x:o.x+t,y:o.y+e}),a&&a.length&&(r.vertices=_.map(a,function(n){return{x:n.x+t,y:n.y+e}})),this.set(r,n)},reparent:function(t){var e;if(this.collection){var n=this.collection.get(this.get("source").id),r=this.collection.get(this.get("target").id),i=this.collection.get(this.get("parent"));n&&r&&(e=this.collection.getCommonAncestor(n,r)),!i||e&&e.id==i.id||i.unembed(this,t),e&&e.embed(this,t)}return e},isLink:function(){return!0},hasLoop:function(){var t=this.get("source").id,e=this.get("target").id;return t&&e&&t==e}}),joint.dia.LinkView=joint.dia.CellView.extend({className:function(){return _.unique(this.model.get("type").split(".").concat("link")).join(" ")},options:{shortLinkLength:100,doubleLinkTools:!1,longLinkLength:160,linkToolsOffset:40,doubleLinkToolsOffset:60},initialize:function(t){joint.dia.CellView.prototype.initialize.apply(this,arguments),"function"!=typeof this.constructor.prototype.watchSource&&(this.constructor.prototype.watchSource=this.createWatcher("source"),this.constructor.prototype.watchTarget=this.createWatcher("target")),this._labelCache={},this._markerCache={},this.startListening()},startListening:function(){this.listenTo(this.model,"change:markup",this.render),this.listenTo(this.model,"change:smooth change:manhattan change:router change:connector",this.update),this.listenTo(this.model,"change:toolMarkup",function(){this.renderTools().updateToolsPosition()}),this.listenTo(this.model,"change:labels change:labelMarkup",function(){this.renderLabels().updateLabelPositions()}),this.listenTo(this.model,"change:vertices change:vertexMarkup",function(t,e,n){this.renderVertexMarkers(),(!n.translateBy||n.translateBy==this.model.id||this.model.hasLoop())&&this.update()}),this.listenTo(this.model,"change:source",function(t,e){this.watchSource(t,e).update()}),this.listenTo(this.model,"change:target",function(t,e){this.watchTarget(t,e).update()})},render:function(){this.$el.empty();var t=V(this.model.get("markup")||this.model.markup);if(_.isArray(t)||(t=[t]),this._V={},_.each(t,function(t){var e=t.attr("class");e&&(this._V[$.camelCase(e)]=t)},this),!this._V.connection)throw new Error("link: no connection path in the markup");return this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),V(this.el).append(t),this.renderLabels(),this.watchSource(this.model,this.model.get("source")).watchTarget(this.model,this.model.get("target")).update(),this},renderLabels:function(){if(!this._V.labels)return this;this._labelCache={};var t=$(this._V.labels.node).empty(),e=this.model.get("labels")||[];if(!e.length)return this;var n=_.template(this.model.get("labelMarkup")||this.model.labelMarkup),r=V(n());return _.each(e,function(e,n){var i=r.clone().node;this._labelCache[n]=V(i);var o=$(i).find("text"),a=$(i).find("rect"),s=_.extend({"text-anchor":"middle","font-size":14},joint.util.getByPath(e,"attrs/text","/"));o.attr(_.omit(s,"text")),_.isUndefined(s.text)||V(o[0]).text(s.text+""),t.append(i);var u=V(o[0]).bbox(!0,t[0]);V(o[0]).translate(0,-u.height/2);var l=_.extend({fill:"white",rx:3,ry:3},joint.util.getByPath(e,"attrs/rect","/"));a.attr(_.extend(l,{x:u.x,y:u.y-u.height/2,width:u.width,height:u.height}))},this),this},renderTools:function(){if(!this._V.linkTools)return this;var t=$(this._V.linkTools.node).empty(),e=_.template(this.model.get("toolMarkup")||this.model.toolMarkup),n=V(e());if(t.append(n.node),this._toolCache=n,this.options.doubleLinkTools){var r=n.clone();t.append(r.node),this._tool2Cache=r}return this},renderVertexMarkers:function(){if(!this._V.markerVertices)return this;var t=$(this._V.markerVertices.node).empty(),e=_.template(this.model.get("vertexMarkup")||this.model.vertexMarkup);return _.each(this.model.get("vertices"),function(n,r){t.append(V(e(_.extend({idx:r},n))).node)}),this},renderArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;var t=$(this._V.markerArrowheads.node);t.empty();var e=_.template(this.model.get("arrowheadMarkup")||this.model.arrowheadMarkup);return this._V.sourceArrowhead=V(e({end:"source"})),this._V.targetArrowhead=V(e({end:"target"})),t.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node),this},update:function(){_.each(this.model.get("attrs"),function(t,e){var n=[];_.isObject(t.fill)&&(this.applyGradient(e,"fill",t.fill),n.push("fill")),_.isObject(t.stroke)&&(this.applyGradient(e,"stroke",t.stroke),n.push("stroke")),_.isObject(t.filter)&&(this.applyFilter(e,t.filter),n.push("filter")),n.length>0&&(n.unshift(t),t=_.omit.apply(_,n)),this.findBySelector(e).attr(t)},this);var t=this.route=this.findRoute(this.model.get("vertices")||[]);this._findConnectionPoints(t);var e=this.getPathData(t);return this._V.connection.attr("d",e),this._V.connectionWrap&&this._V.connectionWrap.attr("d",e),this._translateAndAutoOrientArrows(this._V.markerSource,this._V.markerTarget),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),delete this.options.perpendicular,this.updatePostponed=!1,this},_findConnectionPoints:function(t){var e,n,r,i,o=_.first(t);e=this.getConnectionPoint("source",this.model.get("source"),o||this.model.get("target")).round();var a=_.last(t);n=this.getConnectionPoint("target",this.model.get("target"),a||e).round();var s=this._markerCache;this._V.markerSource&&(s.sourceBBox=s.sourceBBox||this._V.markerSource.bbox(!0),r=g.point(e).move(o||n,s.sourceBBox.width*this._V.markerSource.scale().sx*-1).round()),this._V.markerTarget&&(s.targetBBox=s.targetBBox||this._V.markerTarget.bbox(!0),i=g.point(n).move(a||e,s.targetBBox.width*this._V.markerTarget.scale().sx*-1).round()),s.sourcePoint=r||e,s.targetPoint=i||n,this.sourcePoint=e,this.targetPoint=n},updateLabelPositions:function(){if(!this._V.labels)return this;var t=this.model.get("labels")||[];if(!t.length)return this;var e=this._V.connection.node,n=e.getTotalLength();return _.isNaN(n)||_.each(t,function(t,r){var i=t.position;i=i>n?n:i,i=0>i?n+i:i,i=i>1?i:n*i;var o=e.getPointAtLength(i);this._labelCache[r].attr("transform","translate("+o.x+", "+o.y+")")},this),this},updateToolsPosition:function(){if(!this._V.linkTools)return this;var t="",e=this.options.linkToolsOffset,n=this.getConnectionLength();n<this.options.shortLinkLength&&(t="scale(.5)",e/=2);var r=this.getPointAtLength(e);if(this._toolCache.attr("transform","translate("+r.x+", "+r.y+") "+t),this.options.doubleLinkTools&&n>=this.options.longLinkLength){var i=this.options.doubleLinkToolsOffset||e;r=this.getPointAtLength(n-i),this._tool2Cache.attr("transform","translate("+r.x+", "+r.y+") "+t),this._tool2Cache.attr("visibility","visible")}else this.options.doubleLinkTools&&this._tool2Cache.attr("visibility","hidden");return this},updateArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;if("none"===$.css(this._V.markerArrowheads.node,"display"))return this;var t=this.getConnectionLength()<this.options.shortLinkLength?.5:1;return this._V.sourceArrowhead.scale(t),this._V.targetArrowhead.scale(t),this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead),this},createWatcher:function(t){function e(e,r){r=r||{};var i=null,o=e.previous(t)||{};return o.id&&this.stopListening(this.paper.getModelById(o.id),"change",n),r.id&&(i=this.paper.getModelById(r.id),this.listenTo(i,"change",n)),n.call(this,i,{cacheOnly:!0}),this}var n=_.partial(this.onEndModelChange,t);return e},onEndModelChange:function(t,e,n){var r=!n.cacheOnly,i=this.model.get(t)||{};if(e){var o=this.constructor.makeSelector(i),a="source"==t?"target":"source",s=this.model.get(a)||{},u=s.id&&this.constructor.makeSelector(s);if(n.isLoop&&o==u)this[t+"BBox"]=this[a+"BBox"],this[t+"View"]=this[a+"View"],this[t+"Magnet"]=this[a+"Magnet"];else if(n.translateBy){var l=this[t+"BBox"];l.x+=n.tx,l.y+=n.ty}else{var c=this.paper.findViewByModel(i.id),h=c.el.querySelector(o);this[t+"BBox"]=c.getStrokeBBox(h),this[t+"View"]=c,this[t+"Magnet"]=h}if(n.isLoop&&n.translateBy&&this.model.isEmbeddedIn(e)&&!_.isEmpty(this.model.get("vertices"))&&(r=!1),!this.updatePostponed&&s.id){var f=this.paper.getModelById(s.id);n.isLoop=i.id==s.id,(n.isLoop||n.translateBy&&f.isEmbeddedIn(n.translateBy))&&(this.updatePostponed=!0,r=!1)}}else this[t+"BBox"]=g.rect(i.x||0,i.y||0,1,1),this[t+"View"]=this[t+"Magnet"]=null;this.lastEndChange=t,r&&this.update()},_translateAndAutoOrientArrows:function(t,e){t&&t.translateAndAutoOrient(this.sourcePoint,_.first(this.route)||this.targetPoint,this.paper.viewport),e&&e.translateAndAutoOrient(this.targetPoint,_.last(this.route)||this.sourcePoint,this.paper.viewport)},removeVertex:function(t){var e=_.clone(this.model.get("vertices"));return e&&e.length&&(e.splice(t,1),this.model.set("vertices",e,{ui:!0})),this},addVertex:function(t){for(var e,n=(this.model.get("vertices")||[]).slice(),r=n.slice(),i=this._V.connection.node.cloneNode(!1),o=i.getTotalLength(),a=20,s=n.length+1;s--&&(n.splice(s,0,t),V(i).attr("d",this.getPathData(this.findRoute(n))),e=i.getTotalLength(),e-o>a);)n=r.slice();return-1===s&&(s=0,n.splice(s,0,t)),this.model.set("vertices",n,{ui:!0}),s},sendToken:function(t,e,n){e=e||1e3,V(this.paper.viewport).append(t),V(t).animateAlongPath({dur:e+"ms",repeatCount:1},this._V.connection.node),_.delay(function(){V(t).remove(),n&&n()},e)},findRoute:function(t){var e=this.model.get("router");if(!e){if(!this.model.get("manhattan"))return t;e={name:"orthogonal"}}var n=joint.routers[e.name];if(!_.isFunction(n))throw"unknown router: "+e.name;var r=n.call(this,t||[],e.args||{},this);return r},getPathData:function(t){var e=this.model.get("connector");if(e||(e=this.model.get("smooth")?{name:"smooth"}:{name:"normal"}),!_.isFunction(joint.connectors[e.name]))throw"unknown connector: "+e.name;var n=joint.connectors[e.name].call(this,this._markerCache.sourcePoint,this._markerCache.targetPoint,t||this.model.get("vertices")||{},e.args||{},this);return n},getConnectionPoint:function(t,e,n){var r;if(_.isEmpty(e)&&(e={
x:0,y:0}),_.isEmpty(n)&&(n={x:0,y:0}),e.id){var i,o="source"===t?this.sourceBBox:this.targetBBox;if(n.id){var a="source"===t?this.targetBBox:this.sourceBBox;i=g.rect(a).intersectionWithLineFromCenterToPoint(g.rect(o).center()),i=i||g.rect(a).center()}else i=g.point(n);if(this.paper.options.perpendicularLinks||this.options.perpendicular){var s,u=g.rect(0,i.y,this.paper.options.width,1),l=g.rect(i.x,0,1,this.paper.options.height);if(u.intersect(g.rect(o)))switch(s=g.rect(o).sideNearestToPoint(i)){case"left":r=g.point(o.x,i.y);break;case"right":r=g.point(o.x+o.width,i.y);break;default:r=g.rect(o).center()}else if(l.intersect(g.rect(o)))switch(s=g.rect(o).sideNearestToPoint(i)){case"top":r=g.point(i.x,o.y);break;case"bottom":r=g.point(i.x,o.y+o.height);break;default:r=g.rect(o).center()}else r=g.rect(o).intersectionWithLineFromCenterToPoint(i),r=r||g.rect(o).center()}else if(this.paper.options.linkConnectionPoint){var c="target"===t?this.targetView:this.sourceView,h="target"===t?this.targetMagnet:this.sourceMagnet;r=this.paper.options.linkConnectionPoint(this,c,h,i)}else r=g.rect(o).intersectionWithLineFromCenterToPoint(i),r=r||g.rect(o).center()}else r=g.point(e);return r},getConnectionLength:function(){return this._V.connection.node.getTotalLength()},getPointAtLength:function(t){return this._V.connection.node.getPointAtLength(t)},_beforeArrowheadMove:function(){this.model.trigger("batch:start"),this._z=this.model.get("z"),this.model.toFront(),this.el.style.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets()},_afterArrowheadMove:function(){this._z&&(this.model.set("z",this._z,{ui:!0}),delete this._z),this.el.style.pointerEvents="visiblePainted",this.paper.options.markAvailable&&this._unmarkAvailableMagnets(),this.model.trigger("batch:stop")},_createValidateConnectionArgs:function(t){function e(t,e){return n[o]=t,n[o+1]=t.el===e?void 0:e,n}var n=[];n[4]=t,n[5]=this;var r,i=0,o=0;"source"===t?(i=2,r="target"):(o=2,r="source");var a=this.model.get(r);return a.id&&(n[i]=this.paper.findViewByModel(a.id),n[i+1]=a.selector&&n[i].el.querySelector(a.selector)),e},_markAvailableMagnets:function(){var t=this.paper.model.getElements(),e=this.paper.options.validateConnection;_.chain(t).map(this.paper.findViewByModel,this.paper).each(function(t){var n="false"!==t.el.getAttribute("magnet")&&e.apply(this.paper,this._validateConnectionArgs(t,null)),r=_.filter(t.el.querySelectorAll("[magnet]"),function(n){return e.apply(this.paper,this._validateConnectionArgs(t,n))},this);n&&V(t.el).addClass("available-magnet"),_.each(r,function(t){V(t).addClass("available-magnet")}),(n||r.length)&&V(t.el).addClass("available-cell")},this)},_unmarkAvailableMagnets:function(){_.each(this.paper.el.querySelectorAll(".available-cell, .available-magnet"),function(t){V(t).removeClass("available-magnet").removeClass("available-cell")})},startArrowheadMove:function(t){this._action="arrowhead-move",this._arrowhead=t,this._validateConnectionArgs=this._createValidateConnectionArgs(this._arrowhead),this._beforeArrowheadMove()},pointerdown:function(t,e,n){function r(t){return _.isObject(i)&&i[t]===!1?!1:!0}joint.dia.CellView.prototype.pointerdown.apply(this,arguments),this._dx=e,this._dy=n;var i=_.isFunction(this.options.interactive)?this.options.interactive(this,"pointerdown"):this.options.interactive;if(i!==!1){var o=t.target.getAttribute("class");switch(o){case"marker-vertex":r("vertexMove")&&(this._action="vertex-move",this._vertexIdx=t.target.getAttribute("idx"));break;case"marker-vertex-remove":case"marker-vertex-remove-area":r("vertexRemove")&&this.removeVertex(t.target.getAttribute("idx"));break;case"marker-arrowhead":r("arrowheadMove")&&this.startArrowheadMove(t.target.getAttribute("end"));break;default:var a=t.target.parentNode.getAttribute("event");a?"remove"===a?this.model.remove():this.paper.trigger(a,t,this,e,n):r("vertexAdd")&&(this._vertexIdx=this.addVertex({x:e,y:n}),this._action="vertex-move")}this.paper.trigger("link:pointerdown",t,this,e,n)}},pointermove:function(t,e,n){switch(joint.dia.CellView.prototype.pointermove.apply(this,arguments),this._action){case"vertex-move":var r=_.clone(this.model.get("vertices"));r[this._vertexIdx]={x:e,y:n},this.model.set("vertices",r,{ui:!0});break;case"arrowhead-move":if(this.paper.options.snapLinks){var i=this.paper.options.snapLinks.radius||50,o=this.paper.findViewsInArea({x:e-i,y:n-i,width:2*i,height:2*i});this._closestView&&this._closestView.unhighlight(this._closestEnd.selector,{connecting:!0,snapping:!0}),this._closestView=this._closestEnd=null;var a,s=g.point(e,n),u=Number.MAX_VALUE;_.each(o,function(t){"false"!==t.el.getAttribute("magnet")&&(a=t.model.getBBox().center().distance(s),i>a&&u>a&&this.paper.options.validateConnection.apply(this.paper,this._validateConnectionArgs(t,null))&&(u=a,this._closestView=t,this._closestEnd={id:t.model.id})),t.$("[magnet]").each(_.bind(function(e,n){var r=V(n).bbox(!1,this.paper.viewport);a=s.distance({x:r.x+r.width/2,y:r.y+r.height/2}),i>a&&u>a&&this.paper.options.validateConnection.apply(this.paper,this._validateConnectionArgs(t,n))&&(u=a,this._closestView=t,this._closestEnd={id:t.model.id,selector:t.getSelector(n),port:n.getAttribute("port")})},this))},this),this._closestView&&this._closestView.highlight(this._closestEnd.selector,{connecting:!0,snapping:!0}),this.model.set(this._arrowhead,this._closestEnd||{x:e,y:n},{ui:!0})}else{var l="mousemove"===t.type?t.target:document.elementFromPoint(t.clientX,t.clientY);this._targetEvent!==l&&(this._magnetUnderPointer&&this._viewUnderPointer.unhighlight(this._magnetUnderPointer,{connecting:!0}),this._viewUnderPointer=this.paper.findView(l),this._viewUnderPointer?(this._magnetUnderPointer=this._viewUnderPointer.findMagnet(l),this._magnetUnderPointer&&this.paper.options.validateConnection.apply(this.paper,this._validateConnectionArgs(this._viewUnderPointer,this._magnetUnderPointer))?this._magnetUnderPointer&&this._viewUnderPointer.highlight(this._magnetUnderPointer,{connecting:!0}):this._magnetUnderPointer=null):this._magnetUnderPointer=null),this._targetEvent=l,this.model.set(this._arrowhead,{x:e,y:n},{ui:!0})}}this._dx=e,this._dy=n},pointerup:function(t){joint.dia.CellView.prototype.pointerup.apply(this,arguments),"arrowhead-move"===this._action&&(this.paper.options.snapLinks?(this._closestView&&this._closestView.unhighlight(this._closestEnd.selector,{connecting:!0,snapping:!0}),this._closestView=this._closestEnd=null):(this._magnetUnderPointer&&(this._viewUnderPointer.unhighlight(this._magnetUnderPointer,{connecting:!0}),this.model.set(this._arrowhead,{id:this._viewUnderPointer.model.id,selector:this._viewUnderPointer.getSelector(this._magnetUnderPointer),port:$(this._magnetUnderPointer).attr("port")},{ui:!0})),delete this._viewUnderPointer,delete this._magnetUnderPointer),this.paper.options.embeddingMode&&this.model.reparent()&&delete this._z,this._afterArrowheadMove()),delete this._action}},{makeSelector:function(t){var e='[model-id="'+t.id+'"]';return t.port?e+=' [port="'+t.port+'"]':t.selector&&(e+=" "+t.selector),e}}),"object"==typeof exports&&(module.exports.Link=joint.dia.Link,module.exports.LinkView=joint.dia.LinkView),joint.dia.Paper=Backbone.View.extend({className:"paper",options:{width:800,height:600,origin:{x:0,y:0},gridSize:50,perpendicularLinks:!1,elementView:joint.dia.ElementView,linkView:joint.dia.LinkView,snapLinks:!1,markAvailable:!1,defaultLink:new joint.dia.Link,validateMagnet:function(t,e){return"passive"!==e.getAttribute("magnet")},validateConnection:function(t,e,n,r,i,o){return("target"===i?n:t)instanceof joint.dia.ElementView},embeddingMode:!1,validateEmbedding:function(t,e){return!0},findParentBy:"bbox",frontParentOnly:!0},events:{mousedown:"pointerdown",dblclick:"mousedblclick",click:"mouseclick",touchstart:"pointerdown",mousemove:"pointermove",touchmove:"pointermove","mouseover .element":"cellMouseover","mouseover .link":"cellMouseover","mouseout .element":"cellMouseout","mouseout .link":"cellMouseout"},constructor:function(t){this._configure(t),Backbone.View.apply(this,arguments)},_configure:function(t){this.options&&(t=_.extend({},_.result(this,"options"),t)),this.options=t},initialize:function(){_.bindAll(this,"addCell","sortCells","resetCells","pointerup","asyncRenderCells"),this.svg=V("svg").node,this.viewport=V("g").addClass("viewport").node,this.defs=V("defs").node,V(this.svg).append([this.viewport,this.defs]),this.$el.append(this.svg),this.setOrigin(),this.setDimensions(),this.listenTo(this.model,"add",this.onAddCell),this.listenTo(this.model,"reset",this.resetCells),this.listenTo(this.model,"sort",this.sortCells),$(document).on("mouseup touchend",this.pointerup),this._mousemoved=!1,this.on({"cell:highlight":this.onCellHighlight,"cell:unhighlight":this.onCellUnhighlight})},remove:function(){this.removeCells(),$(document).off("mouseup touchend",this.pointerup),Backbone.View.prototype.remove.call(this)},setDimensions:function(t,e){t=this.options.width=t||this.options.width,e=this.options.height=e||this.options.height,V(this.svg).attr({width:t,height:e}),this.trigger("resize",t,e)},setOrigin:function(t,e){this.options.origin.x=t||0,this.options.origin.y=e||0,V(this.viewport).translate(t,e,{absolute:!0}),this.trigger("translate",t,e)},fitToContent:function(t,e,n,r){_.isObject(t)?(r=t,t=r.gridWidth||1,e=r.gridHeight||1,n=r.padding||0):(r=r||{},t=t||1,e=e||1,n=n||0);var i=V(this.viewport).bbox(!0,this.svg),o=V(this.viewport).scale();i.x*=o.sx,i.y*=o.sy,i.width*=o.sx,i.height*=o.sy;var a=Math.max(Math.ceil((i.width+i.x)/t),1)*t,s=Math.max(Math.ceil((i.height+i.y)/e),1)*e,u=0,l=0;("negative"==r.allowNewOrigin&&i.x<0||"positive"==r.allowNewOrigin&&i.x>=0||"any"==r.allowNewOrigin)&&(u=Math.ceil(-i.x/t)*t,u+=n,a+=u),("negative"==r.allowNewOrigin&&i.y<0||"positive"==r.allowNewOrigin&&i.y>=0||"any"==r.allowNewOrigin)&&(l=Math.ceil(-i.y/e)*e,l+=n,s+=l),a+=n,s+=n,a=Math.max(a,r.minWidth||0),s=Math.max(s,r.minHeight||0);var c=a!=this.options.width||s!=this.options.height,h=u!=this.options.origin.x||l!=this.options.origin.y;h&&this.setOrigin(u,l),c&&this.setDimensions(a,s)},scaleContentToFit:function(t){var e=this.getContentBBox();if(e.width&&e.height){t=t||{},_.defaults(t,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE});var n=t.padding,r=t.minScaleX||t.minScale,i=t.maxScaleX||t.maxScale,o=t.minScaleY||t.minScale,a=t.maxScaleY||t.maxScale,s=t.fittingBBox||{x:this.options.origin.x,y:this.options.origin.y,width:this.options.width,height:this.options.height};s=g.rect(s).moveAndExpand({x:n,y:n,width:-2*n,height:-2*n});var u=V(this.viewport).scale(),l=s.width/e.width*u.sx,c=s.height/e.height*u.sy;if(t.preserveAspectRatio&&(l=c=Math.min(l,c)),t.scaleGrid){var h=t.scaleGrid;l=h*Math.floor(l/h),c=h*Math.floor(c/h)}l=Math.min(i,Math.max(r,l)),c=Math.min(a,Math.max(o,c)),this.scale(l,c);var f=this.getContentBBox(),d=s.x-f.x,p=s.y-f.y;this.setOrigin(d,p)}},getContentBBox:function(){var t=this.viewport.getBoundingClientRect(),e=this.viewport.getScreenCTM(),n=this.viewport.getCTM(),r=g.rect({x:t.left-e.e+n.e,y:t.top-e.f+n.f,width:t.width,height:t.height});return r},createViewForModel:function(t){var e,n=t.get("type"),r=n.split(".")[0],i=n.split(".")[1];return e=joint.shapes[r]&&joint.shapes[r][i+"View"]?new joint.shapes[r][i+"View"]({model:t,interactive:this.options.interactive}):t instanceof joint.dia.Element?new this.options.elementView({model:t,interactive:this.options.interactive}):new this.options.linkView({model:t,interactive:this.options.interactive})},onAddCell:function(t,e,n){if(this.options.async&&n.async!==!1&&_.isNumber(n.position)){if(this._asyncCells=this._asyncCells||[],this._asyncCells.push(t),0==n.position){if(this._frameId)throw"another asynchronous rendering in progress";this.asyncRenderCells(this._asyncCells),delete this._asyncCells}}else this.addCell(t)},addCell:function(t){var e=this.createViewForModel(t);V(this.viewport).append(e.el),e.paper=this,e.render(),$(e.el).find("image").on("dragstart",function(){return!1})},beforeRenderCells:function(t){return t.sort(function(t,e){return t instanceof joint.dia.Link?1:-1}),t},afterRenderCells:function(){this.sortCells()},resetCells:function(t){$(this.viewport).empty();var e=t.models.slice();e=this.beforeRenderCells(e),this._frameId&&(joint.util.cancelFrame(this._frameId),delete this._frameId),this.options.async?this.asyncRenderCells(e):(_.each(e,this.addCell,this),this.sortCells())},removeCells:function(){this.model.get("cells").each(function(t){var e=this.findViewByModel(t);e&&e.remove()},this)},asyncBatchAdded:_.identity,asyncRenderCells:function(t,e){var n=!1;this._frameId&&(_.each(_.range(this.options.async&&this.options.async.batchSize||50),function(){var e=t.shift();n=!e,n||this.addCell(e)},this),this.asyncBatchAdded()),n?(delete this._frameId,this.afterRenderCells(),this.trigger("render:done",e)):this._frameId=joint.util.nextFrame(_.bind(function(){this.asyncRenderCells(t,e)},this))},sortCells:function(){var t=$(this.viewport).children("[model-id]"),e=this.model.get("cells");this.sortElements(t,function(t,n){var r=e.get($(t).attr("model-id")),i=e.get($(n).attr("model-id"));return(r.get("z")||0)>(i.get("z")||0)?1:-1})},sortElements:function(t,e){var n=$(t),r=n.map(function(){var t=this,e=t.parentNode,n=e.insertBefore(document.createTextNode(""),t.nextSibling);return function(){if(e===this)throw new Error("You can't sort elements if any one is a descendant of another.");e.insertBefore(this,n),e.removeChild(n)}});return Array.prototype.sort.call(n,e).each(function(t){r[t].call(this)})},scale:function(t,e,n,r){e=e||t,_.isUndefined(n)&&(n=0,r=0),V(this.viewport).attr("transform","");var i=this.options.origin.x,o=this.options.origin.y;if(n||r||i||o){var a=i-n*(t-1),s=o-r*(e-1);this.setOrigin(a,s)}return V(this.viewport).scale(t,e),this.trigger("scale",t,e,n,r),this},rotate:function(t,e,n){if(_.isUndefined(e)){var r=this.viewport.getBBox();e=r.width/2,n=r.height/2}V(this.viewport).rotate(t,e,n)},findView:function(t){var e=this.$(t);return 0===e.length||e[0]===this.el?void 0:e.data("view")?e.data("view"):this.findView(e.parent())},findViewByModel:function(t){var e=_.isString(t)?t:t.id,n=this.$('[model-id="'+e+'"]');return n.length?n.data("view"):void 0},findViewsFromPoint:function(t){t=g.point(t);var e=_.map(this.model.getElements(),this.findViewByModel);return _.filter(e,function(e){return e&&g.rect(V(e.el).bbox(!1,this.viewport)).containsPoint(t)},this)},findViewsInArea:function(t){t=g.rect(t);var e=_.map(this.model.getElements(),this.findViewByModel);return _.filter(e,function(e){return e&&t.intersect(g.rect(V(e.el).bbox(!1,this.viewport)))},this)},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t){var e=V(this.viewport).toLocalPoint(t.x,t.y);return{x:g.snapToGrid(e.x,this.options.gridSize),y:g.snapToGrid(e.y,this.options.gridSize)}},getDefaultLink:function(t,e){return _.isFunction(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},onCellHighlight:function(t,e){V(e).addClass("highlighted")},onCellUnhighlight:function(t,e){V(e).removeClass("highlighted")},mousedblclick:function(t){t.preventDefault(),t=joint.util.normalizeEvent(t);var e=this.findView(t.target),n=this.snapToGrid({x:t.clientX,y:t.clientY});e?e.pointerdblclick(t,n.x,n.y):this.trigger("blank:pointerdblclick",t,n.x,n.y)},mouseclick:function(t){if(!this._mousemoved){t=joint.util.normalizeEvent(t);var e=this.findView(t.target),n=this.snapToGrid({x:t.clientX,y:t.clientY});e?e.pointerclick(t,n.x,n.y):this.trigger("blank:pointerclick",t,n.x,n.y)}this._mousemoved=!1},pointerdown:function(t){t=joint.util.normalizeEvent(t);var e=this.findView(t.target),n=this.snapToGrid({x:t.clientX,y:t.clientY});e?(this.sourceView=e,e.pointerdown(t,n.x,n.y)):this.trigger("blank:pointerdown",t,n.x,n.y)},pointermove:function(t){if(t.preventDefault(),t=joint.util.normalizeEvent(t),this.sourceView){this._mousemoved=!0;var e=this.snapToGrid({x:t.clientX,y:t.clientY});this.sourceView.pointermove(t,e.x,e.y)}},pointerup:function(t){t=joint.util.normalizeEvent(t);var e=this.snapToGrid({x:t.clientX,y:t.clientY});this.sourceView?(this.sourceView.pointerup(t,e.x,e.y),this.sourceView=null):this.trigger("blank:pointerup",t,e.x,e.y)},cellMouseover:function(t){t=joint.util.normalizeEvent(t);var e=this.findView(t.target);e&&e.mouseover(t)},cellMouseout:function(t){t=joint.util.normalizeEvent(t);var e=this.findView(t.target);e&&e.mouseout(t)}}),"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{},dia:{Element:require("../src/joint.dia.element").Element,ElementView:require("../src/joint.dia.element").ElementView}},_=require("lodash");if(joint.shapes.basic={},joint.shapes.basic.Generic=joint.dia.Element.extend({defaults:joint.util.deepSupplement({type:"basic.Generic",attrs:{".":{fill:"#FFFFFF",stroke:"none"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.basic.Rect=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Rect",attrs:{rect:{fill:"#FFFFFF",stroke:"black",width:100,height:60},text:{"font-size":14,text:"","ref-x":.5,"ref-y":.5,ref:"rect","y-alignment":"middle","x-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.TextView=joint.dia.ElementView.extend({initialize:function(){joint.dia.ElementView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:attrs",this.resize)}}),joint.shapes.basic.Text=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><text/></g></g>',defaults:joint.util.deepSupplement({type:"basic.Text",attrs:{text:{"font-size":18,fill:"black"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Circle=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Circle",size:{width:60,height:60},attrs:{circle:{fill:"#FFFFFF",stroke:"black",r:30,transform:"translate(30, 30)"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,ref:"circle","y-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Image=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Image",attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,ref:"image","y-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Path=joint.shapes.basic.Generic.extend({markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>',defaults:joint.util.deepSupplement({type:"basic.Path",size:{width:60,height:60},attrs:{path:{fill:"#FFFFFF",stroke:"black"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,ref:"path","y-alignment":"middle",fill:"black","font-family":"Arial, helvetica, sans-serif"}}},joint.shapes.basic.Generic.prototype.defaults)}),joint.shapes.basic.Rhombus=joint.shapes.basic.Path.extend({defaults:joint.util.deepSupplement({type:"basic.Rhombus",attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5}}},joint.shapes.basic.Path.prototype.defaults)}),joint.shapes.basic.PortsModelInterface={initialize:function(){this.updatePortsAttrs(),this.on("change:inPorts change:outPorts",this.updatePortsAttrs,this),this.constructor.__super__.constructor.__super__.initialize.apply(this,arguments)},updatePortsAttrs:function(t){var e=this.get("attrs");_.each(this._portSelectors,function(t){e[t]&&delete e[t]}),this._portSelectors=[];var n={};_.each(this.get("inPorts"),function(t,e,r){var i=this.getPortAttrs(t,e,r.length,".inPorts","in");this._portSelectors=this._portSelectors.concat(_.keys(i)),_.extend(n,i)},this),_.each(this.get("outPorts"),function(t,e,r){var i=this.getPortAttrs(t,e,r.length,".outPorts","out");this._portSelectors=this._portSelectors.concat(_.keys(i)),_.extend(n,i)},this),this.attr(n,{silent:!0}),this.processPorts(),this.trigger("process:ports")},getPortSelector:function(t){var e=".inPorts",n=this.get("inPorts").indexOf(t);if(0>n&&(e=".outPorts",n=this.get("outPorts").indexOf(t),0>n))throw new Error("getPortSelector(): Port doesn't exist.");return e+">g:nth-child("+(n+1)+")>circle"}},joint.shapes.basic.PortsViewInterface={initialize:function(){this.listenTo(this.model,"process:ports",this.update),joint.dia.ElementView.prototype.initialize.apply(this,arguments)},update:function(){this.renderPorts(),joint.dia.ElementView.prototype.update.apply(this,arguments)},renderPorts:function(){var t=this.$(".inPorts").empty(),e=this.$(".outPorts").empty(),n=_.template(this.model.portMarkup);_.each(_.filter(this.model.ports,function(t){return"in"===t.type}),function(e,r){t.append(V(n({id:r,port:e})).node)}),_.each(_.filter(this.model.ports,function(t){return"out"===t.type}),function(t,r){e.append(V(n({id:r,port:t})).node)})}},joint.shapes.basic.TextBlock=joint.shapes.basic.Generic.extend({markup:['<g class="rotatable"><g class="scalable"><rect/></g><switch>','<foreignObject requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" class="fobj">','<body xmlns="http://www.w3.org/1999/xhtml"><div/></body>',"</foreignObject>",'<text class="content"/>',"</switch></g>"].join(""),defaults:joint.util.deepSupplement({type:"basic.TextBlock",attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"",ref:"rect","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},joint.shapes.basic.Generic.prototype.defaults),initialize:function(){"undefined"!=typeof SVGForeignObjectElement&&(this.setForeignObjectSize(this,this.get("size")),this.setDivContent(this,this.get("content")),this.listenTo(this,"change:size",this.setForeignObjectSize),this.listenTo(this,"change:content",this.setDivContent)),joint.shapes.basic.Generic.prototype.initialize.apply(this,arguments)},setForeignObjectSize:function(t,e){t.attr({".fobj":_.clone(e),div:{style:_.clone(e)}})},setDivContent:function(t,e){t.attr({div:{html:e}})}}),joint.shapes.basic.TextBlockView=joint.dia.ElementView.extend({initialize:function(){joint.dia.ElementView.prototype.initialize.apply(this,arguments),"undefined"==typeof SVGForeignObjectElement&&(this.noSVGForeignObjectElement=!0,this.listenTo(this.model,"change:content",function(t){this.updateContent(t)}))},update:function(t,e){if(this.noSVGForeignObjectElement){var n=this.model,r=_.omit(e||n.get("attrs"),".content");joint.dia.ElementView.prototype.update.call(this,n,r),(!e||_.has(e,".content"))&&this.updateContent(n,e)}else joint.dia.ElementView.prototype.update.call(this,n,e)},updateContent:function(t,e){var n=_.merge({},(e||t.get("attrs"))[".content"]);delete n.text;var r=joint.util.breakText(t.get("content"),t.get("size"),n,{svgDocument:this.paper.svg}),i=joint.util.setByPath({},".content",n,"/");i[".content"].text=r,joint.dia.ElementView.prototype.update.call(this,t,i)}}),"object"==typeof exports&&(module.exports=joint.shapes.basic),joint.routers.orthogonal=function(){function t(t,e){return t.y<e.y&&t.x===e.x?"down":t.y>e.y&&t.x===e.x?"up":t.x<e.x&&t.y===e.y?"right":"left"}function e(t,e,n){var r;if(r=t.x<e.x?t.y>e.y?["up","right"]:t.y<e.y?["down","right"]:["right"]:t.x>e.x?t.y>e.y?["up","left"]:t.y<e.y?["down","left"]:["left"]:t.y>e.y?["up"]:["down"],_.contains(r,n))return n;var i=_.first(r);switch(n){case"down":if("up"===i)return _.last(r);break;case"up":if("down"===i)return _.last(r);break;case"left":if("right"===i)return _.last(r);break;case"right":if("left"===i)return _.last(r)}return i}function n(t,n,r){var i=e(t,n,r);return"down"===i||"up"===i?{x:t.x,y:n.y,d:i}:{x:n.x,y:t.y,d:i}}function r(e){e=(e||[]).slice();var r=[],a=i.center(),s=o.center();e.length||(Math.abs(a.x-s.x)<i.width/2||Math.abs(a.y-s.y)<i.height/2)&&(e=[{x:Math.min(a.x,s.x)+Math.abs(a.x-s.x)/2,y:Math.min(a.y,s.y)+Math.abs(a.y-s.y)/2}]),e.unshift(a),e.push(s);for(var u,l,c,h,f=0;f<e.length-1;f++){c=e[f],h=e[f+1],l=_.last(r),f>0&&(u=c,u.d=l?t(l,c):"top",r.push(u),l=u);var d=l&&l.d;u=n(c,h,d),g.point(u).equals(g.point(c))||g.point(u).equals(g.point(h))||r.push(u)}return r}var i,o;return function(t){return i=this.sourceBBox,o=this.targetBBox,r(t)}}(),joint.routers.manhattan=function(){"use strict";function t(t,e){for(var n,r=[],i={x:0,y:0},o=e;n=t[o];){var a=n.difference(o);a.equals(i)||(r.unshift(o),i=a),o=n}return r.unshift(o),r}function e(t,e,n){var r=n.step,i=t.center(),o=_.chain(n.directionMap).pick(e).map(function(e){var n=e.x*t.width/2,o=e.y*t.height/2,a=g.point(i).offset(n,o).snapToGrid(r);return t.containsPoint(a)&&a.offset(e.x*r,e.y*r),a}).value();return o}function n(t,e,n){var r=360/n,i=Math.floor(t.theta(e)/r);return n-i}function r(r,i,o,a){var s=a.reversed?a.endDirections:a.startDirections,u=a.reversed?a.startDirections:a.endDirections,l=r instanceof g.rect?e(r,s,a):[r],c=i instanceof g.rect?e(i,u,a):[i],h=l.length>1?r.center():l[0],f=c.length>1?i.center():c[0],d=_.filter(c,function(t){var e=g.point(t).snapToGrid(a.mapGridSize).toString(),n=_.every(o[e],function(e){return!e.containsPoint(t)});return n});if(d.length)for(var p=a.step,m=a.penalties,v=_.chain(d).invoke("snapToGrid",p).min(function(t){return a.estimateCost(h,t)}).value(),y={},b={},x={},w=a.directions,k=w.length,S=k/2,C=a.previousDirIndexes||{},E={},M={},A=_.chain(l).invoke("snapToGrid",p).each(function(t){var e=t.toString();b[e]=0,x[e]=a.estimateCost(t,v),C[e]=C[e]||n(h,t,k),M[e]=!0}).map(function(t){return t.toString()}).sortBy(function(t){return x[t]}).value(),P=a.maximumLoops,j=a.maxAllowedDirectionChange;A.length&&P--;){var T=A[0],N=g.point(T);if(v.equals(N))return a.previousDirIndexes=_.pick(C,T),t(y,N);A.splice(0,1),M[F]=null,E[F]=!0;for(var $=C[T],I=b[T],L=0;k>L;L++){var O=Math.abs(L-$);if(O>S&&(O=k-O),!(O>j)){var D=w[L],z=g.point(N).offset(D.offsetX,D.offsetY),F=z.toString();if(!E[F]){var R=g.point(z).snapToGrid(a.mapGridSize).toString(),B=_.every(o[R],function(t){return!t.containsPoint(z)});if(B){var q=_.has(M,F),V=I+D.cost;if((!q||V<b[F])&&(y[F]=N,C[F]=L,b[F]=V,x[F]=V+a.estimateCost(z,v)+m[O],!q)){var H=_.sortedIndex(A,F,function(t){return x[t]});A.splice(H,0,F),M[F]=!0}}}}}}return a.fallbackRoute(h,f,a)}function i(t,e){e.directions=_.result(e,"directions"),e.penalties=_.result(e,"penalties"),e.paddingBox=_.result(e,"paddingBox"),this.options.perpendicular=!!e.perpendicular;var n=e.reversed="source"===this.lastEndChange,i=n?g.rect(this.targetBBox):g.rect(this.sourceBBox),o=n?g.rect(this.sourceBBox):g.rect(this.targetBBox);i.moveAndExpand(e.paddingBox),o.moveAndExpand(e.paddingBox);for(var a=this.model,s=this.paper.model,u=_.chain(e.excludeEnds).map(a.get,a).pluck("id").map(s.getCell,s).value(),l=e.mapGridSize,c=_.chain(s.getElements()).difference(u).reject(function(t){return _.contains(e.excludeTypes,t.get("type"))}).invoke("getBBox").invoke("moveAndExpand",e.paddingBox).foldl(function(t,e){for(var n=e.origin().snapToGrid(l),r=e.corner().snapToGrid(l),i=n.x;i<=r.x;i+=l)for(var o=n.y;o<=r.y;o+=l){var a=i+"@"+o;t[a]=t[a]||[],t[a].push(e)}return t},{}).value(),h=[],f=_.map(t,g.point),d=i.center(),p=0,m=f.length;m>=p;p++){var v=null,y=b||i,b=f[p];if(!b){b=o;var x=!this.model.get("source").id||!this.model.get("target").id;if(x&&_.isFunction(e.draggingRoute)){var w=y instanceof g.rect?y.center():y;v=e.draggingRoute(w,b.origin(),e)}}v=v||r(y,b,c,e);var k=_.first(v);k&&k.equals(d)&&v.shift(),d=_.last(v)||d,h=h.concat(v)}return n?h.reverse():h}var o={step:10,perpendicular:!0,mapGridSize:100,excludeEnds:[],excludeTypes:["basic.Text"],maximumLoops:500,startDirections:["left","right","top","bottom"],endDirections:["left","right","top","bottom"],directionMap:{right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0},top:{x:0,y:-1}},maxAllowedDirectionChange:1,paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},directions:function(){var t=this.step;return[{offsetX:t,offsetY:0,cost:t},{offsetX:0,offsetY:t,cost:t},{offsetX:-t,offsetY:0,cost:t},{offsetX:0,offsetY:-t,cost:t}]},penalties:function(){return[0,this.step/2,this.step]},estimateCost:function(t,e){return t.manhattanDistance(e)},fallbackRoute:function(t,e,n){var r=n.prevDirIndexes||{},i=(r[t]||0)%2?g.point(t.x,e.y):g.point(e.x,t.y);return[i,e]},draggingRoute:null};return function(t,e,n){return i.call(n,t,_.extend({},o,e))}}(),joint.routers.metro=function(){if(!_.isFunction(joint.routers.manhattan))throw"Metro requires the manhattan router.";var t={diagonalCost:null,directions:function(){var t=this.step,e=this.diagonalCost||Math.ceil(Math.sqrt(t*t<<1));return[{offsetX:t,offsetY:0,cost:t},{offsetX:t,offsetY:t,cost:e},{offsetX:0,offsetY:t,cost:t},{offsetX:-t,offsetY:t,cost:e},{offsetX:-t,offsetY:0,cost:t},{offsetX:-t,offsetY:-t,cost:e},{offsetX:0,offsetY:-t,cost:t},{offsetX:t,offsetY:-t,cost:e}]},fallbackRoute:function(t,e,n){var r=t.theta(e),i={x:e.x,y:t.y},o={x:t.x,y:e.y};if(r%180>90){var a=i;i=o,o=a}var s=45>r%90?i:o,u=g.line(t,s),l=90*Math.ceil(r/90),c=g.point.fromPolar(u.squaredLength(),g.toRad(l+135),s),h=g.line(e,c),f=u.intersection(h);return f?[f.round(),e]:[e]}};return function(e,n,r){return joint.routers.manhattan(e,_.extend({},t,n),r)}}(),joint.connectors.normal=function(t,e,n){var r=["M",t.x,t.y];return _.each(n,function(t){r.push(t.x,t.y)}),r.push(e.x,e.y),r.join(" ")},joint.connectors.rounded=function(t,e,n,r){var i,o,a,s,u,l,c=r.radius||10,h=["M",t.x,t.y];return _.each(n,function(r,f){u=n[f-1]||t,l=n[f+1]||e,a=s||g.point(r).distance(u)/2,s=g.point(r).distance(l)/2,i=g.point(r).move(u,-Math.min(c,a)).round(),o=g.point(r).move(l,-Math.min(c,s)).round(),h.push(i.x,i.y,"S",r.x,r.y,o.x,o.y,"L")}),h.push(e.x,e.y),h.join(" ")},joint.connectors.smooth=function(t,e,n){var r;if(n.length)r=g.bezier.curveThroughPoints([t].concat(n).concat([e]));else{var i=t.x<e.x?e.x-(e.x-t.x)/2:t.x-(t.x-e.x)/2;r=["M",t.x,t.y,"C",i,t.y,i,e.y,e.x,e.y]}return r.join(" ")},"object"==typeof exports)var joint={util:require("../src/core").util,shapes:{},dia:{Element:require("../src/joint.dia.element").Element,Link:require("../src/joint.dia.link").Link}};joint.shapes.erd={},joint.shapes.erd.Entity=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.Entity",size:{width:150,height:60},attrs:{".outer":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"100,0 100,60 0,60 0,0"},".inner":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"95,5 95,55 5,55 5,5",display:"none"},text:{text:"Entity","font-family":"Arial","font-size":14,ref:".outer","ref-x":.5,"ref-y":.5,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.WeakEntity=joint.shapes.erd.Entity.extend({defaults:joint.util.deepSupplement({type:"erd.WeakEntity",attrs:{".inner":{display:"auto"},text:{text:"Weak Entity"}}},joint.shapes.erd.Entity.prototype.defaults)}),joint.shapes.erd.Relationship=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.Relationship",size:{width:80,height:80},attrs:{".outer":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,0 80,40 40,80 0,40"},".inner":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,5 75,40 40,75 5,40",display:"none"},text:{text:"Relationship","font-family":"Arial","font-size":12,ref:".","ref-x":.5,"ref-y":.5,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.IdentifyingRelationship=joint.shapes.erd.Relationship.extend({defaults:joint.util.deepSupplement({type:"erd.IdentifyingRelationship",attrs:{".inner":{display:"auto"},text:{text:"Identifying"}}},joint.shapes.erd.Relationship.prototype.defaults)}),joint.shapes.erd.Attribute=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><ellipse class="outer"/><ellipse class="inner"/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.Attribute",size:{width:100,height:50},attrs:{ellipse:{transform:"translate(50, 25)"},".outer":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:50,ry:25,fill:"#E67E22"},".inner":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:45,ry:20,fill:"#E67E22",display:"none"},text:{"font-family":"Arial","font-size":14,ref:".","ref-x":.5,"ref-y":.5,"x-alignment":"middle",
"y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.Multivalued=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Multivalued",attrs:{".inner":{display:"block"},text:{text:"multivalued"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.Derived=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Derived",attrs:{".outer":{"stroke-dasharray":"3,5"},text:{text:"derived"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.Key=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Key",attrs:{ellipse:{"stroke-width":4},text:{text:"key","font-weight":"800","text-decoration":"underline"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.Normal=joint.shapes.erd.Attribute.extend({defaults:joint.util.deepSupplement({type:"erd.Normal",attrs:{text:{text:"Normal"}}},joint.shapes.erd.Attribute.prototype.defaults)}),joint.shapes.erd.ISA=joint.dia.Element.extend({markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>',defaults:joint.util.deepSupplement({type:"erd.ISA",size:{width:100,height:50},attrs:{polygon:{points:"0,0 50,50 100,0",fill:"#F1C40F",stroke:"#F39C12","stroke-width":2},text:{text:"ISA","font-size":18,ref:"polygon","ref-x":.5,"ref-y":.3,"x-alignment":"middle","y-alignment":"middle"}}},joint.dia.Element.prototype.defaults)}),joint.shapes.erd.Line=joint.dia.Link.extend({defaults:{type:"erd.Line"},cardinality:function(t){this.set("labels",[{position:-20,attrs:{text:{dy:-8,text:t}}}])}}),"object"==typeof exports&&(module.exports=joint.shapes.erd),function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};r.dagre=t("./index")},{"./index":2}],2:[function(t,e,n){n.Digraph=t("graphlib").Digraph,n.Graph=t("graphlib").Graph,n.layout=t("./lib/layout"),n.version=t("./lib/version")},{"./lib/layout":3,"./lib/version":18,graphlib:24}],3:[function(t,e,n){var r=t("./util"),i=t("./rank"),o=t("./order"),a=t("graphlib").CGraph,s=t("graphlib").CDigraph;e.exports=function(){function e(t){var e=new s;t.eachNode(function(t,n){void 0===n&&(n={}),e.addNode(t,{width:n.width,height:n.height}),n.hasOwnProperty("rank")&&(e.node(t).prefRank=n.rank)}),t.parent&&t.nodes().forEach(function(n){e.parent(n,t.parent(n))}),t.eachEdge(function(t,n,r,i){void 0===i&&(i={});var o={e:t,minLen:i.minLen||1,width:i.width||0,height:i.height||0,points:[]};e.addEdge(null,n,r,o)});var n=t.graph()||{};return e.graph({rankDir:n.rankDir||d.rankDir,orderRestarts:n.orderRestarts}),e}function n(t){var n,a=g.rankSep();try{return n=r.time("initLayoutGraph",e)(t),0===n.order()?n:(n.eachEdge(function(t,e,n,r){r.minLen*=2}),g.rankSep(a/2),r.time("rank.run",i.run)(n,d.rankSimplex),r.time("normalize",u)(n),r.time("order",o)(n,d.orderMaxSweeps),r.time("position",p.run)(n),r.time("undoNormalize",l)(n),r.time("fixupEdgePoints",c)(n),r.time("rank.restoreEdges",i.restoreEdges)(n),r.time("createFinalGraph",h)(n,t.isDirected()))}finally{g.rankSep(a)}}function u(t){var e=0;t.eachEdge(function(n,r,i,o){var a=t.node(r).rank,s=t.node(i).rank;if(s>a+1){for(var u=r,l=a+1,c=0;s>l;++l,++c){var h="_D"+ ++e,f={width:o.width,height:o.height,edge:{id:n,source:r,target:i,attrs:o},rank:l,dummy:!0};0===c?f.index=0:l+1===s&&(f.index=1),t.addNode(h,f),t.addEdge(null,u,h,{}),u=h}t.addEdge(null,u,i,{}),t.delEdge(n)}})}function l(t){t.eachNode(function(e,n){if(n.dummy){if("index"in n){var r=n.edge;t.hasEdge(r.id)||t.addEdge(r.id,r.source,r.target,r.attrs);var i=t.edge(r.id).points;i[n.index]={x:n.x,y:n.y,ul:n.ul,ur:n.ur,dl:n.dl,dr:n.dr}}t.delNode(e)}})}function c(t){t.eachEdge(function(t,e,n,r){r.reversed&&r.points.reverse()})}function h(t,e){var n=e?new s:new a;n.graph(t.graph()),t.eachNode(function(t,e){n.addNode(t,e)}),t.eachNode(function(e){n.parent(e,t.parent(e))}),t.eachEdge(function(t,e,r,i){n.addEdge(i.e,e,r,i)});var r=0,i=0;return t.eachNode(function(e,n){t.children(e).length||(r=Math.max(r,n.x+n.width/2),i=Math.max(i,n.y+n.height/2))}),t.eachEdge(function(t,e,n,o){var a=Math.max.apply(Math,o.points.map(function(t){return t.x})),s=Math.max.apply(Math,o.points.map(function(t){return t.y}));r=Math.max(r,a+o.width/2),i=Math.max(i,s+o.height/2)}),n.graph().width=r,n.graph().height=i,n}function f(t){return function(){return arguments.length?(t.apply(null,arguments),g):t()}}var d={debugLevel:0,orderMaxSweeps:o.DEFAULT_MAX_SWEEPS,rankSimplex:!1,rankDir:"TB"},p=t("./position")(),g={};return g.orderIters=r.propertyAccessor(g,d,"orderMaxSweeps"),g.rankSimplex=r.propertyAccessor(g,d,"rankSimplex"),g.nodeSep=f(p.nodeSep),g.edgeSep=f(p.edgeSep),g.universalSep=f(p.universalSep),g.rankSep=f(p.rankSep),g.rankDir=r.propertyAccessor(g,d,"rankDir"),g.debugAlignment=f(p.debugAlignment),g.debugLevel=r.propertyAccessor(g,d,"debugLevel",function(t){r.log.level=t,p.debugLevel(t)}),g.run=r.time("Total layout",n),g._normalize=u,g}},{"./order":4,"./position":9,"./rank":10,"./util":17,graphlib:24}],4:[function(t,e,n){function r(t,e){function n(){t.eachNode(function(t,e){l[t]=e.order})}arguments.length<2&&(e=g);var r=t.graph().orderRestarts||0,i=f(t);i.forEach(function(e){e=e.filterNodes(function(e){return!t.children(e).length})});for(var o,a=0,u=Number.MAX_VALUE,l={},p=0;p<Number(r)+1&&0!==u;++p){o=Number.MAX_VALUE,d(t,r>0),c.log(2,"Order phase start cross count: "+t.graph().orderInitCC);var m,v,y;for(m=0,v=0;4>v&&e>m&&o>0;++m,++v,++a)s(t,i,m),y=h(t),o>y&&(v=0,o=y,u>y&&(n(),u=y)),c.log(3,"Order phase start "+p+" iter "+m+" cross count: "+y)}Object.keys(l).forEach(function(e){t.children&&t.children(e).length||(t.node(e).order=l[e])}),t.graph().orderCC=u,c.log(2,"Order iterations: "+a),c.log(2,"Order phase best cross count: "+t.graph().orderCC)}function o(t,e){var n={};return e.forEach(function(e){n[e]=t.inEdges(e).map(function(e){return t.node(t.source(e)).order})}),n}function a(t,e){var n={};return e.forEach(function(e){n[e]=t.outEdges(e).map(function(e){return t.node(t.target(e)).order})}),n}function s(t,e,n){n%2===0?u(t,e,n):l(t,e,n)}function u(t,e){var n;for(i=1;i<e.length;++i)n=p(e[i],n,o(t,e[i].nodes()))}function l(t,e){var n;for(i=e.length-2;i>=0;--i)p(e[i],n,a(t,e[i].nodes()))}var c=t("./util"),h=t("./order/crossCount"),f=t("./order/initLayerGraphs"),d=t("./order/initOrder"),p=t("./order/sortLayer");e.exports=r;var g=24;r.DEFAULT_MAX_SWEEPS=g},{"./order/crossCount":5,"./order/initLayerGraphs":6,"./order/initOrder":7,"./order/sortLayer":8,"./util":17}],5:[function(t,e,n){function r(t){for(var e=0,n=o.ordering(t),r=1;r<n.length;++r)e+=i(t,n[r-1],n[r]);return e}function i(t,e,n){var r=[];e.forEach(function(e){var n=[];t.outEdges(e).forEach(function(e){n.push(t.node(t.target(e)).order)}),n.sort(function(t,e){return t-e}),r=r.concat(n)});for(var i=1;i<n.length;)i<<=1;var o=2*i-1;i-=1;for(var a=[],s=0;o>s;++s)a[s]=0;var u=0;return r.forEach(function(t){var e=t+i;for(++a[e];e>0;)e%2&&(u+=a[e+1]),e=e-1>>1,++a[e]}),u}var o=t("../util");e.exports=r},{"../util":17}],6:[function(t,e,n){function r(t){function e(r){if(null===r)return void t.children(r).forEach(function(t){e(t)});var i=t.node(r);i.minRank="rank"in i?i.rank:Number.MAX_VALUE,i.maxRank="rank"in i?i.rank:Number.MIN_VALUE;var a=new o;return t.children(r).forEach(function(n){var r=e(n);a=o.union([a,r]),i.minRank=Math.min(i.minRank,t.node(n).minRank),i.maxRank=Math.max(i.maxRank,t.node(n).maxRank)}),"rank"in i&&a.add(i.rank),a.keys().forEach(function(t){t in n||(n[t]=[]),n[t].push(r)}),a}var n=[];e(null);var r=[];return n.forEach(function(e,n){r[n]=t.filterNodes(i(e))}),r}var i=t("graphlib").filter.nodesFromList,o=t("cp-data").Set;e.exports=r},{"cp-data":19,graphlib:24}],7:[function(t,e,n){function r(t,e){var n=[];t.eachNode(function(e,r){var i=n[r.rank];t.children&&t.children(e).length>0||(i||(i=n[r.rank]=[]),i.push(e))}),n.forEach(function(n){e&&o.shuffle(n),n.forEach(function(e,n){t.node(e).order=n})});var r=i(t);t.graph().orderInitCC=r,t.graph().orderCC=Number.MAX_VALUE}var i=t("./crossCount"),o=t("../util");e.exports=r},{"../util":17,"./crossCount":5}],8:[function(t,e,n){function r(t,e,n){var r=[],o={};t.eachNode(function(t,e){r[e.order]=t;var a=n[t];a.length&&(o[t]=i.sum(a)/a.length)});var a=t.nodes().filter(function(t){return void 0!==o[t]});a.sort(function(e,n){return o[e]-o[n]||t.node(e).order-t.node(n).order});for(var s=0,u=0,l=a.length;l>u;++s)void 0!==o[r[s]]&&(t.node(a[u++]).order=s)}var i=t("../util");e.exports=r},{"../util":17}],9:[function(t,e,n){var r=t("./util");e.exports=function(){function t(t){t=t.filterNodes(r.filterNonSubgraphs(t));var e=r.ordering(t),a=n(t,e),s={};["u","d"].forEach(function(n){"d"===n&&e.reverse(),["l","r"].forEach(function(r){"r"===r&&c(e);var u=n+r,h=i(t,e,a,"u"===n?"predecessors":"successors");s[u]=o(t,e,h.pos,h.root,h.align),y.debugLevel>=3&&v(n+r,t,e,s[u]),"r"===r&&l(s[u]),"r"===r&&c(e)}),"d"===n&&e.reverse()}),u(t,e,s),t.eachNode(function(e){var n=[];for(var r in s){var i=s[r][e];g(r,t,e,i),n.push(i)}n.sort(function(t,e){return t-e}),p(t,e,(n[1]+n[2])/2)});var d=0,b="BT"===t.graph().rankDir||"RL"===t.graph().rankDir;e.forEach(function(e){var n=r.max(e.map(function(e){return f(t,e)}));d+=n/2,e.forEach(function(e){m(t,e,b?-d:d)}),d+=n/2+y.rankSep});var _=r.min(t.nodes().map(function(e){return p(t,e)-h(t,e)/2})),x=r.min(t.nodes().map(function(e){return m(t,e)-f(t,e)/2}));t.eachNode(function(e){p(t,e,p(t,e)-_),m(t,e,m(t,e)-x)})}function e(t,e){return e>t?t.toString().length+":"+t+"-"+e:e.toString().length+":"+e+"-"+t}function n(t,n){function r(t){var n=c[t];(a>n||n>u)&&(l[e(o[s],t)]=!0)}var i,o,a,s,u,l={},c={};if(n.length<=2)return l;n[1].forEach(function(t,e){c[t]=e});for(var h=1;h<n.length-1;++h){i=n[h],o=n[h+1],a=0,s=0;for(var f=0;f<o.length;++f){var d=o[f];if(c[d]=f,u=void 0,t.node(d).dummy){var p=t.predecessors(d)[0];void 0!==p&&t.node(p).dummy&&(u=c[p])}if(void 0===u&&f===o.length-1&&(u=i.length-1),void 0!==u){for(;f>=s;++s)t.predecessors(o[s]).forEach(r);a=u}}}return l}function i(t,n,r,i){var o={},a={},s={};return n.forEach(function(t){t.forEach(function(t,e){a[t]=t,s[t]=t,o[t]=e})}),n.forEach(function(n){var u=-1;n.forEach(function(n){var l,c=t[i](n);c.length>0&&(c.sort(function(t,e){return o[t]-o[e]}),l=(c.length-1)/2,c.slice(Math.floor(l),Math.ceil(l)+1).forEach(function(t){s[n]===n&&!r[e(t,n)]&&u<o[t]&&(s[t]=n,s[n]=a[n]=a[t],u=o[t])}))})}),{pos:o,root:a,align:s}}function o(t,e,n,i,o){function a(t,e,n){e in l[t]?l[t][e]=Math.min(l[t][e],n):l[t][e]=n}function s(e){if(!(e in f)){f[e]=0;var r=e;do{if(n[r]>0){var l=i[h[r]];s(l),u[e]===e&&(u[e]=u[l]);var c=d(t,h[r])+d(t,r);u[e]!==u[l]?a(u[l],u[e],f[e]-f[l]-c):f[e]=Math.max(f[e],f[l]+c)}r=o[r]}while(r!==e)}}var u={},l={},c={},h={},f={};return e.forEach(function(t){t.forEach(function(e,n){u[e]=e,l[e]={},n>0&&(h[e]=t[n-1])})}),r.values(i).forEach(function(t){s(t)}),e.forEach(function(t){t.forEach(function(t){if(f[t]=f[i[t]],t===i[t]&&t===u[t]){var e=0;t in l&&Object.keys(l[t]).length>0&&(e=r.min(Object.keys(l[t]).map(function(e){return l[t][e]+(e in c?c[e]:0)}))),c[t]=e}})}),e.forEach(function(t){t.forEach(function(t){f[t]+=c[u[i[t]]]||0})}),f}function a(t,e,n){return r.min(e.map(function(t){var e=t[0];return n[e]}))}function s(t,e,n){return r.max(e.map(function(t){var e=t[t.length-1];return n[e]}))}function u(t,e,n){function r(t){n[h][t]+=l[h]}var i,o={},u={},l={},c=Number.POSITIVE_INFINITY;for(var h in n){var f=n[h];o[h]=a(t,e,f),u[h]=s(t,e,f);var d=u[h]-o[h];c>d&&(c=d,i=h)}["u","d"].forEach(function(t){["l","r"].forEach(function(e){var n=t+e;l[n]="l"===e?o[i]-o[n]:u[i]-u[n]})});for(h in n)t.eachNode(r)}function l(t){for(var e in t)t[e]=-t[e]}function c(t){t.forEach(function(t){t.reverse()})}function h(t,e){switch(t.graph().rankDir){case"LR":return t.node(e).height;case"RL":return t.node(e).height;default:return t.node(e).width}}function f(t,e){switch(t.graph().rankDir){case"LR":return t.node(e).width;case"RL":return t.node(e).width;default:return t.node(e).height}}function d(t,e){if(null!==y.universalSep)return y.universalSep;var n=h(t,e),r=t.node(e).dummy?y.edgeSep:y.nodeSep;return(n+r)/2}function p(t,e,n){if("LR"===t.graph().rankDir||"RL"===t.graph().rankDir){if(arguments.length<3)return t.node(e).y;t.node(e).y=n}else{if(arguments.length<3)return t.node(e).x;t.node(e).x=n}}function g(t,e,n,r){if("LR"===e.graph().rankDir||"RL"===e.graph().rankDir){if(arguments.length<3)return e.node(n)[t];e.node(n)[t]=r}else{if(arguments.length<3)return e.node(n)[t];e.node(n)[t]=r}}function m(t,e,n){if("LR"===t.graph().rankDir||"RL"===t.graph().rankDir){if(arguments.length<3)return t.node(e).x;t.node(e).x=n}else{if(arguments.length<3)return t.node(e).y;t.node(e).y=n}}function v(t,e,n,r){n.forEach(function(n,i){var o,a;n.forEach(function(n){var s=r[n];if(o){var u=d(e,o)+d(e,n);u>s-a&&console.log("Position phase: sep violation. Align: "+t+". Layer: "+i+". U: "+o+" V: "+n+". Actual sep: "+(s-a)+" Expected sep: "+u)}o=n,a=s})})}var y={nodeSep:50,edgeSep:10,universalSep:null,rankSep:30},b={};return b.nodeSep=r.propertyAccessor(b,y,"nodeSep"),b.edgeSep=r.propertyAccessor(b,y,"edgeSep"),b.universalSep=r.propertyAccessor(b,y,"universalSep"),b.rankSep=r.propertyAccessor(b,y,"rankSep"),b.debugLevel=r.propertyAccessor(b,y,"debugLevel"),b.run=t,b}},{"./util":17}],10:[function(t,e,n){function r(t,e){o(t),h.time("constraints.apply",g.apply)(t),a(t),h.time("acyclic",f)(t);var n=t.filterNodes(h.filterNonSubgraphs(t));d(n),v(n).forEach(function(t){var r=n.filterNodes(y.nodesFromList(t));l(r,e)}),h.time("constraints.relax",g.relax(t)),h.time("reorientEdges",u)(t)}function i(t){f.undo(t)}function o(t){t.eachEdge(function(e,n,r,i){if(n===r){var o=s(t,e,n,r,i,0,!1),a=s(t,e,n,r,i,1,!0),u=s(t,e,n,r,i,2,!1);t.addEdge(null,o,n,{minLen:1,selfLoop:!0}),t.addEdge(null,o,a,{minLen:1,selfLoop:!0}),t.addEdge(null,n,u,{minLen:1,selfLoop:!0}),t.addEdge(null,a,u,{minLen:1,selfLoop:!0}),t.delEdge(e)}})}function a(t){t.eachEdge(function(e,n,r,i){if(n===r){var o=i.originalEdge,a=s(t,o.e,o.u,o.v,o.value,0,!0);t.addEdge(null,n,a,{minLen:1}),t.addEdge(null,a,r,{minLen:1}),t.delEdge(e)}})}function s(t,e,n,r,i,o,a){return t.addNode(null,{width:a?i.width:0,height:a?i.height:0,edge:{id:e,source:n,target:r,attrs:i},dummy:!0,index:o})}function u(t){t.eachEdge(function(e,n,r,i){t.node(n).rank>t.node(r).rank&&(t.delEdge(e),i.reversed=!0,t.addEdge(e,r,n,i))})}function l(t,e){var n=p(t);e&&(h.log(1,"Using network simplex for ranking"),m(t,n)),c(t)}function c(t){var e=h.min(t.nodes().map(function(e){return t.node(e).rank}));t.eachNode(function(t,n){n.rank-=e})}var h=t("./util"),f=t("./rank/acyclic"),d=t("./rank/initRank"),p=t("./rank/feasibleTree"),g=t("./rank/constraints"),m=t("./rank/simplex"),v=t("graphlib").alg.components,y=t("graphlib").filter;n.run=r,n.restoreEdges=i},{"./rank/acyclic":11,"./rank/constraints":12,"./rank/feasibleTree":13,"./rank/initRank":14,"./rank/simplex":16,"./util":17,graphlib:24}],11:[function(t,e,n){function r(t){function e(o){o in r||(r[o]=n[o]=!0,t.outEdges(o).forEach(function(r){var a,s=t.target(r);o===s?console.error('Warning: found self loop "'+r+'" for node "'+o+'"'):s in n?(a=t.edge(r),t.delEdge(r),a.reversed=!0,++i,t.addEdge(r,s,o,a)):e(s)}),delete n[o])}var n={},r={},i=0;return t.eachNode(function(t){e(t)}),o.log(2,"Acyclic Phase: reversed "+i+" edge(s)"),i}function i(t){t.eachEdge(function(e,n,r,i){i.reversed&&(delete i.reversed,t.delEdge(e),t.addEdge(e,r,n,i))})}var o=t("../util");e.exports=r,e.exports.undo=i},{"../util":17}],12:[function(t,e,n){function r(t){return"min"!==t&&"max"!==t&&0!==t.indexOf("same_")?(console.error("Unsupported rank type: "+t),!1):!0}function i(t,e,n,r){t.inEdges(e).forEach(function(e){var i,o=t.edge(e);i=o.originalEdge?o:{originalEdge:{e:e,u:t.source(e),v:t.target(e),value:o},minLen:t.edge(e).minLen},o.selfLoop&&(r=!1),r?(t.addEdge(null,n,t.source(e),i),i.reversed=!0):t.addEdge(null,t.source(e),n,i)})}function o(t,e,n,r){t.outEdges(e).forEach(function(e){var i,o=t.edge(e);i=o.originalEdge?o:{originalEdge:{e:e,u:t.source(e),v:t.target(e),value:o},minLen:t.edge(e).minLen},o.selfLoop&&(r=!1),r?(t.addEdge(null,t.target(e),n,i),i.reversed=!0):t.addEdge(null,n,t.target(e),i)})}function a(t,e,n){void 0!==n&&t.children(e).forEach(function(e){e===n||t.outEdges(n,e).length||t.node(e).dummy||t.addEdge(null,n,e,{minLen:0})})}function s(t,e,n){void 0!==n&&t.children(e).forEach(function(e){e===n||t.outEdges(e,n).length||t.node(e).dummy||t.addEdge(null,e,n,{minLen:0})})}n.apply=function(t){function e(n){var u={};t.children(n).forEach(function(a){if(t.children(a).length)return void e(a);var s=t.node(a),l=s.prefRank;if(void 0!==l){if(!r(l))return;l in u?u.prefRank.push(a):u.prefRank=[a];var c=u[l];void 0===c&&(c=u[l]=t.addNode(null,{originalNodes:[]}),t.parent(c,n)),i(t,a,c,"min"===l),o(t,a,c,"max"===l),t.node(c).originalNodes.push({u:a,value:s,parent:n}),t.delNode(a)}}),a(t,n,u.min),s(t,n,u.max)}e(null)},n.relax=function(t){var e=[];t.eachEdge(function(t,n,r,i){var o=i.originalEdge;o&&e.push(o)}),t.eachNode(function(e,n){var r=n.originalNodes;r&&(r.forEach(function(e){e.value.rank=n.rank,t.addNode(e.u,e.value),t.parent(e.u,e.parent)}),t.delNode(e))}),e.forEach(function(e){t.addEdge(e.e,e.u,e.v,e.value)})}},{}],13:[function(t,e,n){function r(t){function e(n){var o=!0;return t.predecessors(n).forEach(function(a){r.has(a)&&!i(t,a,n)&&(r.has(n)&&(s.addNode(n,{}),r.remove(n),s.graph({root:n})),s.addNode(a,{}),s.addEdge(null,a,n,{reversed:!0}),r.remove(a),e(a),o=!1)}),t.successors(n).forEach(function(a){r.has(a)&&!i(t,n,a)&&(r.has(n)&&(s.addNode(n,{}),r.remove(n),s.graph({root:n})),s.addNode(a,{}),s.addEdge(null,n,a,{}),r.remove(a),e(a),o=!1)}),o}function n(){var e=Number.MAX_VALUE;r.keys().forEach(function(n){t.predecessors(n).forEach(function(o){if(!r.has(o)){var a=i(t,o,n);Math.abs(a)<Math.abs(e)&&(e=-a)}}),t.successors(n).forEach(function(o){if(!r.has(o)){var a=i(t,n,o);Math.abs(a)<Math.abs(e)&&(e=a)}})}),s.eachNode(function(n){t.node(n).rank-=e})}var r=new o(t.nodes()),s=new a;if(1===r.size()){var u=t.nodes()[0];return s.addNode(u,{}),s.graph({root:u}),s}for(;r.size();){for(var l=s.order()?s.nodes():r.keys(),c=0,h=l.length;h>c&&e(l[c]);++c);r.size()&&n()}return s}function i(t,e,n){var r=t.node(n).rank-t.node(e).rank,i=s.max(t.outEdges(e,n).map(function(e){return t.edge(e).minLen}));return r-i}var o=t("cp-data").Set,a=t("graphlib").Digraph,s=t("../util");e.exports=r},{"../util":17,"cp-data":19,graphlib:24}],14:[function(t,e,n){function r(t){var e=o(t);e.forEach(function(e){var n=t.inEdges(e);if(0===n.length)return void(t.node(e).rank=0);var r=n.map(function(e){return t.node(t.source(e)).rank+t.edge(e).minLen});t.node(e).rank=i.max(r)})}var i=t("../util"),o=t("graphlib").alg.topsort;e.exports=r},{"../util":17,graphlib:24}],15:[function(t,e,n){function r(t,e,n,r){return Math.abs(t.node(e).rank-t.node(n).rank)-r}e.exports={slack:r}},{}],16:[function(t,e,n){function r(t,e){for(i(t,e);;){var n=u(e);if(null===n)break;var r=l(t,e,n);c(t,e,n,r)}}function i(t,e){function n(r){var i=e.successors(r);for(var o in i){var s=i[o];n(s)}r!==e.graph().root&&a(t,e,r)}o(e),e.eachEdge(function(t,e,n,r){r.cutValue=0}),n(e.graph().root)}function o(t){function e(r){var i=t.successors(r),o=n;for(var a in i){var s=i[a];e(s),o=Math.min(o,t.node(s).low)}t.node(r).low=o,t.node(r).lim=n++}var n=0;e(t.graph().root)}function a(t,e,n){var r=e.inEdges(n)[0],i=[],o=e.outEdges(n);for(var a in o)i.push(e.target(o[a]));var u,l=0,c=0,h=0,f=0,d=0,p=t.outEdges(n);for(var g in p){var m=t.target(p[g]);for(u in i)s(e,m,i[u])&&c++;s(e,m,n)||f++}var v=t.inEdges(n);for(var y in v){var b=t.source(v[y]);for(u in i)s(e,b,i[u])&&h++;s(e,b,n)||d++}var _=0;for(u in i){var x=e.edge(o[u]).cutValue;e.edge(o[u]).reversed?_-=x:_+=x}e.edge(r).reversed?l-=_-c+h-f+d:l+=_-c+h-f+d,e.edge(r).cutValue=l}function s(t,e,n){return t.node(n).low<=t.node(e).lim&&t.node(e).lim<=t.node(n).lim}function u(t){var e=t.edges();for(var n in e){var r=e[n],i=t.edge(r);if(i.cutValue<0)return r}return null}function l(t,e,n){var r,i=e.source(n),o=e.target(n),a=e.node(o).lim<e.node(i).lim?o:i,u=!e.edge(n).reversed,l=Number.POSITIVE_INFINITY;if(u?t.eachEdge(function(i,o,u,c){if(i!==n&&s(e,o,a)&&!s(e,u,a)){var h=p.slack(t,o,u,c.minLen);l>h&&(l=h,r=i)}}):t.eachEdge(function(i,o,u,c){if(i!==n&&!s(e,o,a)&&s(e,u,a)){var h=p.slack(t,o,u,c.minLen);l>h&&(l=h,r=i)}}),void 0===r){var c=[],h=[];throw t.eachNode(function(t){s(e,t,a)?h.push(t):c.push(t)}),new Error("No edge found from outside of tree to inside")}return r}function c(t,e,n,r){function o(t){var n=e.inEdges(t);for(var r in n){var i=n[r],a=e.source(i),s=e.edge(i);o(a),e.delEdge(i),s.reversed=!s.reversed,e.addEdge(i,t,a,s)}}e.delEdge(n);var a=t.source(r),s=t.target(r);o(s);for(var u=a,l=e.inEdges(u);l.length>0;)u=e.source(l[0]),l=e.inEdges(u);e.graph().root=u,e.addEdge(null,a,s,{cutValue:0}),i(t,e),h(t,e)}function h(t,e){function n(r){var i=e.successors(r);i.forEach(function(e){var i=f(t,r,e);t.node(e).rank=t.node(r).rank+i,n(e)})}n(e.graph().root)}function f(t,e,n){var r=t.outEdges(e,n);if(r.length>0)return d.max(r.map(function(e){return t.edge(e).minLen}));var i=t.inEdges(e,n);return i.length>0?-d.max(i.map(function(e){return t.edge(e).minLen})):void 0}var d=t("../util"),p=t("./rankUtil");e.exports=r},{"../util":17,"./rankUtil":15}],17:[function(t,e,n){function r(t,e){return function(){var n=(new Date).getTime();try{return e.apply(null,arguments)}finally{o(1,t+" time: "+((new Date).getTime()-n)+"ms")}}}function o(t){o.level>=t&&console.log.apply(console,Array.prototype.slice.call(arguments,1))}n.min=function(t){return Math.min.apply(Math,t)},n.max=function(t){return Math.max.apply(Math,t)},n.all=function(t,e){for(var n=0;n<t.length;++n)if(!e(t[n]))return!1;return!0},n.sum=function(t){return t.reduce(function(t,e){return t+e},0)},n.values=function(t){return Object.keys(t).map(function(e){return t[e]})},n.shuffle=function(t){for(i=t.length-1;i>0;--i){var e=Math.floor(Math.random()*(i+1)),n=t[e];t[e]=t[i],t[i]=n}},n.propertyAccessor=function(t,e,n,r){return function(i){return arguments.length?(e[n]=i,r&&r(i),t):e[n]}},n.ordering=function(t){var e=[];return t.eachNode(function(t,n){var r=e[n.rank]||(e[n.rank]=[]);r[n.order]=t}),e},n.filterNonSubgraphs=function(t){return function(e){return 0===t.children(e).length}},r.enabled=!1,n.time=r,o.level=0,n.log=o},{}],18:[function(t,e,n){e.exports="0.4.5"},{}],19:[function(t,e,n){n.Set=t("./lib/Set"),n.PriorityQueue=t("./lib/PriorityQueue"),n.version=t("./lib/version")},{"./lib/PriorityQueue":20,"./lib/Set":21,"./lib/version":23}],20:[function(t,e,n){function r(){this._arr=[],this._keyIndices={}}e.exports=r,r.prototype.size=function(){return this._arr.length},r.prototype.keys=function(){return this._arr.map(function(t){return t.key})},r.prototype.has=function(t){return t in this._keyIndices},r.prototype.priority=function(t){var e=this._keyIndices[t];return void 0!==e?this._arr[e].priority:void 0},r.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},r.prototype.add=function(t,e){var n=this._keyIndices;if(!(t in n)){var r=this._arr,i=r.length;return n[t]=i,r.push({key:t,priority:e}),this._decrease(i),!0}return!1},r.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},r.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},r.prototype._heapify=function(t){var e=this._arr,n=2*t,r=n+1,i=t;n<e.length&&(i=e[n].priority<e[i].priority?n:i,r<e.length&&(i=e[r].priority<e[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},r.prototype._decrease=function(t){for(var e,n=this._arr,r=n[t].priority;0!==t&&(e=t>>1,!(n[e].priority<r));)this._swap(t,e),t=e},r.prototype._swap=function(t,e){var n=this._arr,r=this._keyIndices,i=n[t],o=n[e];n[t]=o,n[e]=i,r[o.key]=t,r[i.key]=e}},{}],21:[function(t,e,n){function r(t){if(this._size=0,this._keys={},t)for(var e=0,n=t.length;n>e;++e)this.add(t[e])}function i(t){var e,n=Object.keys(t),r=n.length,i=new Array(r);for(e=0;r>e;++e)i[e]=t[n[e]];return i}var o=t("./util");e.exports=r,r.intersect=function(t){if(0===t.length)return new r;for(var e=new r(o.isArray(t[0])?t[0]:t[0].keys()),n=1,i=t.length;i>n;++n)for(var a=e.keys(),s=o.isArray(t[n])?new r(t[n]):t[n],u=0,l=a.length;l>u;++u){var c=a[u];s.has(c)||e.remove(c)}return e},r.union=function(t){for(var e=o.reduce(t,function(t,e){return t+(e.size?e.size():e.length)},0),n=new Array(e),i=0,a=0,s=t.length;s>a;++a)for(var u=t[a],l=o.isArray(u)?u:u.keys(),c=0,h=l.length;h>c;++c)n[i++]=l[c];return new r(n)},r.prototype.size=function(){return this._size},r.prototype.keys=function(){return i(this._keys)},r.prototype.has=function(t){return t in this._keys},r.prototype.add=function(t){return t in this._keys?!1:(this._keys[t]=t,++this._size,!0)},r.prototype.remove=function(t){return t in this._keys?(delete this._keys[t],--this._size,!0):!1}},{"./util":22}],22:[function(t,e,n){Array.isArray?n.isArray=Array.isArray:n.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},"function"!=typeof Array.prototype.reduce?n.reduce=function(t,e,n){"use strict";if(null===t||"undefined"==typeof t)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var r,i,o=t.length>>>0,a=!1;for(1<arguments.length&&(i=n,a=!0),r=0;o>r;++r)t.hasOwnProperty(r)&&(a?i=e(i,t[r],r,t):(i=t[r],a=!0));if(!a)throw new TypeError("Reduce of empty array with no initial value");return i}:n.reduce=function(t,e,n){return t.reduce(e,n)}},{}],23:[function(t,e,n){e.exports="1.1.3"},{}],24:[function(t,e,n){n.Graph=t("./lib/Graph"),n.Digraph=t("./lib/Digraph"),n.CGraph=t("./lib/CGraph"),n.CDigraph=t("./lib/CDigraph"),t("./lib/graph-converters"),n.alg={isAcyclic:t("./lib/alg/isAcyclic"),components:t("./lib/alg/components"),dijkstra:t("./lib/alg/dijkstra"),dijkstraAll:t("./lib/alg/dijkstraAll"),findCycles:t("./lib/alg/findCycles"),floydWarshall:t("./lib/alg/floydWarshall"),postorder:t("./lib/alg/postorder"),preorder:t("./lib/alg/preorder"),prim:t("./lib/alg/prim"),tarjan:t("./lib/alg/tarjan"),topsort:t("./lib/alg/topsort")},n.converter={json:t("./lib/converter/json.js")};var r=t("./lib/filter");n.filter={all:r.all,nodesFromList:r.nodesFromList},n.version=t("./lib/version")},{"./lib/CDigraph":26,"./lib/CGraph":27,"./lib/Digraph":28,"./lib/Graph":29,"./lib/alg/components":30,"./lib/alg/dijkstra":31,"./lib/alg/dijkstraAll":32,"./lib/alg/findCycles":33,"./lib/alg/floydWarshall":34,"./lib/alg/isAcyclic":35,"./lib/alg/postorder":36,"./lib/alg/preorder":37,"./lib/alg/prim":38,"./lib/alg/tarjan":39,"./lib/alg/topsort":40,"./lib/converter/json.js":42,"./lib/filter":43,"./lib/graph-converters":44,"./lib/version":46}],25:[function(t,e,n){function r(){this._value=void 0,this._nodes={},this._edges={},this._nextId=0}function i(t,e,n){(t[e]||(t[e]=new a)).add(n)}function o(t,e,n){var r=t[e];r.remove(n),0===r.size()&&delete t[e]}var a=t("cp-data").Set;e.exports=r,r.prototype.order=function(){return Object.keys(this._nodes).length},r.prototype.size=function(){return Object.keys(this._edges).length},r.prototype.graph=function(t){return 0===arguments.length?this._value:void(this._value=t)},r.prototype.hasNode=function(t){return t in this._nodes},r.prototype.node=function(t,e){var n=this._strictGetNode(t);return 1===arguments.length?n.value:void(n.value=e)},r.prototype.nodes=function(){var t=[];return this.eachNode(function(e){t.push(e)}),t},r.prototype.eachNode=function(t){for(var e in this._nodes){var n=this._nodes[e];t(n.id,n.value)}},r.prototype.hasEdge=function(t){return t in this._edges},r.prototype.edge=function(t,e){var n=this._strictGetEdge(t);return 1===arguments.length?n.value:void(n.value=e)},r.prototype.edges=function(){var t=[];return this.eachEdge(function(e){t.push(e)}),t},r.prototype.eachEdge=function(t){for(var e in this._edges){var n=this._edges[e];t(n.id,n.u,n.v,n.value)}},r.prototype.incidentNodes=function(t){var e=this._strictGetEdge(t);return[e.u,e.v]},r.prototype.addNode=function(t,e){if(void 0===t||null===t){do t="_"+ ++this._nextId;while(this.hasNode(t))}else if(this.hasNode(t))throw new Error("Graph already has node '"+t+"'");return this._nodes[t]={id:t,value:e},t},r.prototype.delNode=function(t){this._strictGetNode(t),this.incidentEdges(t).forEach(function(t){this.delEdge(t)},this),delete this._nodes[t]},r.prototype._addEdge=function(t,e,n,r,o,a){if(this._strictGetNode(e),this._strictGetNode(n),void 0===t||null===t){do t="_"+ ++this._nextId;while(this.hasEdge(t))}else if(this.hasEdge(t))throw new Error("Graph already has edge '"+t+"'");return this._edges[t]={id:t,u:e,v:n,value:r},i(o[n],e,t),i(a[e],n,t),t},r.prototype._delEdge=function(t,e,n){var r=this._strictGetEdge(t);o(e[r.v],r.u,t),o(n[r.u],r.v,t),delete this._edges[t]},r.prototype.copy=function(){var t=new this.constructor;return t.graph(this.graph()),this.eachNode(function(e,n){t.addNode(e,n)}),this.eachEdge(function(e,n,r,i){t.addEdge(e,n,r,i)}),t._nextId=this._nextId,t},r.prototype.filterNodes=function(t){var e=new this.constructor;return e.graph(this.graph()),this.eachNode(function(n,r){t(n)&&e.addNode(n,r)}),this.eachEdge(function(t,n,r,i){e.hasNode(n)&&e.hasNode(r)&&e.addEdge(t,n,r,i)}),e},r.prototype._strictGetNode=function(t){var e=this._nodes[t];if(void 0===e)throw new Error("Node '"+t+"' is not in graph");return e},r.prototype._strictGetEdge=function(t){var e=this._edges[t];if(void 0===e)throw new Error("Edge '"+t+"' is not in graph");return e}},{"cp-data":19}],26:[function(t,e,n){var r=t("./Digraph"),i=t("./compoundify"),o=i(r);e.exports=o,o.fromDigraph=function(t){var e=new o,n=t.graph();return void 0!==n&&e.graph(n),t.eachNode(function(t,n){void 0===n?e.addNode(t):e.addNode(t,n)}),t.eachEdge(function(t,n,r,i){void 0===i?e.addEdge(null,n,r):e.addEdge(null,n,r,i)}),e},o.prototype.toString=function(){return"CDigraph "+JSON.stringify(this,null,2)}},{"./Digraph":28,"./compoundify":41}],27:[function(t,e,n){var r=t("./Graph"),i=t("./compoundify"),o=i(r);e.exports=o,o.fromGraph=function(t){var e=new o,n=t.graph();return void 0!==n&&e.graph(n),t.eachNode(function(t,n){void 0===n?e.addNode(t):e.addNode(t,n)}),t.eachEdge(function(t,n,r,i){void 0===i?e.addEdge(null,n,r):e.addEdge(null,n,r,i)}),e},o.prototype.toString=function(){return"CGraph "+JSON.stringify(this,null,2)}},{"./Graph":29,"./compoundify":41}],28:[function(t,e,n){function r(){o.call(this),this._inEdges={},this._outEdges={}}var i=t("./util"),o=t("./BaseGraph"),a=t("cp-data").Set;e.exports=r,r.prototype=new o,r.prototype.constructor=r,r.prototype.isDirected=function(){return!0},r.prototype.successors=function(t){return this._strictGetNode(t),Object.keys(this._outEdges[t]).map(function(t){return this._nodes[t].id},this)},r.prototype.predecessors=function(t){return this._strictGetNode(t),Object.keys(this._inEdges[t]).map(function(t){return this._nodes[t].id},this)},r.prototype.neighbors=function(t){return a.union([this.successors(t),this.predecessors(t)]).keys()},r.prototype.sources=function(){var t=this;return this._filterNodes(function(e){return 0===t.inEdges(e).length})},r.prototype.sinks=function(){var t=this;return this._filterNodes(function(e){return 0===t.outEdges(e).length})},r.prototype.source=function(t){return this._strictGetEdge(t).u},r.prototype.target=function(t){return this._strictGetEdge(t).v},r.prototype.inEdges=function(t,e){this._strictGetNode(t);var n=a.union(i.values(this._inEdges[t])).keys();return arguments.length>1&&(this._strictGetNode(e),n=n.filter(function(t){return this.source(t)===e},this)),n},r.prototype.outEdges=function(t,e){this._strictGetNode(t);var n=a.union(i.values(this._outEdges[t])).keys();return arguments.length>1&&(this._strictGetNode(e),n=n.filter(function(t){return this.target(t)===e},this)),n},r.prototype.incidentEdges=function(t,e){return arguments.length>1?a.union([this.outEdges(t,e),this.outEdges(e,t)]).keys():a.union([this.inEdges(t),this.outEdges(t)]).keys()},r.prototype.toString=function(){return"Digraph "+JSON.stringify(this,null,2)},r.prototype.addNode=function(t,e){return t=o.prototype.addNode.call(this,t,e),this._inEdges[t]={},this._outEdges[t]={},t},r.prototype.delNode=function(t){
o.prototype.delNode.call(this,t),delete this._inEdges[t],delete this._outEdges[t]},r.prototype.addEdge=function(t,e,n,r){return o.prototype._addEdge.call(this,t,e,n,r,this._inEdges,this._outEdges)},r.prototype.delEdge=function(t){o.prototype._delEdge.call(this,t,this._inEdges,this._outEdges)},r.prototype._filterNodes=function(t){var e=[];return this.eachNode(function(n){t(n)&&e.push(n)}),e}},{"./BaseGraph":25,"./util":45,"cp-data":19}],29:[function(t,e,n){function r(){o.call(this),this._incidentEdges={}}var i=t("./util"),o=t("./BaseGraph"),a=t("cp-data").Set;e.exports=r,r.prototype=new o,r.prototype.constructor=r,r.prototype.isDirected=function(){return!1},r.prototype.neighbors=function(t){return this._strictGetNode(t),Object.keys(this._incidentEdges[t]).map(function(t){return this._nodes[t].id},this)},r.prototype.incidentEdges=function(t,e){return this._strictGetNode(t),arguments.length>1?(this._strictGetNode(e),e in this._incidentEdges[t]?this._incidentEdges[t][e].keys():[]):a.union(i.values(this._incidentEdges[t])).keys()},r.prototype.toString=function(){return"Graph "+JSON.stringify(this,null,2)},r.prototype.addNode=function(t,e){return t=o.prototype.addNode.call(this,t,e),this._incidentEdges[t]={},t},r.prototype.delNode=function(t){o.prototype.delNode.call(this,t),delete this._incidentEdges[t]},r.prototype.addEdge=function(t,e,n,r){return o.prototype._addEdge.call(this,t,e,n,r,this._incidentEdges,this._incidentEdges)},r.prototype.delEdge=function(t){o.prototype._delEdge.call(this,t,this._incidentEdges,this._incidentEdges)}},{"./BaseGraph":25,"./util":45,"cp-data":19}],30:[function(t,e,n){function r(t){function e(n,i){r.has(n)||(r.add(n),i.push(n),t.neighbors(n).forEach(function(t){e(t,i)}))}var n=[],r=new i;return t.nodes().forEach(function(t){var r=[];e(t,r),r.length>0&&n.push(r)}),n}var i=t("cp-data").Set;e.exports=r},{"cp-data":19}],31:[function(t,e,n){function r(t,e,n,r){function o(e){var r=t.incidentNodes(e),i=r[0]!==u?r[0]:r[1],o=a[i],c=n(e),h=l.distance+c;if(0>c)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+c);h<o.distance&&(o.distance=h,o.predecessor=u,s.decrease(i,h))}var a={},s=new i;n=n||function(){return 1},r=r||(t.isDirected()?function(e){return t.outEdges(e)}:function(e){return t.incidentEdges(e)}),t.eachNode(function(t){var n=t===e?0:Number.POSITIVE_INFINITY;a[t]={distance:n},s.add(t,n)});for(var u,l;s.size()>0&&(u=s.removeMin(),l=a[u],l.distance!==Number.POSITIVE_INFINITY);)r(u).forEach(o);return a}var i=t("cp-data").PriorityQueue;e.exports=r},{"cp-data":19}],32:[function(t,e,n){function r(t,e,n){var r={};return t.eachNode(function(o){r[o]=i(t,o,e,n)}),r}var i=t("./dijkstra");e.exports=r},{"./dijkstra":31}],33:[function(t,e,n){function r(t){return i(t).filter(function(t){return t.length>1})}var i=t("./tarjan");e.exports=r},{"./tarjan":39}],34:[function(t,e,n){function r(t,e,n){var r={},i=t.nodes();return e=e||function(){return 1},n=n||(t.isDirected()?function(e){return t.outEdges(e)}:function(e){return t.incidentEdges(e)}),i.forEach(function(o){r[o]={},r[o][o]={distance:0},i.forEach(function(t){o!==t&&(r[o][t]={distance:Number.POSITIVE_INFINITY})}),n(o).forEach(function(n){var i=t.incidentNodes(n),a=i[0]!==o?i[0]:i[1],s=e(n);s<r[o][a].distance&&(r[o][a]={distance:s,predecessor:o})})}),i.forEach(function(t){var e=r[t];i.forEach(function(n){var o=r[n];i.forEach(function(n){var r=o[t],i=e[n],a=o[n],s=r.distance+i.distance;s<a.distance&&(a.distance=s,a.predecessor=i.predecessor)})})}),r}e.exports=r},{}],35:[function(t,e,n){function r(t){try{i(t)}catch(e){if(e instanceof i.CycleException)return!1;throw e}return!0}var i=t("./topsort");e.exports=r},{"./topsort":40}],36:[function(t,e,n){function r(t,e,n){function r(e,i){if(o.has(e))throw new Error("The input graph is not a tree: "+t);o.add(e),t.neighbors(e).forEach(function(t){t!==i&&r(t,e)}),n(e)}var o=new i;if(t.isDirected())throw new Error("This function only works for undirected graphs");r(e)}var i=t("cp-data").Set;e.exports=r},{"cp-data":19}],37:[function(t,e,n){function r(t,e,n){function r(e,i){if(o.has(e))throw new Error("The input graph is not a tree: "+t);o.add(e),n(e),t.neighbors(e).forEach(function(t){t!==i&&r(t,e)})}var o=new i;if(t.isDirected())throw new Error("This function only works for undirected graphs");r(e)}var i=t("cp-data").Set;e.exports=r},{"cp-data":19}],38:[function(t,e,n){function r(t,e){function n(n){var i=t.incidentNodes(n),o=i[0]!==r?i[0]:i[1],a=u.priority(o);if(void 0!==a){var l=e(n);a>l&&(s[o]=r,u.decrease(o,l))}}var r,a=new i,s={},u=new o;if(0===t.order())return a;t.eachNode(function(t){u.add(t,Number.POSITIVE_INFINITY),a.addNode(t)}),u.decrease(t.nodes()[0],0);for(var l=!1;u.size()>0;){if(r=u.removeMin(),r in s)a.addEdge(null,r,s[r]);else{if(l)throw new Error("Input graph is not connected: "+t);l=!0}t.incidentEdges(r).forEach(n)}return a}var i=t("../Graph"),o=t("cp-data").PriorityQueue;e.exports=r},{"../Graph":29,"cp-data":19}],39:[function(t,e,n){function r(t){function e(a){var s=i[a]={onStack:!0,lowlink:n,index:n++};if(r.push(a),t.successors(a).forEach(function(t){t in i?i[t].onStack&&(s.lowlink=Math.min(s.lowlink,i[t].index)):(e(t),s.lowlink=Math.min(s.lowlink,i[t].lowlink))}),s.lowlink===s.index){var u,l=[];do u=r.pop(),i[u].onStack=!1,l.push(u);while(a!==u);o.push(l)}}if(!t.isDirected())throw new Error("tarjan can only be applied to a directed graph. Bad input: "+t);var n=0,r=[],i={},o=[];return t.nodes().forEach(function(t){t in i||e(t)}),o}e.exports=r},{}],40:[function(t,e,n){function r(t){function e(a){if(a in r)throw new i;a in n||(r[a]=!0,n[a]=!0,t.predecessors(a).forEach(function(t){e(t)}),delete r[a],o.push(a))}if(!t.isDirected())throw new Error("topsort can only be applied to a directed graph. Bad input: "+t);var n={},r={},o=[],a=t.sinks();if(0!==t.order()&&0===a.length)throw new i;return t.sinks().forEach(function(t){e(t)}),o}function i(){}e.exports=r,r.CycleException=i,i.prototype.toString=function(){return"Graph has at least one cycle"}},{}],41:[function(t,e,n){function r(t){function e(){t.call(this),this._parents={},this._children={},this._children[null]=new i}return e.prototype=new t,e.prototype.constructor=e,e.prototype.parent=function(t,e){if(this._strictGetNode(t),arguments.length<2)return this._parents[t];if(t===e)throw new Error("Cannot make "+t+" a parent of itself");null!==e&&this._strictGetNode(e),this._children[this._parents[t]].remove(t),this._parents[t]=e,this._children[e].add(t)},e.prototype.children=function(t){return null!==t&&this._strictGetNode(t),this._children[t].keys()},e.prototype.addNode=function(e,n){return e=t.prototype.addNode.call(this,e,n),this._parents[e]=null,this._children[e]=new i,this._children[null].add(e),e},e.prototype.delNode=function(e){var n=this.parent(e);return this._children[e].keys().forEach(function(t){this.parent(t,n)},this),this._children[n].remove(e),delete this._parents[e],delete this._children[e],t.prototype.delNode.call(this,e)},e.prototype.copy=function(){var e=t.prototype.copy.call(this);return this.nodes().forEach(function(t){e.parent(t,this.parent(t))},this),e},e.prototype.filterNodes=function(e){function n(t){var e=r.parent(t);return null===e||i.hasNode(e)?(o[t]=e,e):e in o?o[e]:n(e)}var r=this,i=t.prototype.filterNodes.call(this,e),o={};return i.eachNode(function(t){i.parent(t,n(t))}),i},e}var i=t("cp-data").Set;e.exports=r},{"cp-data":19}],42:[function(t,e,n){function r(t){return Object.prototype.toString.call(t).slice(8,-1)}var i=t("../Graph"),o=t("../Digraph"),a=t("../CGraph"),s=t("../CDigraph");n.decode=function(t,e,n){if(n=n||o,"Array"!==r(t))throw new Error("nodes is not an Array");if("Array"!==r(e))throw new Error("edges is not an Array");if("string"==typeof n)switch(n){case"graph":n=i;break;case"digraph":n=o;break;case"cgraph":n=a;break;case"cdigraph":n=s;break;default:throw new Error("Unrecognized graph type: "+n)}var u=new n;return t.forEach(function(t){u.addNode(t.id,t.value)}),u.parent&&t.forEach(function(t){t.children&&t.children.forEach(function(e){u.parent(e,t.id)})}),e.forEach(function(t){u.addEdge(t.id,t.u,t.v,t.value)}),u},n.encode=function(t){var e=[],n=[];t.eachNode(function(n,r){var i={id:n,value:r};if(t.children){var o=t.children(n);o.length&&(i.children=o)}e.push(i)}),t.eachEdge(function(t,e,r,i){n.push({id:t,u:e,v:r,value:i})});var r;if(t instanceof s)r="cdigraph";else if(t instanceof a)r="cgraph";else if(t instanceof o)r="digraph";else{if(!(t instanceof i))throw new Error("Couldn't determine type of graph: "+t);r="graph"}return{nodes:e,edges:n,type:r}}},{"../CDigraph":26,"../CGraph":27,"../Digraph":28,"../Graph":29}],43:[function(t,e,n){var r=t("cp-data").Set;n.all=function(){return function(){return!0}},n.nodesFromList=function(t){var e=new r(t);return function(t){return e.has(t)}}},{"cp-data":19}],44:[function(t,e,n){var r=t("./Graph"),i=t("./Digraph");r.prototype.toDigraph=r.prototype.asDirected=function(){var t=new i;return this.eachNode(function(e,n){t.addNode(e,n)}),this.eachEdge(function(e,n,r,i){t.addEdge(null,n,r,i),t.addEdge(null,r,n,i)}),t},i.prototype.toGraph=i.prototype.asUndirected=function(){var t=new r;return this.eachNode(function(e,n){t.addNode(e,n)}),this.eachEdge(function(e,n,r,i){t.addEdge(e,n,r,i)}),t}},{"./Digraph":28,"./Graph":29}],45:[function(t,e,n){n.values=function(t){var e,n=Object.keys(t),r=n.length,i=new Array(r);for(e=0;r>e;++e)i[e]=t[n[e]];return i}},{}],46:[function(t,e,n){e.exports="0.7.4"},{}]},{},[1]),joint.layout.DirectedGraph={layout:function(t,e){e=e||{};var n=this._prepareData(t),r=dagre.layout();e.debugLevel&&r.debugLevel(e.debugLevel),e.rankDir&&r.rankDir(e.rankDir),e.rankSep&&r.rankSep(e.rankSep),e.edgeSep&&r.edgeSep(e.edgeSep),e.nodeSep&&r.nodeSep(e.nodeSep);var i=r.run(n);return i.eachNode(function(n,r){if(!r.dummy){var i=t.getCell(n);e.setPosition?e.setPosition(i,r):t.get("cells").get(n).set("position",{x:r.x-r.width/2,y:r.y-r.height/2})}}),e.setLinkVertices&&i.eachEdge(function(n,r,i,o){var a=t.getCell(n);a&&(e.setVertices?e.setVertices(a,o.points):a.set("vertices",o.points))}),{width:i.graph().width,height:i.graph().height}},_prepareData:function(t){var e=new dagre.Digraph;return _.each(t.getElements(),function(t){e.hasNode(t.id)||e.addNode(t.id,{width:t.get("size").width,height:t.get("size").height,rank:t.get("rank")})}),_.each(t.getLinks(),function(t){if(!e.hasEdge(t.id)){var n=t.get("source").id,r=t.get("target").id;e.addEdge(t.id,n,r,{minLen:t.get("minLen")||1})}}),e}},function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(t.jQuery)}(this,function(t){function e(t){if(t in h.style)return t;for(var e=["Moz","Webkit","O","ms"],n=t.charAt(0).toUpperCase()+t.substr(1),r=0;r<e.length;++r){var i=e[r]+n;if(i in h.style)return i}}function n(){return h.style[f.transform]="",h.style[f.transform]="rotateY(90deg)",""!==h.style[f.transform]}function r(t){return"string"==typeof t&&this.parse(t),this}function i(t,e,n){e===!0?t.queue(n):e?t.queue(e,n):t.each(function(){n.call(this)})}function o(e){var n=[];return t.each(e,function(e){e=t.camelCase(e),e=t.transit.propertyMap[e]||t.cssProps[e]||e,e=u(e),f[e]&&(e=u(f[e])),-1===t.inArray(e,n)&&n.push(e)}),n}function a(e,n,r,i){var a=o(e);t.cssEase[r]&&(r=t.cssEase[r]);var s=""+c(n)+" "+r;parseInt(i,10)>0&&(s+=" "+c(i));var u=[];return t.each(a,function(t,e){u.push(e+" "+s)}),u.join(", ")}function s(e,n){n||(t.cssNumber[e]=!0),t.transit.propertyMap[e]=f.transform,t.cssHooks[e]={get:function(n){var r=t(n).css("transit:transform");return r.get(e)},set:function(n,r){var i=t(n).css("transit:transform");i.setFromString(e,r),t(n).css({"transit:transform":i})}}}function u(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}function l(t,e){return"string"!=typeof t||t.match(/^[\-0-9\.]+$/)?""+t+e:t}function c(e){var n=e;return"string"!=typeof n||n.match(/^[\-0-9\.]+/)||(n=t.fx.speeds[n]||t.fx.speeds._default),l(n,"ms")}t.transit={version:"0.9.12",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var h=document.createElement("div"),f={},d=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;f.transition=e("transition"),f.transitionDelay=e("transitionDelay"),f.transform=e("transform"),f.transformOrigin=e("transformOrigin"),f.filter=e("Filter"),f.transform3d=n();var p={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},g=f.transitionEnd=p[f.transition]||null;for(var m in f)f.hasOwnProperty(m)&&"undefined"==typeof t.support[m]&&(t.support[m]=f[m]);return h=null,t.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeInCubic:"cubic-bezier(.550,.055,.675,.190)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},t.cssHooks["transit:transform"]={get:function(e){return t(e).data("transform")||new r},set:function(e,n){var i=n;i instanceof r||(i=new r(i)),"WebkitTransform"!==f.transform||d?e.style[f.transform]=i.toString():e.style[f.transform]=i.toString(!0),t(e).data("transform",i)}},t.cssHooks.transform={set:t.cssHooks["transit:transform"].set},t.cssHooks.filter={get:function(t){return t.style[f.filter]},set:function(t,e){t.style[f.filter]=e}},t.fn.jquery<"1.8"&&(t.cssHooks.transformOrigin={get:function(t){return t.style[f.transformOrigin]},set:function(t,e){t.style[f.transformOrigin]=e}},t.cssHooks.transition={get:function(t){return t.style[f.transition]},set:function(t,e){t.style[f.transition]=e}}),s("scale"),s("scaleX"),s("scaleY"),s("translate"),s("rotate"),s("rotateX"),s("rotateY"),s("rotate3d"),s("perspective"),s("skewX"),s("skewY"),s("x",!0),s("y",!0),r.prototype={setFromString:function(t,e){var n="string"==typeof e?e.split(","):e.constructor===Array?e:[e];n.unshift(t),r.prototype.set.apply(this,n)},set:function(t){var e=Array.prototype.slice.apply(arguments,[1]);this.setter[t]?this.setter[t].apply(this,e):this[t]=e.join(",")},get:function(t){return this.getter[t]?this.getter[t].apply(this):this[t]||0},setter:{rotate:function(t){this.rotate=l(t,"deg")},rotateX:function(t){this.rotateX=l(t,"deg")},rotateY:function(t){this.rotateY=l(t,"deg")},scale:function(t,e){void 0===e&&(e=t),this.scale=t+","+e},skewX:function(t){this.skewX=l(t,"deg")},skewY:function(t){this.skewY=l(t,"deg")},perspective:function(t){this.perspective=l(t,"px")},x:function(t){this.set("translate",t,null)},y:function(t){this.set("translate",null,t)},translate:function(t,e){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==t&&void 0!==t&&(this._translateX=l(t,"px")),null!==e&&void 0!==e&&(this._translateY=l(e,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var t=(this.scale||"1,1").split(",");return t[0]&&(t[0]=parseFloat(t[0])),t[1]&&(t[1]=parseFloat(t[1])),t[0]===t[1]?t[0]:t},rotate3d:function(){for(var t=(this.rotate3d||"0,0,0,0deg").split(","),e=0;3>=e;++e)t[e]&&(t[e]=parseFloat(t[e]));return t[3]&&(t[3]=l(t[3],"deg")),t}},parse:function(t){var e=this;t.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(t,n,r){e.setFromString(n,r)})},toString:function(t){var e=[];for(var n in this)if(this.hasOwnProperty(n)){if(!f.transform3d&&("rotateX"===n||"rotateY"===n||"perspective"===n||"transformOrigin"===n))continue;"_"!==n[0]&&(t&&"scale"===n?e.push(n+"3d("+this[n]+",1)"):t&&"translate"===n?e.push(n+"3d("+this[n]+",0)"):e.push(n+"("+this[n]+")"))}return e.join(" ")}},t.fn.transition=t.fn.transit=function(e,n,r,o){var s=this,u=0,l=!0,h=t.extend(!0,{},e);"function"==typeof n&&(o=n,n=void 0),"object"==typeof n&&(r=n.easing,u=n.delay||0,l="undefined"==typeof n.queue?!0:n.queue,o=n.complete,n=n.duration),"function"==typeof r&&(o=r,r=void 0),"undefined"!=typeof h.easing&&(r=h.easing,delete h.easing),"undefined"!=typeof h.duration&&(n=h.duration,delete h.duration),"undefined"!=typeof h.complete&&(o=h.complete,delete h.complete),"undefined"!=typeof h.queue&&(l=h.queue,delete h.queue),"undefined"!=typeof h.delay&&(u=h.delay,delete h.delay),"undefined"==typeof n&&(n=t.fx.speeds._default),"undefined"==typeof r&&(r=t.cssEase._default),n=c(n);var d=a(h,n,r,u),p=t.transit.enabled&&f.transition,m=p?parseInt(n,10)+parseInt(u,10):0;if(0===m){var v=function(t){s.css(h),o&&o.apply(s),t&&t()};return i(s,l,v),s}var y={},b=function(e){var n=!1,r=function(){n&&s.unbind(g,r),m>0&&s.each(function(){this.style[f.transition]=y[this]||null}),"function"==typeof o&&o.apply(s),"function"==typeof e&&e()};m>0&&g&&t.transit.useTransitionEnd?(n=!0,s.bind(g,r)):window.setTimeout(r,m),s.each(function(){m>0&&(this.style[f.transition]=d),t(this).css(h)})},_=function(t){this.offsetWidth,b(t)};return i(s,l,_),this},t.transit.getTransitionValue=a,t}),!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(t.jQuery)}(this,function(t){"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e});var e={init:function(e){return this.options=t.extend({},t.noty.defaults,e),this.options.layout=this.options.custom?t.noty.layouts.inline:t.noty.layouts[this.options.layout],t.noty.themes[this.options.theme]?this.options.theme=t.noty.themes[this.options.theme]:e.themeClassName=this.options.theme,delete e.layout,delete e.theme,this.options=t.extend({},this.options,this.options.layout.options),this.options.id="noty_"+(new Date).getTime()*Math.floor(1e6*Math.random()),this.options=t.extend({},this.options,e),this._build(),this},_build:function(){var e=t('<div class="noty_bar noty_type_'+this.options.type+'"></div>').attr("id",this.options.id);if(e.append(this.options.template).find(".noty_text").html(this.options.text),this.$bar=null!==this.options.layout.parent.object?t(this.options.layout.parent.object).css(this.options.layout.parent.css).append(e):e,this.options.themeClassName&&this.$bar.addClass(this.options.themeClassName).addClass("noty_container_type_"+this.options.type),this.options.buttons){this.options.closeWith=[],this.options.timeout=!1;var n=t("<div/>").addClass("noty_buttons");null!==this.options.layout.parent.object?this.$bar.find(".noty_bar").append(n):this.$bar.append(n);var r=this;t.each(this.options.buttons,function(e,n){var i=t("<button/>").addClass(n.addClass?n.addClass:"gray").html(n.text).attr("id",n.id?n.id:"button-"+e).appendTo(r.$bar.find(".noty_buttons")).on("click",function(e){t.isFunction(n.onClick)&&n.onClick.call(i,r,e)})})}this.$message=this.$bar.find(".noty_message"),this.$closeButton=this.$bar.find(".noty_close"),this.$buttons=this.$bar.find(".noty_buttons"),t.noty.store[this.options.id]=this},show:function(){var e=this;return e.options.custom?e.options.custom.find(e.options.layout.container.selector).append(e.$bar):t(e.options.layout.container.selector).append(e.$bar),e.options.theme&&e.options.theme.style&&e.options.theme.style.apply(e),"function"===t.type(e.options.layout.css)?this.options.layout.css.apply(e.$bar):e.$bar.css(this.options.layout.css||{}),e.$bar.addClass(e.options.layout.addClass),e.options.layout.container.style.apply(t(e.options.layout.container.selector)),e.showing=!0,e.options.theme&&e.options.theme.style&&e.options.theme.callback.onShow.apply(this),t.inArray("click",e.options.closeWith)>-1&&e.$bar.css("cursor","pointer").one("click",function(t){e.stopPropagation(t),e.options.callback.onCloseClick&&e.options.callback.onCloseClick.apply(e),e.close()}),t.inArray("hover",e.options.closeWith)>-1&&e.$bar.one("mouseenter",function(){e.close()}),t.inArray("button",e.options.closeWith)>-1&&e.$closeButton.one("click",function(t){e.stopPropagation(t),e.close()}),-1==t.inArray("button",e.options.closeWith)&&e.$closeButton.remove(),e.options.callback.onShow&&e.options.callback.onShow.apply(e),"string"==typeof e.options.animation.open?(e.$bar.css("height",e.$bar.innerHeight()),e.$bar.show().addClass(e.options.animation.open).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.options.callback.afterShow&&e.options.callback.afterShow.apply(e),e.showing=!1,e.shown=!0})):e.$bar.animate(e.options.animation.open,e.options.animation.speed,e.options.animation.easing,function(){e.options.callback.afterShow&&e.options.callback.afterShow.apply(e),e.showing=!1,e.shown=!0}),e.options.timeout&&e.$bar.delay(e.options.timeout).promise().done(function(){e.close()}),this},close:function(){if(!(this.closed||this.$bar&&this.$bar.hasClass("i-am-closing-now"))){var e=this;if(this.showing)return void e.$bar.queue(function(){e.close.apply(e)});if(!this.shown&&!this.showing){var n=[];return t.each(t.noty.queue,function(t,r){r.options.id!=e.options.id&&n.push(r)}),void(t.noty.queue=n)}e.$bar.addClass("i-am-closing-now"),e.options.callback.onClose&&e.options.callback.onClose.apply(e),"string"==typeof e.options.animation.close?e.$bar.addClass(e.options.animation.close).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.options.callback.afterClose&&e.options.callback.afterClose.apply(e),e.closeCleanUp()}):e.$bar.clearQueue().stop().animate(e.options.animation.close,e.options.animation.speed,e.options.animation.easing,function(){e.options.callback.afterClose&&e.options.callback.afterClose.apply(e)}).promise().done(function(){e.closeCleanUp()})}},closeCleanUp:function(){var e=this;e.options.modal&&(t.notyRenderer.setModalCount(-1),0==t.notyRenderer.getModalCount()&&t(".noty_modal").fadeOut("fast",function(){t(this).remove()})),t.notyRenderer.setLayoutCountFor(e,-1),0==t.notyRenderer.getLayoutCountFor(e)&&t(e.options.layout.container.selector).remove(),"undefined"!=typeof e.$bar&&null!==e.$bar&&("string"==typeof e.options.animation.close?(e.$bar.css("transition","all 100ms ease").css("border",0).css("margin",0).height(0),e.$bar.one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){e.$bar.remove(),e.$bar=null,e.closed=!0,e.options.theme.callback&&e.options.theme.callback.onClose&&e.options.theme.callback.onClose.apply(e)})):(e.$bar.remove(),e.$bar=null,e.closed=!0)),delete t.noty.store[e.options.id],e.options.theme.callback&&e.options.theme.callback.onClose&&e.options.theme.callback.onClose.apply(e),e.options.dismissQueue||(t.noty.ontap=!0,t.notyRenderer.render()),e.options.maxVisible>0&&e.options.dismissQueue&&t.notyRenderer.render()},setText:function(t){return this.closed||(this.options.text=t,this.$bar.find(".noty_text").html(t)),this},setType:function(t){return this.closed||(this.options.type=t,this.options.theme.style.apply(this),this.options.theme.callback.onShow.apply(this)),this},setTimeout:function(t){if(!this.closed){var e=this;this.options.timeout=t,e.$bar.delay(e.options.timeout).promise().done(function(){e.close()})}return this},stopPropagation:function(t){t=t||window.event,"undefined"!=typeof t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},closed:!1,showing:!1,shown:!1};t.notyRenderer={},t.notyRenderer.init=function(n){var r=Object.create(e).init(n);return r.options.killer&&t.noty.closeAll(),r.options.force?t.noty.queue.unshift(r):t.noty.queue.push(r),t.notyRenderer.render(),"object"==t.noty.returns?r:r.options.id},t.notyRenderer.render=function(){var e=t.noty.queue[0];"object"===t.type(e)?e.options.dismissQueue?e.options.maxVisible>0?t(e.options.layout.container.selector+" li").length<e.options.maxVisible&&t.notyRenderer.show(t.noty.queue.shift()):t.notyRenderer.show(t.noty.queue.shift()):t.noty.ontap&&(t.notyRenderer.show(t.noty.queue.shift()),t.noty.ontap=!1):t.noty.ontap=!0},t.notyRenderer.show=function(e){e.options.modal&&(t.notyRenderer.createModalFor(e),t.notyRenderer.setModalCount(1)),e.options.custom?0==e.options.custom.find(e.options.layout.container.selector).length?e.options.custom.append(t(e.options.layout.container.object).addClass("i-am-new")):e.options.custom.find(e.options.layout.container.selector).removeClass("i-am-new"):0==t(e.options.layout.container.selector).length?t("body").append(t(e.options.layout.container.object).addClass("i-am-new")):t(e.options.layout.container.selector).removeClass("i-am-new"),t.notyRenderer.setLayoutCountFor(e,1),e.show()},t.notyRenderer.createModalFor=function(e){if(0==t(".noty_modal").length){var n=t("<div/>").addClass("noty_modal").addClass(e.options.theme).data("noty_modal_count",0);e.options.theme.modal&&e.options.theme.modal.css&&n.css(e.options.theme.modal.css),n.prependTo(t("body")).fadeIn("fast"),t.inArray("backdrop",e.options.closeWith)>-1&&n.on("click",function(e){t.noty.closeAll()})}},t.notyRenderer.getLayoutCountFor=function(e){return t(e.options.layout.container.selector).data("noty_layout_count")||0},t.notyRenderer.setLayoutCountFor=function(e,n){return t(e.options.layout.container.selector).data("noty_layout_count",t.notyRenderer.getLayoutCountFor(e)+n)},t.notyRenderer.getModalCount=function(){return t(".noty_modal").data("noty_modal_count")||0},t.notyRenderer.setModalCount=function(e){return t(".noty_modal").data("noty_modal_count",t.notyRenderer.getModalCount()+e)},t.fn.noty=function(e){return e.custom=t(this),t.notyRenderer.init(e)},t.noty={},t.noty.queue=[],t.noty.ontap=!0,t.noty.layouts={},t.noty.themes={},t.noty.returns="object",t.noty.store={},t.noty.get=function(e){return t.noty.store.hasOwnProperty(e)?t.noty.store[e]:!1},t.noty.close=function(e){return t.noty.get(e)?t.noty.get(e).close():!1},t.noty.setText=function(e,n){return t.noty.get(e)?t.noty.get(e).setText(n):!1},t.noty.setType=function(e,n){return t.noty.get(e)?t.noty.get(e).setType(n):!1},t.noty.clearQueue=function(){t.noty.queue=[]},t.noty.closeAll=function(){t.noty.clearQueue(),t.each(t.noty.store,function(t,e){e.close()})};var n=window.alert;return t.noty.consumeAlert=function(e){window.alert=function(n){e?e.text=n:e={text:n},t.notyRenderer.init(e)}},t.noty.stopConsumeAlert=function(){window.alert=n},t.noty.defaults={layout:"top",theme:"defaultTheme",type:"alert",text:"",dismissQueue:!0,template:'<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:500},timeout:!1,force:!1,modal:!1,maxVisible:5,killer:!1,closeWith:["click"],callback:{onShow:function(){},afterShow:function(){},onClose:function(){},afterClose:function(){},onCloseClick:function(){}},buttons:!1},t(window).on("resize",function(){t.each(t.noty.layouts,function(e,n){n.container.style.apply(t(n.container.selector))})}),window.noty=function(e){return t.notyRenderer.init(e)},t.noty.layouts.bottom={name:"bottom",options:{},container:{object:'<ul id="noty_bottom_layout_container" />',selector:"ul#noty_bottom_layout_container",style:function(){t(this).css({bottom:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""},t.noty.layouts.bottomCenter={name:"bottomCenter",options:{},container:{object:'<ul id="noty_bottomCenter_layout_container" />',selector:"ul#noty_bottomCenter_layout_container",style:function(){t(this).css({bottom:20,left:0,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),t(this).css({left:(t(window).width()-t(this).outerWidth(!1))/2+"px"})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},t.noty.layouts.bottomLeft={name:"bottomLeft",options:{},container:{object:'<ul id="noty_bottomLeft_layout_container" />',selector:"ul#noty_bottomLeft_layout_container",style:function(){t(this).css({bottom:20,left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&t(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},t.noty.layouts.bottomRight={name:"bottomRight",options:{},container:{object:'<ul id="noty_bottomRight_layout_container" />',selector:"ul#noty_bottomRight_layout_container",style:function(){t(this).css({bottom:20,right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&t(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},t.noty.layouts.center={name:"center",options:{},container:{object:'<ul id="noty_center_layout_container" />',selector:"ul#noty_center_layout_container",style:function(){t(this).css({position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var e=t(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");t("body").append(e),e.find(".i-am-closing-now").remove(),e.find("li").css("display","block");var n=e.height();e.remove(),t(this).hasClass("i-am-new")?t(this).css({left:(t(window).width()-t(this).outerWidth(!1))/2+"px",top:(t(window).height()-n)/2+"px"}):t(this).animate({left:(t(window).width()-t(this).outerWidth(!1))/2+"px",top:(t(window).height()-n)/2+"px"},500)}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},t.noty.layouts.centerLeft={name:"centerLeft",options:{},container:{object:'<ul id="noty_centerLeft_layout_container" />',selector:"ul#noty_centerLeft_layout_container",style:function(){t(this).css({left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var e=t(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");t("body").append(e),e.find(".i-am-closing-now").remove(),e.find("li").css("display","block");var n=e.height();e.remove(),t(this).hasClass("i-am-new")?t(this).css({top:(t(window).height()-n)/2+"px"}):t(this).animate({top:(t(window).height()-n)/2+"px"},500),window.innerWidth<600&&t(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},t.noty.layouts.centerRight={name:"centerRight",options:{},container:{object:'<ul id="noty_centerRight_layout_container" />',selector:"ul#noty_centerRight_layout_container",style:function(){t(this).css({right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7});var e=t(this).clone().css({visibility:"hidden",display:"block",position:"absolute",top:0,left:0}).attr("id","dupe");t("body").append(e),e.find(".i-am-closing-now").remove(),e.find("li").css("display","block");var n=e.height();e.remove(),t(this).hasClass("i-am-new")?t(this).css({top:(t(window).height()-n)/2+"px"}):t(this).animate({top:(t(window).height()-n)/2+"px"},500),window.innerWidth<600&&t(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},t.noty.layouts.inline={name:"inline",options:{},container:{object:'<ul class="noty_inline_layout_container" />',selector:"ul.noty_inline_layout_container",style:function(){t(this).css({width:"100%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""},t.noty.layouts.top={name:"top",options:{},container:{object:'<ul id="noty_top_layout_container" />',selector:"ul#noty_top_layout_container",style:function(){t(this).css({top:0,left:"5%",position:"fixed",width:"90%",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:9999999})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none"},addClass:""},t.noty.layouts.topCenter={
name:"topCenter",options:{},container:{object:'<ul id="noty_topCenter_layout_container" />',selector:"ul#noty_topCenter_layout_container",style:function(){t(this).css({top:20,left:0,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),t(this).css({left:(t(window).width()-t(this).outerWidth(!1))/2+"px"})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},t.noty.layouts.topLeft={name:"topLeft",options:{},container:{object:'<ul id="noty_topLeft_layout_container" />',selector:"ul#noty_topLeft_layout_container",style:function(){t(this).css({top:20,left:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&t(this).css({left:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},t.noty.layouts.topRight={name:"topRight",options:{},container:{object:'<ul id="noty_topRight_layout_container" />',selector:"ul#noty_topRight_layout_container",style:function(){t(this).css({top:20,right:20,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),window.innerWidth<600&&t(this).css({right:5})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},t.noty.themes.bootstrapTheme={name:"bootstrapTheme",modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1e4,opacity:.6,display:"none",left:0,top:0}},style:function(){var e=this.options.layout.container.selector;switch(t(e).addClass("list-group"),this.$closeButton.append('<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>'),this.$closeButton.addClass("close"),this.$bar.addClass("list-group-item").css("padding","0px"),this.options.type){case"alert":case"notification":this.$bar.addClass("list-group-item-info");break;case"warning":this.$bar.addClass("list-group-item-warning");break;case"error":this.$bar.addClass("list-group-item-danger");break;case"information":this.$bar.addClass("list-group-item-info");break;case"success":this.$bar.addClass("list-group-item-success")}this.$message.css({fontSize:"13px",lineHeight:"16px",textAlign:"center",padding:"8px 10px 9px",width:"auto",position:"relative"})},callback:{onShow:function(){},onClose:function(){}}},t.noty.themes.defaultTheme={name:"defaultTheme",helpers:{borderFix:function(){if(this.options.dismissQueue){var e=this.options.layout.container.selector+" "+this.options.layout.parent.selector;switch(this.options.layout.name){case"top":t(e).css({borderRadius:"0px 0px 0px 0px"}),t(e).last().css({borderRadius:"0px 0px 5px 5px"});break;case"topCenter":case"topLeft":case"topRight":case"bottomCenter":case"bottomLeft":case"bottomRight":case"center":case"centerLeft":case"centerRight":case"inline":t(e).css({borderRadius:"0px 0px 0px 0px"}),t(e).first().css({"border-top-left-radius":"5px","border-top-right-radius":"5px"}),t(e).last().css({"border-bottom-left-radius":"5px","border-bottom-right-radius":"5px"});break;case"bottom":t(e).css({borderRadius:"0px 0px 0px 0px"}),t(e).first().css({borderRadius:"5px 5px 0px 0px"})}}}},modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1e4,opacity:.6,display:"none",left:0,top:0}},style:function(){switch(this.$bar.css({overflow:"hidden",background:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAoCAQAAAClM0ndAAAAhklEQVR4AdXO0QrCMBBE0bttkk38/w8WRERpdyjzVOc+HxhIHqJGMQcFFkpYRQotLLSw0IJ5aBdovruMYDA/kT8plF9ZKLFQcgF18hDj1SbQOMlCA4kao0iiXmah7qBWPdxpohsgVZyj7e5I9KcID+EhiDI5gxBYKLBQYKHAQoGFAoEks/YEGHYKB7hFxf0AAAAASUVORK5CYII=') repeat-x scroll left top #fff"}),this.$message.css({fontSize:"13px",lineHeight:"16px",textAlign:"center",padding:"8px 10px 9px",width:"auto",position:"relative"}),this.$closeButton.css({position:"absolute",top:4,right:4,width:10,height:10,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAQAAAAnOwc2AAAAxUlEQVR4AR3MPUoDURSA0e++uSkkOxC3IAOWNtaCIDaChfgXBMEZbQRByxCwk+BasgQRZLSYoLgDQbARxry8nyumPcVRKDfd0Aa8AsgDv1zp6pYd5jWOwhvebRTbzNNEw5BSsIpsj/kurQBnmk7sIFcCF5yyZPDRG6trQhujXYosaFoc+2f1MJ89uc76IND6F9BvlXUdpb6xwD2+4q3me3bysiHvtLYrUJto7PD/ve7LNHxSg/woN2kSz4txasBdhyiz3ugPGetTjm3XRokAAAAASUVORK5CYII=)",display:"none",cursor:"pointer"}),this.$buttons.css({padding:5,textAlign:"right",borderTop:"1px solid #ccc",backgroundColor:"#fff"}),this.$buttons.find("button").css({marginLeft:5}),this.$buttons.find("button:first").css({marginLeft:0}),this.$bar.on({mouseenter:function(){t(this).find(".noty_close").stop().fadeTo("normal",1)},mouseleave:function(){t(this).find(".noty_close").stop().fadeTo("normal",0)}}),this.options.layout.name){case"top":this.$bar.css({borderRadius:"0px 0px 5px 5px",borderBottom:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});break;case"topCenter":case"center":case"bottomCenter":case"inline":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"center"});break;case"topLeft":case"topRight":case"bottomLeft":case"bottomRight":case"centerLeft":case"centerRight":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"left"});break;case"bottom":this.$bar.css({borderRadius:"5px 5px 0px 0px",borderTop:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",boxShadow:"0 -2px 4px rgba(0, 0, 0, 0.1)"});break;default:this.$bar.css({border:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"})}switch(this.options.type){case"alert":case"notification":this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"});break;case"warning":this.$bar.css({backgroundColor:"#FFEAA8",borderColor:"#FFC237",color:"#826200"}),this.$buttons.css({borderTop:"1px solid #FFC237"});break;case"error":this.$bar.css({backgroundColor:"red",borderColor:"darkred",color:"#FFF"}),this.$message.css({fontWeight:"bold"}),this.$buttons.css({borderTop:"1px solid darkred"});break;case"information":this.$bar.css({backgroundColor:"#57B7E2",borderColor:"#0B90C4",color:"#FFF"}),this.$buttons.css({borderTop:"1px solid #0B90C4"});break;case"success":this.$bar.css({backgroundColor:"lightgreen",borderColor:"#50C24E",color:"darkgreen"}),this.$buttons.css({borderTop:"1px solid #50C24E"});break;default:this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"})}},callback:{onShow:function(){t.noty.themes.defaultTheme.helpers.borderFix.apply(this)},onClose:function(){t.noty.themes.defaultTheme.helpers.borderFix.apply(this)}}},t.noty.themes.relax={name:"relax",helpers:{},modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1e4,opacity:.6,display:"none",left:0,top:0}},style:function(){switch(this.$bar.css({overflow:"hidden",margin:"4px 0",borderRadius:"2px"}),this.$message.css({fontSize:"14px",lineHeight:"16px",textAlign:"center",padding:"10px",width:"auto",position:"relative"}),this.$closeButton.css({position:"absolute",top:4,right:4,width:10,height:10,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAQAAAAnOwc2AAAAxUlEQVR4AR3MPUoDURSA0e++uSkkOxC3IAOWNtaCIDaChfgXBMEZbQRByxCwk+BasgQRZLSYoLgDQbARxry8nyumPcVRKDfd0Aa8AsgDv1zp6pYd5jWOwhvebRTbzNNEw5BSsIpsj/kurQBnmk7sIFcCF5yyZPDRG6trQhujXYosaFoc+2f1MJ89uc76IND6F9BvlXUdpb6xwD2+4q3me3bysiHvtLYrUJto7PD/ve7LNHxSg/woN2kSz4txasBdhyiz3ugPGetTjm3XRokAAAAASUVORK5CYII=)",display:"none",cursor:"pointer"}),this.$buttons.css({padding:5,textAlign:"right",borderTop:"1px solid #ccc",backgroundColor:"#fff"}),this.$buttons.find("button").css({marginLeft:5}),this.$buttons.find("button:first").css({marginLeft:0}),this.$bar.on({mouseenter:function(){t(this).find(".noty_close").stop().fadeTo("normal",1)},mouseleave:function(){t(this).find(".noty_close").stop().fadeTo("normal",0)}}),this.options.layout.name){case"top":this.$bar.css({borderBottom:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",borderTop:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});break;case"topCenter":case"center":case"bottomCenter":case"inline":this.$bar.css({border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"center"});break;case"topLeft":case"topRight":case"bottomLeft":case"bottomRight":case"centerLeft":case"centerRight":this.$bar.css({border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"left"});break;case"bottom":this.$bar.css({borderTop:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",borderBottom:"2px solid #eee",boxShadow:"0 -2px 4px rgba(0, 0, 0, 0.1)"});break;default:this.$bar.css({border:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"})}switch(this.options.type){case"alert":case"notification":this.$bar.css({backgroundColor:"#FFF",borderColor:"#dedede",color:"#444"});break;case"warning":this.$bar.css({backgroundColor:"#FFEAA8",borderColor:"#FFC237",color:"#826200"}),this.$buttons.css({borderTop:"1px solid #FFC237"});break;case"error":this.$bar.css({backgroundColor:"#FF8181",borderColor:"#e25353",color:"#FFF"}),this.$message.css({fontWeight:"bold"}),this.$buttons.css({borderTop:"1px solid darkred"});break;case"information":this.$bar.css({backgroundColor:"#78C5E7",borderColor:"#3badd6",color:"#FFF"}),this.$buttons.css({borderTop:"1px solid #0B90C4"});break;case"success":this.$bar.css({backgroundColor:"#BCF5BC",borderColor:"#7cdd77",color:"darkgreen"}),this.$buttons.css({borderTop:"1px solid #50C24E"});break;default:this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"})}},callback:{onShow:function(){},onClose:function(){}}},window.noty}),function(t,e,n){e[t]=n}("onDomReady",this,function(t){"use strict";function e(t){if(!x){if(!a.body)return i(e);for(x=!0;t=w.shift();)i(t)}}function n(t){(b||t.type===u||a[f]===h)&&(r(),e())}function r(){b?(a[y](m,n,l),t[y](u,n,l)):(a[p](v,n),t[p](c,n))}function i(t,e){setTimeout(t,+e>=0?e:1)}function o(t){x?i(t):w.push(t)}null==document.readyState&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",function S(){document.removeEventListener("DOMContentLoaded",S,!1),document.readyState="complete"},!1),document.readyState="loading");var a=t.document,s=a.documentElement,u="load",l=!1,c="on"+u,h="complete",f="readyState",d="attachEvent",p="detachEvent",g="addEventListener",m="DOMContentLoaded",v="onreadystatechange",y="removeEventListener",b=g in a,_=l,x=l,w=[];if(a[f]===h)i(e);else if(b)a[g](m,n,l),t[g](u,n,l);else{a[d](v,n),t[d](c,n);try{_=null==t.frameElement&&s}catch(k){}_&&_.doScroll&&!function C(){if(!x){try{_.doScroll("left")}catch(t){return i(C,50)}r(),e()}}()}return o.version="1.4.0",o.isReady=function(){return x},o}(this)),document.querySelectorAll||(document.querySelectorAll=function(t){var e,n=document.createElement("style"),r=[];for(document.documentElement.firstChild.appendChild(n),document._qsa=[],n.styleSheet.cssText=t+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0),n.parentNode.removeChild(n);document._qsa.length;)e=document._qsa.shift(),e.style.removeAttribute("x-qsa"),r.push(e);return document._qsa=null,r}),document.querySelector||(document.querySelector=function(t){var e=document.querySelectorAll(t);return e.length?e[0]:null}),document.getElementsByClassName||(document.getElementsByClassName=function(t){return t=String(t).replace(/^|\s+/g,"."),document.querySelectorAll(t)}),Object.keys||(Object.keys=function(t){if(t!==Object(t))throw TypeError("Object.keys called on non-object");var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n}),function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.atob=t.atob||function(t){t=String(t);var n,r=0,i=[],o=0,a=0;if(t=t.replace(/\s/g,""),t.length%4===0&&(t=t.replace(/=+$/,"")),t.length%4===1)throw Error("InvalidCharacterError");if(/[^+/0-9A-Za-z]/.test(t))throw Error("InvalidCharacterError");for(;r<t.length;)n=e.indexOf(t.charAt(r)),o=o<<6|n,a+=6,24===a&&(i.push(String.fromCharCode(o>>16&255)),i.push(String.fromCharCode(o>>8&255)),i.push(String.fromCharCode(255&o)),a=0,o=0),r+=1;return 12===a?(o>>=4,i.push(String.fromCharCode(255&o))):18===a&&(o>>=2,i.push(String.fromCharCode(o>>8&255)),i.push(String.fromCharCode(255&o))),i.join("")},t.btoa=t.btoa||function(t){t=String(t);var n,r,i,o,a,s,u,l=0,c=[];if(/[^\x00-\xFF]/.test(t))throw Error("InvalidCharacterError");for(;l<t.length;)n=t.charCodeAt(l++),r=t.charCodeAt(l++),i=t.charCodeAt(l++),o=n>>2,a=(3&n)<<4|r>>4,s=(15&r)<<2|i>>6,u=63&i,l===t.length+2?(s=64,u=64):l===t.length+1&&(u=64),c.push(e.charAt(o),e.charAt(a),e.charAt(s),e.charAt(u));return c.join("")}}(this),Object.prototype.hasOwnProperty||(Object.prototype.hasOwnProperty=function(t){var e=this.__proto__||this.constructor.prototype;return t in this&&(!(t in e)||e[t]!==this[t])}),window.requestAnimationFrame||(window.webkitRequestAnimationFrame?!function(t){t.requestAnimationFrame=function(e){return webkitRequestAnimationFrame(function(){e(t.performance.now())})},t.cancelAnimationFrame=webkitCancelAnimationFrame}(this):window.mozRequestAnimationFrame?!function(t){t.requestAnimationFrame=function(e){return mozRequestAnimationFrame(function(){e(t.performance.now())})},t.cancelAnimationFrame=mozCancelAnimationFrame}(this):!function(t){t.requestAnimationFrame=function(e){return t.setTimeout(e,1e3/60)},t.cancelAnimationFrame=t.clearTimeout}(this)),function(t,e){t.augment=e()}(this,function(){var t=function(){},e=Array.prototype.slice,n=function(n,r){var i=t.prototype="function"==typeof n?n.prototype:n,o=new t,a=r.apply(o,e.call(arguments,2).concat(i));if("object"==typeof a)for(var s in a)o[s]=a[s];if(!o.hasOwnProperty("constructor"))return o;var u=o.constructor;return u.prototype=o,u};return n.defclass=function(t){var e=t.constructor;return e.prototype=t,e},n.extend=function(t,e){return n(t,function(t){return this.uber=t,e})},n}),function(t,e,n){function r(t,e,n,r){var a=i(n.substr(n.lastIndexOf(t.domain)),t);a&&o({mode:null,el:r,flags:a,engineSettings:e})}function i(t,e){for(var n={theme:b($.settings.themes.gray,null),stylesheets:e.stylesheets,holderURL:[]},r=!1,i=String.fromCharCode(11),o=t.replace(/([^\\])\//g,"$1"+i).split(i),a=/%[0-9a-f]{2}/gi,s=o.length,u=0;s>u;u++){var l=o[u];if(l.match(a))try{l=decodeURIComponent(l)}catch(c){l=o[u]}var h=!1;if($.flags.dimensions.match(l))r=!0,n.dimensions=$.flags.dimensions.output(l),h=!0;else if($.flags.fluid.match(l))r=!0,n.dimensions=$.flags.fluid.output(l),n.fluid=!0,h=!0;else if($.flags.textmode.match(l))n.textmode=$.flags.textmode.output(l),h=!0;else if($.flags.colors.match(l)){var f=$.flags.colors.output(l);n.theme=b(n.theme,f),h=!0}else if(e.themes[l])e.themes.hasOwnProperty(l)&&(n.theme=b(e.themes[l],null)),h=!0;else if($.flags.font.match(l))n.font=$.flags.font.output(l),h=!0;else if($.flags.auto.match(l))n.auto=!0,h=!0;else if($.flags.text.match(l))n.text=$.flags.text.output(l),h=!0;else if($.flags.size.match(l))n.size=$.flags.size.output(l),h=!0;else if($.flags.random.match(l)){null==$.vars.cache.themeKeys&&($.vars.cache.themeKeys=Object.keys(e.themes));var d=$.vars.cache.themeKeys[0|Math.random()*$.vars.cache.themeKeys.length];n.theme=b(e.themes[d],null),h=!0}h&&n.holderURL.push(l)}return n.holderURL.unshift(e.domain),n.holderURL=n.holderURL.join("/"),r?n:!1}function o(t){var e=t.mode,n=t.el,r=t.flags,i=t.engineSettings,o=r.dimensions,s=r.theme,u=o.width+"x"+o.height;if(e=null==e?r.fluid?"fluid":"image":e,null!=r.text&&(s.text=r.text,"object"===n.nodeName.toLowerCase())){for(var h=s.text.split("\\n"),f=0;f<h.length;f++)h[f]=C(h[f]);s.text=h.join("\\n")}var d=r.holderURL,p=b(i,null);r.font&&(s.font=r.font,!p.noFontFallback&&"img"===n.nodeName.toLowerCase()&&$.setup.supportsCanvas&&"svg"===p.renderer&&(p=b(p,{renderer:"canvas"}))),r.font&&"canvas"==p.renderer&&(p.reRender=!0),"background"==e?null==n.getAttribute("data-background-src")&&m(n,{"data-background-src":d}):m(n,{"data-src":d}),r.theme=s,n.holderData={flags:r,engineSettings:p},("image"==e||"fluid"==e)&&m(n,{alt:s.text?s.text+" ["+u+"]":u});var g={mode:e,el:n,holderSettings:{dimensions:o,theme:s,flags:r},engineSettings:p};"image"==e?("html"!=p.renderer&&r.auto||(n.style.width=o.width+"px",n.style.height=o.height+"px"),"html"==p.renderer?n.style.backgroundColor=s.background:(a(g),"exact"==r.textmode&&(n.holderData.resizeUpdate=!0,$.vars.resizableImages.push(n),l(n)))):"background"==e&&"html"!=p.renderer?a(g):"fluid"==e&&(n.holderData.resizeUpdate=!0,"%"==o.height.slice(-1)?n.style.height=o.height:null!=r.auto&&r.auto||(n.style.height=o.height+"px"),"%"==o.width.slice(-1)?n.style.width=o.width:null!=r.auto&&r.auto||(n.style.width=o.width+"px"),("inline"==n.style.display||""===n.style.display||"none"==n.style.display)&&(n.style.display="block"),c(n),"html"==p.renderer?n.style.backgroundColor=s.background:($.vars.resizableImages.push(n),l(n)))}function a(t){function n(){var e=null;switch(u.renderer){case"canvas":e=L(c,t);break;case"svg":e=O(c,t);break;default:throw"Holder: invalid renderer: "+u.renderer}return e}var r=null,i=t.mode,o=t.holderSettings,a=t.el,u=t.engineSettings;switch(u.renderer){case"svg":if(!$.setup.supportsSVG)return;break;case"canvas":if(!$.setup.supportsCanvas)return;break;default:return}var l={width:o.dimensions.width,height:o.dimensions.height,theme:o.theme,flags:o.flags},c=s(l);if(r=n(),null==r)throw"Holder: couldn't render placeholder";"background"==i?(a.style.backgroundImage="url("+r+")",a.style.backgroundSize=l.width+"px "+l.height+"px"):("img"===a.nodeName.toLowerCase()?m(a,{src:r}):"object"===a.nodeName.toLowerCase()&&(m(a,{data:r}),m(a,{type:"image/svg+xml"})),u.reRender&&e.setTimeout(function(){var t=n();if(null==t)throw"Holder: couldn't render placeholder";"img"===a.nodeName.toLowerCase()?m(a,{src:t}):"object"===a.nodeName.toLowerCase()&&(m(a,{data:t}),m(a,{type:"image/svg+xml"}))},100)),m(a,{"data-holder-rendered":!0})}function s(t){function e(t,e,n,r){e.width=n,e.height=r,t.width=Math.max(t.width,e.width),t.height+=e.height,t.add(e)}var n=$.defaults.size;switch(parseFloat(t.theme.size)?n=t.theme.size:parseFloat(t.flags.size)&&(n=t.flags.size),t.font={family:t.theme.font?t.theme.font:"Arial, Helvetica, Open Sans, sans-serif",size:u(t.width,t.height,n),units:t.theme.units?t.theme.units:$.defaults.units,weight:t.theme.fontweight?t.theme.fontweight:"bold"},t.text=t.theme.text?t.theme.text:Math.floor(t.width)+"x"+Math.floor(t.height),t.flags.textmode){case"literal":t.text=t.flags.dimensions.width+"x"+t.flags.dimensions.height;break;case"exact":if(!t.flags.exactDimensions)break;t.text=Math.floor(t.flags.exactDimensions.width)+"x"+Math.floor(t.flags.exactDimensions.height)}var r=new D({width:t.width,height:t.height}),i=r.Shape,o=new i.Rect("holderBg",{fill:t.theme.background});o.resize(t.width,t.height),r.root.add(o);var a=new i.Group("holderTextGroup",{text:t.text,align:"center",font:t.font,fill:t.theme.foreground});a.moveTo(null,null,1),r.root.add(a);var s=a.textPositionData=I(r);if(!s)throw"Holder: staging fallback not supported yet.";a.properties.leading=s.boundingBox.height;var l=null,c=null;if(s.lineCount>1){var h=0,f=0,d=t.width*$.setup.lineWrapRatio,p=0;c=new i.Group("line"+p);for(var g=0;g<s.words.length;g++){var m=s.words[g];l=new i.Text(m.text);var v="\\n"==m.text;(h+m.width>=d||v===!0)&&(e(a,c,h,a.properties.leading),h=0,f+=a.properties.leading,p+=1,c=new i.Group("line"+p),c.y=f),v!==!0&&(l.moveTo(h,0),h+=s.spaceWidth+m.width,c.add(l))}e(a,c,h,a.properties.leading);for(var y in a.children)c=a.children[y],c.moveTo((a.width-c.width)/2,null,null);a.moveTo((t.width-a.width)/2,(t.height-a.height)/2,null),(t.height-a.height)/2<0&&a.moveTo(null,0,null)}else l=new i.Text(t.text),c=new i.Group("line0"),c.add(l),a.add(c),a.moveTo((t.width-s.boundingBox.width)/2,(t.height-s.boundingBox.height)/2,null);return r}function u(t,e,n){var r=parseInt(t,10),i=parseInt(e,10),o=Math.max(r,i),a=Math.min(r,i),s=.8*Math.min(a,o*$.defaults.scale);return Math.round(Math.max(n,s))}function l(t){var e;e=null==t||null==t.nodeType?$.vars.resizableImages:[t];for(var n=0,r=e.length;r>n;n++){var i=e[n];if(i.holderData){var o=i.holderData.flags,s=h(i);if(s){if(!i.holderData.resizeUpdate)continue;if(o.fluid&&o.auto){var u=i.holderData.fluidConfig;switch(u.mode){case"width":s.height=s.width/u.ratio;break;case"height":s.width=s.height*u.ratio}}var l={mode:"image",holderSettings:{dimensions:s,theme:o.theme,flags:o},el:i,engineSettings:i.holderData.engineSettings};"exact"==o.textmode&&(o.exactDimensions=s,l.holderSettings.dimensions=o.dimensions),a(l)}else p(i)}}}function c(t){if(t.holderData){var e=h(t);if(e){var n=t.holderData.flags,r={fluidHeight:"%"==n.dimensions.height.slice(-1),fluidWidth:"%"==n.dimensions.width.slice(-1),mode:null,initialDimensions:e};r.fluidWidth&&!r.fluidHeight?(r.mode="width",r.ratio=r.initialDimensions.width/parseFloat(n.dimensions.height)):!r.fluidWidth&&r.fluidHeight&&(r.mode="height",r.ratio=parseFloat(n.dimensions.width)/r.initialDimensions.height),t.holderData.fluidConfig=r}else p(t)}}function h(t){var e={height:t.clientHeight,width:t.clientWidth};return e.height&&e.width?e:!1}function f(){for(var t,n=[],r=Object.keys($.vars.invisibleImages),i=0,o=r.length;o>i;i++)t=$.vars.invisibleImages[r[i]],h(t)&&"img"==t.nodeName.toLowerCase()&&(n.push(t),delete $.vars.invisibleImages[r[i]]);n.length&&N.run({images:n}),e.requestAnimationFrame(f)}function d(){$.vars.visibilityCheckStarted||(e.requestAnimationFrame(f),$.vars.visibilityCheckStarted=!0)}function p(t){t.holderData.invisibleId||($.vars.invisibleId+=1,$.vars.invisibleImages["i"+$.vars.invisibleId]=t,t.holderData.invisibleId=$.vars.invisibleId)}function g(t,e){return null==e?P.createElement(t):P.createElementNS(e,t)}function m(t,e){for(var n in e)t.setAttribute(n,e[n])}function v(t,e,n){if(null==t){t=g("svg",M);var r=g("defs",M);t.appendChild(r)}t.webkitMatchesSelector&&t.setAttribute("xmlns",M);for(var i=0;i<t.childNodes.length;i++)t.childNodes[i].nodeType===A&&t.removeChild(t.childNodes[i]);return m(t,{width:e,height:n,viewBox:"0 0 "+e+" "+n,preserveAspectRatio:"none"}),t}function y(t,n){if(e.XMLSerializer){var r=new XMLSerializer,i="",o=n.stylesheets;t.querySelector("defs");if(n.svgXMLStylesheet){for(var a=(new DOMParser).parseFromString("<xml />","application/xml"),s=o.length-1;s>=0;s--){var u=a.createProcessingInstruction("xml-stylesheet",'href="'+o[s]+'" rel="stylesheet"');a.insertBefore(u,a.firstChild)}var l=a.createProcessingInstruction("xml",'version="1.0" encoding="UTF-8" standalone="yes"');a.insertBefore(l,a.firstChild),a.removeChild(a.documentElement),i=r.serializeToString(a)}var c=r.serializeToString(t);return c=c.replace(/\&amp;(\#[0-9]{2,}\;)/g,"&$1"),i+c}}function b(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);if(null!=e)for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n}function _(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n+":"+t[n]);return e.join(";")}function x(t){$.vars.debounceTimer||t.call(this),$.vars.debounceTimer&&e.clearTimeout($.vars.debounceTimer),$.vars.debounceTimer=e.setTimeout(function(){$.vars.debounceTimer=null,t.call(this)},$.setup.debounce)}function w(){x(function(){l(null)})}function k(t){var n=null;return"string"==typeof t?n=P.querySelectorAll(t):e.NodeList&&t instanceof e.NodeList?n=t:e.Node&&t instanceof e.Node?n=[t]:e.HTMLCollection&&t instanceof e.HTMLCollection?n=t:t instanceof Array?n=t:null===t&&(n=[]),n}function S(t,e){var n=new Image;n.onerror=function(){e.call(this,!1)},n.onload=function(){e.call(this,!0)},n.src=t}function C(t){for(var e=[],n=0,r=t.length-1;r>=0;r--)n=t.charCodeAt(r),n>128?e.unshift(["&#",n,";"].join("")):e.unshift(t[r]);return e.join("")}function E(t){return t.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(e)})}var M="http://www.w3.org/2000/svg",A=8,P=e.document,j="2.5.2",T="\nCreated with Holder.js "+j+".\nLearn more at http://holderjs.com\n(c) 2012-2015 Ivan Malopinsky - http://imsky.co\n",N={version:j,addTheme:function(t,e){return null!=t&&null!=e&&($.settings.themes[t]=e),delete $.vars.cache.themeKeys,this},addImage:function(t,e){var n=P.querySelectorAll(e);if(n.length)for(var r=0,i=n.length;i>r;r++){var o=g("img");m(o,{"data-src":t}),n[r].appendChild(o)}return this},setResizeUpdate:function(t,e){t.holderData&&(t.holderData.resizeUpdate=!!e,t.holderData.resizeUpdate&&l(t))},run:function(t){t=t||{};var n={};$.vars.preempted=!0;var a=b($.settings,t);n.renderer=a.renderer?a.renderer:$.setup.renderer,-1===$.setup.renderers.join(",").indexOf(n.renderer)&&(n.renderer=$.setup.supportsSVG?"svg":$.setup.supportsCanvas?"canvas":"html");var s=k(a.images),u=k(a.bgnodes),l=k(a.stylenodes),c=k(a.objects);n.stylesheets=[],n.svgXMLStylesheet=!0,n.noFontFallback=a.noFontFallback?a.noFontFallback:!1;for(var h=0;h<l.length;h++){var f=l[h];if(f.attributes.rel&&f.attributes.href&&"stylesheet"==f.attributes.rel.value){var d=f.attributes.href.value,p=g("a");p.href=d;var m=p.protocol+"//"+p.host+p.pathname+p.search;n.stylesheets.push(m)}}for(h=0;h<u.length;h++)if(e.getComputedStyle){var v=e.getComputedStyle(u[h],null).getPropertyValue("background-image"),y=u[h].getAttribute("data-background-src"),_=null;_=null==y?v:y;var x=null,w="?"+a.domain+"/";if(0===_.indexOf(w))x=_.slice(1);else if(-1!=_.indexOf(w)){var C=_.substr(_.indexOf(w)).slice(1),E=C.match(/([^\"]*)"?\)/);null!=E&&(x=E[1])}if(null!=x){var M=i(x,a);M&&o({mode:"background",el:u[h],flags:M,engineSettings:n})}}for(h=0;h<c.length;h++){var A=c[h],P={};try{P.data=A.getAttribute("data"),P.dataSrc=A.getAttribute("data-src")}catch(j){}var T=null!=P.data&&0===P.data.indexOf(a.domain),N=null!=P.dataSrc&&0===P.dataSrc.indexOf(a.domain);T?r(a,n,P.data,A):N&&r(a,n,P.dataSrc,A)}for(h=0;h<s.length;h++){var I=s[h],L={};try{L.src=I.getAttribute("src"),L.dataSrc=I.getAttribute("data-src"),L.rendered=I.getAttribute("data-holder-rendered")}catch(j){}var O=null!=L.src,D=null!=L.dataSrc&&0===L.dataSrc.indexOf(a.domain),z=null!=L.rendered&&"true"==L.rendered;O?0===L.src.indexOf(a.domain)?r(a,n,L.src,I):D&&(z?r(a,n,L.dataSrc,I):!function(t,e,n,i,o){S(t,function(t){t||r(e,n,i,o)})}(L.src,a,n,L.dataSrc,I)):D&&r(a,n,L.dataSrc,I)}return this}},$={settings:{domain:"holder.js",images:"img",objects:"object",bgnodes:"body .holderjs",stylenodes:"head link.holderjs",stylesheets:[],themes:{gray:{background:"#EEEEEE",foreground:"#AAAAAA"},social:{background:"#3a5a97",foreground:"#FFFFFF"},industrial:{background:"#434A52",foreground:"#C2F200"},sky:{background:"#0D8FDB",foreground:"#FFFFFF"},vine:{background:"#39DBAC",foreground:"#1E292C"},lava:{background:"#F8591A",foreground:"#1C2846"}}},defaults:{size:10,units:"pt",scale:1/16},flags:{dimensions:{regex:/^(\d+)x(\d+)$/,output:function(t){var e=this.regex.exec(t);return{width:+e[1],height:+e[2]}}},fluid:{regex:/^([0-9]+%?)x([0-9]+%?)$/,output:function(t){var e=this.regex.exec(t);return{width:e[1],height:e[2]}}},colors:{regex:/(?:#|\^)([0-9a-f]{3,})\:(?:#|\^)([0-9a-f]{3,})/i,output:function(t){var e=this.regex.exec(t);return{foreground:"#"+e[2],background:"#"+e[1]}}},text:{regex:/text\:(.*)/,output:function(t){return this.regex.exec(t)[1].replace("\\/","/")}},font:{regex:/font\:(.*)/,output:function(t){return this.regex.exec(t)[1]}},auto:{regex:/^auto$/},textmode:{regex:/textmode\:(.*)/,output:function(t){return this.regex.exec(t)[1]}},random:{regex:/^random$/},size:{regex:/size\:(\d+)/,output:function(t){return this.regex.exec(t)[1]}}}},I=function(){var t=null,e=null,n=null;return function(r){var i=r.root;if($.setup.supportsSVG){var o=!1,a=function(t){return P.createTextNode(t)};(null==t||t.parentNode!==P.body)&&(o=!0),t=v(t,i.properties.width,i.properties.height),t.style.display="block",o&&(e=g("text",M),n=a(null),m(e,{x:0}),e.appendChild(n),t.appendChild(e),P.body.appendChild(t),t.style.visibility="hidden",t.style.position="absolute",t.style.top="-100%",t.style.left="-100%");var s=i.children.holderTextGroup,u=s.properties;m(e,{y:u.font.size,style:_({"font-weight":u.font.weight,"font-size":u.font.size+u.font.units,"font-family":u.font.family})}),n.nodeValue=u.text;var l=e.getBBox(),c=Math.ceil(l.width/(i.properties.width*$.setup.lineWrapRatio)),h=u.text.split(" "),f=u.text.match(/\\n/g);c+=null==f?0:f.length,n.nodeValue=u.text.replace(/[ ]+/g,"");var d=e.getComputedTextLength(),p=l.width-d,y=Math.round(p/Math.max(1,h.length-1)),b=[];if(c>1){n.nodeValue="";for(var x=0;x<h.length;x++)if(0!==h[x].length){n.nodeValue=E(h[x]);var w=e.getBBox();b.push({text:h[x],width:w.width})}}return t.style.display="none",{spaceWidth:y,lineCount:c,boundingBox:l,words:b}}return!1}}(),L=function(){var t=g("canvas"),e=null;return function(n){null==e&&(e=t.getContext("2d"));var r=n.root;t.width=$.dpr(r.properties.width),t.height=$.dpr(r.properties.height),e.textBaseline="middle",e.fillStyle=r.children.holderBg.properties.fill,e.fillRect(0,0,$.dpr(r.children.holderBg.width),$.dpr(r.children.holderBg.height));var i=r.children.holderTextGroup;i.properties;e.font=i.properties.font.weight+" "+$.dpr(i.properties.font.size)+i.properties.font.units+" "+i.properties.font.family+", monospace",e.fillStyle=i.properties.fill;for(var o in i.children){var a=i.children[o];for(var s in a.children){var u=a.children[s],l=$.dpr(i.x+a.x+u.x),c=$.dpr(i.y+a.y+u.y+i.properties.leading/2);e.fillText(u.properties.text,l,c)}}return t.toDataURL("image/png")}}(),O=function(){if(e.XMLSerializer){var t=v(null,0,0),n=g("rect",M);return t.appendChild(n),function(e,r){var i=e.root,o=r.holderSettings.flags.holderURL,a=P.createComment("\nSource URL: "+o+T);v(t,i.properties.width,i.properties.height),t.insertBefore(a,t.firstChild);for(var s=t.querySelectorAll("g"),u=0;u<s.length;u++)s[u].parentNode.removeChild(s[u]);m(n,{width:i.children.holderBg.width,height:i.children.holderBg.height,fill:i.children.holderBg.properties.fill});var l=i.children.holderTextGroup,c=l.properties,h=g("g",M),f=l.textPositionData;t.appendChild(h),l.y+=.8*f.boundingBox.height;for(var d in l.children){var p=l.children[d];for(var b in p.children){var x=p.children[b],w=l.x+p.x+x.x,k=l.y+p.y+x.y,S=g("text",M),C=P.createTextNode(null);m(S,{x:w,y:k,style:_({fill:c.fill,"font-weight":c.font.weight,"font-family":c.font.family+", monospace","font-size":c.font.size+c.font.units})}),C.nodeValue=x.properties.text,S.appendChild(C),h.appendChild(S)}}var E="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(y(t,r.engineSettings))));return E}}}(),D=function(t){function e(t,e){for(var n in e)t[n]=e[n];return t}var n=1,r=augment.defclass({constructor:function(t){n++,this.parent=null,this.children={},this.id=n,this.name="n"+n,null!=t&&(this.name=t),this.x=0,this.y=0,this.z=0,this.width=0,this.height=0},resize:function(t,e){null!=t&&(this.width=t),null!=e&&(this.height=e)},moveTo:function(t,e,n){this.x=null!=t?t:this.x,this.y=null!=e?e:this.y,this.z=null!=n?n:this.z},add:function(t){var e=t.name;if(null!=this.children[e])throw"SceneGraph: child with that name already exists: "+e;this.children[e]=t,t.parent=this}}),i=augment(r,function(e){this.constructor=function(){e.constructor.call(this,"root"),this.properties=t}}),o=augment(r,function(t){function n(n,r){if(t.constructor.call(this,n),this.properties={fill:"#000"},null!=r)e(this.properties,r);else if(null!=n&&"string"!=typeof n)throw"SceneGraph: invalid node name"}this.Group=augment.extend(this,{constructor:n,type:"group"}),this.Rect=augment.extend(this,{constructor:n,type:"rect"}),this.Text=augment.extend(this,{constructor:function(t){n.call(this),this.properties.text=t},type:"text"})}),a=new i;return this.Shape=o,this.root=a,this};for(var z in $.flags)$.flags.hasOwnProperty(z)&&($.flags[z].match=function(t){return t.match(this.regex)});$.setup={renderer:"html",debounce:100,ratio:1,supportsCanvas:!1,supportsSVG:!1,lineWrapRatio:.9,renderers:["html","canvas","svg"]},$.dpr=function(t){return t*$.setup.ratio},$.vars={preempted:!1,resizableImages:[],invisibleImages:{},invisibleId:0,visibilityCheckStarted:!1,debounceTimer:null,cache:{}},function(){var t=1,n=1,r=g("canvas"),i=null;r.getContext&&-1!=r.toDataURL("image/png").indexOf("data:image/png")&&($.setup.renderer="canvas",i=r.getContext("2d"),$.setup.supportsCanvas=!0),$.setup.supportsCanvas&&(t=e.devicePixelRatio||1,n=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1),$.setup.ratio=t/n,P.createElementNS&&P.createElementNS(M,"svg").createSVGRect&&($.setup.renderer="svg",$.setup.supportsSVG=!0)}(),d(),t(N,"Holder",e),e.onDomReady&&e.onDomReady(function(){$.vars.preempted||N.run(),e.addEventListener?(e.addEventListener("resize",w,!1),
e.addEventListener("orientationchange",w,!1)):e.attachEvent("onresize",w),"object"==typeof e.Turbolinks&&e.document.addEventListener("page:change",function(){N.run()})})}(function(t,e,n){var r="function"==typeof define&&define.amd;"object"==typeof exports;r?define(t):n[e]=t},this),function(t){if("undefined"!=typeof module&&module.exports)module.exports=t(this);else if("function"==typeof define&&define.amd){var e=this;define("i18n",function(){return t(e)})}else this.I18n=t(this)}(function(t){"use strict";var e=t&&t.I18n||{},n=Array.prototype.slice,r=function(t){return("0"+t.toString()).substr(-2)},i={day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridian:["AM","PM"]},o={precision:3,separator:".",delimiter:",",strip_insignificant_zeros:!1},a={unit:"$",precision:2,format:"%u%n",sign_first:!0,delimiter:",",separator:"."},s={unit:"%",precision:3,format:"%n%u",separator:".",delimiter:""},u=[null,"kb","mb","gb","tb"],l={defaultLocale:"en",locale:"en",defaultSeparator:".",placeholder:/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm,fallbacks:!1,translations:{},missingBehaviour:"message",missingTranslationPrefix:""};return e.reset=function(){this.defaultLocale=l.defaultLocale,this.locale=l.locale,this.defaultSeparator=l.defaultSeparator,this.placeholder=l.placeholder,this.fallbacks=l.fallbacks,this.translations=l.translations,this.missingBehaviour=l.missingBehaviour,this.missingTranslationPrefix=l.missingTranslationPrefix},e.initializeOptions=function(){"undefined"==typeof this.defaultLocale&&null!==this.defaultLocale&&(this.defaultLocale=l.defaultLocale),"undefined"==typeof this.locale&&null!==this.locale&&(this.locale=l.locale),"undefined"==typeof this.defaultSeparator&&null!==this.defaultSeparator&&(this.defaultSeparator=l.defaultSeparator),"undefined"==typeof this.placeholder&&null!==this.placeholder&&(this.placeholder=l.placeholder),"undefined"==typeof this.fallbacks&&null!==this.fallbacks&&(this.fallbacks=l.fallbacks),"undefined"==typeof this.translations&&null!==this.translations&&(this.translations=l.translations)},e.initializeOptions(),e.locales={},e.locales.get=function(t){var n=this[t]||this[e.locale]||this["default"];return"function"==typeof n&&(n=n(t)),n instanceof Array==!1&&(n=[n]),n},e.locales["default"]=function(t){var n,r=[],i=[];return t&&r.push(t),!t&&e.locale&&r.push(e.locale),e.fallbacks&&e.defaultLocale&&r.push(e.defaultLocale),r.forEach(function(t){n=t.split("-")[0],~i.indexOf(t)||i.push(t),e.fallbacks&&n&&n!==t&&!~i.indexOf(n)&&i.push(n)}),r.length||r.push("en"),i},e.pluralization={},e.pluralization.get=function(t){return this[t]||this[e.locale]||this["default"]},e.pluralization["default"]=function(t){switch(t){case 0:return["zero","other"];case 1:return["one"];default:return["other"]}},e.currentLocale=function(){return this.locale||this.defaultLocale},e.isSet=function(t){return void 0!==t&&null!==t},e.lookup=function(t,e){e=this.prepareOptions(e);var n,r,i,o=this.locales.get(e.locale).slice();o[0];for(t=this.getFullScope(t,e);o.length;)if(n=o.shift(),r=t.split(this.defaultSeparator),i=this.translations[n]){for(;r.length&&(i=i[r.shift()],void 0!==i&&null!==i););if(void 0!==i&&null!==i)return i}return this.isSet(e.defaultValue)?e.defaultValue:void 0},e.meridian=function(){var t=this.lookup("time"),e=this.lookup("date");return t&&t.am&&t.pm?[t.am,t.pm]:e&&e.meridian?e.meridian:i.meridian},e.prepareOptions=function(){for(var t,e=n.call(arguments),r={};e.length;)if(t=e.shift(),"object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(this.isSet(r[i])||(r[i]=t[i]));return r},e.createTranslationOptions=function(t,e){var n=[{scope:t}];return this.isSet(e.defaults)&&(n=n.concat(e.defaults)),this.isSet(e.defaultValue)&&(n.push({message:e.defaultValue}),delete e.defaultValue),n},e.translate=function(t,e){e=this.prepareOptions(e);var n,r=this.createTranslationOptions(t,e),i=r.some(function(t){return this.isSet(t.scope)?n=this.lookup(t.scope,e):this.isSet(t.message)&&(n=t.message),void 0!==n&&null!==n?!0:void 0},this);return i?("string"==typeof n?n=this.interpolate(n,e):n instanceof Object&&this.isSet(e.count)&&(n=this.pluralize(e.count,n,e)),n):this.missingTranslation(t,e)},e.interpolate=function(t,e){e=this.prepareOptions(e);var n,r,i,o,a=t.match(this.placeholder);if(!a)return t;for(var r;a.length;)n=a.shift(),i=n.replace(this.placeholder,"$1"),r=this.isSet(e[i])?e[i].toString().replace(/\$/gm,"_#$#_"):i in e?this.nullPlaceholder(n,t):this.missingPlaceholder(n,t),o=new RegExp(n.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),t=t.replace(o,r);return t.replace(/_#\$#_/g,"$")},e.pluralize=function(t,e,n){n=this.prepareOptions(n);var r,i,o,a,s;if(r=e instanceof Object?e:this.lookup(e,n),!r)return this.missingTranslation(e,n);for(i=this.pluralization.get(n.locale),o=i(t);o.length;)if(a=o.shift(),this.isSet(r[a])){s=r[a];break}return n.count=String(t),this.interpolate(s,n)},e.missingTranslation=function(t,e){if("guess"==this.missingBehaviour){var n=t.split(".").slice(-1)[0];return(this.missingTranslationPrefix.length>0?this.missingTranslationPrefix:"")+n.replace("_"," ").replace(/([a-z])([A-Z])/g,function(t,e,n){return e+" "+n.toLowerCase()})}var r=this.getFullScope(t,e),i=[this.currentLocale(),r].join(this.defaultSeparator);return'[missing "'+i+'" translation]'},e.missingPlaceholder=function(t,e){return"[missing "+t+" value]"},e.nullPlaceholder=function(){return e.missingPlaceholder.apply(e,arguments)},e.toNumber=function(t,e){e=this.prepareOptions(e,this.lookup("number.format"),o);var n,r,i=0>t,a=Math.abs(t).toFixed(e.precision).toString(),s=a.split("."),u=[],l=e.format||"%n",c=i?"-":"";for(t=s[0],n=s[1];t.length>0;)u.unshift(t.substr(Math.max(0,t.length-3),3)),t=t.substr(0,t.length-3);return r=u.join(e.delimiter),e.strip_insignificant_zeros&&n&&(n=n.replace(/0+$/,"")),e.precision>0&&n&&(r+=e.separator+n),l=e.sign_first?"%s"+l:l.replace("%n","%s%n"),r=l.replace("%u",e.unit).replace("%n",r).replace("%s",c)},e.toCurrency=function(t,e){return e=this.prepareOptions(e,this.lookup("number.currency.format"),this.lookup("number.format"),a),this.toNumber(t,e)},e.localize=function(t,e,n){switch(n||(n={}),t){case"currency":return this.toCurrency(e);case"number":return t=this.lookup("number.format"),this.toNumber(e,t);case"percentage":return this.toPercentage(e);default:var r;return r=t.match(/^(date|time)/)?this.toTime(t,e):e.toString(),this.interpolate(r,n)}},e.parseDate=function(t){var e,n,r;if("object"==typeof t)return t;if(e=t.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2})([\.,]\d{1,3})?)?(Z|\+00:?00)?/)){for(var i=1;6>=i;i++)e[i]=parseInt(e[i],10)||0;e[2]-=1,r=e[7]?1e3*("0"+e[7]):null,n=e[8]?new Date(Date.UTC(e[1],e[2],e[3],e[4],e[5],e[6],r)):new Date(e[1],e[2],e[3],e[4],e[5],e[6],r)}else"number"==typeof t?(n=new Date,n.setTime(t)):t.match(/([A-Z][a-z]{2}) ([A-Z][a-z]{2}) (\d+) (\d+:\d+:\d+) ([+-]\d+) (\d+)/)?(n=new Date,n.setTime(Date.parse([RegExp.$1,RegExp.$2,RegExp.$3,RegExp.$6,RegExp.$4,RegExp.$5].join(" ")))):t.match(/\d+ \d+:\d+:\d+ [+-]\d+ \d+/)?(n=new Date,n.setTime(Date.parse(t))):(n=new Date,n.setTime(Date.parse(t)));return n},e.strftime=function(t,n){var o=this.lookup("date"),a=e.meridian();o||(o={}),o=this.prepareOptions(o,i);var s=t.getDay(),u=t.getDate(),l=t.getFullYear(),c=t.getMonth()+1,h=t.getHours(),f=h,d=h>11?1:0,p=t.getSeconds(),g=t.getMinutes(),m=t.getTimezoneOffset(),v=Math.floor(Math.abs(m/60)),y=Math.abs(m)-60*v,b=(m>0?"-":"+")+(v.toString().length<2?"0"+v:v)+(y.toString().length<2?"0"+y:y);return f>12?f-=12:0===f&&(f=12),n=n.replace("%a",o.abbr_day_names[s]),n=n.replace("%A",o.day_names[s]),n=n.replace("%b",o.abbr_month_names[c]),n=n.replace("%B",o.month_names[c]),n=n.replace("%d",r(u)),n=n.replace("%e",u),n=n.replace("%-d",u),n=n.replace("%H",r(h)),n=n.replace("%-H",h),n=n.replace("%I",r(f)),n=n.replace("%-I",f),n=n.replace("%m",r(c)),n=n.replace("%-m",c),n=n.replace("%M",r(g)),n=n.replace("%-M",g),n=n.replace("%p",a[d]),n=n.replace("%S",r(p)),n=n.replace("%-S",p),n=n.replace("%w",s),n=n.replace("%y",r(l)),n=n.replace("%-y",r(l).replace(/^0+/,"")),n=n.replace("%Y",l),n=n.replace("%z",b)},e.toTime=function(t,e){var n=this.parseDate(e),r=this.lookup(t);return n.toString().match(/invalid/i)?n.toString():r?this.strftime(n,r):n.toString()},e.toPercentage=function(t,e){return e=this.prepareOptions(e,this.lookup("number.percentage.format"),this.lookup("number.format"),s),this.toNumber(t,e)},e.toHumanSize=function(t,e){for(var n,r,i=1024,o=t,a=0;o>=i&&4>a;)o/=i,a+=1;return 0===a?(n=this.t("number.human.storage_units.units.byte",{count:o}),r=0):(n=this.t("number.human.storage_units.units."+u[a]),r=o-Math.floor(o)===0?0:1),e=this.prepareOptions(e,{unit:n,precision:r,format:"%n%u",delimiter:""}),this.toNumber(o,e)},e.getFullScope=function(t,e){return e=this.prepareOptions(e),t.constructor===Array&&(t=t.join(this.defaultSeparator)),e.scope&&(t=[e.scope,t].join(this.defaultSeparator)),t},e.t=e.translate,e.l=e.localize,e.p=e.pluralize,e}),I18n.translations||(I18n.translations={}),I18n.translations.en={js:{as:{bt:"Belongs to",has:"Has"},at:{sys:{created_at:"Created at",email:"Email",passwd:"Password",status:"Status",status_values:["inactive","active","blocked"],updated_at:"Updated at"}},cms:{confirm:{"delete":"Delete this %{slab}?"}},confirm:{upgrade_ver:"You are running an outdated version. Do you want to reload the page to update?"},demo:{hint_no_upload:"Demo App is read-only. Uploading is deactivated."},editor:{ack:{dev_sync_off:"Phone/Tablet synchronization: OFF",dev_sync_on:"Phone/Tablet synchronization: ON",field_name:{block:"block",inline:"inline",none:"none"},update_field_name:"Show field name: %{state}"},attr_type:{attach:"Attachment",bool:"Boolean",date:"Date",datetime:"Datetime",geoloc:"Location",hyperlink:"URL",image:"Image",number:"Number",select:"Choice",string:"Text",text:"Text",time:"Time"},confirm:{delete_attr:"Delete this data field?",delete_data:"Delete this data model?",delete_dview:"Delete this detail view?",delete_elem:"Delete this element?",delete_rel:"Delete this relationship?",delete_root:"Delete this navigation page?",delete_seco:"Delete this pop-up page?",delete_tab:"Delete this tab?",delete_view:"Delete this view?"},data:{unnamed:"Unnamed"},elem:{default_label_count:"Count All %{slab}",default_label_count_linked:"Count %{slab}",hd_admin:"Timestamp",hd_content:"Content",hd_count:"Data Count",hd_linked:"Associated Content",hd_linked_count:"Associated Data Count"},error:{"invalid-assoc":"Invalid relationship","invalid-struct-attr":"Invalid data field name","invalid-struct-label":"Invalid model name"},hint:{elem_unavailable:{acb:"Action Buttons are not available for this view",lv_acb:"Action Buttons are not available for list item",lv_cv:"Child Views are not available for list item"}},"import":{error:{ext_not_csv:"Not a .CSV file",file_too_large:"File too large (max. 3 MB)",invalid_csv:"Invalid CSV file"}},view:{unnamed:"Unnamed"}},error:{no_network:"No network. Please check your network connection.",upload_no_image:"Only images are allowed: JPEG, PNG, GIF."},form:{cancel:"Cancel",ok:"OK"},hint:{link_desktop_only:"Please open the link with a desktop browser."},shared:{sort_asc:"ascending",sort_desc:"descending"},static_content:{image:"Image",map:"Map"},web:{confirm:{"delete":"Delete this %{slab}?"},msg_signup_success:"Thank you for signing up. You will receive an email with instructions for how to confirm your email address in a few minutes."}}},I18n.translations.de={js:{as:{bt:"Geh\xf6rt zu",has:"Hat"},at:{sys:{created_at:"Erstellt am",email:"Email",passwd:"Passwort",status:"Status",status_values:["inactiv","activ","blockiert"],updated_at:"Aktualisiert am"}},cms:{confirm:{"delete":"%{slab} l\xf6schen?"}},confirm:{upgrade_ver:"Neue Version wurde gefunden. M\xf6chten Sie die App aktualisieren?"},demo:{hint_no_upload:"Beispiel-App ist schreibgesch\xfctzt. Hochladen ist nicht m\xf6glich."},editor:{ack:{dev_sync_off:"Phone/Tablet Synchronization: AUS",dev_sync_on:"Phone/Tablet Synchronization: EIN",field_name:{block:"block",inline:"inline",none:"aus"},update_field_name:"Feldname wird angezeigt: %{state}"},attr_type:{attach:"Anlage",bool:"Boolean",date:"Datum",datetime:"Zeit",geoloc:"Location",hyperlink:"URL",image:"Bild",number:"Zahl",select:"Auswahlliste",string:"Text",text:"Text",time:"Uhrzeit"},confirm:{delete_attr:"Datenfeld l\xf6schen?",delete_data:"Datenmodell l\xf6schen?",delete_dview:"Detailansicht l\xf6schen?",delete_elem:"Element l\xf6schen?",delete_rel:"Beziehung l\xf6schen?",delete_root:"Navigation-Seite l\xf6schen?",delete_seco:"Popup-Seite l\xf6schen?",delete_tab:"Tab-Ansicht l\xf6schen?",delete_view:"Ansicht l\xf6schen?"},data:{unnamed:"Unbenannt"},elem:{default_label_count:"Anzahl (gesamt) %{slab}",default_label_count_linked:"Anzahl %{slab}",hd_admin:"Zeitstempel",hd_content:"Inhalte",hd_count:"Anzahl der Datens\xe4tze",hd_linked:"Verkn\xfcpfte Inhalte",hd_linked_count:"Anzahl verkn\xfcpfter Datens\xe4tze"},error:{"invalid-assoc":"Beziehung ist ung\xfcltig","invalid-struct-attr":"Name des Datenfeldes ist ung\xfcltig","invalid-struct-label":"Name des Datenmodelles ist ung\xfcltig"},hint:{elem_unavailable:{acb:"Aktionsbuttons sind nicht erh\xe4ltlich f\xfcr diese Ansicht",lv_acb:"Aktionsbuttons sind nicht erh\xe4ltlich f\xfcr Listenansicht",lv_cv:"Unteransichten sind nicht erh\xe4ltlich f\xfcr Listenansicht"}},"import":{error:{ext_not_csv:"Keine .CSV Datei",file_too_large:"Datei ist zu gro\xdf (max. 3 MB)",invalid_csv:"Die CSV-Datei ist ung\xfcltig"}},view:{unnamed:"Unbenannt"}},error:{no_network:"Sie sind zurzeit offline. Bitte \xfcberpr\xfcfen Sie Ihre Netzverbindung.",upload_no_image:"Nur folgende Bild-Formate sind erlaubt: JPEG, PNG, GIF."},form:{cancel:"Abbrechen",ok:"OK"},hint:{link_desktop_only:"Bitte \xf6ffnen Sie den Link an PC mit einem Web-Browser."},shared:{sort_asc:"aufsteigend",sort_desc:"absteigend"},static_content:{image:"Bild",map:"Landkarte"},web:{confirm:{"delete":"%{slab} l\xf6schen?"},msg_signup_success:"Vielen Dank f\xfcr Ihre Registriertung. In weniger Minuten erhalten Sie eine E-Mail mit den Aktivierungslink."}}},I18n.translations.zh={js:{as:{bt:"\u96b6\u5c5e",has:"\u62e5\u6709"},at:{sys:{created_at:"\u521b\u5efa\u65f6\u95f4",email:"\u90ae\u4ef6\u5730\u5740",passwd:"\u5bc6\u7801",status:"\u72b6\u6001",status_values:["\u672a\u6fc0\u6d3b","\u6b63\u5e38","\u5df2\u5c4f\u853d"],updated_at:"\u66f4\u65b0\u65f6\u95f4"}},cms:{confirm:{"delete":"\u5220\u9664\u8fd9\u4e2a%{slab}?"}},confirm:{upgrade_ver:"\u9879\u76ee\u7248\u672c\u6709\u66f4\u65b0\uff0c\u662f\u5426\u91cd\u8f7d\u9875\u9762\uff1f"},demo:{hint_no_upload:"\u793a\u4f8b\u5e94\u7528\u53ea\u53ef\u8bfb\uff0c\u65e0\u6cd5\u4e0a\u4f20\u6587\u4ef6\u3002"},editor:{ack:{dev_sync_off:"\u4e0d\u540c\u5c3a\u5bf8\u5e03\u5c40\u540c\u6b65\uff1a\u505c\u6b62",dev_sync_on:"\u4e0d\u540c\u5c3a\u5bf8\u5e03\u5c40\u540c\u6b65\uff1a\u5f00\u542f",field_name:{block:"\u5355\u884c\u663e\u793a",inline:"\u540c\u884c\u663e\u793a",none:"\u4e0d\u663e\u793a"},update_field_name:"\u5b50\u9879\u540d\u79f0\u663e\u793a\u65b9\u5f0f: %{state}"},attr_type:{attach:"\u9644\u4ef6",bool:"\u5f00\u5173\u9879",date:"\u65e5\u671f",datetime:"\u65f6\u95f4",geoloc:"\u5730\u7406\u4f4d\u7f6e",hyperlink:"\u7f51\u9875\u94fe\u63a5",image:"\u56fe\u7247",number:"\u6570\u5b57",select:"\u9009\u62e9\u9879",string:"\u6587\u5b57",text:"\u6587\u5b57",time:"\u949f\u70b9"},confirm:{delete_attr:"\u5220\u9664\u8fd9\u4e2a\u6570\u636e\u7c7b\u5b50\u9879?",delete_data:"\u5220\u9664\u8fd9\u4e2a\u6570\u636e\u7c7b\uff1f",delete_dview:"\u5220\u9664\u8fd9\u4e2a\u89c6\u56fe?",delete_elem:"\u5220\u9664\u8fd9\u4e2a\u9875\u9762\u5b50\u9879?",delete_rel:"\u5220\u9664\u8fd9\u4e2a\u6570\u636e\u5173\u7cfb?",delete_root:"\u5220\u9664\u8fd9\u4e2a\u5bfc\u822a\u9875?",delete_seco:"\u5220\u9664\u8fd9\u4e2a\u5f39\u51fa\u9875?",delete_tab:"\u5220\u9664\u8fd9\u4e2a\u5206\u680f\u9875?",delete_view:"\u5220\u9664\u8fd9\u4e2a\u89c6\u56fe?"},data:{unnamed:"\u672a\u547d\u540d"},elem:{default_label_count:"\u603b\u6570: %{slab}",default_label_count_linked:"\u6570\u91cf: %{slab}",hd_admin:"\u7cfb\u7edf\u4fe1\u606f",hd_content:"\u5185\u5bb9",hd_count:"\u7edf\u8ba1\u503c",hd_linked:"\u5173\u8054\u5185\u5bb9",hd_linked_count:"\u5173\u8054\u7edf\u8ba1\u503c"},error:{"invalid-assoc":"\u6570\u636e\u5173\u7cfb\u65e0\u6548","invalid-struct-attr":"\u8be5\u540d\u79f0\u5df2\u5b58\u5728\uff0c\u8bf7\u9009\u62e9\u5176\u5b83\u547d\u540d","invalid-struct-label":"\u8be5\u540d\u79f0\u5df2\u5b58\u5728\uff0c\u8bf7\u9009\u62e9\u5176\u5b83\u547d\u540d"},hint:{elem_unavailable:{acb:"\u6ca1\u6709\u53ef\u7528\u7684\u72ec\u7acb\u64cd\u4f5c\u6309\u952e",lv_acb:"\u5217\u8868\u5185\u4e0d\u80fd\u6dfb\u52a0\u72ec\u7acb\u64cd\u4f5c\u6309\u952e",lv_cv:"\u5217\u8868\u5185\u4e0d\u80fd\u5185\u5d4c\u5b50\u89c6\u56fe"}},"import":{error:{ext_not_csv:"\u4e0d\u662fCSV\u6587\u4ef6",file_too_large:"\u6587\u4ef6\u592a\u5927 (\u6700\u59273MB)",invalid_csv:"\u65e0\u6548\u7684CSV\u683c\u5f0f"}},view:{unnamed:"\u672a\u547d\u540d"}},error:{no_network:"\u60a8\u5f53\u524d\u5904\u4e8e\u79bb\u7ebf\u72b6\u6001\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8bbe\u7f6e\u3002",upload_no_image:"\u56fe\u7247\u4e0a\u4f20\u76ee\u524d\u53ea\u652f\u6301\u4ee5\u4e0b\u683c\u5f0f: JPEG, PNG, GIF\u3002"},form:{cancel:"\u53d6\u6d88",ok:"\u786e\u5b9a"},hint:{link_desktop_only:"\u8bf7\u5728\u53f0\u5f0f\u6216\u7b14\u8bb0\u672c\u7535\u8111\u4e0a\u6253\u5f00\u94fe\u63a5\u3002"},shared:{sort_asc:"\u5347\u5e8f",sort_desc:"\u964d\u5e8f"},static_content:{image:"\u56fe\u7247",map:"\u5730\u56fe"},web:{confirm:{"delete":"\u5220\u9664\u8fd9\u4e2a%{slab}?"},msg_signup_success:"\u611f\u8c22\u6ce8\u518c\u5e10\u53f7\uff0c\u60a8\u5c06\u9a6c\u4e0a\u6536\u5230\u4e00\u5c01\u90ae\u4ef6\u901a\u77e5\u60a8\u786e\u8ba4\u90ae\u4ef6\u5730\u5740\u3002"}}},function(){"use strict";var e,n,r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,b,x,w,k,S,C,E,M,A,P,j,T,N,I,O,D,z,F,R,B,q,V,H,U,G,W,Y,X,J,Q,K,Z,tt,et,nt,rt,it,ot,at,st,ut,lt,ct,ht,ft,dt,pt,gt,mt,vt,yt,bt,_t,xt,wt,kt,St,Ct,Et,Mt,At,Pt,jt,Tt,Nt,$t,It,Lt,Ot,Dt,zt,Ft,Rt,Bt,qt,Vt,Ht,Ut,Gt,Wt,Yt,Xt,Jt,Qt,Kt,Zt,te,ee,ne,re,ie,oe,ae,se,ue,le,ce,he,fe,de,pe,ge,me,ve,ye,be,_e,xe,we,ke,Se,Ce,Ee,Me,Ae,Pe,je,Te,Ne,$e,Ie,Le,Oe,De,ze,Fe,Re,Be,qe,Ve,He,Ue,Ge,We,Ye,Xe,Je,Qe,Ke,Ze,tn,en,nn,rn,on,an,sn,un,ln,cn,hn,fn,dn,pn,gn,mn,vn,yn,bn,_n,xn,wn,kn,Sn,Cn,En,Mn,An,Pn,jn,Tn,Nn,$n,In,Ln,On=[].slice;$(document).ajaxStart(function(){return $("#loaded").hide(),$("#loading").show()}),$(document).ajaxStop(function(){return $("#loaded").show(),$("#loading").hide()}),Function.prototype.partial=function(){var t=Array.prototype.slice.call(arguments),e=this;return function(){var n=Array.prototype.slice.call(arguments);return e.apply(this,t.concat(n))}},Ln=function(t,e){var n,r,i,o,a;o={},n=Object.keys(t).length,n||e(o),a=[];for(i in t)r=t[i],a.push(function(t){return r(function(r){return o[t]=r,Object.keys(o).length===n?e(o):void 0})}(i));return a},In=function(t,e,n){var r,i,o,a,s,u,l,c,h;if($.isPlainObject(t)){if(u={},r=Object.keys(t).length){l=[];for(a in t)h=t[a],l.push(function(t){return e(t,h,function(e){return u[t]=e,Object.keys(u).length===r?n(u):void 0})}(a));return l}return n(u)}if($.isArray(t)){if(u=[],r=t.length){for(c=[],o=0,s=t.length;s>o;o++)i=t[o],c.push(e(i,function(t){return u.push(t),u.length===r?n(u):void 0}));return c}return n(u)}return n()},Be=function(t){var e;return t?(e=t.split("/"),e[e.length-1]):void 0},window.Handlebars&&(Handlebars.registerHelper("ifEqual",function(t,e,n){return t===e?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifAny",function(t,e,n){return t||e?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifAll",function(t,e,n){return t&&e?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifnot",function(t,e){return t?void 0:e.fn(this)}),Handlebars.registerHelper("ifEmpty",function(t,e){return t&&0===t.length?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("ifLess",function(t,e,n){return e>t?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("ifIn",function(t,e,n){var r,i,o,a,s;if(r=!1,e)for(a=e.split(" "),i=0,o=a.length;o>i;i++)s=a[i],t===s&&(r=!0);return r?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("kv",function(t,e){var n,r,i;if(function(){var e;e=[];for(r in t)i=t[r],e.push(r);return e}().length){n="";for(r in t)i=t[r],n+=e.fn({key:r,value:t[r]});return n}return e.inverse(this)}),Handlebars.registerHelper("addTo",function(t,e){return t+e}),Handlebars.registerHelper("hyperlink",function(t){return t.match(/^(http|https):\/\//)?t:"http://"+t}),Handlebars.registerHelper("format_time",function(t,e){if(e)switch(t){case"date":return moment(e).tz(_zone).format("YYYY-MM-DD");case"datetime":return moment(e).tz(_zone).format("YYYY-MM-DD, HH:mm");case"time":return moment(e).tz(_zone).format("HH:mm")}}),Handlebars.registerHelper("format_text_h",function(t){var e;return t?function(){var n,r,i,o;for(i=t.split(/(?:\r\n|\r|\n)/),o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(Handlebars.Utils.escapeExpression(e));return o}().join("<br/>"):void 0}),Handlebars.registerHelper("host_path",function(t){return window._api_host&&t&&"/"===t.toString()[0]?_api_host+t:t}),Handlebars.registerHelper("attach_short",function(t,e){return e||Be(t)}),Handlebars.registerHelper("_cuid",function(){return window._cud.cuid}),Handlebars.registerHelper("ifUserOrAllowGuest",function(t,e){return window._cud.cuid||t?e.fn(this):void 0}),a={},this.get_tmpl=function(t){return a[t]||(a[t]=function(){return Handlebars.compile($("#"+t+"-tmpl").html())}())}),this.delay=function(t,e){return setTimeout(e,t)},Ve=null,Le=null,Ie=null,Pe=null,$e=null,je=null,De=null,Oe=null,Te=null,Ne=null,function(){var t,e,n,r,i,o,a,s;return n=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725],e=function(t){var e;return e=t.toString(16),1===e.length?"0"+e:e},t=function(){var t,e;for(e=[],a=t=1;20>=t;a=++t)s=n[a-1],e.push({r:s>>16,g:s>>8&255,b:255&s});return e}(),i=function(e){var n,r;return 0>e?[]:(n=t[2*e%20],r=t[(2*e+1)%20],[n,r])},r=function(t){var n,r,o,a,s;for(a=i(t),s=[],r=0,o=a.length;o>r;r++)n=a[r],s.push("#"+e(n.r)+e(n.g)+e(n.b));return s},o=function(t){return t?r(~~jsc[t]):["#fff","#fff"]},Ve=function(t){var e;return r((e=kt(t))?~~e.color:-1)},Le=function(t){return"string"==typeof t&&(t=$(t)),t.find("[color]").each(function(t){var e,n;return n=$(this),e=i(n.attr("color"))[1],n.css("background-color","rgba("+e.r+","+e.g+","+e.b+",0.75)")})},Ie=function(t){return"string"==typeof t&&(t=$(t)),t.find("[color]").each(function(t){var e,n;return n=$(this),e=r(n.attr("color")),n.css("border-color",e[0]),n.css("background-color",e[1])})},Pe=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=o(n.attr("js-c")),n.css("border-color",e[1])})},$e=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=o(n.attr("js-c")),n.css("border-color",e[0]),n.css("background-color",e[1])})},je=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=o(n.attr("js-c")),n.css("border-color",e[0])})},De=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=o(n.attr("js-c")),n.css("border-left-color",e[0])})},Oe=function(t){return"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(t){var e,n;return n=$(this),e=o(n.attr("js-c")),n.css("border-color",e[1]),n.css("border-left-color",e[0])}),t.find(".seco-hd[js-c], .form-hd[js-c]").each(function(t){var e,n;return n=$(this),e=o(n.attr("js-c")),n.css("background-color",e[1])}),t.find(".rest-toolbar[js-c]").each(function(t){var e,n;return n=$(this),e=o(n.attr("js-c")),n.css("background-color",e[1])}),t.find(".e-ac-btn[js-c]").each(function(t){var e,n;return n=$(this),e=o(n.attr("js-c")),n.css("border-color",e[0]),n.css("background-color",e[0])})},Te=function(t){var e,n,r;return e=function(){var t,e;t=St(),e=[];for(r in t)n=t[r],e.push({color:r});return e}(),"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(){var t,e;return e=$(this),(r=e.attr("js-c"))&&(t=Ve(r),e.css("border-color",t[0]),e.hasClass("data-title"))?e.css("background-color",t[1]):void 0})},Ne=function(t){var e,n,r;return e=function(){var t,e;t=St(),e=[];for(r in t)n=t[r],e.push({color:r});return e}(),"string"==typeof t&&(t=$(t)),t.find("[js-c]").each(function(){var t,e;return e=$(this),(r=e.attr("js-c"))&&!e.hasClass("template")?(t=Ve(r),e.css("border-color",t[0]),e.css("background-color",t[1])):void 0})}}(),sn=null,Re=null,mn=null,gn=null,function(){var t,e,n,r,i,o,a;return r=!1,o=null,n=null,a=null,sn=function(t,e,s){return null==s&&(s={}),r?void 0:(r=!0,o=e,n=s.prefix||"_uct",a=s.before_send,t(document).on("click",".uploaded-con .remove-upload",function(){var e,n;return n=t(this),e=n.closest(".user-uploader"),i(e),!1}))},gn=function(t){var e,n;return window.FileReader&&(e=null!=(n=t[0].files)?n[0]:void 0)?e.size>3145728?(en(I18n.t("js.editor.import.error.file_too_large")),!1):e.name.match(/\.csv$/i)?!0:(en(I18n.t("js.editor.import.error.ext_not_csv")),!1):void 0},mn=function(t,e){var n;return n=t.fileupload({dataType:"text",url:o,beforeSend:a,error:function(t){return en("Ops, "+t.statusText+" ("+t.status+")")},success:function(t){return e&&e(t)}}),t.trigger("change")},Re=function(n,r){return n.find(".user-uploader input[type=file]").each(function(){return function(i){var s,u,l;return u=i.closest(".user-uploader"),s={dataType:"json",url:o,beforeSend:a,error:function(t){return en("Ops, "+t.statusText+" ("+t.status+")")},success:function(t){return t.error?en(t.error):e(u,t)}},(l=u.hasClass("user-image"))&&($.extend(s,{disableImageResize:!1,imageMaxWidth:1080,imageMaxHeight:1080,imageQuality:.75,send:function(t,e){return e.files[0].type.match(/image\/.+$/i)?void 0:(en(I18n.t("js.error.upload_no_image")),!1)}}),window._rails_test&&$.extend(s,{add:function(t,e){return $("#loaded").hide(),e.submit()},send:null}),r&&$.extend(s,{send:function(e,r){var i,o,a;return a=[n.data("scope").id,u.attr("rel")],o=a[0],i=a[1],t(u,r.files[0],o,i),!1}})),i.fileupload(s)}($(this))})},t=function(t,n,r,i){return offline.put_draft_attach(r,i,n,function(r){var i;return i={url:r,ts:~new Date,filename:n.name,cache_name:r},e(t,i)})},e=function(t,e){var r,i,o,a,s;return i=t.attr("rel"),o=n+"["+i+"]",a=n+"["+i+"-upload-cache]",s=n+"["+i+"-upload-fname]",e.url?(t.find("input[name='"+o+"']").val("x"),t.find("input[name='"+a+"']").val(e.cache_name),t.find("input[name='"+s+"']").val(e.filename),t.find(".uploaded-con").removeClass("hidden"),t.find(".no-uploaded").addClass("hidden"),t.find(".upload-image").attr("src",e.url),r=e.filename||Be(e.url),t.find(".upload-attach").text(r)):void 0},i=function(t){var e,r,i,o;return e=t.attr("rel"),r=n+"["+e+"]",i=n+"["+e+"-upload-cache]",o=n+"["+e+"-upload-fname]",t.find("input[name='"+r+"']").val(""),t.find("input[name='"+i+"']").val(""),t.find("input[name='"+o+"']").val(""),t.find(".uploaded-con").addClass("hidden"),t.find(".no-uploaded").removeClass("hidden"),t.find(".upload-image").attr("src",""),t.find(".upload-attach").text("")}}(),ze=null,Fe=null,function(){var t;return ze=function(t){return t.find(".date-picker").each(function(){var t,e;switch(t=$(this),e=t.attr("rel")){case"datetime":return t.combodate({zone:_zone,format:"YYYY-MM-DDTHH:mm:ssZ",template:"YYYY MM DD ,   HH : mm"});case"date":return t.combodate({zone:_zone,format:"YYYY-MM-DDTHH:mm:ssZ",template:"YYYY MM DD"});case"time":return t.combodate({zone:_zone,format:"YYYY-MM-DDTHH:mm:ssZ",template:"HH : mm",time_only:!0})}})},Fe=function(e,n,r){return null==r&&(r={}),n.find(".select-picker").each(function(){var n,i,o,a,s;return n=$(this),"select"===n.prop("tagName").toLowerCase()?n.select2({minimumResultsForSearch:-1,allowClear:!0,placeholder:"-"}):(o=n.attr("rel"),i=[n.attr("s2-k"),n.attr("s2-v")],a=i[0],s=i[1],n.select2({minimumResultsForSearch:-1,allowClear:!0,placeholder:"-",ajax:t(e,o,r),text:function(t){return t.label},initSelection:function(t,e){return a?e({id:a,label:s}):void 0}}),a?n.select2("val",[]):void 0)})},t=function(t,e,n){return{transport:function(t){return t.beforeSend=n.beforeSend,$.ajax(t)},url:t+"/select2/"+e,dataType:"json",quietMillis:250,data:function(t,e){return{q:t,page:e}},results:function(t,e){return{results:t.items,more:t.page*t.per_page<t.count}},escapeMarkup:function(t){return t}}}}(),tn=null,nn=null,en=null,rn=null,function(){return window.bootbox&&bootbox.setDefaults({animate:!1}),$.noty?($.noty.defaults.layout="bottomRight",$.noty.defaults.animation.speed=0,$.noty.defaults.timeout=5e3):void 0}(),$(function(){var t;return window.bootbox&&window.I18n?(t={OK:I18n.t("js.form.ok"),CANCEL:I18n.t("js.form.cancel"),CONFIRM:I18n.t("js.form.ok")},bootbox.addLocale("custom",t),bootbox.setLocale("custom")):void 0}),function(){return tn=function(t){return noty({type:"alert",text:t,theme:"relax",timeout:3e3,killer:!0})},nn=function(t){return noty({type:"alert",text:t})},en=function(t){return noty({type:"error",text:t})},rn=function(t){var e;return e=noty({type:"warning",text:t,killer:!0,buttons:[{addClass:"btn btn-default btn-xs",text:"Undo",onClick:function(t){return t.close(),nn("Undo clicked")}}]}),delay(2e4,function(){return e.close()})}}(),qe=null,Ke=null,Ze=null,Ae=null,function(){var t,e;return qe=function(t,e){var n,r,i;return i=t.find(".get-location i").addClass("fa-spin"),n=function(t){return i.removeClass("fa-spin"),en("Error: "+t.message)},r=function(n){return t.find(".map-pin").addClass("hidden"),i.removeClass("fa-spin"),n=[n.coords.latitude,n.coords.longitude].join(", "),t.find(".lat-lng").val(n),e&&e()},navigator.geolocation.getCurrentPosition(r,n)},Ze=function(t){var e,n;return n=t.find(".map-pin"),n.hasClass("hidden")?(n.removeClass("hidden"),e=Ke(t),e.on("movestart",function(){return e.eachLayer(function(t){return t._url||e.removeLayer(t)})}),e.on("moveend",function(){var n,r,i,o;return e.eachLayer(function(t){return t._url||e.removeLayer(t)}),o=e.getCenter(),n=o.lat,r=o.lng,t.find(".lat-lng").val([n,r].join(", ")),i=L.marker([n,r]),e.addLayer(i)})):(n.addClass("hidden"),Ke(t))},Ae=function(t){return t.find(".map-pin").addClass("hidden"),t.find(".lat-lng").val(""),Ke(t)},Ke=function(t,n){var r,i;return null==n&&(n={}),r=null,i=n.zoom||13,t.each(function(){var t,o,a,s,u;return o=$(this),u=o.find(".lat-lng").val().split(/\s*,\s*/),a=u[0],s=u[1],t=$("<div>"),t.appendTo(o.find(".map-canvas").empty()),n.css&&t.css(n.css),r=e(t[0],a,s,i,{marker:!0})}),r},e=function(t,e,n,r,i){var o,a,s,u,l;return null==i&&(i={}),u="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",s='\xa9 <a href="http://openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors',a=new L.TileLayer(u,{attribution:s}),o=L.map(t,{zoomControl:!1}),o.attributionControl.setPrefix(!1),o.addLayer(a),l=[parseFloat(e),parseFloat(n)],l[0]&&l[1]?(o.setView(l,r),i.marker&&L.marker(l).addTo(o)):o.setView([23,0],1),o},t=function(t,e,n,r){var i,o,a;return e&&n?(o={center:{lat:parseFloat(e),lng:parseFloat(n)},zoom:r},i=new google.maps.Map(t,o),a=new google.maps.LatLng(e,n),new google.maps.Marker({position:a,map:i,title:"Hello World!"})):(o={center:{lat:23,lng:0},zoom:1},new google.maps.Map(t,o))}}(),Qe=null,function(){var t,e,n,r,i;return e=300,n=100,t=23,i="<div class='divider-0 divider-51'></div><div class='divider-0 divider-52'></div><div class='divider-0 divider-53'></div><div class='divider-0 divider-54'></div>",r="<div class='divider-0 divider-31'></div><div class='divider-0 divider-32'></div>",Qe=function(){function o(t,n){null==n&&(n={}),this._ex=t,this._height=n.height||e,this._outer_height=n.outerHeight||e,this._data={l:[],d:[],r:[]},this._cols={}}return o.prototype.traverse=function(t){var e,n,r,i,o,a;e=this._data_pr||this._data;for(r in e)for(a=e[r],n=0,i=a.length;i>n;n++)o=a[n],t(r,o);return this},o.prototype.get_splitter_pos=function(t){var e,n;return e=this._ex.w,n=function(){switch(t){case"l":return e/3;case"r":return e/3*2;case"c":return e/2}}()},o.prototype.splitters=function(t){var e,n,r,i,o,a,s,u,l,c,h;n=this._cols,r=_.keys(n).length,a=1===r?{}:2===r&&n.l&&n.r?{c:!0}:_.pick(n,"l","r");for(o in a)e=a[o],l=3,c=this.get_splitter_pos(o)-l/2,h=0,u=l,i=this._ex.h-2,s={ex:{x:c,y:h,w:u,h:i}},t(o,s);return this},o.prototype.get_order_data=function(){var t;return t=[],this.traverse(function(e,n){return t.push({idx:n._el_idx,pos:n.a})}),t},o.prototype.reset_el_idx=function(){var t;return t=0,
this.traverse(function(e,n){return n._el_idx=t++}),this},o.prototype.find_by_el=function(t){var e,n,r,i;e=null,r=this._data;for(n in r)i=r[n],e||(e=_.find(i,function(e){return e.e===t[0]}));return e},o.prototype.height=function(){return this._ex.h},o.prototype.init=function(e){var n,r,i,o,a,s;for(r=i=0,a=e.length;a>i;r=++i)n=e[r],s=n.item.pos||"",o=s[0]||"d",this._data[o].push({_el_idx:r,e:n.el[0],h:t,a:s,is_view:n.is_view,is_list:n.item.is_list});return this.recalc(this._data),this},o.prototype.add_dividers=function(){return $(),this.traverse(function(t,e){var n,o;return e.is_list?(n=e.h>200?i:r,o=$(e.e),o.find(".divider-0").remove(),o.append(n)):void 0})},o.prototype.recalc=function(e){var r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,b,x,w,k,S;for(u in e)if(b=e[u],b.length)for(a=function(){var t,e,n;for(n=[],t=0,e=b.length;e>t;t++)v=b[t],v.is_view||n.push(1);return n}().length,g=this._height-a*t,y=function(){var t,e,n;for(n=[],t=0,e=b.length;e>t;t++)v=b[t],v.is_view&&n.push(v);return n}(),s=0,c=y.length;c>s;s++)v=y[s],v.h=Math.max(n,g/y.length);o=function(){var t;t=[];for(u in e)b=e[u],b.length&&t.push(function(){var t,e,n;for(n=[],t=0,e=b.length;e>t;t++)v=b[t],n.push(v.h);return n}().reduce(function(t,e){return t+e}));return t}(),this._ex.h=(d=Math.max).call.apply(d,[null,this._outer_height].concat(On.call(o))),this._ex.y1=this._ex.y+this._ex.h,x={l:0,d:0,r:0},r={};for(u in e)v=e[u],v.length&&(r[u]=!0);if(i=_.keys(r).length,2===i&&r.d){w=this._ex.w/3;for(u in r)v=r[u],x[u]="d"===u?2*w:w}else{w=this._ex.w/i;for(u in r)v=r[u],x[u]=w}for(u in x)v=x[u],x[u]=~~(v+.5);for(this._cols=r,S={l:0,d:0,r:0},p=["l","r"],l=0,h=p.length;h>l;l++)u=p[l],0===e[u].length&&(x.d+=x[u],x[u]=0);for(u in e)for(b=e[u],m=0,f=b.length;f>m;m++)v=b[m],"b"===v.a[1]?k=this._ex.h-v.h:(k=S[u],S[u]+=v.h),v.ex=function(){switch(u){case"l":return{x:0,y:k,w:x.l,h:v.h};case"d":return{x:x.l,y:k,w:x.d,h:v.h};case"r":return{x:this._ex.w-x.r,y:k,w:x.r,h:v.h}}}.call(this);return this.add_dividers(),this},o.prototype["final"]=function(){var t,e,n,r,i,o,a,s,u,l,c;if(this._data_pr){this._data={l:[],d:[],r:[]},s=this._data_pr;for(r in s)for(c=s[r],this._data[r]=[],n=0,o=c.length;o>n;n++)e=c[n],this._data[r].push(e),e.a=r;this._data_pr=null}else if(t=_.keys(this._cols).length,1===t&&0===this._data.d.length){u=this._data;for(r in u)c=u[r],c.length&&"d"!==r&&(this._data.d=this._data.d.concat(c),this._data[r]=[]);for(l=this._data.d,i=0,a=l.length;a>i;i++)e=l[i],e.a="d"}return this},o.prototype.resize=function(t,e,n){var r,i,o,a,s,u,l;if(l=this.get_resize_transform(t,e)){this._data_pr={l:[],d:[],r:[]};for(u in l)for(r=l[u],s=this._data[u],o=0,a=s.length;a>o;o++)i=s[o],this._data_pr[r].push(i);this.recalc(this._data_pr)}return this},o.prototype.get_resize_transform=function(t,e,n){var r,i;return i=e/this._ex.w,r=function(){switch(t){case"l":switch(!1){case!(.1>=i):return{l:"d"};case!(.33>=i):return{};case!(i>=.9):return{l:"d",d:"d",r:"d"};case!(i>=.67):return{l:"d",d:"r"};case!(i>=.5):return{d:"r"}}break;case"r":switch(!1){case!(i>=.9):return{r:"d"};case!(i>=.67):return{};case!(.1>=i):return{l:"d",d:"d",r:"d"};case!(.33>=i):return{d:"l",r:"d"};case!(.5>=i):return{d:"l"}}break;case"c":switch(!1){case!(.1>=i):return{l:"d",r:"d"};case!(.33>=i):return{r:"d"};case!(i>=.9):return{l:"d",r:"d"};case!(i>=.67):return{l:"d"}}}}(),_.extend({l:"l",d:"d",r:"r"},r||{})},o.prototype.drag=function(t,e,n,r){var i,o,a,s,u;return s=this.get_drag_pos(e,n),a=s[0],i=s[1],o=a[0],u=t.a[0]||"d",o!==u&&(this._data[u].splice(this._data[u].indexOf(t),1),this._data[o].push(t)),t.a=a,this._data[o]=_.sortBy(this._data[o],function(e){return e===t?r:e.ex.y}),this.recalc(this._data),this},o.prototype.get_drag_pos=function(t,e){var n,r,i,o,a;return i=25,n=25,o=(t+i/2)/this._ex.w,a=(e+n/2)/this._ex.h,r=function(){switch(!1){case!(.33>=o):return"l";case!(o>=.67):return"r";default:return"d"}}(),[r,.1>=o||o>=.9]},o}()}(),Je=null,Xe=null,function(t){return function(){var t,e,n,r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,b;return y=null,h=null,f=null,o={e_mover:{min_w:10,min_h:10,behavior:{move:{x:!0,y:!0},resize:{x:!1,y:!1}},callbacks:{}},s_mover:{min_w:10,min_h:10,behavior:{move:{x:!0,y:!1},resize:{x:!1,y:!1}},callbacks:{}},pv:{callbacks:{onMoveStart:function(t){var e,n;return h.data({is_dragging:!0}),f.css("pointer-events","all"),e=t.getContainer(),n=e.data("drag"),n.current=n.layout.find_by_el(h.closest(".dummy0")),n.current?y=H:(y=Nn,n.splitter=h.attr("dok"))},onMove:function(t,e,n){var r,i,o,a,u;return r=t.getContainer(),i=r.data("drag"),a=e.x-i.ex.x,u=e.y-i.ex.y,(o=s(i,a,u,n))&&y.drawDropableArea(o),d(r,i)},onMoveEnd:function(t){var e,n;return h.data({is_dragging:!1}),f.css("pointer-events","none"),y.resetDropableArea(),y.setTarget(),e=t.getContainer(),n=e.data("drag"),p(n)}}}},l=function(t){var e,n,r,i,o,a;return r=t.offset(),n=r.left,o=r.top,i=[t.outerWidth(),t.outerHeight()],a=i[0],e=i[1],{x:n,y:o,x1:n+a,y1:o+e,w:a,h:e}},c=function(t,e,n){var r,i;return null==n&&(n={}),r=t.x<e.x1&&t.x1>e.x,i=t.y<e.y1&&t.y1>e.y,n.x_only?r:n.y_only?i:r&&i},Je=function(){var e,n,r;return e="resizer",f=$('<svg width="100%" height="100%"></svg>').attr("id",e).css({position:"absolute",top:0,left:0,"background-color":"transparent",border:"none","pointer-events":"none","z-index":999}),$("body").prepend(f),n=new t(d3.select("#"+e),o.e_mover),r=new t(d3.select("#"+e),o.s_mover),[n,r]},Xe=function(t,e,n){var i,o,a,s,u,l,c;return a=function(){var e,n,r,i;for(r=t.find("> .dummy0"),i=[],e=0,n=r.length;n>e;e++)o=r[e],i.push($(o));return i}(),c=function(){var t,n,r;for(r=[],u=t=0,n=e.length;n>t;u=++t)o=e[u],r.push({item:o,is_view:o.view,el:a[u]});return r}(),s=r(t),l=new Qe(s,{height:t.height(),outerHeight:t.outerHeight()}),i={cid:n,items:e,ex:s,layout:l},i.layout.init(c),i.layout.traverse(function(t,e){return $(e.e).attr("rel-o",e._el_idx)}),t.data("drag",i),d(t,i),H.setTarget(),Nn.setTarget()},p=function(t){var e;return t.layout["final"](),e=t.layout.get_order_data(),nt(t.cid,e,function(){return t.layout.reset_el_idx(),t.layout.traverse(function(t,e){return $(e.e).attr("rel-o",e._el_idx)}),_.find(t.items,function(t){return t.view})?ln():void 0})},r=function(t){var e,n,r,i,o;return n=t.offset(),i=n.left,o=n.top,r=t.width(),e=t.height(),{x:i,y:o,w:r,h:e,x1:i+r,y1:o+e}},s=function(t,e,n,r,i){var o,a;return t.current?(t.layout.drag(t.current,e,n,r.y>0?n+.1:n-.1),a=t.ex,o=t.current.ex,{x:a.x+o.x,y:a.y+o.y,w:o.w,h:o.h}):(t.layout.resize(t.splitter,e,n),null)},d=function(t,e){return e.layout.traverse(function(e,n){var r;return r=$(n.e),r.css({left:n.ex.x,top:n.ex.y,width:n.ex.w,height:n.ex.h}),r.detach().appendTo(t)}),t.css("height",e.layout.height()),t.find(".s-handle").remove(),e.layout.splitters(function(e,n){var r;return r=$("<div class='s-handle' dok='"+e+"'></div>"),r.css({left:n.ex.x,top:n.ex.y,width:n.ex.w,height:n.ex.h}),r.appendTo(t)})},t=function(){function t(e,n){var r;n||(n={}),r=$.extend(!0,{},t.defaults,n),this.settings=r,this.svg=i(this,e,r),this.redraw(r)}return t.defaults={x:-100,y:-100,w:10,h:10},t.prototype.getContainer=function(){return this._container},t.prototype.show=function(){return this.svg.el.style("display",null),this},t.prototype.hide=function(){return this.svg.el.style("display","none"),this},t.prototype.getTarget=function(){return h},t.prototype.setTarget=function(t,e,n){var r,i,a,s;return t?h&&h.data("is_dragging")||(this._container=e.closest(n),this.settings.callbacks=o[t].callbacks,s=~~e.css("width").replace("px",""),r=~~e.css("height").replace("px",""),a=e.offset(),this.redraw({x:a.left,y:a.top,w:s,h:r}),h=e,i=e.hasClass("list")):this.redraw({x:-1e3,y:-1e3}),this},t.prototype.boundingBox=function(){var t,e;return e=this.settings.min_w,t=this.settings.min_h,_.extend(r(this._container),{min_w:e,min_h:t})},t.prototype.getExtent=function(){return this.extent||(this.extent=function(t){var e,n,r,i;return r=t.x,i=t.y,n=t.w,e=t.h,Object.freeze({x:r,y:i,w:n,h:e,x1:r+n,y1:i+e,cx:r+n/2,cy:i+e/2})}(this.svg.container.data()[0]))},t.prototype.resetExtent=function(){return this.extent=null,this},t.prototype.drawDropableArea=function(t){var e,n;return e=this.svg.el,n=e.select("rect.drop_rect"),n.empty()&&(n=e.append("rect").classed("drop_rect",!0)),n.attr("x",t.x).attr("y",t.y).attr("width",t.w).attr("height",t.h).attr("stroke","none").attr("fill-opacity",.1),this},t.prototype.resetDropableArea=function(){return this.svg.el.select("rect.drop_rect").remove(),this},t.prototype.redraw=function(t){var e,n,r,i,o,a,s,u;for(null==t&&(t={}),s=this.getExtent(),i=this.svg.container,n=i.data()[0],u=["x","y","w","h"],o=0,a=u.length;a>o;o++)e=u[o],null!=t[e]&&(n[e]=t[e]);return r=this.resetExtent().getExtent(),i.attr("transform","translate("+r.x+","+r.y+")"),i.selectAll(".resize").attr("transform",function(t){return"translate("+(/e$/.test(t.resize)?r.w:0)+", "+(/^s/.test(t.resize)?r.h:0)+")"}),i.selectAll(".rect, .n > rect, .s > rect").attr("width",r.w),i.selectAll(".rect, .e > rect, .w > rect").attr("height",r.h),i.select(".label").attr("x",r.w/2).attr("y",r.h/2).attr("height",r.h).attr("width",r.w),this},t}(),i=function(t,n,r){var i,o,a,s,l,c,f,d,p;return i=r.behavior||{},p=n.append("g").classed("shape",!0).classed("shape-"+r.type,!0),a=p.data([{}]).append("g").style("pointer-events","all"),o=a.append("rect").classed("rect",!0).attr("fill-opacity",.1),f=function(n){var r,o,a;return a=h.width(),o=h.height(),t.redraw({x:i.move.x?d3.event.sourceEvent.pageX-a/2:n.x-a/2,y:i.move.y?d3.event.sourceEvent.pageY-o/2:n.y,w:a,h:o}),n.shape=t,n.dx=n.dy=0,n.extent=t.getExtent(),n.bounded=e(n.extent,t.boundingBox()),r=t.settings.callbacks||{},r.onMoveStart&&r.onMoveStart(t)},l=function(e){var n,r,o;return i.move.x&&(e.dx+=d3.event.dx,r=e.bounded.x(e.extent.x+e.dx)),i.move.y&&(e.dy+=d3.event.dy,o=e.bounded.y(e.extent.y+e.dy)),t.redraw({x:r,y:o}),n=t.settings.callbacks||{},n.onMove&&n.onMove(t,{x:r,y:o,x1:r+e.extent.w,y1:o+e.extent.h},{x:d3.event.dx,y:d3.event.dy})},c=function(e){var n;return n=t.settings.callbacks||{},n.onMoveEnd&&n.onMoveEnd(t)},d=i.move,(d.x||d.y)&&(s=d.x&&d.y?"move":"ew-resize",a.attr("cursor",s).call(d3.behavior.drag().origin(Object).on("dragstart",f).on("drag",l).on("dragend",c))),setTimeout(function(){return u(t,r)}),{el:p,container:a,bg_rect:o}},u=function(t,e){var r,i,o,a,s,u,l,c,h,f,d,p;return i=t.svg.container,i.classed("resizable")?void 0:(i.classed("resizable",!0),r=e.behavior,f=e.callbacks.onResizeStart,c=e.callbacks.onResize,h=e.callbacks.onResizeEnd,o=0+(r.resize.x?0:2)+(r.resize.y?0:1),a=function(){var t,e,n,r;for(n=g[o],r=[],t=0,e=n.length;e>t;t++)d=n[t],r.push({resize:d});return r}(),p=i.selectAll(".resize").data(a),l=function(e){return/[e]$/.test(e.resize)&&(e.x_field="x1"),/[w]$/.test(e.resize)&&(e.x_field="x"),/^[s]/.test(e.resize)&&(e.y_field="y1"),/^[n]/.test(e.resize)&&(e.y_field="y"),e.dx=0,e.dy=0,e.x=d3.event.sourceEvent.pageX,e.y=d3.event.sourceEvent.pageY,e.extent=t.getExtent(),e.bounded=n(e.extent,t.boundingBox()),i.style("pointer-events","none"),d3.select("body").style("cursor",d3.select(this).style("cursor")),f&&f({})},s=function(e){var n,r,i,o,a,s;return e.x_field&&(e.dx=d3.event.sourceEvent.pageX-e.x),e.y_field&&(e.dy=d3.event.sourceEvent.pageY-e.y),d3.event.dx||d3.event.dy?(a=e.x_field?e.bounded[e.x_field](e.dx):e.extent.x+e.dx,s=e.y_field?e.bounded[e.y_field](e.dy):e.extent.y+e.dy,n="x"===e.x_field?a:e.extent.x,i="y"===e.y_field?s:e.extent.y,r="x1"===e.x_field?a:e.extent.x1,o="y1"===e.y_field?s:e.extent.y1,t.redraw({x:n,y:i,w:r-n,h:o-i}),c&&c({x:n,y:i,x1:r,y1:o})):void 0},u=function(t){return d3.select("body").style("cursor",null),h&&h({})},p.enter().append("g").attr("class",function(t){return"resize "+t.resize}).attr("cursor",function(t){return m[t.resize]}).style("pointer-events","all").call(d3.behavior.drag().origin(Object).on("dragstart",l).on("drag",s).on("dragend",u)).append("rect").attr("x",function(t){return/[ew]$/.test(t.resize)?-3:null}).attr("y",function(t){return/^[ns]/.test(t.resize)?-3:null}).attr("width",6).attr("height",6).attr("fill-opacity",.1).style("visibility","hidden"),p.exit().remove(),t.redraw())},a=function(t){return t.selectAll(".resize").data([]).exit().remove()},e=function(t,e){var n,r;return n={x:{min:e.x,max:e.x1-t.w},y:{min:e.y,max:e.y1-t.h}},r=v(),{x:function(t){return b(r.x(t),n.x.min,n.x.max)},y:function(t){return b(r.y(t),n.y.min,n.y.max)}}},n=function(t,e){var n,r;return n={x:{min:e.x,max:t.x1-e.min_w},y:{min:e.y,max:t.y1-e.min_h},x1:{min:t.x+e.min_w,max:e.x1},y1:{min:t.y+e.min_h,max:e.y1}},r=v(n),{x:function(e){return b(r.x(t.x+e),n.x.min,n.x.max)},y:function(e){return b(r.y(t.y+e),n.y.min,n.y.max)},x1:function(e){return b(r.x1(t.x1+e),n.x1.min,n.x1.max)},y1:function(e){return b(r.y1(t.y1+e),n.y1.min,n.y1.max)}}},v=function(t){return{x:_.identity,y:_.identity,x1:_.identity,y1:_.identity}},b=function(t,e,n){return Math.max(e,Math.min(n,t))},g=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],m={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"}}}(this)(),Ue=null,un=null,function(t){return function(){return Ue=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e,n;return e=16*Math.random()|0,n="x"===t?e:3&e|8,n.toString(16)})},$("script.partial").each(function(){var t,e;return t=$(this),e=t.attr("id").replace(/-tmpl$/,""),Handlebars.registerPartial(e,t.html())}),un=function(t){var e,n;for(e in t)n=t[e],n instanceof Array?n.length||delete t[e]:n||delete t[e];return t}}}(this)(),e=window._usn,V=null,j=null,E=null,T=null,P=null,A=null,M=null,q=null,B=null,R=null,N=null,O=null,I=null,D=null,z=null,F=null,wn=null,xn=null,kn=null,_n=null,bn=null,k=null,S=null,St=null,gt=null,bt=null,Yt=null,yt=null,kt=null,dt=null,pt=null,Rt=null,qt=null,Bt=null,Ft=null,ct=null,Ut=null,Gt=null,Lt=null,Nt=null,vt=null,mt=null,wt=null,xt=null,_t=null,te=null,Zt=null,Xt=null,Kt=null,Qt=null,Jt=null,r=null,n=null,o=null,i=null,Ee=null,Ct=null,Dt=null,zt=null,At=null,Pt=null,h=null,y=null,d=null,x=null,b=null,p=null,c=null,m=null,f=null,w=null,g=null,v=null,function(t){return function(){var a,s,u,l,C,L,H,U,G,W,Y,X,J,Q,K,Z,tt,et,nt,rt,it,ot,at,st,ut,lt,Et,Mt,jt,$t,It;return H={string:{require:!0,unique:!0,label:!0,sort:!0,search:!0},text:{require:!0,label:!0,search:!0},select:{require:!0,label:!0,sort:!0},number:{require:!0,label:!0,sort:!0},bool:{require:!0,sort:!0},image:{require:!0},attach:{require:!0},geoloc:{require:!0},date:{require:!0,label:!0,sort:!0},time:{require:!0,sort:!0},datetime:{require:!0,label:!0,sort:!0},hyperlink:{require:!0}},t.plan_quotas={models:{v:10,hint:"Max models: 10"},data_attrs:{v:20,hint:"Max data fields: 20"},pages:{v:20,hint:"Max pages: 20"},view_items:{v:20,hint:"Max elements: 20"}},At=function(){return _.keys(St()).length},Pt=function(){return ht().phone.length+ft().phone.length},s=function(){var t,e,n,r,i,o,a,s,u,l,c,h;t={},a=Yt();for(i in a)for(h=a[i],(c=h.scoped)&&(t[c]=!0),s=h.items||[],r=0,o=s.length;o>r;r++)if(n=s[r],n.dref){switch(u=n.dref.split(":"),e=u[0],l=2<=u.length?On.call(u,1):[],c=null,e){case"_eas":c=l[0];break;case"_ecc":2===l.length&&"x"===l[1]&&(c=l[0])}c&&(t[c]=1)}return _.keys(t)},St=function(){return j},gt=function(){return E},tt=function(){return P},bt=function(){return xn},Yt=function(){return kn},yt=function(t){return kt(t).attrs},kt=function(t){return j[t]},dt=function(t){return E[t]},pt=function(t,e){return _.find(_.values(E),function(n){return n.psn===t&&n.csn===e})},Rt=function(t){return qt().concat(Bt(t))},qt=function(){return[{label:I18n.t("js.at.sys.created_at"),an:"created_at",type:"datetime",required:!0,admin_field:!0},{label:I18n.t("js.at.sys.updated_at"),an:"updated_at",type:"datetime",required:!0,admin_field:!0}]},Bt=function(t){var e;return e=kt(t),e.acts_as_user?[{label:I18n.t("js.at.sys.status"),an:"status",type:"select",opts:{values:I18n.t("js.at.sys.status_values")},required:!0,admin_field:!0},{label:I18n.t("js.at.sys.email"),an:"email",type:"string",required:!0,unique:"1"},{label:I18n.t("js.at.sys.passwd"),an:"password",type:"string",required:!0}]:[]},Ft=function(t,e){return _.find(Rt(t),function(t){return t.an===e})},ct=function(t,e){var n,r,i;return r=e.split(":"),n=r[0],i=r[1],Qt(t,i)},Ut=function(){return e},Gt=function(){var t;return(t=kt(Ut()))&&t.acts_as_user?t:void 0},Lt=function(t,e){var n,r,i;return null==e&&(e=!1),_.isArray(t)?(n=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(kt(r).label);return i}(),e&&(i=kt(_.last(t)),n[t.length-1]=i.label_plural||i.label),n.join(" > ")):(i=kt(t),e?i.label_plural||i.label:i.label)},Nt=function(t,e){var n,r;return r=kt(t),n=_.find(r.attrs,function(t){return t.an===e})},vt=function(t,e,n){var r,i,o;return null==n&&(n={}),i=kt(t),r=_.find(i.attrs,function(t){return t.an===e}),r||(r=_.find(Rt(t),function(t){return t.an===e})),o=n.s_label||i.label,n.full?o+" > "+r.label:r.label},mt=function(t){return H[t]},wt=function(t,e){var n,r,i,o,a,s;for(a=kt(t).label,n=kt(e).label,o=[a,n].join("_"),r=i=1,s=q();s>=1?s>=i:i>=s;r=s>=1?++i:--i)R(o)&&(o=[a,n,r].join("_"));return o},Z=function(){var t,e,n,r,i;for(r=e=I18n.t("js.editor.data.unnamed"),t=n=1,i=q();i>=1?i>=n:n>=i;t=i>=1?++n:--n)_.find(St(),function(t){return t.label===r})&&(r=e+("-"+(t+1)));return r},xt=function(t,e){var n,r,i,o,a,s;for(o=r=I18n.t("js.editor.attr_type."+e,{defaultValue:I18n.t("js.editor.data.unnamed")}),s=kt(t),n=i=1,a=s.attrs.length;a>=1?a>=i:i>=a;n=a>=1?++i:--i)_.find(s.attrs,function(t){return t.label===o})&&(o=r+("-"+(n+1)));return o},_t=function(t,e,n){var r,i,o,a,s,u,l,c,h,f,d,p;if(null==n&&(n={}),f=Ut(),i=e?(s=e.split(":"),a=s[0],p=s[1],s,p?a===f?(d=Xt(a,p),"dws"===d.sdz?d.acl||{}:void 0):(h=[f,a,t].join(","),d=_.find(Zt(f),function(t){return t.spath===h}),d&&"dws"===d.sdz?d.acl||{}:void 0):void 0):void 0,!i&&!e&&n.force_sov){u=Zt(f);for(p in u)d=u[p],i||d.acl&&d.sdz&&_.last(d.spath.split(","))===t&&(i=d.acl)}return r=t===f?{}:t?(o=pt(f,t),(null!=o?o.acl:void 0)||{}):void 0,e&&(l=e.split(":"),a=l[0],p=l[1],p&&(d=Xt(a,p),d.sdz&&(r=null))),r&&i?c={create:r.create||i.create,edit:r.edit||i.edit,"delete":r["delete"]||i["delete"]}:r||i},te=function(){return T},Zt=function(t){return t?T[t]||(T[t]={}):void 0},Xt=function(t,e){return Zt(t)[e]},Kt=function(t,e){var n;return n=Xt(t,e),_.last(n.spath.split(","))},Qt=function(t,e,n){var r,i,o,a,s;for(null==n&&(n=!1),s=Xt(t,e),o=_.rest(s.spath.split(",")),r=0,i=o.length;i>r;r++)t=o[r],a=t;return Lt(a,n)},Jt=function(t){var e,n,r;return t&&(e=t.split(":"),n=e[0],r=e[1],r)?Xt.call(null,n,r):void 0},r=function(t,e){var n;return function(){var r,i,o,a;for(o=["_eas",t,e],a=[],r=0,i=o.length;i>r;r++)n=o[r],n&&a.push(n);return a}().join(":")},n=function(t){return["_acb",t].join(":")},o=function(t){return["_ecc",t,"x"].join(":")},i=function(t){return["_ecc",t].join(":")},Ee=function(t){return t?!!_.find(kt(t).attrs,function(t){return t.searchable}):void 0},Dt=function(t){var e;return t&&(e=_.filter(kt(t).attrs,function(t){var e;return"select"===t.type&&!$.isEmptyObject(null!=(e=t.opts)?e.values:void 0)}),e.length)?e:void 0},zt=function(t){var e,n,r,i,o,a,s;if(t){for(n=[],s=kt(t).attrs,r=0,o=s.length;o>r;r++)e=s[r],e.sortable&&n.push({an:e.an,label:e.label});for(n=_.sortBy(n,function(t){return t.label}),n.unshift({an:"created_at",label:I18n.t("js.at.sys.created_at")}),i=0,a=n.length;a>i;i++)e=n[i],e.sel=[{k:e.an+":asc",label:e.label+" ("+I18n.t("js.shared.sort_asc")+")"},{k:e.an+":desc",label:e.label+" ("+I18n.t("js.shared.sort_desc")+")"}];return n}},U=function(t){var e;return _.flatten(function(){var n,r,i,o;for(i=[!0,!1],o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(a(e,[t]));return o}())},a=function(t,e,n){var r,i,o,s,u,l,c,h,f,d,p,g,m,v;null==n&&(n=[]),f=t?["csn","psn"]:["psn","csn"],r=f[0],u=f[1],g=[],m=_.last(e);for(c in E)o=E[c],o[r]===m&&(s=o[u],-1===e.indexOf(s)&&!function(e,n){var r,i,o,s,u;for(g.push({dirbw:t,spath:e.join(","),apath:n.join(","),sdz:e.length>2?t?"ups":"dws":null,multiple:!t&&!!_.find(n,function(t){return dt(t).multiple}),required:t?!_.find(n,function(t){return!dt(t).required}):!1}),o=a(t,e,n),s=[],r=0,i=o.length;i>r;r++)u=o[r],s.push(g.push(u));return s}(e.concat(s),n.concat(c)));if(!t&&0===n.length){d=z(m);for(s in d){v=d[s];for(h in v)p=v[h],i=p[0],l=p[1],g.push({dirbw:!1,spath:[m,h,s].join(","),apath:[i._cn,l._cn].join(","),sdz:"hmt",multiple:!0})}}return g},jt=function(){var t,e,n,r,i,o,a,s,u,l,c,h,f;for(l=_.keys(St()),s=[],t=0,n=l.length;n>t;t++){for(u=l[t],f=Zt(u),o=function(){var t;t=[];for(h in f)c=f[h],t.push({zidx:h,z:c,remove:!0});return t}(),a=U(u),e=0,r=a.length;r>e;e++)c=a[e],(i=_.find(o,function(t){return t.z.apath===c.apath}))?(f[i.zidx]=c,i.remove=!1):(h=K(u),f[h]=c);s.push(function(){var t,e,n;for(e=[],n=0,t=o.length;t>n;n++)i=o[n],i.remove&&e.push(delete f[i.zidx]);return e}())}return s},X=function(){var t,e,n,r;t=P,e=t.sqn_sn||0;for(r in j)n=j[r],e=Math.max(e,~~r.replace(/^_/,""));return t.sqn_sn=e+1,"_"+t.sqn_sn},Y=function(){var t,e,n;t=0;for(n in E)e=E[n],t=Math.max(t,~~n.replace(/^_/,""));return"_"+(t+1)},K=function(t){var e,n,r,i;e=0,n=Zt(t);for(i in n)r=n[i],e=Math.max(e,~~i.replace(/^_/,""));return"_"+(e+1)},J=function(t){var e,n,r,i,o;for(i=t.sqn||0,o=t.attrs,n=0,r=o.length;r>n;n++)e=o[n],i=Math.max(i,~~e.an.replace(/^_/,""));return t.sqn=i+1,"_"+t.sqn},Q=function(t,e){var n,r,i,o,a,s,u,l;for(n=kt(t).attrs[e],a=n.sqn||0,u=(null!=(s=n.opts)?s.values:void 0)||{},l=r=0,o=u.length;o>r;l=++r)i=u[l],a=Math.max(a,~~i.replace(/^_/,""));return n.sqn=a+1,"_"+n.sqn},Ct=function(){var t,e,n;return t=_.range(10),n=_.difference(t,_.map(_.values(j),function(t){return~~t.color})),0===n.length&&(n=t),e=_.sample(n).toString(),{label:Z(),color:e,attrs:[]}},W=function(t){var e;return t=ot(t),t.attrs=[],e=X(),j[e]=t,e},lt=function(t,e){var n,r,i,o;e=ot(e),i=kt(t),r=[];for(n in e)o=e[n],r.push(i[n]=o);return r},nt=function(t){var e,n;delete j[t],delete T[t];for(e in E)n=E[e],(n.psn===t||n.csn===t)&&(n.dirty=!0);return ve(function(e,n){return n===t?_n(e):void 0})},Mt=function(t,e,n){var r,i,o,a,s;if(t===Ut()&&"email"===e){if(s=kt(t),n.is_label)for(a=s.attrs,i=0,o=a.length;o>i;i++)r=a[i],r.is_label&&(r.is_label=null);return s.email_is_label=!!n.is_label}},Et=function(t,e,n){var r,i,o,a,s,u;if(n.opts_json&&(n.opts=JSON.parse(n.opts_json),delete n.opts_json),n=at(t,e,n),u=kt(t),null!=e){if(i=u.attrs[e],n.is_label){for(s=u.attrs,o=0,a=s.length;a>o;o++)r=s[o],r.is_label&&(r.is_label=null);u.acts_as_user&&(u.email_is_label=null)}return u.attrs[e]=_.extend({},n,{an:i.an})}return n.searchable="text"===n.type&&H.text.search?"1":null,n.sortable="number"!==n.type&&"date"!==n.type||!H[n.type].sort?null:"1",n.an=J(u),u.attrs||(u.attrs=[]),u.attrs.push(n)},rt=function(t,e){var n,r,i,o,a,s;return a=kt(t),i=a.attrs[e],a.attrs.splice(e,1),o=[t,i],s=o[0],r=o[1],n=r.an,fe(function(t,e,r,i,o){return i===s&&o===n&&bn(t,e),he(function(t,e,r,i,o,a,u){var l;return l=Kt(o,a),l===s&&u===n?bn(t,e):void 0})})},l=function(t){var e,n,r;return r=Ut(),n=t.psn,e=t.csn,n===r||e===r?$.extend({},t,{acl:{create:"1",edit:"1","delete":"1"}}):t},G=function(t){var e,n;return e=l(t),n=Y(),E[n]=e,jt()},u=function(t){var e,n,r,i,o,a,s,u,l,c,h;if(h=Ut(),(t.psn===h||t.csn===h)&&(e={create:"1",edit:"1","delete":"1"}),t.is_free)for(u=[t.psn,t.csn],s=u[0],n=u[1],a=wt(s,n),o=W({label:a}),l=[s,n],r=0,i=l.length;i>r;r++)c=l[r],G({psn:c,csn:o,multiple:"1",required:"1"});else G(t);return t},st=function(t,e){var n,r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,b;if(i=E[t],r=_.extend({},e,{attrs:E[t].attrs}),E[t]=r,!!i.multiple!=!!r.multiple&&(r.modified="multiple",me(function(e,n,r){var i,o,a;return n&&(o=n.split(":"),i=o[0],a=o[1],It(i,a,t)&&_n(e)),r?!0:void 0}),pe(function(e,n,r,i){return It(r,i,t)?bn(e,n):void 0})),!!i.required!=!!r.required&&(r.modified="required"),r.unique!==i.unique){if(s=r.csn,c={add:!!r.unique},o=I(s),a=function(){var t,e,r;for(r=[],t=0,e=o.length;e>t;t++)n=o[t],n.unique&&r.push(n._cn);return r}(),1===a.length)for(u=0,l=o.length;l>u;u++)n=o[u],dt(n._cn).unique=c.add?"1":null;o=I(s),a=function(){var t,e,r;for(r=[],t=0,e=o.length;e>t;t++)n=o[t],n.unique&&r.push(n._cn);return r}(),a.length>1?kt(s).comp_uniq=a.sort():kt(s).comp_uniq=null}return v=(null!=(h=i.acl)?h.create:void 0)&&!(null!=(f=r.acl)?f.create:void 0),b=(null!=(d=i.acl)?d.edit:void 0)&&!(null!=(p=r.acl)?p.edit:void 0),y=(null!=(g=i.acl)?g["delete"]:void 0)&&!(null!=(m=r.acl)?m["delete"]:void 0),(v||b||y)&&ue(function(t,e,n,i){return C(r,[e,n.sn])&&(v&&(i.create=null),b&&(i.edit=null),y)?i["delete"]=null:void 0}),e},et=function(t){var e;return e=dt(t),e.dirty=!0},$t=function(t,e,n){return t===Ut()?Zt(t)[e].acl=n:void 0},it=function(t,e){var n;return n=kt(t),n.attrs=_.sortBy(n.attrs,function(t,n){return e.indexOf(n)})},ut=function(t){var e,n,r,i,o,a,s;if(!t){o=Yt();for(e in o)for(s=o[e],a=s.items,r=0,i=a.length;i>r;r++)n=a[r],"button"===n.type&&(n.allow_guest=!1)}return M=t},function(){return h=function(t,e){return dn(W.partial(t),e)},y=function(t,e,n){return dn(lt.partial(t,e),n)},d=function(t,e){return dn(nt.partial(t),e)},x=function(t,e,n,r){return dn(Mt.partial(t,e,n),r)},b=function(t,e,n,r){return dn(Et.partial(t,e,n),r)},p=function(t,e,n){return dn(rt.partial(t,e),n)},c=function(t,e){return dn(u.partial(t),e)},m=function(t,e,n){return dn(st.partial(e,t),n)},f=function(t,e){return dn(et.partial(t),e)},w=function(t,e,n,r){return dn($t.partial(t,e,n),r)},g=function(t,e,n){return dn(it.partial(t,e),n)},v=function(t,e){return dn(ut.partial(t),e)}}(),C=function(t,e){var n,r,i,o;return o=t.psn,n=t.csn,i=e[0],r=e[1],o===i&&n===r},L=function(t,e){return t.psn===e.psn&&t.csn===e.csn},It=function(t,e,n){var r;return r=Xt(t,e),-1!==r.apath.split(",").indexOf(n)},_n=function(t){var e,n,r,i,o,a,s,u,l,c,h,f,d,p;if(p=Wt(t),!p.dirty){if(p.dirty=!0,p.vref&&!Se(p.vref)&&_n(p.vref),p.items)for(l=p.items,r=0,o=l.length;o>r;r++)e=l[r],e.cid&&_n(e.cid);c=Yt();for(s in c)if(u=c[s],u.items&&!u.dirty)for(h=u.items,n=i=0,a=h.length;a>i;n=++i)e=h[n],e.cid===t&&bn(s,n);f=Yt(),d=[];for(s in f)u=f[s],u.items&&!u.dirty&&(u.anchor===t?d.push(_n(s)):d.push(void 0));return d}},bn=function(t,e){var n,r;return r=Wt(t),r.dirty||(n=r.items[e],n.dirty||(n.dirty=!0,"view"!==n.type))?void 0:_n(n.cid)},k=function(){var t,e,n,r,i;if(_.find(_.values(E),function(t){return t.dirty||t.modified})){for(e in E)t=E[e],t.dirty&&delete E[e];for(e in E)t=E[e],t.modified&&delete t.modified;jt(),n=St();for(i in n)r=n[i],r.comp_uniq&&(r.comp_uniq=function(){var t,n,i,o,a;for(i=r.comp_uniq,a=[],t=0,n=i.length;n>t;t++)e=i[t],(null!=(o=dt(e))?o.unique:void 0)&&a.push(e);return a}(),r.comp_uniq.length<2&&(r.comp_uniq=null));return me(function(t,e,n){var r,i,o,a;return e&&(i=e.split(":"),r=i[0],a=i[1],o=Xt(r,a),o||_n(t)),n?!0:void 0}),ce(function(t,e,n,r,i){var o,a,s,u;switch(r){case"_eas":if(i.length&&(u=i[0],o=i[1],s=Xt(Wt(t).sn,u),!s))return bn(t,e);break;case"_ecc":if(2===i.length&&(u=i[0],a=i[1],s=Xt(Wt(t).sn,u),!s))return bn(t,e)}}),le(function(t,e,n,r,i){var o,a;return"_acb"!==r||(a=i[0],o=Xt(Wt(t).sn,a))?void 0:bn(t,e)})}},S=function(){var t,e,n,r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,b,x,w,k,S,C,E,M,A,P,j,T,N,$,I,L,O;m=Yt();for(o in m)L=m[o],L.dirty&&delete kn[o];v=Yt();for(o in v)L=v[o],L.items&&_.find(L.items,function(t){return t.dirty})&&(L.items=_.filter(L.items,function(t){return!t.dirty}));k=Yt();for(o in k)L=k[o],L.vref&&(Wt(L.vref)||delete L.vref);S=Yt();for(o in S)if(L=S[o],L.items)for(C=L.items,f=0,p=C.length;p>f;f++)s=C[f],s.vref&&(Wt(s.vref)||delete s.vref);E=Yt();for(o in E)if(L=E[o],L.is_list&&L.list_opts){if(L.list_opts.search&&!Ee(L.sn)&&(L.list_opts.search=null),L.list_opts.filter){c=null,M=L.list_opts.filter;for(u in M){h=M[u],l="0"===u?L.sn:(O=Jt(L.scoped),O.spath.split(",").reverse()[~~u]);for(e in h)n=h[e],(i=Nt(l,e))&&"select"===i.type&&(r=_.intersection(n,_.union(_.keys(null!=(A=i.opts)?A.values:void 0),[""])),r.length&&(c||(c={}),c[u]||(c[u]={}),c[u][e]=r))}L.list_opts.filter=c}if(L.list_opts.sortable){if(null!=(P=L.list_opts.sortables)?P.length:void 0){for(I=null,l=L.sn,j=L.list_opts.sortables,d=0,g=j.length;g>d;d++)e=j[d],("created_at"===e||(null!=(y=Nt(l,e))?y.sortable:void 0))&&(I||(I=[]),I.push(e));L.list_opts.sortables=I}(null!=(b=L.list_opts.sortables)?b.length:void 0)||(L.list_opts.sortable=null,L.list_opts.sortables=null)}else L.list_opts.sortables=null}x=Yt();for(o in x)L=x[o],t=_t(L.sn,L.scoped,{force_sov:Ce(o)}),t?L.acl=_.pick(L.acl,function(e,n,r){return t[n]}):L.acl=null;w=bt(),T=[];for(a in w)L=w[a],N=Tt(a),N.views=_.filter(N.views,function(t){return null!=Wt(t)}),$=Ot(a),T.push($.views=_.filter($.views,function(t){return null!=Wt(t)}));return T},ot=function(t){var e,n,r,i;for(i=["label","label_plural","color"],e=0,r=i.length;r>e;e++)n=i[e],t[n]=$.trim(t[n]);return t},at=function(t,e,n){var r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y;for(h=["label"],o=0,u=h.length;u>o;o++)a=h[o],n[a]=$.trim(n[a]);if(null!=e)switch(r=kt(t).attrs[e],r.type){case"select":if(p=n.opts)if(p.input_values){for(y={},f=p.input_values,s=0,l=f.length;l>s;s++)d=f[s],g=d[0],m=d[1],(c=$.trim(m))&&(_.find(_.values(y),function(t){return t===c})||(g||(g=Q(t,e)),y[g]=c));n.opts={values:y},n.sqn=r.sqn}else n.opts=r.opts,n.sqn=r.sqn;break;case"image":if(i=n.opts)for(a in i)v=i[a],"upload"!==a&&(i[a]=$.trim(v))}return n},t.trim_view=function(t){var e,n,r,i;for(i=["label"],e=0,r=i.length;r>e;e++)n=i[e],t[n]&&(t[n]=$.trim(t[n]));return t},t.trim_view_item=function(t){var e,n,r,i,o,a,s;for(a=["value"],e=0,i=a.length;i>e;e++)n=a[e],t[n]&&(t[n]=$.trim(t[n]));if(t.style)for(s=["label_custom"],r=0,o=s.length;o>r;r++)n=s[r],t.style[n]&&(t.style[n]=$.trim(t.style[n]));return t},function(){return V=function(t,e){return j=t._mods,E=t._rels,T=t._zscs,P=t._meta||{},A=e.lock,M=e.enable_guest},q=function(){return _.keys(j).length},B=function(){return _.keys(E).length},R=function(t){var e,n,r;e=St();for(r in e)if(n=e[r],n.label===t)return r;return null},N=function(t){return t?kt(t).attrs:[]},O=function(t,e){var n,r,i,o,a;a=[],o=gt();for(i in o)r=o[i],r.psn===e&&r.csn===t&&(n=r.acl)&&(n.create||n.edit||n["delete"])&&a.push(r);return a},I=function(t,e){var n,r,i,o,a,s,u,l,c,h,f,d;if(null==e&&(e={}),r={create:!0,edit:!0,"delete":!0},c=[],e.sdz){u=Zt(t);for(d in u)f=u[d],f.sdz&&f.dirbw&&(s=f.spath.split(","),o=_.last(s),a=function(){var t,e,n,r;for(n=s.slice(1),r=[],t=0,e=n.length;e>t;t++)h=n[t],r.push({sn:h,label:kt(h).label});return r}(),i={asn:o,ci:a},c.push(i));return c}l=Zt(t);for(d in l)f=l[d],!f.sdz&&f.dirbw&&(n=f.apath,o=_.last(f.spath.split(",")),i=$.extend({},dt(n),{_cn:n,asn:o,label:kt(o).label,acl_c:r}),c.push(i));return c.sort(function(t,e){return t.psn<e.psn?-1:t.psn>e.psn?1:0})},D=function(t,e){var n,r,i,o,a,s,u,l,c,h,f,d,p,g;if(null==e&&(e={}),i={create:!0,edit:!0,"delete":!0},o={dws:{"delete":!0}},f=[],e.sdz){c=Zt(t);for(g in c)p=c[g],p.sdz&&!p.dirbw&&(l=p.spath.split(","),s=_.last(l),u=function(){var t,e,n,r;for(n=l.slice(1),r=[],t=0,e=n.length;e>t;t++)d=n[t],r.push({sn:d,label:kt(d).label});return r}(),r=i=null,t===Ut()&&(r=p.acl||{},i=o[p.sdz]),a={_zidx:g,asn:s,ci:u,acl:r,acl_c:i},f.push(a));return f}h=Zt(t);for(g in h)p=h[g],p.sdz||p.dirbw||(n=p.apath,s=_.last(p.spath.split(",")),a=$.extend({},dt(n),{_cn:n,asn:s,label:kt(s).label,acl_c:i}),f.push(a));return f.sort(function(t,e){return t.csn<e.csn?-1:t.csn>e.csn?1:0})},z=function(t){var e,n,r,i,o,a,s,u,l;l={},a=gt();for(e in a)if(r=a[e],r.psn===t&&r.multiple){s=gt();for(n in s)i=s[n],i.csn===r.csn&&i.multiple&&i.psn!==t&&(u=[e,n],r._cn=u[0],i._cn=u[1],l[o=i.psn]||(l[o]={}),l[i.psn][i.csn]=[r,i])}return l},F=function(t){var e,n,r,i;return i=function(){var i,o;i=gt(),o=[];for(e in i)n=i[e],(n.csn===t||n.psn===t)&&(r=t===n.psn?{is_origin:!0,csn:n.csn,multiple:n.multiple,acl:n.acl}:{is_origin:!1,csn:n.psn,required:n.required,acl:n.acl},o.push($.extend({_cn:e},r)));return o}(),i.sort(function(t,e){return!t.is_origin&&e.is_origin?-1:t.is_origin&&!e.is_origin?1:t.required&&!e.required?-1:!t.required&&e.required?1:t.csn<e.csn?-1:t.csn>e.csn?1:0})}}(),function(){return wn=function(t){var e;return e={phone:{root:{views:[]},seco:{views:[]}},tablet:{root:{views:[]},seco:{views:[]}}},xn=t._vdts||e,kn=t._pgvs||{}}}()}}(this)(),Tt=null,Ot=null,Ht=null,ht=null,ft=null,Wt=null,$t=null,Et=null,Vt=null,Mt=null,It=null,ke=null,Se=null,Ce=null,Me=null,xe=null,we=null,Q=null,W=null,Y=null,X=null,G=null,J=null,it=null,tt=null,at=null,ut=null,st=null,lt=null,ot=null,Z=null,K=null,rt=null,nt=null,et=null,function(t){return function(){var e,n,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,b,x,w,k,S,C,E,M,A,P,j;return Tt=function(t){var e;return null!=(e=bt()[t])?e.root:void 0},Ot=function(t){var e;return null!=(e=bt()[t])?e.seco:void 0},Ht=function(t,e){var n;return null!=(n=bt()[t])?n[e]:void 0},ht=function(){var t,e,n,r;n={},e=bt();for(t in e)r=e[t],r.root&&(n[t]=r.root.views);return n;
},ft=function(){var t,e,n,r;n={},e=bt();for(t in e)r=e[t],r.seco&&(n[t]=r.seco.views);return n},Wt=function(t){return kn[t]},$t=function(t){var e,n,r;n=Yt();for(e in n)if(r=n[e],_.find(r.items,function(e){return e.vref===t}))return e;return null},Et=function(t,e){var n,r,i,o;if(null==e&&(e=device_type),n=Tt(e).views.indexOf(t),n>-1)return null;if(n=Ot(e).views.indexOf(t),n>-1)return null;i=Yt();for(r in i)if(o=i[r],_.find(o.items,function(e){return e.cid===t}))return r;return null},Vt=function(t,e){var n,r,i;if(null==e&&(e=device_type),Tt(e).views.indexOf(t)>-1)return t;if(Ot(e).views.indexOf(t)>-1)return t;r=Yt();for(n in r)if(i=r[n],_.find(i.items,function(e){return e.cid===t}))return Vt(n,e);return null},Mt=function(t){var e,n,r,i;r=ht();for(e in r)if(i=r[e],n=i.indexOf(t),n>-1)return n;return null},It=function(t){var e,n,r,i;r=ft();for(e in r)if(i=r[e],n=i.indexOf(t),n>-1)return n;return null},we=function(t){var e;return e=Wt(t),e.anchor?we(e.anchor):!!e.is_list},ke=function(t,e){return-1!==Tt(e).views.indexOf(t)},Se=function(t,e){var n,r;if(e)return-1!==Ot(e).views.indexOf(t);n=ft();for(e in n)if(r=n[e],r.indexOf(t)>-1)return t},Ce=function(t){var e,n,r,i;if(Se(t))return!0;e=!1,r=Yt();for(n in r)i=r[n],e||i.anchor===t&&(e=!0);return e&&Se(n)},Me=function(t,e){var n;return(n=Et(t,e))?Wt(n).is_tabbed:void 0},xe=function(t){var e,n,r;n=Yt();for(e in n)if(r=n[e],r.is_list&&r.vref&&r.vref===t)return!0;return!1},t.cid_to_loc=function(t,e){var n,r,i,o,a,s;if(null==e&&(e=[]),r=Tt(device_type).views.indexOf(t),r>-1)return e.unshift(r),"p-"+e.join("-");if(r=Ot(device_type).views.indexOf(t),r>-1)return e.unshift(r),"s-"+e.join("-");o=Yt();for(i in o)if(a=o[i],s=function(){var t,e,r,i;for(r=_.filter(a.items,function(t){return t.cid}),i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(n.cid);return i}(),r=s.indexOf(t),r>-1)return e.unshift(r),cid_to_loc(i,e);return null},h=function(t){var e;for(t=trim_view(t),e=Ue();Wt(e);)e=Ue();return kn[e]=JSON.parse(JSON.stringify(t)),e},b=function(t,e){var n,r,i,o,a,s;switch(t){case"root":r=ht(),o=[];for(n in r)s=r[n],o.push(Tt(n).views=_.sortBy(Tt(n).views,function(t,n){return e.indexOf(n)}));return o;case"seco":i=ft(),a=[];for(n in i)s=i[n],a.push(Ot(n).views=_.sortBy(Ot(n).views,function(t,n){return e.indexOf(n)}));return a}},x=function(t,e){var n,r,i,o,a,s;for(r=Wt(t).items,n=r.splice(0,r.length),s=[],i=0,o=e.length;o>i;i++)a=e[i],s.push(r.push($.extend(n[a.idx],{pos:a.pos})));return s},w=function(t,e){var n;return n=Wt(t),n.is_tabbed?n.items=_.sortBy(n.items,function(t,n){return e.indexOf(n)}):void 0},u=function(t){var e,n;return n=Ut(),e=_.find(_.values(gt()),function(e){return e.psn===n&&e.csn===t}),!!e},g=function(t,e){var n,i,o,a,s,l,c,h,f,d,p,g,m,v,y,b,x,w,k,S;for(w=kt(t),h=[],k=Ut(),u(t)&&(g=[t,k].join(","),m=_.find(_.pairs(Zt(t)),function(t){var e,n;return n=t[0],e=t[1],e.dirbw&&e.spath===g}),S=m[0],n=m[1],s=r(S),v=Ge(k),c=v.has_label,d=v.label_inline,h.push({dref:s,style:{has_label:c,label_inline:d}})),a=_.filter(w.attrs,function(t){return!t.admin_field}),y=a.slice(0,6),f=0,p=y.length;p>f;f++)i=y[f],b=Ge(t,i.an),c=b.has_label,d=b.label_inline,l={dref:i.an,style:{has_label:c,label_inline:d}},"image"===i.type&&(l.style={image:"1"}),"geoloc"===i.type&&(l.style={map:"1"}),h.push(l);return o="created_at",x=Ge(t,o),c=x.has_label,d=x.label_inline,h.push({dref:o,style:{has_label:c,label_inline:d}}),h},i=function(t){var e,n,r,i,o,a,s,u,l,c,f,d,p,m;p=t.sn,o=t.is_list,s=t.label,e=t.acl,u=t.list_opts,d=t.scoped,p?(d?a=!0:p!==Ut()||o||(a=!0),r={sn:p,is_list:o,scoped:d,label:s,acl:e,list_opts:u,items:g(p,o)}):r={label:s,items:[]},c=ht(),f=[];for(i in c)m=c[i],n=h(r),a?(l=d?h({anchor:n,sn:Ut(),items:[{type:"view",cid:n}]}):n,Wt(l).is_my_scope=!0):l=r.sn?h({anchor:n,items:[{type:"view",cid:n}]}):n,m.push(l),f.push(Wt(l).device_sync=!0);return f},o=function(t){var e,n,r,i,o,a,s,u,l,c,f,d;if(f=t.sn,o=t.is_list,a=t.label,e=t.acl,s=t.list_opts,f){r={sn:f,is_list:o,acl:e,list_opts:s,items:g(f,o)},l=ft(),c=[];for(i in l)d=l[i],n=h(r),u=o?h({anchor:n,items:[{type:"view",cid:n}]}):n,d.push(u),c.push(Wt(u).device_sync=!0);return c}},a=function(t,e){var n,r,i,o,a,s,u,l,c,f;return u=Wt(t),c=e.sn,o=e.is_list,l=e.scoped,a=e.label,n=e.acl,s=e.list_opts,i=c?{sn:c,is_list:o,scoped:l,label:a,acl:n,list_opts:s,items:g(c,o)}:{label:a,items:[]},r=h(i),f=h({anchor:r,items:[{type:"view",cid:r}]}),Wt(t).items.push({type:"view",cid:f}),f},n=function(t,n){var r,i,o,a,s,u,c,f,d,p,m;if(m=n.sn,a=n.is_list,u=n.label,r=n.acl,c=n.list_opts,d=n.s_cid,p=n.scoped,t===d)throw"invalid";return s=g(m,a),f=Wt(d).sn,p?(o=h({sn:f}),i=l(o,{sn:m,is_list:a,label:u,acl:r,list_opts:c,items:s},{s_cid:o,scoped:p})):o=h({sn:f,items:s,label:u,acl:r,list_opts:c}),e(t,o,{layout:"vertical"}),Wt(d).vref=o,o},s=function(t,e){var n,r,i,o,a,s,u,h,f;if(f=e.sn,i=e.is_list,a=e.label,n=e.acl,s=e.list_opts,u=e.s_cid,h=e.scoped,t!==u)throw"invalid";return o=g(f,i),r=l(t,{sn:f,is_list:i,acl:n,list_opts:s,items:o},{s_cid:u,scoped:h}),r||(r=c(t,{sn:f,is_list:i,acl:n,list_opts:s,items:o})),r},l=function(t,n,r){var i,o,a,s,u,l,c,f,d,p,g,m,v;return v=n.sn,u=n.is_list,l=n.items,c=n.label,i=n.acl,f=n.list_opts,g=r.s_cid,m=r.scoped,p=[Wt(g).sn,v],d=p[0],a=p[1],d&&a?d===a&&(m="selected"):m=null,m?("selected"===m&&(m=null),s={sn:v,is_list:u,items:l,scoped:m,label:c,acl:i,list_opts:f},o=h(s),e(t,o),o):void 0},c=function(t,n){var r,i,o,a,s,u,l,c;return c=n.sn,a=n.is_list,s=n.items,u=n.label,r=n.acl,l=n.list_opts,o={sn:c,is_list:a,items:s,label:u,acl:r,list_opts:l},i=h(o),e(t,i),i},k=function(t,n,r){var i,o,a,s,u,l,c,f,d,p,g,m,v,y,b,_,x;if(m=Wt(n),_=m.sn,l=m.is_list,c=m.items,b=m.scoped,f=m.label,a=m.acl,d=m.list_opts,s={sn:_,is_list:l,items:c,scoped:b,label:f,acl:a,list_opts:d},g=Mt(t),null!=g){v=ht(),y=[];for(u in v)x=v[u],u!==device_type&&(i=h(s),o=x[g],p=Wt(o),p._cid=o,e(o,i),y.push(r&&r.call(null,u,p,Wt(i))));return y}},f=function(t,e){var n,r,i,o,a,s,u,l,c,h,f,g,m,v,y,b,_,x,w;g=Se(t)?["seco",It(t)]:["root",Mt(t)],x=g[0],l=g[1],m=bt(),b=[];for(s in m){if(_=m[s],r=_[x].views[l],e&&r!==t){_n(r),f=r,a={},r=_[x].views[l]=d(t,a);for(i in a)o=a[i],p(o,s,a);if("seco"===x){v=Yt();for(n in v)for(w=v[n],w.vref===f&&(w.vref=r),y=w.items,c=0,h=y.length;h>c;c++)u=y[c],u.vref===f&&(u.vref=r)}}b.push(Wt(r).device_sync=e)}return b},d=function(t,e){var n,r,i,o,a;for(n=on(Wt(t)),a=n.items,i=0,o=a.length;o>i;i++)r=a[i],r.cid&&(r.cid=d(r.cid,e));return e[t]=h(n)},p=function(t,e,n){var r,i,o,a,s,u;for(i=Wt(t),u=i.items,a=0,s=u.length;s>a;a++)o=u[a],(r=o.vref)&&(o.vref=Ot(e).views[It(r)]);return(r=i.vref)&&(Se(r)?i.vref=Ot(e).views[It(r)]:i.vref=n[r]),(r=i.anchor)?i.anchor=n[r]:void 0},e=function(t,e,n){var r,i,o,a,s,u;if(null==n&&(n={}),a=Wt(t),a.items||(a.items=[]),"vertical"===n.layout){if((u=function(){var t,e,n,i;for(n=a.items,i=[],t=0,e=n.length;e>t;t++)r=n[t],r.cid&&i.push(r);return i}()).length&&1===_.uniq(function(){var t,e,n,i;for(n=a.items,i=[],t=0,e=n.length;e>t;t++)r=n[t],i.push(r.pos||"d");return i}()).length)for(s=a.items,i=0,o=s.length;o>i;i++)r=s[i],r.pos="l";a.items.push({type:"view",cid:e,pos:"r"})}else a.items.push({type:"view",cid:e});return e},y=function(t){var e,n,r,i,o,a,s,u,l,c,h,f,d;if(t===Vt(t)){if(o=Mt(t),null!=o){a=bt(),c=[];for(n in a)d=a[n],c.push(_n(d.root.views[o]));return c}o=It(t),s=bt();for(n in s)d=s[n],_n(d.seco.views[o]);u=Yt(),h=[];for(e in u)d=u[e],d.items&&h.push(function(){var e,n,o,a;for(o=d.items,a=[],i=e=0,n=o.length;n>e;i=++e)r=o[i],r.vref===t&&a.push(r.vref=null);return a}());return h}_n(t),l=Yt(),f=[];for(t in l)d=l[t],d.items&&f.push(function(){var e,n,o,a;for(o=d.items,a=[],i=e=0,n=o.length;n>e;i=++e)r=o[i],r.cid===t&&a.push(bn(t,i));return a}());return f},m=function(t){var e,n,r;return n=Wt(t),(r=n.vref)&&(e=Vt(r))&&e===Vt(t)&&_n(r),n.vref=null},E=function(t,e){var n,r,i,o,a,s,u,l,c,h,f,d,p,g;for(e=trim_view(e),g=Wt(t),c=["scoped","vref","label","alc","acl"],i=0,a=c.length;a>i;i++)n=c[i],g[n]=e[n];if(g.list_opts=null,e.list_opts&&g.is_list)for(g.list_opts={},h=["limit","order","search","filter","sortable","sortables"],o=0,s=h.length;s>o;o++)n=h[o],g.list_opts[n]=e.list_opts[n];if(ke(t,device_type)){for(l=Mt(t),f=["phone","tablet"],d=[],p=0,u=f.length;u>p;p++)r=f[p],d.push(Wt(bt()[r].root.views[l]).alc=g.alc);return d}},A=function(t,e){var n;return e=$.trim(e),n=Wt(t),n.label=e},M=function(t,e,n){var r,i,o,a,s,u,l,c,h;for(n=trim_view_item(n),i={},l=["type","dref","vref","aref","value","pos","allow_guest","brand"],o=0,s=l.length;s>o;o++)r=l[o],i[r]=n[r];if(i.style={},n.style)for(c=["has_label","label_inline","label_custom","text_style","text_align","image","map","downloadable"],a=0,u=c.length;u>a;a++)r=c[a],(h=n.style[r])&&(i.style[r]=h);return""===e&&(e=null),h=Wt(t),null!=e?h.items[e]=i:h.items.push(i)},P=function(t,e,n){return e.vref=n},C=function(t,e){var n,r,i;return i=Wt(t),n=i.items[e],n.style||(n.style={}),r=n.style,r.has_label?r.label_inline?(r.has_label=null,r.label_inline=null):(r.has_label="1",r.label_inline="1",(r.image||r.map)&&(r.has_label=null,r.label_inline=null)):(r.has_label="1",r.label_inline=null),r},t.tabbable_view=function(t){var e,n,r,i,o,a,s,u,l,c,h,f;if(t.is_tabbed)return!0;if(t.items.length){if(l=_.groupBy(t.items,function(t){return"view"===t.type?"items":"free_items"}),r=l.items,n=l.free_items,h={},r){for(u={},i=0,a=r.length;a>i;i++)e=r[i],f=Wt(e.cid),f.vref&&(u[f.vref]=e.cid);for(o=0,s=r.length;s>o;o++)e=r[o],c=u[e.cid]||e.cid,h[c]||(h[c]=[]),h[c].push(e)}return n&&(h.free_items=n),h}},S=function(t,e){var n,r,i,o,a,s,u,l,c,f,d,p,g,m,v,y,b;if(null==e&&(e=device_type),t===Vt(t,e)){if(y=Wt(t),y.is_tabbed){for(n=[],y.anchor&&(y.anchor=Wt(y.anchor).anchor),d=y.items,a=0,l=d.length;l>a;a++){for(r=d[a],b=Wt(r.cid),p=b.items,u=0,c=p.length;c>u;u++)i=p[u],n.push(i);b.items=[],_n(r.cid)}for(y.items=[],v=0,f=n.length;f>v;v++)r=n[v],r.pos=null,y.items.push(r)}else{if(!(m=tabbable_view(y)))return;y.items=[];for(s in m)o=m[s],"free_items"===s?(g=h({items:m.free_items,sn:y.sn,acl:y.acl}),y.items.push({type:"view",cid:g}),y.anchor||(y.anchor=g)):(g=h({anchor:s,items:o}),y.items.push({type:"view",cid:g}),y.anchor===s&&(y.anchor=g));y.items=y.items.sort(function(t,e){return y.anchor===t.cid?-1:1})}return y.is_tabbed=!y.is_tabbed}},v=function(t,e){return bn(t,e)},j=function(t,e,n){var r;return r=Vt(t),Wt(r).device_sync?n.call(null,function(t){return pn(f.partial(r,!0),function(){return e(t)})}):n(e)},function(){return Q=function(t,e,n){return pn(f.partial(t,e),n)},W=function(t,e){return pn(i.partial(t),e)},Y=function(t,e){return pn(o.partial(t),e)},X=function(t,e,n){return j(t,n,function(n){return pn(a.partial(t,e),n)})},G=function(t,e,r){return j(t,r,function(r){return pn(n.partial(t,e),r)})},J=function(t,e,n){return j(t,n,function(n){return pn(s.partial(t,e),n)})},it=function(t,e){return j(t,e,function(e){return pn(S.partial(t),e)})},tt=function(t,e,n){return e?pn(y.partial(t),n):j(t,n,function(e){return pn(y.partial(t),e)})},at=function(t,e,n){return j(t,n,function(n){return pn(E.partial(t,e),n)})},ut=function(t,e,n){return j(t,n,function(n){return pn(A.partial(t,e),n)})},st=function(t,e,n,r){return j(t,r,function(r){return pn(M.partial(t,e,n),r)})},lt=function(t,e,n,r){return j(t,r,function(r){return pn(P.partial(t,e,n),r)})},ot=function(t,e,n){return j(t,n,function(n){return pn(C.partial(t,e),n)})},Z=function(t,e,n){return j(t,n,function(n){return pn(v.partial(t,e),n)})},K=function(t,e){return j(t,e,function(e){return pn(m.partial(t),e)})},rt=function(t,e,n){return j(t,n,function(n){return pn(w.partial(t,e),n)})},nt=function(t,e,n){return j(t,n,function(n){return pn(x.partial(t,e),n)})},et=function(t,e,n){return pn(b.partial(t,e),n)}}()}}(this)(),He=null,Ye=null,Ge=null,We=null,An=null,Pn=null,Mn=null,jn=null,Tn=null,En=null,Sn=null,Cn=null,function(e){return function(){var a,s,u,l,c,h,f,d,p,g,m;return p=function(t){var e,n,r,i,o,a,s;r=[],n=Zt(t);for(s in n)a=n[s],a.dirbw||(o=a.spath.split(","),e=_.last(o),i=Lt(_.rest(o),!0),r.push({avasc1:!0,sn:e,color:e,label:i,zidx:s,sdz:a.sdz,multiple:a.multiple}));return r},s=function(t){var e,n,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y;p=[],h=Zt(t);for(y in h)if(v=h[y],v.dirbw)for(m=v.spath.split(","),n=_.last(m),i=yt(n),f=[{}].concat(i),u=0,c=f.length;c>u;u++)e=f[u],d=r(y,e.an),g=Lt(_.rest(m)),l=e.an?vt(n,e.an,{full:!0,s_label:g}):g,a="image"===e.type,o="image"===e.type||"attach"===e.type,s="geoloc"===e.type,p.push({rel:d,sn:n,color:n,label:l,is_image:a,is_attach:o,is_map:s});return p},l=function(t){var e,n,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y;p=[],h=Zt(t);for(y in h)if(v=h[y],!v.dirbw&&!v.multiple)for(m=v.spath.split(","),n=_.last(m),i=yt(n),f=[{}].concat(i),u=0,c=f.length;c>u;u++)e=f[u],d=r(y,e.an),g=Lt(_.rest(m)),l=e.an?vt(n,e.an,{full:!0,s_label:g}):g,a="image"===e.type,o="image"===e.type||"attach"===e.type,s="geoloc"===e.type,p.push({rel:d,sn:n,color:n,label:l,is_image:a,is_attach:o,is_map:s});return p},u=function(t){var e,n,r,i,a,s,u,l;i=[],n=Zt(t);for(l in n)u=n[l],!u.dirbw&&u.multiple&&(s=u.spath.split(","),e=_.last(s),r=o(l),a=Lt(_.rest(s),!0),i.push({cat:"count",rel:r,sn:e,color:e,label:I18n.t("js.editor.elem.default_label_count_linked",{slab:a})}));return i},c=function(t){var e,r,i,o,a,s,u,l,c,h,f;if(a=[],t){if(l={},c=Ut(),t!==c){r=Zt(c);for(f in r)h=r[f],h.sdz||h.dirbw||(e=_.last(h.spath.split(",")),l[e]=!0)}i=Zt(t);for(f in i)h=i[f],h.dirbw||!h.multiple||h.sdz||(u=h.spath.split(","),e=_.last(u),l[e]&&(o=n(f),s=Lt(_.rest(u)),a.push({rel:o,sn:e,color:e,label:s})))}return a},d=function(t,e,n){var r,i,o,a,s,u,l,c,h,f,d,g,m,v,y,b,x,w,k;o=[],d=St();for(k in d)u=d[k],x=Lt(k,!0),o.push({sn:k,label:x,color:k,multiple:!0});if(o=o.concat(p(e)),o=function(){var t,e,n;for(n=[],t=0,e=o.length;e>t;t++)u=o[t],f={},f.t_list=u.multiple,f.rel=f.t_list?u.sn+" list":u.sn,n.push($.extend(u,f));return n}(),"root"===t&&(k=Ut(),c=Gt().label,i=$.extend({sn:k,label:c,color:k,avasc1:!0,score:1},{rel:k}),o.push(i)),"seco"===t){o=[],g=St();for(k in g)u=g[k],x=Lt(k),o.push({sn:k,label:x,color:k,rel:k,avasc1:!0});m=St();for(k in m)u=m[k],x=Lt(k,!0),o.push({sn:k,label:x,color:k,rel:k+" list",t_list:!0})}switch(t){case"root":break;case"seco":break;default:e&&n&&(w=kt(e).label,u={sn:e,label:w,rel:e,color:e,t_page:!0,avasc1:!0,score:1},o.push(u))}for(v=_.groupBy(o,function(t){return t.avasc1?"avasc1":"avasc0"}),s=v.avasc1,a=v.avasc0,y=[s,a],l=0,h=y.length;h>l;l++)r=y[l],r&&(r=r.sort(function(t,e){return(t.score||0)>(e.score||0)?-1:(t.score||0)<(e.score||0)?1:t.label<e.label?-1:t.label>e.label?1:0}));return b={avasc1:s,avasc0:a},e&&(b.scope={label:kt(e).label,color:e}),b},f=function(t){var e,n,r,i;return e=[],n=Wt(t),i=n.sn,r=n.scope,e=e.concat(c(i)),{ava_list:e}},h=function(t){var e,n,r,o,a,c,h,f,d,p,g,m,v,y,b,x,w,k,S,C,E,M,A;if(o=[],x=Wt(t),A=x.sn,M=x.scope,A){for(w=yt(A),g=0,v=w.length;v>g;g++)e=w[g],d="image"===e.type,f="image"===e.type||"attach"===e.type,p="geoloc"===e.type,o.push({cat:"content",rel:e.an,sn:A,color:A,label:e.label,is_image:d,is_attach:f,is_map:p});for(k=qt(A),m=0,y=k.length;y>m;m++)e=k[m],o.push({cat:"admin",rel:e.an,sn:A,color:A,label:e.label});o=o.concat(s(A)),o=o.concat(l(A)),o=o.concat(u(A))}S=St();for(A in S)h=S[A],E=i(A),o.push({cat:"all",rel:E,sn:A,color:A,label:I18n.t("js.editor.elem.default_label_count",{slab:Lt(A,!0)})});return C=_.groupBy(o,function(t){return t.cat?t.cat:"linked"}),a=C.content,n=C.admin,b=C.linked,c=C.count,r=C.all,{avasc1:[{name:"admin",title:I18n.t("js.editor.elem.hd_admin"),data:n},{name:"content",title:I18n.t("js.editor.elem.hd_content"),data:a},{name:"linked",title:I18n.t("js.editor.elem.hd_linked"),data:b},{name:"count",title:I18n.t("js.editor.elem.hd_linked_count"),data:c}],avasc0:[{name:"all",title:I18n.t("js.editor.elem.hd_count"),data:r}]}},He=function(t,e){var n,r,i,o,s,u,l,c,h,f,d,p;for(null==e&&(e={}),r=device_type,c=[],l=Ot(r).views,o=0,u=l.length;u>o;o++)n=l[o],p=Wt(n),p=a(p)||p,d=p.sn,i=p.is_list,s=p.label,d===t&&!!i==!!e.is_list&&(h=It(n)+1,f=kt(d).label,s="P"+h+": "+f,c.push({label:s,cid:n,value:h}));return c},Ye=function(t,e){var n,r,i,o,a,s,u,l,c;return null==e&&(e={}),o=t.label,l=t.sn,r=t.is_list,u=t.scoped,i=t.is_my_scope,n=t.anchor,e.default_label&&(o=null),o||(o=n?Ye(Wt(n)):void 0),o||(o=i?kt(l).label:void 0),o||(o=l?u?(s=u.split(":"),a=s[0],c=s[1],s,Qt(a,c,r)):Lt(l,r):void 0),o||I18n.t("js.editor.view.unnamed")},Ge=function(t,e){var n,r;return r=function(){if(e){if(n=Nt(t,e),n||(n=Ft(t,e)),!n)return!0;switch(n.type){case"image":case"geoloc":return!0}}}(),{has_label:!r,label_inline:!r}},We=function(t,e){var n,r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,b,_,x,w,k,S,C;if(k=t.sn,r=null,h=null,s=null,d=null,i=e.aref)switch(p=i.split(":"),S=p[0],x=2<=p.length?On.call(p,1):[],S){case"_acb":C=x[0],a=Kt(k,C),w=Qt(k,C),f=w}else if(o=e.dref){switch(g=o.split(":"),S=g[0],x=2<=g.length?On.call(g,1):[],S){case"_eas":C=x[0],r=x[1],a=Kt(k,C),f=Qt(k,C),r&&(f=vt(a,r,{full:!0,s_label:f})),m=Ge(a,r),s=m.has_label,d=m.label_inline;break;case"_ecc":switch(x.length){case 1:a=x[0],w=Lt(a,!0),f=I18n.t("js.editor.elem.default_label_count",{slab:w});break;case 2:C=x[0],a=Kt(k,C),w=Qt(k,C,!0),f=I18n.t("js.editor.elem.default_label_count_linked",{slab:w}),h=!0;break;default:throw"Invalid "+e.dref}s=d=!0;break;default:a=k,r=o,f=vt(a,r),v=Ge(a,r),s=v.has_label,d=v.label_inline}r&&(n=Nt(a,r))&&(l=!!(null!=(y=e.style)?y.image:void 0),u=!!(null!=(b=e.style)?b.downloadable:void 0),c=!!(null!=(_=e.style)?_.map:void 0))}else switch(a=null,f=e.value||"",e.type){case"image":l=!0,f=I18n.t("js.static_content.image");break;case"geoloc":c=!0,f=I18n.t("js.static_content.map")}return[a,f,s,d,h,l,u,c]},g=function(t){var e,n,r,i,o,a,s,u,l;return l=Wt(t),e=l.anchor,i=l.is_tabbed,u=l.sn,n=l.is_list,a=l.scoped,r=l.is_my_scope,o=l.label,o=Ye(l),s=u&&!n||a,{cid:t,anchor:e,is_tabbed:i,sn:u,is_list:n,mysc:r,selected:s,label:o,color:u}},m=function(t,e,n){var r,i,o,a,s,u,l,c;if(l=Wt(e),n.flatten_anchor&&l.anchor&&!ke(e,t)&&!Se(e,t))return m(t,l.anchor,n);if(l._cid=e,c=$.extend(g(e),{loc:cid_to_loc(e)}),(s=l.vref)&&(i=Vt(s,t)===Vt(e,t),c.links=[_.extend(g(s),{loc:cid_to_loc(s),local:i})]),n.lvl||(n.lvl=99),n.lvl>1)for(n.lvl=n.lvl-1,u=l.items,o=0,a=u.length;a>o;o++)r=u[o],"view"===r.type&&(c.views||(c.views=[]),c.views.push(m(t,r.cid,n)));return c},a=function(t){var e,n;return(e=t.anchor)?(n=Wt(e),a(n)||n):void 0},function(){return An=function(){var t,e,n,r,i,o,s,u,l,c,h,f,d,p,g;for(n=device_type,g=[],c=Tt(n).views,r=s=0,l=c.length;l>s;r=++s)t=c[r],p=Wt(t),u=Ye(p),d=Ut(),o=p.is_my_scope,p=a(p)||p,f=p.sn,i=p.is_list,h=p.scoped,f?(e=f,p={pid:r,cid:t,label:u,color:f,is_list:i,mysc:o}):p={pid:r,cid:t,label:u},g.push(p);return g},Pn=function(){var t,e,n,r,i,o,s,u,l,c,h,f,d;for(n=device_type,d=[],l=Ot(n).views,r=o=0,u=l.length;u>o;r=++o)t=l[r],f=Wt(t),f=a(f)||f,h=f.sn,i=f.is_list,s=f.label,c=f.scoped,h&&(s=Lt(h,i)),e=h,f={pid:r,cid:t,label:s,color:e,is_list:i},d.push(f);return d},Mn=function(t,e,n){var r,i,o,a,s,u,l,c,h;for(r={w:n.w,h:n.h,top:0,left:0},h=e?m(t,e,{lvl:2,flatten_anchor:!0}):{},l=[h],c=l.length,o=a=0,s=l.length;s>a;o=++a)u=l[o],u.css=n.tablet?(i=0===o?1===c?1:3:2===c?1.5:3,$.extend({},r,{w:r.w/i})):r;return{css:$.extend({},r,{w:60}),views:l}},jn=function(t,e){var n,r,i,o,a,s,u,l,c,h,f,d,p,g,v,y,b,_,x,w;return t?(o=device_type,_=Wt(t),p=_.sn,x=(y=Tn(t,e.active_tab_cid))?function(){var t,e,n,r;for(n=_.items,r=[],t=0,e=n.length;e>t;t++)a=n[t],a.cid===y.active_tab_cid&&r.push(a);return r}():_.items,d=function(){var t,e,i,d,p,v,y,k;for(k=[],t=0,e=x.length;e>t;t++)a=x[t],b=null!=(i=a.style)?i.text_style:void 0,g=a.aref?"center":(null!=(d=a.style)?d.text_align:void 0)||"left",c=!1,l=!1,h=!1,"view"===a.type?(w=m(o,a.cid,{lvl:2}),k.push($.extend(w,{pos:a.pos,ts:b,ta:g,view:!0,anchored:a.cid===_.anchor}))):(p=We(_,a),u=p[0],s=p[1],n=p[2],r=p[3],f=p[4],c=p[5],l=p[6],h=p[7],k.push({type:a.type,pos:a.pos,ts:b,ta:g,vref:a.vref,color:u,e_label:s,is_image:c,is_downloadable:l,is_map:h,has_label:null!=(v=a.style)?v.has_label:void 0,label_inline:null!=(y=a.style)?y.label_inline:void 0,item_scope:f}));return k}(),i=!0,tabbable_view(_)&&t===Vt(t)&&(v=!0),_.is_tabbed&&(i=!1),Se(t)&&_.anchor&&Wt(_.anchor).is_list&&(i=!1,v=!1),{items:d,cid:t,loc:cid_to_loc(t),tabs:y,tabbable:v,appendable:i}):{}},Tn=function(e,n){var r,i,o,a,s,u,l,c,h,f,d,p;if(c=Vt(e),c===e&&(d=Wt(c),d.is_tabbed&&d.items)){for(f=[],l=d.items,a=0,u=l.length;u>a;a++)o=l[a],"view"===o.type&&(p=Wt(o.cid),s=Ye(p),p.anchor?(r=Wt(p.anchor),i=r.sn):i=p.sn,f.push({cid:o.cid,label:s,color:i,anchored:o.cid===d.anchor}));if(f.length>0){if(e===c)return n||(n=f[0].cid),_.find(f,function(t){return t.cid===n}).active=!0,{cid:c,items:f,active_tab_cid:n};if(h=_.find(f,function(t){return t.cid===e}))return t.active=!0,{cid:c,items:f,active_tab_cid:e}}}},En=function(t,e,n){return d(t,e,n)},Sn=function(t){return h(t)},Cn=function(t){return f(t)}}(),e.device_type="phone",e.device_orient="port",e.device_size={phone:{port:{view:{w:115,h:190},frame:{w:140,h:220}},land:{view:{w:115,h:190},frame:{w:140,h:220}}},tablet:{port:{view:{tablet:!0,w:310,h:190},frame:{w:335,h:220}},land:{view:{tablet:!0,w:310,h:190},frame:{w:335,h:220}}}}}}(this)(),hn=null,C=null,function(t){return function(){var t,e,n,r,i,o,a,s;return hn=function(t){return C=t||Ut(),U.sn=C,i(),ae(C)},n=function(t){var e,n,r;return n=t.closest(".form-line").attr("rel"),null!=n?(n=~~n,r=kt(C),e=r.attrs[n],[r,n,e]):void 0},e=function(t,e,n){var r,i,o,a,s,u,l,c;if(a={},a[e]=!0,"t5"!==n){u=gt();for(i in u)r=u[i],(r.psn===e||r.csn===e)&&(a[r.psn]=!0,a[r.csn]=!0);"bt"!==t&&(a[Ut()]=!0)}return l=function(){var t,e;t=St(),e=[];for(c in t)o=t[c],s=a[c],e.push({sn:c,label:o.label,disabled:s});return e}(),l=_.sortBy(l,function(t){return t.label})},a=function(){return $(".js-data-attrs tbody.user-attrs").sortable({start:function(t,e){return $(this).find(".form-line:not(.ui-sortable-placeholder)").each(function(t){return $(this).attr("rel-ro",t)})},update:function(t,e){var n,r,i;return r=$(this),i=function(){var t,e,i,o;for(i=r.find(".form-line"),o=[],t=0,e=i.length;e>t;t++)n=i[t],o.push(~~$(n).attr("rel-ro"));return o}(),g(C,i,function(){return r.find(".form-line").each(function(t){return $(this).attr("rel",t)})})},containment:$(".js-data-attrs")})},o=function(e,n){return t(),e.popover(n).popover("show")},s=function(e,n){var r;return r=e.hasClass("active"),t(),r?void 0:(e.addClass("active"),n&&n())},t=function(){return $(".default-help").popover("destroy"),$(".step-data .editable").popover("destroy"),$(".action-btn-popup").removeClass("active")},r=function(){return re(dd_graph),ae(C),i()},i=function(){var e,r,i,o,s,u,l,c,h,f,d,p,g,m,v,y,b,x,w,k,S,E,M;for(t(),p=function(){var t,e;t=St(),e=[];for(k in t)b=t[k],e.push({sn:k,s:b});return e}(),p=_.sortBy(p,function(t){return t.s.label}),m=$.extend({},plan_quotas.models,{c:p.length}),h=$("#data-toolbar"),h.html(get_tmpl("data-toolbar")({models:p,quota:m})),Te(h),S=kt(C),S._sn=C,k=C,c=$.extend({},S),c.sys=Rt(k),$("#user-data-form").html(get_tmpl("user-data-form")(c)),Te($("#user-data-form")),M=function(){var t,n,r,i;for(r=c.sys,i=[],t=0,n=r.length;n>t;t++)e=r[t],E=$.extend({},e,{opts_json_ro:e.opts&&JSON.stringify(e.opts)},{type:e.type,type_label:m_at_labels[e.type],enable:mt(e.type)}),"email"===e.an&&(E=$.extend(E,{is_label:S.email_is_label,sys_enabled:{an:!0,label:!0}})),"password"===e.an&&(E=$.extend(E,{enable:{required:!0}})),i.push(E);return i}(),u=function(){var t,n,r,i;for(r=c.attrs,i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push($.extend({},e,{opts_json:e.opts&&JSON.stringify(e.opts)},{enable:mt(e.type)}));return i}(),m=$.extend({},plan_quotas.data_attrs,{c:c.attrs.length}),s={sn:k,sys:M,attrs:u,quota:m},h=$("#user-data-attrs"),h.html(get_tmpl("user-data-attrs")(s)),Te(h),i=I(k),i=function(){var t,e,n;for(n=[],t=0,e=i.length;e>t;t++)r=i[t],g=kt(r.psn).acts_as_user,n.push($.extend({},r,{apply:{require:!0,unique:i.length>1},disabled000:{require:g}}));return n}(),o=function(){var t,e,n,i;for(n=D(k),i=[],t=0,e=n.length;e>t;t++)r=n[t],i.push($.extend({},r,{apply:{multiple:!0}}));return i}(),x=I(k,{sdz:!0}),w=D(k,{sdz:!0}),y=[],S.acts_as_user?y.push({t:"has",title:I18n.t("js.as.has"),acl:!0,asc:o,sdz:w}):(y.push({t:"bt",title:I18n.t("js.as.bt"),acl:!0,asc:i,sdz:x,dirbw:!0}),y.push({t:"has",title:I18n.t("js.as.has"),asc:o,sdz:w})),f=0,d=y.length;d>f;f++)v=y[f],v.is_empty=0===v.asc.length&&0===v.sdz.length;return h=$("#user-data-relationships"),h.html(get_tmpl("user-data-relationships")({s:S,rels:y})),l=h.find(".comp-uniq"),l.length&&(l.first().addClass("comp-uniq-first"),l.last().addClass("comp-uniq-last")),$(".step-data .action-btn-new.disabled[data-toggle='popover']").popover(),Te(h),a(),$("#user-data-attrs .select-opts").each(function(){var t,e,r,i,o;return h=$(this),r=(i=h.attr("opts_json_ro"))?JSON.parse(i):(o=n(h),b=o[0],e=o[1],t=o[2],o,t.opts),h.attr("data-content",get_tmpl("data-attr-select-opts")(r)),h.popover({html:!0,animation:!1,trigger:"hover",placement:"right"})}),$("#user-data-attrs .image-opts").each(function(){var t,e,r;return h=$(this),r=n(h),b=r[0],e=r[1],t=r[2],h.attr("data-content",get_tmpl("data-attr-image-opts")({opts:t.opts})),h.popover({html:!0,animation:!1,trigger:"hover",placement:"right"})}),$(".with-hint").popover({placement:"top",trigger:"hover",html:!0})},$(document).on("click","html",function(){return t()}),$(document).on("click",".popover",function(){return!1}),$(document).on("click",".step-data .data-selector .pre-item",function(){var t;return t=$(this).attr("rel"),hn(t),!1}),$(document).on("click","#user-data-relationships .s-name",function(){var t;return t=$(this).attr("rel"),hn(t),!1}),$(document).on("click",".step-data .new-data",function(){var e,n;return t(),e=$(this),e.hasClass("action-btn-new")?(n=e.parent().find(".action-btn-popup"),s(n)):e.closest(".action-btn-popup").removeClass("active"),!1}),$(document).on("click","#new-data",function(){var t,e;return t=$.extend({is_new:!0},Ct()),e=$("#data-form"),e.html(get_tmpl("data-form")(t)),e.modal("show"),e.find("input[name='label']").focus().select(),Ie(e),!1}),$(document).on("click","#import-data",function(){var t;return t=$("#data-import-form"),t.html(get_tmpl("data-import-form")({})),t.modal("show"),!1}),$(document).on("click","#user-data-form .editable",function(){var t;return t=$("#data-form"),t.html(get_tmpl("data-form")(kt(C))),t.modal("show"),Ie(t),!1}),$(document).on("click","#data-form .color-sel",function(){var t;return t=$(this),t.closest(".color-selection").find(".color-sel").removeClass("active"),t.addClass("active"),!1}),$(document).on("click","#data-form .dlg-save",function(){var t,e,n,i;return n=$(this).closest("#data-form"),e=n.find("input[name='label']"),$.trim(e.val())?(t={label:n.find("input[name='label']").val(),label_plural:n.find("input[name='label_plural']").val(),color:n.find(".color-sel.active").attr("color")},(i=n.find("input[name='is_new']").val())?h(t,function(t){return n.modal("hide"),ie(t,kt(t)),hn(_.last(_.keys(St())))}):y(C,t,function(){return n.modal("hide"),r()})):e.val("").focus(),!1}),$(document).on("click",".step-data .editable",function(){return delay(0,function(){return $(".editable-form input[name=label]").focus().select()})}),$(document).on("click","#del-data",function(){return confirm(I18n.t("js.editor.confirm.delete_data"))&&d(C,function(){return re(dd_graph),hn()}),!1}),$(document).on("click",".step-data .new-attr",function(){var t,e,n,r,o;return n=$(this),n.hasClass("action-btn-new")?(r=n.parent().find(".action-btn-popup"),s(r)):(n.closest(".action-btn-popup").removeClass("active"),o=n.attr("rel")||"string",e=xt(C,o),t={label:e,type:o},b(C,null,t,function(){return i(),$(".js-data-attrs .form-line:last .editable").trigger("click")})),!1}),$(document).on("click",".js-data-attrs a.del",function(t){var e,n;return confirm(I18n.t("js.editor.confirm.delete_attr"))&&(n=$(this).closest(".form-line"),e=n.attr("rel"),p(C,e,function(){return i()})),!1}),$(document).on("click",".step-data .new-assoc",function(){var t,n,i,o,a,u,l;if(a=$(this),a.hasClass("disabled"))return!1;if(a.hasClass("action-btn-new"))o={ho:e("has",C,"t1"),hm:e("has",C,"t3"),hmt:e("has",C,"t5")},kt(C).acts_as_user||(o.bt=e("bt",C)),u=a.parent().find(".action-btn-popup"),s(u,function(){return u.html(get_tmpl("user-data-assoc-new-popup")(o)),Te(u)});else{switch(a.closest(".action-btn-popup").removeClass("active"),l=$(this).attr("rel").split(":"),t=l[0],n=l[1],i=l[2],"bt"===t?(i="t3",o={psn:n,csn:C}):o={psn:C,csn:n},i){case"t1":$.extend(o,{required:"1"});break;case"t2":$.extend(o,{});break;case"t4":$.extend(o,{multiple:"1"});break;case"t5":$.extend(o,{is_free:"1"});break;default:$.extend(o,{multiple:"1",required:"1"})}c(o,function(){return r()})}return!1}),$(document).on("click",".js-data-assocs a.del",function(t){var e,n;return confirm(I18n.t("js.editor.confirm.delete_rel"))&&(n=$(this).closest("tr"),e=n.attr("rel"),f(e,function(){return re(dd_graph),hn(C)})),!1}),$(document).on("change",".js-data-assocs input, .js-data-assocs select",function(){var t,e,n,o,a,s,u,l,c,h,f,d,p;if(a=$(this),h=a.closest(".form-line"),n=h.attr("rel")){for(e=dt(n),f=$.io.form(h).object(),o=$.extend({},e,f),s=a.attr("name"),d=["multiple","required","unique"],u=0,c=d.length;c>u;u++)l=d[u],s!==l||f[l]||(o[l]=null);m(o,n,function(){return r()})}else(p=h.attr("rel-s"))&&(t=$.io.form(h).object().acl,w(C,p,t,function(){return i()}));return!1}),$(document).on("click","#user-data-attrs .editable",function(){var t,e,n,r,i,a,s,u,l;for(e=$(this),s=e.closest(".form-line").attr("rel"),l=e.text(),u="<form class='editable-form' onsubmit=\"return false;\">\n  <input type='text' name='label' value='{{v}}' style='width:150px'/>\n  <div class='btn btn-default btn-xs editable-save' rel='{{rel}}'><i class='fa fa-check'></i></div>\n</form>",a=$("#user-data-attrs .editable"),n=0,r=a.length;r>n;n++)t=a[n],t===this&&(i={html:!0,animation:!1,trigger:"manual",placement:"top",content:function(){return Handlebars.compile(u)({v:l,rel:s})}},o(e,i),$("#user-data-attrs .popover.top.in input:first").focus());return!1}),$(document).on("submit","#user-data-attrs .editable-form",function(){return $(this).find(".editable-save").click(),!1}),$(document).on("click","#user-data-attrs .editable-save",function(){var t,e,n,r;return e=$(this),n=e.closest("form").find("input[name='label']").val(),r=~~e.attr("rel"),t=$("#user-data-attrs .js-data-attrs .form-line").eq(r).find("input.js-data-attr[name=label]"),t.val(n).trigger("change"),i(),!1}),$(document).on("change",".js-data-attrs input.js-data-attr, .js-data-attrs select.js-data-attr",function(){var t,e,n,r,o;return e=$(this),r=e.closest(".form-line, .form-line-sys"),r.hasClass("form-line-sys")?(t=$.io.form(r).object(),x(C,t.an,t,function(){return i()})):(t=$.io.form(r).object(),n=~~r.attr("rel"),b(C,n,t,function(){return i()}),"type"===e.attr("name")&&(o=r.find("input[name='opts']"),"select"===e.val()?o.show():o.hide())),!1}),$(document).on("click","#user-data-attrs .select-opts.edit-attr-opts",function(){var t,e,r,i,o,a,s,u;return r=$(this),o=n(r),s=o[0],e=o[1],t=o[2],u=null!=(a=t.opts)?a.values:void 0,i=$("#data-attr-select-form"),i.html(get_tmpl("data-attr-select-form")({eidx:e,s:s,attr:t,values:u})),i.modal("show"),i.find(".sel-values tbody").sortable(),!1}),$(document).on("click","#data-attr-select-form .new-select-opt",function(){var t,e;return t=$("#data-attr-select-form .sel-values"),e=$("#data-attr-select-form .form-line.hidden"),e.clone().removeClass("hidden").appendTo(t),!1}),$(document).on("click","#data-attr-select-form .del-select-opt",function(){var t;return t=$(this),$("#data-attr-select-form .form-line").length>1?$(this).closest(".form-line").remove():$(this).closest(".form-line").find("input").val(""),!1}),$(document).on("click","#data-attr-select-form .dlg-save",function(){var t,e,n,r;return n=$("#data-attr-select-form"),e=~~$.io.form(n).object().eidx,r=[],n.find("input[name='opt[]']").each(function(t,e){var n;return n=$(e),r.push([n.attr("sel-k"),n.val()])}),t=$.extend({},kt(C).attrs[e],{opts:{input_values:r}}),b(C,e,t,function(){return i()}),n.modal("hide"),!1}),$(document).on("click","#user-data-attrs .image-opts.edit-attr-opts",function(){var t,e,r,i,o,a,s;return r=$(this),a=n(r),s=a[0],e=a[1],t=a[2],o=t.opts||{},i=$("#data-attr-image-form"),i.html(get_tmpl("data-attr-image-form")({eidx:e,s:s,attr:t,opts:o})),i.modal("show"),Re(i),!1}),$(document).on("click","#data-attr-image-form .dlg-save",function(){var t,e,n,r,o,a;return r=$("#data-attr-image-form"),a=$.io.form(r).object(),n=a.eidx,o=a.opts,t=a.brand,t&&(o["default"]=r.find("img.upload-image").attr("src"),o["default-upload-cache"]=t["image-upload-cache"],o["default-upload-fname"]=t["image-upload-fname"]),n=~~n,e=$.extend({},kt(C).attrs[n],{opts:o}),b(C,n,e,function(){return i()}),r.modal("hide"),!1})}}(this)(),fn=null,cn=null,ln=null,s=null,u=null,function(t){return function(){var t,e,n,r,i,o,a,l,c,h,f,d,p,g,m,v,y,b,x,w,k;
l=function(t,e){var n,r,i,o,a,s,u,l,c,h,f,d,p,g;for(o=[],s=e?(g=Jt(e),g.spath.split(",").reverse().slice(0,-1)):void 0,s||(s=[t]),n=u=0,c=s.length;c>u;n=++u)r=s[n],(i=Dt(r))&&(a=_.map(i,function(t){var e,n,r,i,o;return e=t.an,n=t.label,r=function(){var e,n,r;n=(null!=(e=t.opts)?e.values:void 0)||{},r=[];for(i in n)o=n[i],r.push({sk:i,sv:o,checked:!1});return r}(),r.unshift({sk:""}),{an:e,label:n,options:r}}),o.push({idx:n,label:kt(r).label,fs:a}));for(o=o.reverse(),p=zt(t),f=p||[],l=0,h=f.length;h>l;l++)d=f[l],d.checked=!0;return{limit:"10",order:"created_at:desc",searchable:Ee(t),filters:o,sortable:!1,sortables:p}},a=function(t){var e;return e={},Wt(t).is_list?(e.ava_view=I18n.t("js.editor.hint.elem_unavailable.lv_cv"),e.action_btn=I18n.t("js.editor.hint.elem_unavailable.lv_acb")):Cn(t).ava_list.length||(e.action_btn=I18n.t("js.editor.hint.elem_unavailable.acb")),e},w=function(t,e,n,r){var i,o,a;return e?(n&&(a=Vt(n))&&a===Vt(r)&&(o=Wt(n),o.label||(o.label=kt(o.sn).label)),i={vref:n,popups:He(e),cid:r,local_view:o,new_btns:r&&!o},t.find(".list-item-link-to").html(get_tmpl("list-item-link-to")(i))):void 0},fn=function(t){var e,r;return e=device_type,t||(t=Tt(e).views[0]),$("#device-preview").empty(),u=Vt(t),ln(),n(t),Se(u)?(r=It(u),U.vn=["seco",r]):(r=Mt(u),U.vn=["root",r])},n=function(t,e){var r,i,o,a,s,u,l,c;return null==e&&(e={}),t?(c=Wt(t),r=jn(t,e),o=$.extend({},plan_quotas.view_items,{c:r.items.length}),r=$.extend({},r,{quota:o}),(null!=(a=r.tabs)&&null!=(s=a.items)?s.length:void 0)&&(r.tabs.quota=$.extend({},plan_quotas.view_items,{c:r.tabs.items.length})),i=$("#device-preview .view-sel[rel='"+t+"']"),i.hasClass("partial-view")||i.addClass("partial-view"),i.attr("rel-l",cid_to_loc(t)),0===i.length&&(l=Se(t,device_type)?"seco":"root",u={pt:device_type,type:l,color:c.sn,label:Ye(Wt(t))},$("#device-preview").html(get_tmpl("device-preview")(u)),i=$("#device-preview .partial-view:first").attr({rel:t}),r.tabs&&(i.addClass("is-tabbed"),i.css({top:25,height:i.height()-25}))),$("#device-preview .partial-view").removeClass("active"),i.addClass("active"),i.html(get_tmpl("partial-view")(r)),i.addClass("view-sel").attr("rel-l",r.loc),Xe(i,r.items,r.cid),$("#device-preview .action-btn-new.disabled[data-toggle='popover']").popover(),Ne("#device-preview"),c.is_tabbed?(x(),n(r.tabs.active_tab_cid),e.active_tab_cid?void 0:v(t)):v(t)):$("#device-preview").html(get_tmpl("device-preview")({pt:device_type}))},cn=function(){var t,e,n,i;return e=Pt(),i=An(),n=$.extend({},plan_quotas.pages,{c:e}),t={views:i,quota:n,placeholders:_.range(Math.max(3-i.length,0))},$("#root-views").html(get_tmpl("root-views")(t)),Ne("#root-views"),i=Pn(),n=$.extend({},plan_quotas.pages,{c:e}),t={views:i,quota:n,placeholders:[]},$("#seco-views").html(get_tmpl("seco-views")(t)),Ne("#seco-views"),r($("#root-views, #seco-views"),{container:"body",placement:"bottom"}),$(".step-app .action-btn-new.disabled[data-toggle='popover']").popover(),b()},ln=function(t){var e,n,r,i,o,a,s,l,c,h,f;null==t&&(t={}),o=Mt(u),null==o&&(s=It(u)),a=bt();for(i in a)f=a[i],e=null!=o?f.root.views[o]:null!=s?f.seco.views[s]:null,n=device_size[i][device_orient],r=Mn(i,e,n.view),c=$("#page-views ."+i),l=$("#page-views ."+i+" .dev_t"),l.html(get_tmpl("page-views")(r)),i===device_type?c.addClass("active"):c.removeClass("active");return h=Wt(u),$("#device-sync").html(get_tmpl("page-views-sync")(h)),Ne(".step-app")},v=function(t){return t?(y(t),c(t)):void 0},y=function(t){var e,n,i,o,a,u,l,c,h,f,d,p,g,m,v,y,b,x,k,S,C,E;if(s=t,C=Wt(t),C.label_default=Ye(C,{default_label:!0}),C.sn&&(U.sn=C.sn),n=$.extend({},_t(C.sn,C.scoped,{force_sov:Ce(t)})),(Se(t)||xe(t))&&(n.create=!1),e=C.acl,C.is_list){for(b=C.list_opts||{},h=[],p=C.scoped?(E=Jt(C.scoped),E.spath.split(",").reverse().slice(0,-1)):void 0,p||(p=[C.sn]),u=g=0,v=p.length;v>g;u=++g)l=p[u],(c=Dt(l))&&(d=_.map(c,function(t){var e,n,r,i,o,a;return e=t.an,n=t.label,r=function(){var n,r,i,s;r=(null!=(n=t.opts)?n.values:void 0)||{},s=[];for(o in r)a=r[o],s.push({sk:o,sv:a,checked:b.filter&&-1!==_.indexOf(null!=(i=b.filter[u])?i[e]:void 0,o)});return s}(),o="",r.unshift({sk:o,checked:b.filter&&-1!==_.indexOf(null!=(i=b.filter[u])?i[e]:void 0,o)}),{an:e,label:n,options:r}}),h.push({idx:u,label:kt(l).label,fs:d}));if(h=h.reverse(),(i=zt(C.sn))&&b.sortables)for(m=0,y=i.length;y>m;m++)S=i[m],S.checked=!!_.find(b.sortables,function(t){return t===S.an});x={searchable:Ee(C.sn),filters:h,sortables:i}}return o=(null!=(k=Wt(Et(t)))?k.anchor:void 0)===t,a=$.extend({},C,{cid:t,config:C,acl:e,acl_c:n,list_opts:b,list_opts_c:x,anchored:o}),a.enable_alc=ke(t,device_type)&&we(t),f=$("#view-config-form").empty(),!a.anchor,f.html(get_tmpl("view-config")(a)),w(f,C.sn,C.vref,t),r(f,{container:"body",placement:"left"})},c=function(t){var e,n;return t=s,e=u,$("#root-views .ava-view").removeClass("active"),$("#seco-views .ava-view").removeClass("active"),$("#page-views .view-sel").removeClass("active"),$("#device-preview .view-sel").removeClass("active"),$("#root-views .ava-view[rel='"+e+"']").addClass("active"),$("#seco-views .ava-view[rel='"+e+"']").addClass("active"),$("#page-views .dev_t.active .view-sel[rel='"+t+"']").addClass("active"),n=$("#device-preview .view-sel[rel='"+t+"']").addClass("active"),$("#device-preview .view-sel.outer.active").length?$("#device-preview > .template").addClass("active"):$("#device-preview > .template").removeClass("active")},m=function(t,e){var n,r,i,o,a,s,u,l,c;return l=(s=e.attr("rel-cid"))?Wt(s):null,o=function(){switch(t){case"root":return[Ut(),!1];case"seco":return[Ut(),!1];case"tab":case"nested":return[l.sn,l.is_list]}}(),u=o[0],i=o[1],r=En(t,u,i),l&&null!=(a=r.scope)&&(a.is_my_scope=l.is_my_scope),c=function(){switch(t){case"root":return get_tmpl("ava-views-root");case"seco":return get_tmpl("ava-views-seco");case"tab":case"nested":return get_tmpl("ava-views-nested")}}(),e.find(".ava-data-views").html(c(r)),Ne(".ava-data-views"),n=e.find(".ava-view"),1===n.length?n.click():void 0},g=function(t,e){var n,r,i,o,a,s;return s=Wt(e),o=[s.sn,s.is_list],a=o[0],i=o[1],r=Cn(e),a&&(r.scope={label:kt(a).label,color:a},r.scope.is_my_scope=s.is_my_scope),t.find(".ava-data-buttons").html(get_tmpl("ava-data-buttons")(r)),Ne(".ava-data-buttons"),n=t.find(".ava-btn"),1===n.length?n.click():void 0},p=function(t,e){var n,r,i,o,a;return a=Wt(e),i=[a.sn,a.is_list],o=i[0],r=i[1],n=Sn(e),o&&(n.scope={label:kt(o).label,color:o},n.scope.is_my_scope=a.is_my_scope),t.find(".ava-data-attrs").html(get_tmpl("ava-data-attrs")(n)),Ne(".ava-data-attrs")},h=function(t,e){switch(e){case"string":return t.find("textarea").focus();case"hyperlink":return t.find("input[name=value]").focus();case"image":return Re(t);case"geoloc":return Ke(t.find(".location"))}},b=function(){var t,e,n,r,i;for(n=["root","seco"],r=[],t=0,e=n.length;e>t;t++)i=n[t],r.push(function(t){return $("#"+t+"-views .view-group").sortable({start:function(t,e){return $(this).find(".a-view-line:not(.ui-sortable-placeholder)").each(function(t){return $(this).attr("rel-ro",t)})},update:function(e,n){var r,i;return i=function(){var t,e,n,i;for(n=$(this).find(".a-view-line"),i=[],t=0,e=n.length;e>t;t++)r=n[t],i.push(~~$(r).attr("rel-ro"));return i}.call(this),et(t,i)},containment:$("#"+t+"-views")})}(i));return r},x=function(){return $("#device-preview .view-tabs").sortable({start:function(t,e){return $(this).find("> li:not(.ui-sortable-placeholder)").each(function(t){return $(this).attr("rel-ro",t)})},update:function(t,e){var n,r,i;return n=$(this).attr("rel"),i=function(){var t,e,n,i;for(n=$(this).find("> li"),i=[],t=0,e=n.length;e>t;t++)r=n[t],i.push(~~$(r).attr("rel-ro"));return i}.call(this),rt(n,i,function(){return cn(),ln(),v(n)})},containment:"parent"})},r=function(t,e){return null==e&&(e={}),e=$.extend({placement:"bottom",trigger:"hover",html:!0},e),t.find(".help-info").html("<i class='fa fa-info-circle'></i>").popover(e)},e=function(){return $(".default-help").popover("destroy"),$(".step-app > .popover").length?$(".step-app .editable").popover("destroy"):void 0},t=function(t){return function(){return e(),t.apply(this,arguments)}},function(){return $(document).on("click","html",function(){return e()}),$(document).on("click",".step-app .editable",t(function(){var t,e,n;return n=$(this),t=n.closest(".editable-btn"),e=t.attr("rel"),(t.hasClass("active")||t.hasClass("editable-btn-sv"))&&delay(0,function(){var t,n,r,i,o;return o=Wt(e),n=Ye(o,{default_label:!0}),i="<form class='editable-form' onsubmit=\"return false;\">\n  <input type='text' name='label' value='{{label}}' rel='{{cid}}' placeholder='{{label_default}}'/>\n  <div class='btn btn-default btn-xs editable-save'><i class='fa fa-check'></i></div>\n</form>",r={html:!0,animation:!1,trigger:"manual",placement:"bottom",container:".step-app",content:function(){return Handlebars.compile(i)({cid:e,label:o.label,label_default:n})}},t=$(".step-app .editable-btn[rel='"+e+"'] .editable"),t.popover(r).popover("toggle"),$(".step-app > .popover input[rel='"+e+"']").focus().select()}),t.hasClass("editable-btn-sv")?!1:!0})),$(document).on("submit",".step-app .editable-form",function(){return $(this).find(".editable-save").click(),!1}),$(document).on("click",".step-app .editable-save",function(){var t,n,r,i,o;return n=$(this).closest("form").find("input[name='label']"),o=[n.attr("rel"),n.val()],t=o[0],r=o[1],i=Ye(Wt(t),{default_label:!0}),r===i&&(r=""),ut(t,r,function(){var n,o,a;return n=$(".step-app .editable-btn[rel='"+t+"']"),n.find(".editable").text(r||i),e(),ln(),a=Vt(t),a!==t&&(r=Ye(Wt(a)),$(".step-app .editable-btn[rel='"+a+"'] .editable").text(r)),o=Et(t),o&&(r=Ye(Wt(o)),$(".step-app .editable-btn[rel='"+o+"'] .editable").text(r)),r=Ye(Wt(a)),$(".step-app .hd-bar span").text(r)}),!1})}(),$(document).on("click","#device-sync .sync-btn",t(function(){var t,e,n,r;return t=$(this).parent(),n=function(e){return e?t.find(".sync-btn").removeClass("sync-no"):t.find(".sync-btn").addClass("sync-no"),e&&ln(),tn(e?I18n.t("js.editor.ack.dev_sync_on"):I18n.t("js.editor.ack.dev_sync_off"))},(r=Wt(u))&&(e=!r.device_sync,Q(u,e,function(){return n(e)})),!1})),$(document).on("change",".list-opts-ev input",t(function(){var t,e,n,r;switch(e=$(this),t=e.closest(".list-opts-ev"),e.attr("name")){case"list_opts[sortable]":r=t.find(".sortables"),n=r.find("input[type='checkbox']"),e.is(":checked")?(n.prop("checked",!0),r.removeClass("hidden")):(n.prop("checked",!1),r.addClass("hidden"));break;case"list_opts[sortables][]":r=t.find(".sortables"),0===r.find("input[type='checkbox']:checked").length&&(t.find("input[name='list_opts[sortable]']").prop("checked",!1),r.addClass("hidden"))}return!0})),$(document).on("click","#root-views .del-view",t(function(){return confirm(I18n.t("js.editor.confirm.delete_root"))&&tt(u,!0,function(){return cn(),fn()}),!1})),$(document).on("click","#seco-views .del-view",t(function(){return confirm(I18n.t("js.editor.confirm.delete_seco"))&&tt(u,!0,function(){return cn(),fn(Ot(device_type).views[0])}),!1})),$(document).on("click","#page-views-expand",t(function(){var t;return t=$(".step-app"),t.hasClass("pv-compact")?t.removeClass("pv-compact"):t.addClass("pv-compact"),!1})),$(document).on("click","#page-views .dev_t, #page-views .dev_n",t(function(){var t,e,n;return e=$(this),t=e.attr("rel"),window.device_type=t,cn(),Se(u)?(n=It(u),fn(Ot(device_type).views[n])):(n=Mt(u),fn(Tt(device_type).views[n])),c(s),!1})),$(document).on("click","#root-views .ava-view",t(function(){var t;return t=$(this),fn(t.attr("rel")),!1})),$(document).on("click","#root-views .new-view, #root-views .view-placeholder",t(function(){var t;return t=$("#new-root-view-form"),t.html(get_tmpl("new-root-view-form")({})),t.modal("show"),m("root",t),!1})),$(document).on("click","#seco-views .new-view, #seco-views .view-placeholder",t(function(){var t;return t=$("#new-seco-view-form"),t.html(get_tmpl("new-seco-view-form")({})),t.modal("show"),m("seco",t),!1})),$(document).on("click","#device-preview",t(function(){return fn(u),!1})),$(document).on("click","#device-preview .view-sel",t(function(){var t,e,r;return e=$(this),0!==e.closest(".view-sel.active").length||0!==e.find(".view-sel.active").length?(t=e.attr("rel"),e.hasClass("partial-view")?e.hasClass("active")?(r=Et(t))&&n(r,{active_tab_cid:t}):n(t):e.hasClass("active")?n(t):(r=Et(t),n(r),n(t)),!1):void 0})),d={root:{form_id:"new-root-view-form"},seco:{form_id:"new-seco-view-form"},tab:{form_id:"new-tab-view-form"},nested:{form_id:"view-item-form"}},i=function(t,e){var n;return n=e.form_id,$(document).on("click","#"+n+" .ava-data-views .ava-view",function(e){var i,o,a,s,u,c,h,f,d,p,g;return o=$(this),a=$("#"+n),(c=o.attr("rel"))&&(u=c.split(" "),d=u[0],p=u[1],s="list"===p),h=a.attr("rel-cid"),(g=o.attr("rel-t")||a.attr("rel-t"))&&(f="root"===t?[Ut(),g].join(":"):[Wt(h).sn,g].join(":")),i={s_cid:h,sn:d,is_list:s,scoped:f},s&&(i.list_opts=l(d,f),i.list_opts.searchable&&"root"===t&&(i.list_opts.search=!0)),i.acl=i.acl_c=_t(d,f,{force_sov:"seco"===t}),a.data("ava-view-info",i),a.find(".ava-view-opts").html(get_tmpl("view-item-form-view-opts")(i)),a.find(".ava-view").removeClass("selected"),o.addClass("selected"),r(a,{placement:"left"}),!1})};for(f in d)k=d[f],i(f,k);d={root:{form_id:"new-root-view-form"},seco:{form_id:"new-seco-view-form"}},o=function(t,e){var n,r;return r=e.form_id,n="root"===t?W:Y,$(document).on("click","#"+r+" .save-view",function(e){var i,o,a,s,u,l,c,h,f;return a=$("#"+r),o=$.io.form(a).object(),c=a.data("ava-view-info"),f=c.sn,s=c.is_list,h=c.scoped,u=o.label,i=o.acl,l=o.list_opts,n({sn:f,is_list:s,label:u,acl:i,list_opts:l,scoped:h},function(){return cn(),fn(_.last(bt()[device_type][t].views)),a.modal("hide")}),!1})};for(f in d)k=d[f],o(f,k);return $(document).on("click","#new-tab-view-form .save-view",function(t){var e,r,i,o,a,s,l,c,h,f;return i=$("#new-tab-view-form"),r=$.io.form(i).object(),c=i.data("ava-view-info"),f=c.sn,o=c.is_list,h=c.scoped,a=r.label,e=r.acl,s=r.list_opts,l=u,X(l,{sn:f,is_list:o,scoped:h,label:a,acl:e,list_opts:s},function(t){return ln(),n(l,{active_tab_cid:t}),i.modal("hide")}),!1}),$(document).on("click","#view-item-form .save-view",function(){var t,e,r,i,o,a,u,l,c,h,f;return r=$("#view-item-form"),e=$.io.form(r).object(),l=r.data("ava-view-info"),c=l.s_cid,f=l.sn,i=l.is_list,h=l.scoped,o=e.label,t=e.acl,a=e.list_opts,u=c,J(u,{sn:f,is_list:i,s_cid:c,scoped:h,label:o,acl:t,list_opts:a},function(){return ln(),n(s),r.modal("hide")}),!1}),$(document).on("click",".preview-item-btns a.del",t(function(){var t,e,r;return confirm(I18n.t("js.editor.confirm.delete_elem"))&&(r=$(this).closest(".dummy0"),t=r.closest(".partial-view").attr("rel"),e=~~r.attr("rel-o"),Z(t,e,function(){return r.hasClass("view-sel")&&ln(),n(t)})),!1})),$(document).on("click","#view-config-form .del-view",t(function(){var t,e;return t=s,ke(t,device_type)?$("#root-views .ava-view.active .del-view").click():Se(t,device_type)?$("#seco-views .ava-view.active .del-view").click():Me(t,device_type)?$("#device-preview .view-tab-bar .view-tab.active .del-tab").click():confirm(I18n.t("js.editor.confirm.delete_view"))&&(e=Et(t),tt(t,!1,function(){return ln(),n(e)})),!1})),$(document).on("click","#device-preview .action-btn-new.disabled",t(function(){return!1})),$(document).on("click","#device-preview .partial-view .new-item",t(function(){var t,e,n,r,i,o;return i=$(this).closest(".partial-view"),t=i.attr("rel"),o="New Element",e={title:o,cid:t,item:{},hide_opts:!0,banned:a(t)},r=$("#view-item-form"),r.html(get_tmpl("view-item-form")(e)),r.data("ava-attr-info",e),r.attr("rel-cid",s),r.find(".dlg-save").addClass("disabled"),r.modal("show"),n=Wt(t).anchor?"view":"attr",r.find(".item-type-selector a[rel='"+n+"']").click(),m("nested",r),p(r,t),!1})),$(document).on("click",".preview-item-btns a.edit",t(function(){var t,e,n,r,i,o,u,l;return u=function(t){return"view"===t.type?"view":t.aref?"_acb"===t.aref.split(":")[0]?"button":"attr":t.dref?"attr":"static"},r=$(this).closest(".dummy0"),t=r.closest(".partial-view").attr("rel"),n=~~r.attr("rel-o"),l="Edit Element",o=Wt(t).items[n],o=$.extend({},o,{dref_saved:o.dref}),e={title:l,cid:t,rel:n,item:o,banned:a(t)},e.t=u(e.item),i=$("#view-item-form"),i.html(get_tmpl("view-item-form")(e)),i.attr("rel-cid",s),i.data("ava-attr-info",e),i.modal("show"),i.find(".item-type-selector a[rel='"+e.t+"']").click(),!1})),$(document).on("click","#view-item-form .item-type-selector a",function(){var t,e,n,r,i,o,a,s,u;if(o=$(this),u=o.attr("rel"),s=$("#view-item-form"),s.find("input[name=type]").val(u),s.find(".dlg-save").removeClass("disabled"),a=o.parent(),a.hasClass("banned"))return s.find(".item-content").html(a.attr("banned-reason")),!1;switch(r=s.data("ava-attr-info"),r&&r.t===u||(r={item:{}}),s.find(".item-content").html(get_tmpl("view-item-form-"+u)(r)),u){case"view":m("nested",s);break;case"attr":e=s.find("input[name=cid]").val(),p(s,e),i=r.item.dref,s.find(".ava-data-attrs .ava-attr[rel='"+i+"']").click();break;case"button":e=s.find("input[name=cid]").val(),g(s,e),t=r.item.aref,s.find(".ava-data-buttons .ava-btn[rel='"+t+"']").click();break;case"static":n=$(".item-static-content"),h(n,r.item.type)}return!1}),$(document).on("click","#view-item-form .item-static-selector input[type=radio]",function(){var t,e;return e=$(this).val(),t=$(".item-static-content"),t.html(get_tmpl("view-item-form-static-"+e)({})),h(t,e),!0}),$(document).on("click","#view-item-form .ava-btn",function(){var t,e,n,r,i,o,a,u;return n=$(this),$("#view-item-form .ava-btn").removeClass("selected"),n.addClass("selected"),i=$("#view-item-form"),t=n.attr("rel"),e=i.data("ava-attr-info"),e.item.aref=t,e.t="button",i.data("ava-attr-info",e),r=M,u=Wt(s),a=ct(u.sn,t),o=$.extend({},i.data("ava-attr-info").item,{aref:t,enable_guest:r}),$.extend(!0,o,{style:{label_default:a}}),i.find(".view-item-opts").html(get_tmpl("view-item-form-btn-opts")(o)),!1}),$(document).on("click","#view-item-form .ava-attr",function(t){var e,n,r,i,o,a,u,l,c,h,f,d,p,g,m,v,y,b,_,x,w;if(a=$(this),$("#view-item-form .ava-attr").removeClass("selected"),a.addClass("selected"),u=$("#view-item-form"),y=[a.attr("rel"),a.hasClass("is_img"),a.hasClass("is_attn"),a.hasClass("is_map")],i=y[0],h=y[1],c=y[2],f=y[3],r=u.data("ava-attr-info"),r.item.dref=i,r.t="attr",u.data("ava-attr-info",r),b=We(Wt(r.cid),$.extend({},r.item,{aref:null})),e=b[0],p=b[1],l=b[2],g=b[3],n=b[4],i===r.item.dref_saved?w=$.extend({},r.item.style,{label_default:p}):(w={has_label:l,label_inline:g,label_default:p,label_custom:""},h&&(w.image="1"),c&&!h&&(w.downloadable="1"),f&&(w.map="1")),i)switch(m=i.split(":"),m[0]){case"_eas":x=Wt(s).sn,o=Kt(x,m[1]),v=He(o),_=o;break;case"_ecc":"x"===m[2]&&(x=Wt(s).sn,o=Kt(x,m[1]),v=He(o,{is_list:!0}),_=o+" list")}return d=$.extend({},r.item,{dref:i,is_img:h,is_attn:c,is_map:f,popups:v,asn:_,style:w}),u.find(".view-item-opts").html(get_tmpl("view-item-form-attr-opts")(d)),!1}),$(document).on("click","#view-item-form .save-item",function(){var t,e,r,i,o,a;if(i=$("#view-item-form"),e=$.io.form(i).object(),a=[e.cid,e.rel],t=a[0],r=a[1],"static"===e.type)switch(e.type=e.static_type){case"string":case"hyperlink":case"geoloc":if(e.value=e.value.replace(/^\s+/,"").replace(/\s+$/,""),0===e.value.length)return i.find(".item-content [name=value]").val("").focus(),!1;break;case"image":if(e.value=i.find("img.upload-image").attr("src"),!e.value)return o=i.find(".item-static-content .static-hd").addClass("bg-info"),delay(150,function(){return o.removeClass("bg-info")}),!1}return r&&(e.pos=Wt(t).items[r].pos),st(t,r,e,function(){return n(s),i.modal("hide")}),!1}),$(document).on("click","#view-item-form .delete-item",function(t){var e,r,i,o,a;return confirm(I18n.t("js.editor.confirm.delete_elem"))&&(o=$("#view-item-form"),r=$.io.form(o).object(),a=[r.cid,r.rel],e=a[0],i=a[1],Z(e,i,function(){return n(e),o.modal("hide")})),!1}),$(document).on("click","#device-preview .e-label",t(function(){var t,e,n;return n=$(this),t=s,e=~~n.closest(".dummy0").attr("rel-o"),ot(t,e,function(t){var e;return e=t.has_label?t.label_inline?"inline":"block":"none",n.removeClass("e-label-inline e-label-none e-label-block").addClass("e-label-"+e),tn(I18n.t("js.editor.ack.update_field_name",{state:I18n.t("js.editor.ack.field_name."+e)}))}),!1})),$(document).on("click","#view-item-form .add-link-to",function(){var t,e,n,r,i,o;return t=$(this),i=t.attr("sn").split(" "),o=i[0],n=i[1],(e=!!n)&&(r=l(o)),Y({sn:o,is_list:e,list_opts:r,zidx:null},function(){var t,n,r;return n=$("#view-item-form"),t=n.data("ava-attr-info"),r=_.last(He(o,{is_list:e})).cid,lt(s,t.item,r,function(){return n.data("ava-attr-info",t),n.find(".ava-data-attrs .ava-attr[rel='"+t.item.dref+"']").click(),cn(),v(s)})}),!1}),$(document).on("change","#view-config-form input, #view-config-form select",function(){var t,e,r,i;return r=$(this),t=s,r.attr("rel-c")&&(t=r.attr("rel-c")),t&&(i=$("#view-config-form"),e=un($.io.form(i).object()),at(t,e,function(){var e;return"label"===r.attr("name")&&(Vt(t)===t?(cn(),c(t)):Me(t,device_type)&&(e=Et(t),n(e,{active_tab_cid:t}))),ln()})),!1}),$(document).on("click","#view-config-form .add-link-to",function(){var t,e,r,i,o,a;switch(e=$(this),e.attr("rel")){case"popup":k=Wt(s),a=k.sn,Y({sn:a,is_list:!1,zidx:null},function(){var t;return t=_.last(He(a)).cid,lt(s,k,t,function(){return cn(),ln(),v(s)})});break;case"local":o=s,i=Wt(o),a=i.sn,t=i.acl,r=Wt(u).is_tabbed?Et(o):u,G(r,{s_cid:o,sn:a,acl:t},function(t){var e;ln(),r=null,e=Yt();for(f in e)k=e[f],r||k.items&&_.find(k.items,function(e){return e.cid===t})&&(r=f);return r?(n(r),n(o)):void 0})}return!1}),$(document).on("click","#view-config-form .remove-link-to",function(){var t,e;return e=$(this),t=e.attr("rel"),confirm(I18n.t("js.editor.confirm.delete_dview"))&&K(t,function(){return n(Et(t)),n(t),ln()}),!1}),$(document).on("click",".preview-item-btns a.edit-layout",t(function(){var t,e;return e=$(this).closest(".view-sel"),t=e.attr("rel"),n(t),!1})),$(document).on("click","#seco-views .ava-view, #page-views .device.active .link-to, #device-preview .link-to",t(function(){var t,e;return e=$(this),t=e.attr("rel"),e.hasClass("link-to-local")?n(t):fn(t),!1})),$(document).on("click","#view-config-form .link-to",t(function(){var t,e;return e=$(this),t=e.attr("rel"),n(Et(t)),n(t),!1})),$(document).on("click","#device-preview .view-tabs li",t(function(){var t,e,r;return e=$(this),t=e.attr("rel"),r=Et(t),n(r,{active_tab_cid:t}),!1})),$(document).on("click","#device-preview .view-tab-bar .new-tab",t(function(){var t,e,n,r;return t=u,r="New Tab",e={title:r,cid:t,item:{}},n=$("#new-tab-view-form"),n.html(get_tmpl("new-tab-view-form")(e)),n.attr("rel-cid",t),n.find(".dlg-save").addClass("disabled"),n.modal("show"),n.find(".item-type-selector a:first").click(),m("tab",n),p(n,t),!1})),$(document).on("click","#device-preview .view-tab-bar .del-tab",t(function(){var t,e;return confirm(I18n.t("js.editor.confirm.delete_tab"))&&(t=Vt(s),e=$(this).closest(".view-tab").attr("rel"),tt(e,!1,function(){return cn(),ln(),$("#device-preview").empty(),n(t)})),!1})),$(document).on("click","#device-preview .toggle-tabs",t(function(){var t,e;return e=$(this),t=Vt(s),it(t,function(){return cn(),ln(),$("#device-preview").empty(),n(t)}),!1})),$(document).on("click",".debug",function(){var t,e;return t=$(this),e=t.attr("rel"),"cid"===e&&console.log(Wt(t.text())),"sn"===e?console.log(kt(t.text())):void 0})}}(this)(),vn=null,yn=null,dn=null,pn=null,ve=null,me=null,ye=null,be=null,le=null,ce=null,pe=null,fe=null,he=null,de=null,ue=null,ge=null,function(t){return function(){var t,e,n,r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,b,x,w,C,N,I,L,O,D,z,F,R,B,q,H,U,G,W,Y,X,J,Q,K,Z,tt,et,nt,rt,it;return a=null,t=function(t,e){return a||(a={}),a[t]||(a[t]={}),a[t]=$.extend(!0,a[t],e)},l={sn:/^[_a-z][a-z0-9_]*$/i,attr:/^[_a-z][a-z0-9_]*$/i},z=function(t){var e,n;for(e in t)if(n=t[e],!l[e].test(n||""))return!1;return!0},L=function(t){return 1===_.filter(_.keys(St()),function(e){return e===t}).length},I=function(t){return 1===_.filter(_.values(St()),function(e){return e.label===t}).length},w=function(t){return kt(t)},C=function(t){var e,n;return n=t.psn,e=t.csn,1===_.filter(_.values(gt()),function(t){return t.psn===n&&t.csn===e||t.psn===e&&t.csn===n}).length},N=function(t,e){var n,r,i,o,a,s;return a=kt(t),s=Rt(t),n=!_.find(s,function(t){return t.an===e.an}),r=!_.find(s,function(t){return t.label===e.label}),i=1===_.filter(a.attrs,function(t){return t.an===e.an}).length,o=1===_.filter(a.attrs,function(t){return t.label===e.label}).length,n&&r&&i&&o},O=function(t,e){var n;return n={},n[t]=e,n},D=function(t,e,n){return t.concat([e,n])},B=function(t,e){var n,r,i;return n=e.an,r=z({attr:n}),i=!_.find(yt(t),function(t){return t.an===n}),r&&i},R=function(t){var e,n,r,i;return i=t.psn,r=t.csn,e=w(i)&&w(r)&&i!==r,n=!pt(i,r),e&&n},W=function(t){var e,n;return e=z({sn:t}),n=L(t),e&&n},G=function(t){var e,n;return e=t.label,n=I(t.label),e&&n},Y=function(t){var e;return e=kt(t),t===Ut()?!!e.acts_as_user:!e.acts_as_user},U=function(t,e){var n,r;return n=z({attr:e.an}),r=N(t,e),n&&r},q=function(t){var e,n,r,i,o;return o=t.psn,i=t.csn,e=o!==i,n=w(o)&&w(i),r=C(t),e&&n&&r},H=function(t){var e,n,r;return n=t.psn,e=t.csn,r=Ut(),e===r?!1:n===r?!0:!0},et=function(t){return kt(t)},tt=function(t,e,n){var r,i,o,a,s;return s=e,o=Wt(t),n?o.sn===Ut()?!e:void 0:(i=e.split(":"),r=i[0],s=i[1],a=Xt(r,s),!!a)},it=function(t){var e;return e=_.find(t.apath.split(","),function(t){return!dt(t)}),null==e},nt=function(t,e){var n,r,i,o,a,s,u;if(i=[Wt(t),Wt(e)],u=i[0],r=i[1],u&&r&&(o=[u.sn,r.sn],s=o[0],n=o[1],s&&n)){if(s===n)return u.is_list&&!r.is_list;if(a=r.scoped)return s===Kt(n,a)}},rt=function(t,e){var n,r;return(r=Wt(e))&&(n=r.sn,t&&n)?t===n&&!r.is_list:void 0},Q=function(t,e){var n;return n=_.find(yt(t),function(t){return t.an===e}),n||_.find(Rt(t),function(t){return t.an===e})},J=function(t,e,n){var r,i;return i=Xt(t,e),it(i)?null!=n?(r=Kt(t,e),_.find(yt(r),function(t){return t.an===n})):!0:void 0},K=function(t,e){var n;return e?(n=Xt(t,e),it(n)):kt(t)},X=function(t,e,n,r,i,o){var a;return a=_t(n,i,{force_sov:Ce(t)}),a||(a={}),!a.create&&o.create?!1:!a.edit&&o.edit?!1:!a["delete"]&&o["delete"]?!1:!0},Z=function(t,e,n,r,i,o){var a;return a=o.filter,!0},ve=function(t){var e,n,r,i;n=Yt(),r=[];for(e in n)i=n[e],i.sn&&r.push(t.call(null,e,i.sn));return r},me=function(t){var e,n,r,i;n=Yt(),r=[];for(e in n)i=n[e],(i.scoped||i.is_my_scope)&&r.push(t.call(null,e,i.scoped,i.is_my_scope));return r},ye=function(t){var e,n,r,i;n=Yt(),r=[];for(e in n)i=n[e],i.vref&&r.push(t.call(null,e,i.vref));return r},be=function(t){var e,n,r,i,o,a,s,u;a=Yt(),s=[];for(e in a)u=a[e],u.items&&s.push(function(){var a,s,l,c;for(l=u.items,c=[],i=a=0,s=l.length;s>a;i=++a)n=l[i],n.vref&&(o=n.dref.split(":"),1===o.length?c.push(t.call(null,e,u.sn,n.vref)):"_eas"===o[0]?(r=Kt(u.sn,o[1]),c.push(t.call(null,e,r,n.vref))):c.push(void 0));return c}());return s},le=function(t){var e,n,r,i,o,a,s,u;o=Yt(),s=[];for(e in o)u=o[e],u.items&&s.push(function(){var o,s,l,c,h;for(l=u.items,h=[],i=o=0,s=l.length;s>o;i=++o)r=l[i],r.aref&&(c=r.aref.split(":"),n=c[0],a=2<=c.length?On.call(c,1):[],h.push(t.call(null,e,i,r,n,a)));return h}());return s},ce=function(t){var e,n,r,i,o,a,s,u,l;a=Yt(),u=[];for(e in a)l=a[e],l.items&&u.push(function(){var a,u,c,h,f;for(c=l.items,f=[],i=a=0,u=c.length;u>a;i=++a)r=c[i],r.dref&&(o=r.dref.split(":"),1===o.length?f.push(t.call(null,e,i,r,"attr",[])):(h=[o[0],_.rest(o)],n=h[0],s=h[1],f.push(t.call(null,e,i,r,n,s))));return f}());return u},pe=function(t){return ce(function(e,n,r,i,o){switch(i){case"_eas":return t.call(null,e,n,Wt(e).sn,o[0]);case"_ecc":if(o.length>1)return t.call(null,e,n,Wt(e).sn,o[0])}})},fe=function(t){return ce(function(e,n,r,i){var o;return"attr"===i?(o=Wt(e).sn,t.call(null,e,n,r,o,r.dref)):void 0})},he=function(t){return ce(function(e,n,r,i,o){var a,s,u;return"_eas"===i?(s=Wt(e).sn,u=o[0],a=o[1],t.call(null,e,n,r,i,s,u,a)):void 0})},de=function(t){return ce(function(e,n,r,i,o){var a,s;if("count"===i)switch(o.length){case 1:return a=o[0],t.call(null,e,n,r,i,a);case 2:return a=Wt(e).sn,s=Xt(a,zidx),t.call(null,e,n,r,i,a,s.zidx)}})},ue=function(t){var e,n,r,i,o;i=Ut(),n=Yt(),r=[];for(e in n)o=n[e],o.acl&&(_.isEmpty(o.acl)?r.push(void 0):r.push(t.call(null,e,i,o,o.acl)));return r},ge=function(t){var e,n,r,i,o;i=Ut(),n=Yt(),r=[];for(e in n)o=n[e],o.is_list&&o.list_opts&&r.push(t.call(null,e,i,o,o.list_opts));return r},i=function(){var e,n,r,i;Gt()||t("invalid-struct-user",{}),e=St(),n=[];for(i in e)r=e[i],Y(i)?n.push(void 0):n.push(t("invalid-user-sn",O(i,"")));return n},r=function(){var e,n,r,i,o,a,s,u,l,c,h,f,d;s=St();for(d in s)f=s[d],W(d)||t("invalid-struct-sn",O(d,"")),G(f)||t("invalid-struct-label",O(d,f.label));u=St();for(d in u)if(f=u[d],f.attrs){for(l=f.attrs,n=i=0,a=l.length;a>i;n=++i)e=l[n],U(d,e)||t("invalid-struct-attr",O(f.label,e.label));o=function(){var t,n,r,i;for(r=f.attrs,i=[],t=0,n=r.length;n>t;t++)e=r[t],e.is_label&&i.push(e);return i}(),f.email_is_label&&o.push("email"),o.length>1&&t("invalid-label-field",O(d,o))}c=St(),h=[];for(d in c)f=c[d],f.comp_uniq?h.push(function(){var e,n,i,o;for(i=f.comp_uniq,o=[],e=0,n=i.length;n>e;e++)r=i[e],dt(r)&&dt(r).unique?o.push(void 0):o.push(t("invalid-comp-uniq",O(f.label,f.comp_uniq)));return o}()):h.push(void 0);return h},e=function(){var e,n,r,i,o;r=gt(),i=[];for(n in r)e=r[n],q(e)?i.push(void 0):(o=kt(e.psn).label+":"+kt(e.csn).label,i.push(t("invalid-assoc",O(o,e))));return i},n=function(){var e,n,r,i;r=gt(),i=[];for(n in r)e=r[n],H(e)?i.push(void 0):i.push(t("invalid-assoc",O("user",e)));return i},o=function(){var e,n,r,i,o,a,s;n=te(),r=[];for(i in n)s=n[i],r.push(function(){var n;n=[];for(a in s)o=s[a],n.push(function(){var n,r,s,u;for(s=o.apath.split(","),u=[],n=0,r=s.length;r>n;n++)e=s[n],dt(e)?u.push(void 0):u.push(t("invalid-z",O(i,a)));return u}());return n}());return r},y=function(){return ve(function(e,n){return et(n)?void 0:t(e,O("invalid-struct-name",n))})},v=function(){return me(function(e,n,r){return tt(e,n,r)?void 0:t(e,O("invalid-scope",n))})},p=function(){var e,n,r,i,o,a,s,u,l,c,h,f,d,p,g;i={root:[],seco:[]},l=bt();for(o in l)d=l[o],i.root.push(d.root.views.length),i.seco.push(d.seco.views.length);for(s in i)e=i[s],1!==_.uniq(e).length&&t("invalid-dt-views-count",O(s,e.join(":")));for(f={},n=function(e,r){var i,o,a,s,u;if(!f[e]){for(f[e]=r,d=Wt(e),d.vref&&n(d.vref,r),s=d.items,u=[],o=0,a=s.length;a>o;o++)i=s[o],i.cid&&u.push(n(i.cid,r));return u}return f[e]!==r?t(e,O("dt-conflict",[f[e],r].join(","))):void 0},c=[ht(),ft()],h=[],a=0,u=c.length;u>a;a++)p=c[a],h.push(function(){var t;t=[];for(o in p)g=p[o],t.push(function(){var t,e,i;for(i=[],t=0,e=g.length;e>t;t++)r=g[t],i.push(n(r,o));return i}());return t}());return h},h=function(){var e,n,r,i;n=Yt(),r=[];for(e in n)i=n[e],i.anchor&&(Wt(i.anchor)?r.push(void 0):r.push(t(e,O("invalid-anchor",i.anchor))));return r},b=function(){var e,n,r,i,o,a;i=Yt(),o=[];for(e in i)a=i[e],a.is_tabbed&&(r=function(){var t,e,r,i;for(r=a.items,i=[],t=0,e=r.length;e>t;t++)n=r[t],"view"!==n.type&&i.push(n);return i}(),r.length?o.push(t(e,O("invalid-tabbed-view",r.length))):o.push(void 0));return o},x=function(){return ye(function(e,n){return nt(e,n)?void 0:t(e,O("invalid-vref",n))}),be(function(e,n,r){return rt(n,r)?void 0:t(e,O("invalid-vref-e",O(n,r)))})},d=function(){return fe(function(e,n,r,i,o){return Q(i,o)?void 0:t(e,O("invalid-dref-attr",O(n,i+", "+r.dref)))}),de(function(e,n,r,i,o,a){return K(o,a)?void 0:t(e,O("invalid-dref-count",O(n,o+", "+r.dref)))}),he(function(e,n,r,i,o,a,s){return J(o,a,s)?void 0:t(e,O("invalid-dref-as",O(n,o+", "+r.dref)))})},f=function(){return le(function(e,n,r,i,o){var a,s,u;switch(i){case"_acb":if(s=[Wt(e).sn,o[0]],a=s[0],u=s[1],!Xt(a,u))return t(e,O("invalid-aref-attr",O(n,a+", "+r.aref)))}})},c=function(){return ue(function(e,n,r,i){return X(e,n,r.sn,r.is_list,r.scoped,i)?void 0:t(e,O("invalid-acl",r.sn+" "+JSON.stringify(i)))})},g=function(){return ge(function(e,n,r,i){return Z(e,n,r.sn,r.is_list,r.scoped,i)?void 0:t(e,O("invalid-list-opts",r.sn+" "+JSON.stringify(i)))})},m=function(){var e,n,r,i,o,a,s,u,l,c,h,f,d,p,g,m;u={},r=function(t){return function(t,e){var n,r,i,o;if(t.items)for(o=t.items,r=0,i=o.length;i>r;r++)n=o[r],n.cid&&e.push(n.cid);return t.vref&&e.push(t.vref),e}(Wt(t),[])},l=function(t){var e,n,i,o,a;if(!u[t]){for(u[t]=!0,o=r(t),a=[],n=0,i=o.length;i>n;n++)e=o[n],a.push(l(e));return a}},h=bt();for(n in h)for(m=h[n],f=[m.root,m.seco],i=0,a=f.length;a>i;i++)if(g=f[i])for(d=g.views,o=0,s=d.length;s>o;o++)e=d[o],l(e);c={},p=Yt();for(e in p)m=p[e],u[e]||(c[e]=!0);return _.isEmpty(c)?void 0:t("invalid-view-or",c)},s=function(){var e;return e=plan_quotas.models,At()>e.v?t("Error: "+e.hint,e):void 0},u=function(){var e;return e=plan_quotas.pages,
Pt()>e.v?t("Error: "+e.hint,e):void 0},vn=function(){return a=null,i(),r(),e(),n(),o(),s(),a||(a=yn())},yn=function(){return a=null,y(),v(),d(),f(),x(),p(),h(),b(),c(),g(),m(),u(),a},dn=function(t,e,n){var r,i,o,a,s;return a=JSON.stringify({_mods:j,_rels:E,_zscs:T,_meta:P}),o=JSON.stringify({lock:A,enable_guest:M}),s=JSON.stringify({_vdts:xn,_pgvs:kn}),i=t(),k(),S(),(r=vn())?(V(JSON.parse(a),JSON.parse(o)),wn(JSON.parse(s)),F(r),n?n(r):delay(200,function(){return an()})):e&&e(i),i},pn=function(t,e,n){var r,i,o;return o=JSON.stringify({_vdts:xn,_pgvs:kn}),i=t(),k(),S(),(r=yn())?(wn(JSON.parse(o)),F(r),n?n(r):delay(200,function(){return an()})):e&&e(i),i},F=function(t){var e;return e=_.keys(t)[0],en(I18n.t("js.editor.error."+e,{defaultValue:e}))}}}(this)(),SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(t){return t.getScreenCTM().inverse().multiply(this.getScreenCTM())},re=null,ie=null,se=null,oe=null,ae=null,ne=528,ee=450,function(t){return function(){var t,e,n,r,i,o,a,s,u,l;return e=null,i=null,r=null,n=null,t=function(t){return t&&t.required,1},l=function(){var t;return t=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},{x:t(30,ne-130),y:t(30,ee-130)}},u=function(t,n,r,i){var o,a,s,u,c,h;return u=n,i&&(u="\uf007 "+n),r||(r=l()),h=Ve(t),o=h[0],a=h[1],c={size:{width:88,height:36},position:r,attrs:{text:{text:u,label:n},".outer":{stroke:o,fill:a,rel:t}}},s=new joint.shapes.erd.Entity(c),e.addCell(s),s},s=function(n,r,i,o,a,s){var u,l,c,h;return c={source:{id:n.id},target:{id:r.id},attrs:{".connection":{"stroke-width":t(o),rel:"as-"+s},".labels":{rel:"as-"+s}}},u=[],o.multiple&&(h="n",u.push({position:-18,attrs:{text:{dy:0,text:h}}})),o.required?(h="*",u.push({position:12,attrs:{text:{dy:0,text:h}}})):o.required||(h="0..1"),u.length&&(c.labels=u),l=new joint.shapes.erd.Line(c),a&&(l.set("vertices",a),l.set({smooth:!1})),e.addCell(l),l},a=function(){return i=se()},ie=function(t,e,n,i){var o;return null==i&&(i=!0),o=e.label,r[t]=u(t,o,n,e.acts_as_user),ae(t),i&&a()},o=function(t,e,i,o){var u,l,c,h;return null==o&&(o=!0),c=[t.psn,t.csn],h=c[0],u=c[1],l=[h,u].join("-"),r[h]&&r[u]?(n[l]={cell:s(r[h],r[u],{label:null},t,i,e),as:t},o&&a()):void 0},se=function(){var t,n,i,o,a,s,u,l,c,h,f,d;if(e){for(u={},d={},l=e.attributes.cells.models,n=0,o=l.length;o>n;n++)switch(a=l[n],a.attributes.type){case"erd.Entity":i=a.attributes.attrs.text.label,h=R(i),u[h]=a.attributes.position;break;case"erd.Line":f=_.find(r,function(t){return t.attributes.id===a.attributes.source.id}).attributes.attrs.text.text,t=_.find(r,function(t){return t.attributes.id===a.attributes.target.id}).attributes.attrs.text.text,i=null!=(c=a.attributes.labels)?c[0].attrs.text.text:void 0,s=[f,t,i].join("-"),d[s]=a.get("vertices")}return{nodes:u,vertices:d}}},re=function(t){var s,u,l,c,h,f,d,p,g,m,v,y,b,_,x;r={},n={},$("#paper").empty(),e=new joint.dia.Graph,h=new joint.dia.Paper({el:$("#paper"),width:ne,height:ee,gridSize:1,model:e}),b=new Date,d=St();for(y in d)l=d[y],f=null!=(p=i||t)?p.nodes[y]:void 0,ie(y,l,f,!1);g=gt();for(u in g)s=g[u],c=[s.psn,s.csn].join("-"),x=null!=(m=i||t)&&null!=(v=m.vertices)?v[c]:void 0,o(s,u,x,!1);return e.on("change",function(t){return a()}),_=new Date},oe=function(){var t,n,r,i,o;return i=joint.layout.DirectedGraph.layout(e,{setLinkVertices:!1}),o=i.width,r=i.height,t=(ne-o)/2,n=(ee-r)/2,_.each(e.getElements(),function(e){return e.translate(t,n)}),{width:o,height:r}},ae=function(t){var e,n,r,i,o,a,s,u;for(a=$("#paper g.link"),a.find(".connection").css({"stroke-width":1,stroke:"#eee"}),a.find(".labels text").css({fill:"#ccc"}),s=F(t),i=0,o=s.length;o>i;i++)e=s[i],r=e._cn,u=e.required?3:1,n=e.required?"#333":"#111",a.find(".connection[rel='as-"+r+"']").css({"stroke-width":u,stroke:n}),a.find(".labels[rel='as-"+r+"'] text").css({fill:n});return $("#paper g.Entity .outer").each(function(e){var n,r;return n=$(this),r=n.attr("rel")===t?3:2,n.css({"stroke-width":r})})},$(document).on("click","#paper g.Entity .outer",function(){var t;return t=$(this).attr("rel"),hn(t),ae(t),!1}),$(document).on("click","#paper",function(){var t;return t=$("#paper g.link"),t.find(".connection").css({"stroke-width":1,stroke:"#111"}),t.find(".labels text").css({fill:"#111"})})}}(this)(),l=function(){return $.active},jt=function(){return window.rev},$n=function(t){return window.rev=t.toString()},an=null,on=null,H=null,Nn=null,U=null,_e=$("#is_demo").text(),function(t){return function(){var t,e,n,r,i,o,a,s,u,c,h,f,d,p,g,m,y,b,x,w,k,S,C,E,M;return o=function(){return["eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9","PwdnUlDH_4eXSpqTtI1qE5fbVrbkUchvLykaRGq3ztU"]},U={last_step:null,sn:null,vn:[]},t=null,s={data:"init",extra:"init"},i=function(t){var e,n;try{return n=t.split(".")[1],e=JSON.parse(Base64.decode(n)),e._data}catch(r){return{}}},a=function(t){var e,n,r,i;return r=Base64.encodeURI(JSON.stringify({_data:t})),i=o(),n=i[0],e=i[1],[n,r,e].join(".")},c=function(){return"u/"+window._gid+"/editor"},e=function(t){switch(t.status){case 406:if(confirm(I18n.t("js.confirm.upgrade_ver")))return document.location.reload(!0);break;default:return en("Ops, "+t.statusText+" ("+t.status+")")}},n=function(t){return $.ajax({dataType:"text",url:"/"+c()+"/start",data:{},success:function(e){return t(i(e))}})},C=function(){return $.ajax({type:"POST",dataType:"json",url:"/"+c()+"/toggle_data_lock",data:{},success:function(t){return A=t.lock,b()}})},y=function(t){var n,r,i,o;if(_e)return void(t&&t());if(l())return void(t&&t());if("init"===s.data)return void(t&&t());n={},r={data:JSON.stringify(k()),extra:JSON.stringify(S())};for(o in r)i=r[o],s[o]!==i&&(n[o]=i);return _.isEmpty(n)?void(t&&t()):(n.rev=jt(),$.ajax({type:"PUT",dataType:"json",url:"/"+c(),data:{j:a(n)},error:e,success:function(e){$n(e.rev);for(o in n)i=n[o],s[o]=i;return e.upload&&(E(),M(e.upload),s.data=JSON.stringify(k())),t&&t()}}),p())},f=function(t){var e,n,r,i,o,a,s,u,l,c,h,f,d,p,g;for(d={},c=["label","label_plural","color","acts_as_user","email_is_label","sqn"],r=0,s=c.length;s>r;r++)i=c[r],t[i]&&(d[i]=t[i]);for(d.attrs=[],h=t.attrs,a=0,u=h.length;u>a;a++){for(e=h[a],n={},f=["an","label","type","opts","sqn","required","unique","is_label","sortable","searchable","admin_field"],p=0,l=f.length;l>p;p++)o=f[p],(g=e[o])&&(n[o]=g);d.attrs.push(n)}return d.comp_uniq=t.comp_uniq,d},h=function(t){var e,n,r,i,o,a,s,u,l,c;for(l={},s=["psn","csn","multiple","required","unique"],n=0,o=s.length;o>n;n++)r=s[n],null!=(c=t[r])&&(l[r]=c);if(e=t.acl)for(l.acl={},u=["create","edit","delete"],i=0,a=u.length;a>i;i++)r=u[i],null!=(c=e[r])&&(l.acl[r]=c);return l},on=function(t){var e,n,r,i,o,a,s,u,l,c,h,f,d,p,g,m,v,y,b,_,x,w,k,S,C,E,M,A,P,j,T,N,$;for(P={},x=["sn","is_list","scoped","is_my_scope","is_tabbed","label","alc"],l=0,d=x.length;d>l;l++)a=x[l],(N=t[a])&&(P[a]=N);for(w=["vref","anchor"],f=0,p=w.length;p>f;f++)a=w[f],(N=t[a])&&(P[a]=N);for(k=["device_sync"],T=0,g=k.length;g>T;T++)a=k[T],(N=t[a])&&(P[a]=N);for(S=["acl","list_opts"],e=0,m=S.length;m>e;e++)if(a=S[e],N=t[a]){P[a]={};for(h in N)$=N[h],$&&(P[a][h]=$)}for(P.items=[],C=t.items||[],n=0,v=C.length;v>n;n++){for(s=C[n],u={},E=["type","dref","aref","value","pos","allow_guest","brand"],r=0,y=E.length;y>r;r++)c=E[r],(N=s[c])&&(u[c]=N);for(M=["cid","vref"],i=0,b=M.length;b>i;i++)c=M[i],(N=s[c])&&(u[c]=N);if(j=s.style)for(u.style={},A=["has_label","label_inline","label_custom","text_style","text_align","image","downloadable","map"],o=0,_=A.length;_>o;o++)c=A[o],(N=j[c])&&(u.style[c]=N);P.items.push(u)}return P},k=function(){var t,e,n,r,i,o,a,s,u,l,c,d,p,g,m,v,y,b,_,x,w,k,S,C,E,M,A,j,T,N,I;if(s=vn())return null;v={},y=St();for(E in y)S=y[E],v[E]=f(S);e={},b=gt();for(r in b)t=b[r],e[r]=h(t);I={},_=te();for(E in _)if(a=_[E]){I[E]={};for(N in a)T=a[N],T&&(I[E][N]=T)}m={};for(l in P)A=P[l],A&&(m[l]=A);o=xn,j={};for(n in kn)A=kn[n],j[n]=on(A);for(i=$.io.form($(".step-settings .panel-body")).object(),C={user:{}},x=["title","description","locale","timezone"],u=0,d=x.length;d>u;u++)l=x[u],null!=(A=i[l])&&(C[l]=$.trim(A));for(w=["brand"],c=0,p=w.length;p>c;c++)l=w[c],null!=(A=i[l])&&(C[l]=A);for(k=["enable_guest","enable_registration","enable_notification"],M=0,g=k.length;g>M;M++)l=k[M],null!=(A=i.user[l])&&(C.user[l]=A);return{_mods:v,_rels:e,_zscs:I,_meta:m,_vdts:o,_pgvs:j,_cfgs:C}},S=function(){var t;return t=se()||dd_graph,{graph:t}},E=function(){var t,e,n,r,i,o,a,s,u,l,c,h;$("input[name*=-upload-cache]").val(""),$("input[name*=-upload-fname]").val(""),o=St();for(c in o)for(l=o[c],a=l.attrs,r=0,i=a.length;i>r;r++)t=a[r],"image"===t.type&&t.opts&&(t.opts["default-upload-cache"]=null,t.opts["default-upload-fname"]=null);s=Yt(),u=[];for(e in s)h=s[e],u.push(function(){var t,e,r,i;for(r=h.items,i=[],t=0,e=r.length;e>t;t++)n=r[t],"image"===n.type&&n.brand&&(n.brand["image-upload-cache"]=null,i.push(n.brand["image-upload-fname"]=null));return i}());return u},M=function(t){var e,n,r,i,o;r=Yt(),i=[];for(e in r)o=r[e],i.push(function(){var e,r,i,a;for(i=o.items,a=[],e=0,r=i.length;r>e;e++)n=i[e],"image"===n.type&&n.value&&a.push(d(t,n,"value"));return a}());return i},d=function(t,e,n){var r,i,o,a;o=[];for(r in t)a=t[r],r.length>10&&a.length>10&&(-1!==(null!=(i=e[n])?i.indexOf(r):void 0)?o.push(e[n]=a):o.push(void 0));return o},b=function(){var t,e,n;return n=$(".data-lock-indicator"),t=$("a.dlock, button.dlock, .action-btn.dlock"),e=$("input.dlock, select.dlock"),A?(n.removeClass("fa-unlock").addClass("fa-lock"),t.hide(),e.attr("disabled","disabled")):(n.removeClass("fa-lock").addClass("fa-unlock"),t.show(),e.removeAttr("disabled"))},x=function(t){var e,n,r,i,o;switch(kt(U.sn)||(U.sn=null),n=U.vn,i=n[0],o=n[1],e=function(){switch(i){case"root":return Tt(device_type).views[o];case"seco":return Ot(device_type).views[o];default:return null}}(),t){case"step-data":re(dd_graph),S().graph||oe(),hn(U.sn);break;case"step-app":cn(),fn(e);break;case"step-preview":r=device_type,"step-data"===U.last_step&&(r="cms"),$(".step-preview .preview-btn[rel='"+r+"']").click()}return g(),Holder.run()},an=function(){var e;switch(e=t){case"step-data":x(e);break;case"step-app":x(e)}return null},u=function(t){var e,n;return window.dd_graph=JSON.parse(t.extra).graph,V(t.core,t.conf),wn(t.apps),s.data=JSON.stringify(k()),s.extra=JSON.stringify(S()),n=(e=window.location.pathname.match(/\/editor\/?([^\/]+)/))?"step-"+e[1]:"step-settings",r(n,{replacestate:!0})},r=function(e,n){var r,i,o,a,s;if(null==n&&(n={}),t!==e){if(s=function(){switch(e){case"step-settings":return"Settings";case"step-data":return"Data Model";case"step-app":return"Mobile App";case"step-preview":return"Preview"}}(),s&&(r=$("head title"),r.text([r.attr("text"),s].join(" - "))),U.last_step=t,t=e,$("#side-menu .a").removeClass("active"),$("#side-menu #"+e).addClass("active"),$(".step-body").removeClass("active"),$("."+e).addClass("active"),_e)return void x(e);switch(i=e.split("-")[1],n.pushstate?history.pushState({step:e},"","/"+c()+"/"+i):n.replacestate&&history.replaceState({step:e},"","/"+c()+"/"+i),e){case"step-preview":y(function(){return x(e)});break;default:x(e),y()}if(!window._rails_test)switch(o='<div class="popover default-help" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',e){case"step-data":if(_.keys(St()).length<2)return $(".step-data .default-help").popover({template:o}).popover("show");break;case"step-app":if(!(null!=(a=bt.phone)?a.root.views.length:void 0))return $(".step-app .default-help").popover({template:o}).popover("show")}}},w=function(t){var e,n,r,i,o,a,s,u;return null==t&&(t=device_type),a=$(".step-preview #dev-preview-"+t+" .iframe"),0===a.find("iframe").length?(r=$(window).height()-51-100-6+4,s=U.sn||"",e={cms:{path:"/u/"+_gid+"/cms/"+s,w:"100%",h:r+"px"},phone:{path:"/u/"+_gid+"/web?device_type=phone",w:"100%",h:"640px"},tablet:{path:"/u/"+_gid+"/web?device_type=tablet",w:"100%",h:"640px"}},o=e[t],i=o.path,u=o.w,n=o.h,$("<iframe src='"+i+"' width='"+u+"' height='"+n+"' scrolling='yes' frameborder='0'/>").append("<p>Your browser does not support iframes</p>").appendTo(a)):void 0},p=function(){return $("#dev-preview iframe").remove()},m=function(){var t;return t=$(window).height(),$(".step-app .col-w").outerHeight(t-51)},function(){return $(document).on("blur","input.lat-lng",function(){var t;return t=$(this).closest(".location"),Ke(t),!1}),$(document).on("click",".get-location",function(){var t;return t=$(this).closest(".location"),qe(t,function(){return Ke(t)}),!1}),$(document).on("click",".pin-location",function(){var t;return t=$(this).closest(".location"),Ze(t),!1}),$(document).on("click",".clear-location",function(){var t;return t=$(this).closest(".location"),Ae(t),!1})}(),$("#back-to-overview").click(function(){var t;return t=$(this).attr("rel"),y(function(){return window.location.href=t}),!1}),$("#side-menu .a").click(function(t){return r($(this).attr("id"),{pushstate:!0}),!1}),$("#save-all").click(function(){return y(),!1}),$(document).on("click","#toggle-data-lock",function(){return C(),!1}),$(document).on("change","#enable_guest",function(){return v($(this).is(":checked")),!1}),$(document).on("click",".step-preview .preview-btn",function(){var t,e;return e=$(this).attr("rel"),t=$(".qr-code"),"phone"===e||"tablet"===e?(0===t.find("canvas").length&&(t.css({transition:"all 1s"}),t.qrcode({size:~~t.attr("qrc-size"),text:t.attr("qrc-url")})),t.css({opacity:.9})):t.css({opacity:0}),("phone"===e||"tablet"===e)&&(window.device_type=e),w(e),!0}),$(document).on("click",".reload-device-preview",function(){var t,e;return t=$(this).find("i"),t.addClass("fa-spin"),delay(1e3,function(){return t.removeClass("fa-spin")}),$("#dev-preview .tab-pane.active").find("iframe").remove(),e=$(".step-preview .active > .preview-btn").attr("rel"),w(e),!1}),$(document).on("click","#data-import-form .dlg-save",function(){var t,e;return e=$("#data-import-form"),t=e.find("input[name=import]"),gn(t)&&y(function(){return mn(t,function(t){var e;return e=i(t),e.error?en(e.error):($n(e.rev),u(e.data),U.sn=_.last(_.keys(St())),x("step-data"))}),e.modal("hide")}),!1}),$(document).on("mouseenter","#device-preview .dummy0 .i-handle",function(){return 0===$(this).parent().find(".partial-view").length?(H.setTarget("pv",$(this),".partial-view"),Nn.setTarget()):void 0}),$(document).on("mouseenter","#device-preview .s-handle",function(){return 0===$(this).parent().find(".partial-view").length?(Nn.setTarget("pv",$(this),".partial-view"),H.setTarget()):void 0}),$("#device-preview-con").scroll(function(){return g()}),$(window).resize(function(){return g()}),g=function(){return H.setTarget(),Nn.setTarget()},window.onpopstate=function(t){var e;return(e=t.state.step)?r(e):void 0},$(function(){var t,e,o,a,s,l,h,f,d,p,g,v,y,_;if(m(),$(window).resize(function(){return m()}),window.innerHeight<850&&$(".step-app").addClass("pv-compact"),h=Je(),H=h[0],Nn=h[1],y={prefix:"brand"},_e&&(y.before_send=function(){return en(I18n.t("js.demo.hint_no_upload")),!1}),sn($,"/"+c()+"/upload_image",y),Re($(".step-settings .form")),b(),o=_e){if(f=o.split(":"),v=f[0],a=f[1],l="step-"+v,e=i(a),window.dd_graph=JSON.parse(e.extra).graph,V(e.core,e.conf),wn(e.apps),r(l),_=window.location.toString(),s=_.match(/model=(.+)/)){d=St();for(g in d)p=d[g],p.label===decodeURIComponent(s[1])&&hn(g)}return void((s=_.match(/popup=(.+)/))&&(t=bt().phone.seco.views[~~s[1]-1],fn(t)))}return n(function(t){return u(t)})})}}(this)(),Holder.invisible_error_fn=function(t){return function(e){setTimeout(function(){t.call(this,e)},10)}}}.call(this);